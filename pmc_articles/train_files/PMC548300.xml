<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id><journal-title>BMC Evolutionary Biology</journal-title><issn pub-type="epub">1471-2148</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15663782</article-id><article-id pub-id-type="pmc">PMC548300</article-id><article-id pub-id-type="publisher-id">1471-2148-5-6</article-id><article-id pub-id-type="doi">10.1186/1471-2148-5-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Inference of demographic history from genealogical trees using reversible jump Markov chain Monte Carlo</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Opgen-Rhein</surname><given-names>Rainer</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>opgen@stat.uni-muenchen.de</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Fahrmeir</surname><given-names>Ludwig</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>fahrmeir@stat.uni-muenchen.de</email></contrib><contrib id="A3" corresp="yes" contrib-type="author"><name><surname>Strimmer</surname><given-names>Korbinian</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>korbinian.strimmer@lmu.de</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Statistics, University of Munich, Ludwigstr. 33, D-80539 Munich, Germany</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>21</day><month>1</month><year>2005</year></pub-date><volume>5</volume><fpage>6</fpage><lpage>6</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2148/5/6"/><history><date date-type="received"><day>29</day><month>6</month><year>2004</year></date><date date-type="accepted"><day>21</day><month>1</month><year>2005</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2005 Opgen-Rhein et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2005</copyright-year><copyright-holder>Opgen-Rhein et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Opgen-Rhein
               Rainer
               
               opgen@stat.uni-muenchen.de
            </dc:author><dc:title>
            Inference of demographic history from genealogical trees using reversible jump Markov chain Monte Carlo
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Evolutionary Biology 5(1): 6-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2148(2005)5:1&#x0003c;6&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2148</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Coalescent theory is a general framework to model genetic variation in a population. Specifically, it allows inference about population parameters from sampled DNA sequences. However, most currently employed variants of coalescent theory only consider very simple demographic scenarios of population size changes, such as exponential growth.</p></sec><sec><title>Results</title><p>Here we develop a coalescent approach that allows Bayesian non-parametric estimation of the demographic history using genealogies reconstructed from sampled DNA sequences. In this framework inference and model selection is done using reversible jump Markov chain Monte Carlo (MCMC). This method is computationally efficient and overcomes the limitations of related non-parametric approaches such as the skyline plot. We validate the approach using simulated data. Subsequently, we reanalyze HIV-1 sequence data from Central Africa and Hepatitis C virus (HCV) data from Egypt.</p></sec><sec><title>Conclusions</title><p>The new method provides a Bayesian procedure for non-parametric estimation of the demographic history. By construction it additionally provides confidence limits and may be used jointly with other MCMC-based coalescent approaches.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The coalescent is a very versatile stochastic model of the genetic variation in a set of sequences sampled from a population. It allows to accommodate a wide range of assumptions about rates and modes of evolution, and of population history [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B5">5</xref>].</p><p>As the observed sequence data are positively correlated due to common ancestry, coalescent theory also provides a framework for understanding the relationship between a population's history and its genealogy. For instance, it has long been noted that genealogies of samples taken from exponentially growing populations tend to be "star-like" with short branch lengths near the root of the tree. In contrast, the inter-node distances in genealogies from constant-size populations typically are much more evenly spaced. </p><p>Thus, coalescent theory quantifies the imprint that demographic development of a population leaves in the data. While the original theory was outlined for constant population size [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>], Slatkin and Hudson [<xref ref-type="bibr" rid="B6">6</xref>] soon developed a coalescent model for the case of an exponentially growing population. Subsequently, a general approach allowing arbitrary population size variation through time was presented by Griffith and Tavar&#x000e9; [<xref ref-type="bibr" rid="B7">7</xref>].</p><p>Therefore at least in principle the coalescent model provides a basis for <italic>statistically inferring the demographic history </italic>as a function of time from the sampled sequences [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B12">12</xref>] or, alternatively, from the corresponding inferred genealogies [<xref ref-type="bibr" rid="B13">13</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. In practice, however, application of coalescent theory to this problem has been restricted to very simple demographic scenarios such as constant size, exponential or logistic growth.</p><p>Only recently methods have emerged that attempt the completely non-parametric estimation of the demographic function from the data. Polanski et al. proposed an approach based on pairwise distances [<xref ref-type="bibr" rid="B16">16</xref>], hence generalizing the method by Slatkin and Hudson [<xref ref-type="bibr" rid="B6">6</xref>]. Pybus et al. [<xref ref-type="bibr" rid="B14">14</xref>] presented the "skyline plot" method that uses a step-function to approximate the population history obtained from an estimated genealogy. This method was subsequently refined to the "generalized skyline plot" [<xref ref-type="bibr" rid="B17">17</xref>] which is essentially a regularized version of the classic skyline plot. If the population size is truly constant through time the generalized skyline plot estimate of population size collapses to the phylogenetic coalescent estimator proposed by Felsenstein [<xref ref-type="bibr" rid="B13">13</xref>].</p><p>The advantage of the skyline plot over the method suggested by Polanski et al. [<xref ref-type="bibr" rid="B16">16</xref>] is that it takes into account the genealogical relationship among the sequences. This helps to decrease bias and improves the efficiency of the resulting estimator compared to methods based on summary statistics and pairwise distances [<xref ref-type="bibr" rid="B13">13</xref>]. Unfortunately, the skyline plot approach also has several deficiencies. First, it is unclear how to extend the approach to allow multiple genealogies as input. This is important in order to accommodate phylogenetic error, and to allow non-parametric inference of population history in coalescent approaches that take all possible genealogies into account [<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B10">10</xref>]. Second, and perhaps more critical, the (generalized) skyline plot only provides a population size trend rather than a realistic estimate of population size changes, as by construction the population function is modeled by a step function. Moreover, the change-points of this function are fixed at the inter-nodes of the underlying tree.</p><p>In this paper we propose a novel framework to non-parametric estimation of the demographic history. This approach relies on Bayesian reversible-jump MCMC inference [<xref ref-type="bibr" rid="B18">18</xref>] to obtain a smooth population size function from a given set of genealogies. The new method not only renders many deficiencies of the classic and generalized skyline plot obsolete but it is also computationally efficient, with running times of the algorithm for typical data in the order of minutes on standard PC hardware. The framework has been implemented in the computer language R [<xref ref-type="bibr" rid="B19">19</xref>] and incorporated in the R package APE [<xref ref-type="bibr" rid="B20">20</xref>].</p><p>The remainder of the paper is organized as follows. In the next section we describe the mathematical and statistical theory of the new framework. Subsequently, we apply the method to simulated and biological sequence data and discuss the results. In the last section we briefly outline possible further extensions and related directions of research.</p></sec><sec><title>Results</title><sec><title>Background in coalescent theory</title><sec><title>Basic model</title><p>In a pan-mictic population with constant effective population size <italic>N</italic><sub><italic>e</italic></sub>, where every individual has a single parent, the waiting time <italic>w</italic><sub><italic>n </italic></sub>until any two of <italic>n </italic>sampled lineages coalesce is exponentially distributed with rate <inline-graphic xlink:href="1471-2148-5-6-i1.gif"/>[<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. For <italic>n </italic>sequences there are therefore <italic>n </italic>- 1 intervals <italic>I</italic><sub><italic>n</italic></sub>, <italic>I</italic><sub><italic>n</italic>-1</sub>,..., <italic>I</italic><sub>2 </sub>with rates <italic>r</italic><sub><italic>n</italic></sub>, <italic>r</italic><sub><italic>n</italic>-1</sub>,..., <italic>r</italic><sub>2 </sub>and interval lengths <italic>w</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>n</italic>-1</sub>,..., <italic>w</italic><sub>2</sub>. With <inline-graphic xlink:href="1471-2148-5-6-i2.gif"/> we denote the time until all samples have reached the most recent common ancestor.</p><p>The coalescent model implies that the waiting time to the next coalescent event follows an inhomogeneous Poisson-process with a hazard rate <italic>r</italic><sub><italic>n </italic></sub>that varies in time <italic>t </italic>because of the change in the number of lineages. Thus, it is straightforward to also include variable population size in the coalescent simply by using the hazard rate <inline-graphic xlink:href="1471-2148-5-6-i3.gif"/>. From standard theory in survival analysis [<xref ref-type="bibr" rid="B21">21</xref>] it follows that the corresponding density for the waiting times is given by</p><p><inline-graphic xlink:href="1471-2148-5-6-i4.gif"/></p><p>where <italic>&#x003c4;</italic><sub><italic>i </italic></sub>is the time at the beginning of the interval <italic>I</italic><sub><italic>i</italic></sub>. This is exactly the distribution from the variable population size coalescent</p><p><inline-graphic xlink:href="1471-2148-5-6-i5.gif"/></p><p>as developed in [<xref ref-type="bibr" rid="B7">7</xref>]. The coalescent model can be further expanded to diploid populations [<xref ref-type="bibr" rid="B22">22</xref>] or to include other effects like selection, recombination or geographical structures [<xref ref-type="bibr" rid="B4">4</xref>]. In this paper, however, we focus solely on the coalescent/survival model given by Eq. 2.</p></sec><sec><title>Estimation of population size</title><p>If the waiting times <italic>w</italic><sub><italic>i </italic></sub>are known Eq. 2 can be used directly to estimate <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>). This is typically done by maximizing the likelihood <inline-graphic xlink:href="1471-2148-5-6-i6.gif"/> assuming a simple parametric model for the population size change. For constant population size this has been done in [<xref ref-type="bibr" rid="B13">13</xref>], for more complicated scenarios such as logistic growth see, e.g., [<xref ref-type="bibr" rid="B14">14</xref>].</p><p>In a typical setting, however, the waiting times are themselves estimated from sequence data. In this case the total likelihood function will be a weighted sum of the likelihoods for all possible waiting times, so that in effect the <italic>w</italic><sub><italic>i </italic></sub>are marginalized out in favor of the actually observed data. In practice exact calculation of this sum is prohibitive, hence one relies on approximating MCMC methods [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B10">10</xref>].</p><p>As a shortcut to avoid these computationally very expensive procedures one may also substitute the "true" waiting times by those obtained from inter-node distances of a single estimated gene tree (see, e.g., [<xref ref-type="bibr" rid="B23">23</xref>] for an overview of relevant likelihood-based tree inference methods) and proceed as above. Note that the resulting plug-in approximation ignores the uncertainty from estimating the <italic>w</italic><sub><italic>i </italic></sub>in the inference of demographic parameters. However, this is justifiable if the phylogenetic error is much smaller than the error introduced by the coalescent. This will be the case if sequences are sufficiently long and the substitution rate is comparatively high (a typical example would be virus data).</p><p>For non-parametric estimation of population size, Pybus et al. suggested the "skyline plot" [<xref ref-type="bibr" rid="B14">14</xref>]. This method assumes a piece-wise constant function for the population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) and allows population size changes only at the beginning and end of an interval <italic>I</italic><sub><italic>i</italic></sub>. The estimated effective population size <inline-graphic xlink:href="1471-2148-5-6-i7.gif"/> in interval <italic>I</italic><sub><italic>i </italic></sub>according to the skyline plot is given by the simple relation</p><p><inline-graphic xlink:href="1471-2148-5-6-i8.gif"/></p><p>This is the maximum likelihood estimate under the assumed model of fixed change-points. The "generalized skyline plot" subsequently introduced by Strimmer and Pybus [<xref ref-type="bibr" rid="B17">17</xref>] reduces the over-fitting present in the classic skyline plot by applying a simple form of regularization: adjacent intervals that alone are likely to have high stochastic noise are pooled together (cf. Fig. <xref ref-type="fig" rid="F2">2b</xref> and <xref ref-type="fig" rid="F2">2d</xref>). Choice of an optimal grouping of intervals (i.e. model selection) is performed by employing a second-order variant of the Akaike criterion [<xref ref-type="bibr" rid="B24">24</xref>].</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Comparison of prior and posterior demographic functions </bold><italic>Top row</italic>: Bayesian inference using a prior demographic function with constant mean and constant variance (a 95% confidence band is indicated by showing the 2.5% and 97.5% quantiles). <italic>Bottom row</italic>: Bayesian inference using the "skyline plot" prior function.</p></caption><graphic xlink:href="1471-2148-5-6-2"/></fig></sec></sec><sec><title>A Bayesian non-parametric approach to estimating demographic history</title><sec><title>Outline</title><p>In this paper we present a non-parametric approach to infer population size changes in time that overcomes the limitations of previous approaches. More specifically, we develop a non-parametric Bayesian estimator for the function <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) conditioned on observed or sampled inter-node distances <italic>w</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>n</italic>-1</sub>,..., <italic>w</italic><sub>2 </sub>by determining the posterior distribution P(<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)|<italic>w</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>n</italic>-1</sub>,..., <italic>w</italic><sub>2</sub>). In order to sample the non-parametric demographic function from this posterior we use the reversible jump Markov chain Monte Carlo (rjMCMC) algorithm [<xref ref-type="bibr" rid="B18">18</xref>]. As a result, we obtain for any given time <italic>t </italic>both a point estimate <inline-graphic xlink:href="1471-2148-5-6-i9.gif"/> &#x02013; here we choose the posterior median &#x02013; as well as the associated credible interval (e.g., the lower and upper 2.5% quantiles). If the considered inter-node distances <italic>w</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>n</italic>-1</sub>,..., <italic>w</italic><sub>2 </sub>are fixed and obtained from a single estimated tree, the resulting method is already directly applicable to phylogenetically informative data such as viral sequences (this is the focus of this paper). However, sampling of non-parametric demographic functions can also be combined in a conceptually straightforward fashion with sampling of trees, as outlined below.</p></sec><sec><title>Bayesian inference using reversible jump MCMC</title><p>In a nutshell, Bayesian inference of a parameter <italic>x </italic>consists of updating its prior distribution P(<italic>x</italic>) to a posterior distribution P(<italic>x</italic>|<italic>D</italic>) that takes account of the information in the observed data <italic>D</italic>. The relative evidence of the data for different values of <italic>x </italic>is summarized in the likelihood <italic>L </italic>= P(<italic>D</italic>|<italic>x</italic>) that accordingly plays a central role in the computation of the posterior via Bayes' theorem</p><p><inline-graphic xlink:href="1471-2148-5-6-i10.gif"/></p><p>For most realistic problems the posterior distribution cannot be computed analytically, in particular if <italic>x </italic>is a high-dimensional vector. Instead, one utilizes computational procedures to efficiently draw random samples from the posterior. This in turn allows computation of summary statistics such as the median or the upper and lower 2.5% quantiles. Markov chain Monte Carlo (MCMC) is one particularly useful sampling algorithm as it doesn't require calculation of the sum (or integral) in the nominator of Eq. 4. Briefly, sampling via MCMC is done by constructing a Markov chain with the possible combinations of parameter values as "states", and the desired posterior as its stationary distribution. These properties can be guaranteed by following certain rules for accepting or rejecting proposed new parameter values. Here we use the Metropolis-Hastings-Green method, i.e. the reversible jump MCMC algorithm [<xref ref-type="bibr" rid="B18">18</xref>], that has the advantage of not only allowing changes in the parameters values but also in the dimension of the parameter vector itself. Specifically, if <italic>x </italic>is the initial state, and <inline-graphic xlink:href="1471-2148-5-6-i11.gif"/> a proposed new state with proposal density <inline-graphic xlink:href="1471-2148-5-6-i12.gif"/>, then the acceptance probability according to Green [<xref ref-type="bibr" rid="B18">18</xref>] is</p><p><inline-graphic xlink:href="1471-2148-5-6-i13.gif"/></p><p>where <inline-graphic xlink:href="1471-2148-5-6-i14.gif"/> is the likelihood ratio P(<italic>D</italic>|<inline-graphic xlink:href="1471-2148-5-6-i11.gif"/>)/P(<italic>D</italic>|<italic>x</italic>), <inline-graphic xlink:href="1471-2148-5-6-i15.gif"/> is the prior ratio P(<inline-graphic xlink:href="1471-2148-5-6-i11.gif"/>)/P(<italic>x</italic>), <inline-graphic xlink:href="1471-2148-5-6-i16.gif"/> is the proposal ratio <italic>q</italic>(<inline-graphic xlink:href="1471-2148-5-6-i11.gif"/>)/<italic>q</italic>(<italic>x</italic>), and <inline-graphic xlink:href="1471-2148-5-6-i17.gif"/> is the determinant of the Jacobian resulting from the potential change of dimension of the parameter vector.</p><p>Accordingly, for the application of MCMC to infer the functional form of demographic history a variety of components need to be specified:</p><p>&#x02022; a suitable <italic>parameterization </italic>of the estimated function <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)</p><p>&#x02022; the <italic>likelihood function</italic>,</p><p>&#x02022; a <italic>prior distribution </italic>for each considered variable, and,</p><p>&#x02022; rules to construct the <italic>Markov chain </italic>(i.e. acceptance probabilities).</p><p>In the following sections we now describe each of these elements in detail. For further general information on the statistical and mathematical background of the MCMC algorithm we refer to the many excellent monographs on this topic (e.g., [<xref ref-type="bibr" rid="B25">25</xref>]).</p></sec><sec><title>Parameterization of <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>)</title><p>In our suggested procedure we approximate the sampled demographic history <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) by a piecewise linear function. This spline of first order degree consists of a first node at position <italic>a</italic><sub>0 </sub>= 0 and height <italic>h</italic><sub>0</sub>, followed by <italic>k </italic>internal supporting nodes at (<italic>a</italic><sub>1</sub>; <italic>h</italic><sub>1</sub>), (<italic>a</italic><sub>2</sub>;<italic>h</italic><sub>2</sub>),..., (<italic>a</italic><sub><italic>k</italic></sub>; <italic>h</italic><sub><italic>k</italic></sub>), and a terminal node at <inline-graphic xlink:href="1471-2148-5-6-i18.gif"/> with height <italic>h</italic><sub><italic>k</italic>+1 </sub>Hence, the spline is defined for all <italic>t </italic>&#x02208; [0, <italic>T</italic>], and for any given <italic>k </italic>the it contains <italic>k </italic>free position parameters and <italic>k </italic>+ 2 free height parameters. Note that, unlike in the skyline plot, we do not constrain the change-points <italic>a</italic><sub>1</sub>,..., <italic>a</italic><sub><italic>k </italic></sub>to lie on the grid points defined by the inter-node distances <italic>w</italic><sub><italic>i</italic></sub>. Moreover, we also allow that the number of internal nodes <italic>k </italic>changes during sampling of the population function from the posterior. Hence, <italic>k </italic>is technically a hyper-parameter that controls the roughness of the resulting spline. As will be clear from the outline of the MCMC algorithm below, note that the final point estimate <inline-graphic xlink:href="1471-2148-5-6-i9.gif"/> obtained from posterior sampling will be a mixture of linear splines (i.e. a smooth and possibly nonlinear function) rather than a single spline.</p></sec><sec><title>Likelihood function</title><p>The likelihood <italic>L </italic>employed in our procedure is the product of the densities of the waiting times between subsequent coalescence events, i.e. <inline-graphic xlink:href="1471-2148-5-6-i19.gif"/>. This function depends via Eq. 2 on the effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>), and hence indirectly on the spline parameters <italic>a</italic><sub><italic>i</italic></sub>, <italic>h</italic><sub><italic>i </italic></sub>and <italic>k</italic>. Because <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) is represented by a linear spline, calculation of the likelihood can be done in a computationally efficient fashion.</p></sec><sec><title>Prior distributions</title><sec><title>Number of change-points</title><p>Following [<xref ref-type="bibr" rid="B18">18</xref>] we employ a truncated Poisson-distribution as the prior distribution for <italic>k</italic>, i.e.</p><p><inline-graphic xlink:href="1471-2148-5-6-i20.gif"/></p><p>where <italic>c </italic>is a normalizing constant to ensure that P(<italic>k</italic>) is a proper distribution. For the hard upper limit of the number of change-points we use <italic>k</italic><sub>max </sub>= 30. The parameter <italic>&#x003bb; </italic>acts as a smoothing parameter, set in a typical analysis to about <italic>&#x003bb; </italic>= 0.1 - 1.0.</p><p>As an alternative to using a fixed <italic>&#x003bb; </italic>we also suggest a hierarchical Bayes approach where <italic>&#x003bb; </italic>is drawn from a Gamma distribution</p><p><inline-graphic xlink:href="1471-2148-5-6-i21.gif"/></p><p>with some shape parameter <italic>a </italic>and scale parameter <italic>b </italic>(for instance, <italic>a </italic>&#x02248; 0.5 and <italic>b </italic>&#x02248; 2 so that E(<italic>&#x003bb;</italic>) = <italic>ab </italic>&#x02248; 1 and Var(<italic>&#x003bb;</italic>) = <italic>ab</italic><sup>2 </sup>&#x02248; 2).</p></sec><sec><title>Positions</title><p>We assume that the internal nodes of the spline are <italic>a priori </italic>uniformly distributed in the interval [0, <italic>T</italic>]. As a simple trick to avoid very small inter-node distance we generate <italic>2k </italic>+ 1 random variables, and set the change-points <italic>a</italic><sub><italic>j </italic></sub>= <italic>z</italic><sub>[2<italic>j</italic>] </sub>for <italic>j </italic>= 1,..., <italic>k</italic>. The corresponding joint density is</p><p><inline-graphic xlink:href="1471-2148-5-6-i22.gif"/></p><p>with <italic>a</italic><sub>0 </sub>= 0 and <italic>a</italic><sub><italic>k</italic>+1 </sub>= <italic>T</italic>.</p></sec><sec><title>Heights</title><p>As prior distributions for the heights <italic>h</italic><sub><italic>i </italic></sub>we assume a Gamma distribution</p><p>Gamma(<italic>h</italic><sub><italic>i</italic></sub>|<italic>&#x003b1;</italic><sub><italic>i</italic></sub>, <italic>&#x003b2;</italic><sub><italic>i</italic></sub>) &#x000a0;&#x000a0;&#x000a0; (9)</p><p>which ensures that sampled heights are always positive. The parameters <italic>&#x003b1;</italic><sub><italic>i </italic></sub>and <italic>&#x003b2;</italic><sub><italic>i </italic></sub>determine the <italic>a priori </italic>mean and variance of height <italic>h</italic><sub><italic>i</italic></sub>. More generally, one can also allow fully time-dependent prior parameters <italic>&#x003b1;</italic>(<italic>t</italic>) and <italic>&#x003b2;</italic>(<italic>t</italic>). This is particularly advisable if the population size is known in advance to be subject to large changes in time.</p><p>In a strict Bayesian approach, the choice of the prior distribution for the heights is completely external to the observed data. One simple possibility would, e.g., be to assume an arbitrary constant for the mean and variance. However, we recommend to follow a more pragmatic "empirical Bayes" route and to use the data at hand (or some other related data set) to obtain an informed guess about the prior heights. For example, an assumed constant population size as prior mean could be estimated using the method by Felsenstein [<xref ref-type="bibr" rid="B13">13</xref>]. Another possibility is to employ the skyline plot as a prior mean estimate (this is the default in our program).</p><p>However, note that in practice the actual choice of prior height distribution seems to matter only little for estimating the posterior demographic function (see Figure <xref ref-type="fig" rid="F2">2</xref> and the section on simulated data below). Only when there are few coalescent events per unit of time will the posterior estimate of the demographic function be dominated by the prior.</p></sec></sec><sec><title>Construction of the Markov chain</title><p>There are four different possibilities to change the state defined by the parameters <italic>c</italic><sub><italic>i</italic></sub>, <italic>h</italic><sub><italic>i</italic></sub>, and <italic>k </italic>of the spline describing the effective population size <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>):</p><p>1. varying the position of a change-point (i.e. internal node),</p><p>2. changing the height at a certain change-point,</p><p>3. generating a new change-point ("birth" step), and</p><p>4. deleting an existent change-point ("death" step).</p><p>Let <italic>&#x003b7;</italic><sub><italic>k</italic></sub>, <italic>&#x003c0;</italic><sub><italic>k</italic></sub>, <italic>b</italic><sub><italic>k</italic></sub>, and <italic>d</italic><sub><italic>k </italic></sub>the probabilities of the four moves given <italic>k</italic>, with <italic>&#x003b7;</italic><sub><italic>k </italic></sub>+ <italic>&#x003c0;</italic><sub><italic>k </italic></sub>+ <italic>b</italic><sub><italic>k </italic></sub>+ <italic>d</italic><sub><italic>k </italic></sub>= 1. In order to satisfy the requirement of detailed balance in the corresponding Markov chain the probabilities of birth and death steps (<italic>b</italic><sub><italic>k </italic></sub>and <italic>d</italic><sub><italic>k</italic></sub>) need to be synchronized [<xref ref-type="bibr" rid="B18">18</xref>]. This can be achieved, e.g., by setting</p><p><inline-graphic xlink:href="1471-2148-5-6-i23.gif"/></p><p>and</p><p><inline-graphic xlink:href="1471-2148-5-6-i24.gif"/></p><p>where <italic>c </italic>is chosen so that <italic>b</italic><sub><italic>k </italic></sub>+ <italic>d</italic><sub><italic>k </italic></sub>&#x0003c; 0.9 for all <italic>k</italic>.</p><p>Next, we describe the individual procedures to propose and accept one of the above four moves as implemented in our program.</p><sec><title>Height change</title><p>First, a height <italic>h</italic><sub><italic>j </italic></sub>is selected out of the <italic>k </italic>+ 2 existing heights with probability <inline-graphic xlink:href="1471-2148-5-6-i25.gif"/>. Second, a new height <inline-graphic xlink:href="1471-2148-5-6-i26.gif"/> is generated by <inline-graphic xlink:href="1471-2148-5-6-i26.gif"/> = <italic>h</italic><sub><italic>j </italic></sub>exp(<italic>z</italic>), where <italic>z </italic>is a uniformly distributed random variable on <inline-graphic xlink:href="1471-2148-5-6-i27.gif"/>. Third, the new height is accepted with probability</p><p><inline-graphic xlink:href="1471-2148-5-6-i28.gif"/></p><p>where <italic>&#x003b1; </italic>and <italic>&#x003b2; </italic>are from the prior distribution and <inline-graphic xlink:href="1471-2148-5-6-i14.gif"/> denotes the ratio of the likelihood of the new state <inline-graphic xlink:href="1471-2148-5-6-i11.gif"/> (with modified height) and the likelihood of the current state <italic>x</italic>.</p></sec><sec><title>Position move</title><p>First, a change-point <italic>a</italic><sub><italic>j </italic></sub>is chosen randomly with probability <inline-graphic xlink:href="1471-2148-5-6-i29.gif"/>. Second, its new position <inline-graphic xlink:href="1471-2148-5-6-i30.gif"/> within [<italic>a</italic><sub><italic>j</italic>-1</sub>, <italic>a</italic><sub><italic>j</italic>+1</sub>] is determined by drawing from the corresponding uniform distribution. Third, <inline-graphic xlink:href="1471-2148-5-6-i30.gif"/> is accepted with probability</p><p><inline-graphic xlink:href="1471-2148-5-6-i31.gif"/></p></sec><sec><title>Birth step</title><p>First, the position <italic>a</italic>* of the new change-point is found by uniformly drawing from (0, <italic>L</italic>), and let the neighboring nodes left and right of <italic>a</italic>* have positions <italic>a</italic><sub><italic>j </italic></sub>and <italic>a</italic><sub><italic>j</italic>+1</sub>. Second, the corresponding new height <italic>h</italic>* is generated by randomly disturbing the current height <italic>N</italic><sub><italic>e</italic></sub>(<italic>a</italic>*) on the position <italic>a</italic>* according to <italic>N</italic><sub><italic>e</italic></sub>(<italic>a</italic>*) + <italic>zN</italic><sub><italic>e</italic></sub>(<italic>a</italic>*) where <italic>z </italic>is a uniformly distributed random variable on the interval <inline-graphic xlink:href="1471-2148-5-6-i27.gif"/>. Note that the birth step increases the dimension of the parameter vector from 2<italic>k </italic>+ 2 to 2<italic>k </italic>+ 4 as a new change-point and a new height are generated.</p><p>The corresponding acceptance probability of the birth step is computed according to Eq. 5 with likelihood and prior ratios as above, and with proposal ratio</p><p><inline-graphic xlink:href="1471-2148-5-6-i32.gif"/></p><p>and Jacobi determinant</p><p><inline-graphic xlink:href="1471-2148-5-6-i33.gif"/></p></sec><sec><title>Death step</title><p>This is the inversion of the birth step and consists of removing a change-point. First, <italic>a</italic>* chosen from <italic>a</italic><sub>1</sub>,..., <italic>a</italic><sub><italic>k </italic></sub>with probability <inline-graphic xlink:href="1471-2148-5-6-i29.gif"/>. Second, the corresponding height <italic>h</italic>* is also removed from the vector of spline parameters. The acceptance probability for the death step is</p><p><inline-graphic xlink:href="1471-2148-5-6-i34.gif"/></p><p>where the proposal ratio and the Jacobi determinant is the same as for the birth step.</p></sec></sec><sec><title>Computation of estimated <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) and associated confidence intervals</title><p>In order to obtain an estimate of the effective population size in time we now proceed as follows. First, the Markov chain is started with an initial state that corresponds to a completely flat demographic function, i.e. <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) = <italic>c</italic>, where c is some rough estimate of population size, and <italic>k </italic>= 0. Second, 100,000 repeats of the MCMC algorithm are performed, of which the first 5,000 are ignored to allow for a "burn-in" period.</p><p>Third, the remaining samples are thinned out by a factor of 1:50 to remove auto-correlation. As a result, 1900 independent samples from the joint posterior of the spline parameters <italic>a</italic><sub><italic>i</italic></sub>, <italic>h</italic><sub><italic>i </italic></sub>and <italic>k </italic>are obtained.</p><p>Subsequently, in order to obtain a point estimate <inline-graphic xlink:href="1471-2148-5-6-i9.gif"/> and associated confidence bands we compute the distribution of the effective population size at a number of fixed equidistant time points <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>,..., <italic>t</italic><sub>1000 </sub>&#x02208; [0, <italic>T</italic>]. Finally, we report as summary statistics the corresponding median and the lower and upper 2.5% quantiles.</p></sec><sec><title>Extension to multiple genealogies</title><p>In this paper we have introduced non-parametric sampling of demographic histories assuming a fixed underlying genealogical tree (or equivalently, a fixed set of inter-node distances <italic>w</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>n</italic>-1</sub>,..., <italic>w</italic><sub>2</sub>.)</p><p>However, in our approach &#x02013; unlike previous non-parametric methods such as the skyline plot &#x02013; it is also conceptually straightforward to incorporate phylogenetic error.</p><p>This can be done by joint sampling of trees and demographies according to the following simple algorithm:</p><p>1. Given sequence data <italic>D</italic>, sample a tree <italic>G</italic>* with clock-like branch lengths (see, e.g, refs. [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B26">26</xref>] for suitable methods).</p><p>2. Use the method described in this paper to sample the demographic function conditioned on the inter-node distances <inline-graphic xlink:href="1471-2148-5-6-i35.gif"/> from <italic>G</italic>*.</p><p>3. Repeat steps 1 and 2 to obtain the posterior distribution for the population size function, now conditioned on <italic>D </italic>rather than on some given <italic>w</italic><sub><italic>n</italic></sub>, <italic>w</italic><sub><italic>n</italic>-1</sub>,..., <italic>w</italic><sub>2</sub>.</p><p>Note that each sampled tree may have a different depth <inline-graphic xlink:href="1471-2148-5-6-i36.gif"/>. This means that the interval [0, <italic>T</italic>] for the prior (and posterior) height distribution has to be set in advance (and independent of the <italic>T</italic>*). For the case of 0 &#x0003c;<italic>t </italic>&#x0003c;<italic>T</italic>* sampling of heights then proceeds as described above, while for <italic>T</italic>* &#x0003c;<italic>t </italic>&#x0003c;<italic>T </italic>&#x02013; the region with no data from a given sampled tree &#x02013; the heights are simply drawn from the respective prior distribution.</p></sec></sec></sec><sec><title>Discussion</title><p>In order to test the potential of the proposed reversible jump MCMC algorithm we first applied it to synthetic data simulated according to various demographic scenarios. Subsequently, we reanalyzed two viral data sets from Central Africa and Egypt.</p><sec><title>Computer program</title><p>The proposed framework has been implemented by us for the case of a single underlying genealogy. The program is written in the statistical computer language R [<xref ref-type="bibr" rid="B19">19</xref>] and is incorporated in recent versions of the R package APE [<xref ref-type="bibr" rid="B20">20</xref>].</p><p>To install the APE package, simply run the R program, and enter at the R prompt</p><p>install.packages("ape")</p><p>This downloads the APE package from the Internet. The proposed reversible jump MCMC approach is implemented in the function "mcmc.popsize" of which an extensive description along with examples can be obtained online by typing</p><p>library("ape")</p><p>help(mcmc.popsize)</p><p>into the R command window. The APE package also includes routines for plotting the inferred population function (e.g., all figures in this paper were prepared with APE).</p><p>Note that the use of this R program is only valid if the phylogenetic error is low &#x02013; this is typically the case when the evolutionary rate is high and the available sequences are long (e.g. viral data). If the phylogenetic error is not negligible compared to the coalescent error, please use software such as BEAST [<xref ref-type="bibr" rid="B27">27</xref>].</p></sec><sec><title>Simulated data</title><p>In the simulation setup we followed Pybus et al. [<xref ref-type="bibr" rid="B14">14</xref>] and Strimmer and Pybus [<xref ref-type="bibr" rid="B17">17</xref>]. Specifically, we performed simulations assuming constant population size (<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) = 100) as well as exponential population growth (<italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) = l000<italic>e</italic><sup>-<italic>t</italic></sup>), using 25 and 100 sampled lineages, respectively. To estimate the population size function we employed the proposed MCMC algorithm and the classic and generalized skyline plot. In the former the smoothing parameter <italic>&#x003bb; </italic>was drawn from the hierarchical model with default parameters (<italic>a </italic>= 0.5 and <italic>b </italic>= 2).</p><p>Figure <xref ref-type="fig" rid="F1">1</xref> shows the results from a typical run of the simulations. The top row illustrates the case of constant population size, whereas the bottom row demonstrates exponential growth. On the left in Figure <xref ref-type="fig" rid="F1">1</xref>, top row, the true underlying constant population size is shown (the thick dashed line), together with the estimate provided by the classic skyline plot. On the right, this is contrasted with the estimate obtained by using our reversible jump MCMC algorithm. Clearly, the median of the posterior distribution of <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) is a very good point estimator of the true demographic history. In addition, the 95% confidence band is also automatically obtained by the MCMC method. Interestingly, it can be immediately seen that the uncertainty in <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) increases with a growing distance from the present. This simply reflects the fact that near the root of the tree for constant population size there are only few coalescent events.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Simulated data </bold><italic>Top row</italic>: Example of a simulation with constant population size: (left) true demographic history (dashed line) and estimate obtained with the classic skyline plot; (right) point estimate obtained with rjMCMC and 95% confidence band. <italic>Bottom row</italic>: Example with exponential population growth: (left) true population growth and classic skyline plot; (right) results from rjMCMC approach.</p></caption><graphic xlink:href="1471-2148-5-6-1"/></fig><p>In Figure <xref ref-type="fig" rid="F1">1</xref>, bottom row, an example for a simulation with an exponentially growing population is shown. As for the constant population, the rjMCMC algorithm is capable of recovering the original population size function (shown as thick dashed line) complete with confidence bands, whereas the skyline plot contains a large amount of stochastic noise, and only provides a rough exploratory picture of the population size changes.</p><p>In Figure <xref ref-type="fig" rid="F2">2</xref> the influence of the choice of prior demographic function on the final posterior estimate is investigated using further simulations of an exponentially growing population. The left column depicts the prior distributions (specifically the 2.5%, 50% and 97.5% quantiles for each time point) for two typical cases: a constant prior function (= constant population size with constant variance), and the "skyline plot" prior function (= time dependent piecewise- constant population size and variance). The right column of figure <xref ref-type="fig" rid="F2">2</xref> presents the corresponding posterior distributions as obtained with the present rjMCMC approach. The results for both cases are very similar. This indicates that there is sufficient signal in the data to make the posterior demographic function (almost) independent from the choice of prior distribution. Note that only near the left and right end of the investigated time intervals there are some slight differences. These can be explained by the lack of data points near the borders.</p></sec><sec><title>HIV-1 in Central Africa</title><p>Next, we applied our method to infer the demographic history from a set of HIV-1 sequences from Central Africa. These data was originally used by Vidal et al. [<xref ref-type="bibr" rid="B28">28</xref>] who examined the genetic diversity of HIV-1 type M in this region. Further detailed analysis can be found in Rambaut et al. [<xref ref-type="bibr" rid="B29">29</xref>] and Yusim et al. [<xref ref-type="bibr" rid="B30">30</xref>]. Here we use the reconstructed phylogeny of Yusim et al. with which Strimmer and Pybus also estimated the demographic history by means of the generalized skyline plot [<xref ref-type="bibr" rid="B17">17</xref>].</p><p>Figure <xref ref-type="fig" rid="F3">3</xref> shows the result of the analysis with the reversible jump MCMC algorithm compared with the predictions from the classic and generalized skyline plots. As in Yusim et al. [<xref ref-type="bibr" rid="B30">30</xref>] an evolutionary rate of 0.0023 substitutions per year was assumed to convert the time axis into units of years. The first row of Figure <xref ref-type="fig" rid="F3">3</xref> displays the tree of Yusim et al. [<xref ref-type="bibr" rid="B30">30</xref>] and the corresponding classic skyline plot. The latter exhibits a large amount of noise, nevertheless the main demographic signal is clearly visible in the graph. In contrast, in Figure <xref ref-type="fig" rid="F3">3c</xref> (second row) the effective population size as estimated by the rjMCMC algorithm is displayed. The thick line shows the median and the thin lines the 95% confidence interval. Especially in the middle part of the figure, where most of the data is located, the confidence interval is very narrow, indicating a stable estimation of the demographic history. Also note that for this data the average number of change-points in the MCMC run was <italic>k </italic>= 9.25, i.e. the estimated effective degree of freedom is much less than that implicitly assumed in the classic skyline plot.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>HIV-1 in Central Africa </bold><italic>Top row</italic>: a) underlying genealogy; b) classic skyline plot. <italic>Bottom row</italic>: c) population size function estimated with rjMCMC and corresponding 95% confidence band; d) comparison rjMCMC versus generalized skyline plot.</p></caption><graphic xlink:href="1471-2148-5-6-3"/></fig><p>A comparison with the generalized skyline plot [<xref ref-type="bibr" rid="B17">17</xref>] is shown in Figure <xref ref-type="fig" rid="F3">3d</xref>. This demonstrates that the generalized skyline plot, in contrast to its classic cousin, provides a very good noise-reduced approximation to the demographic history as estimated by the reversible jump MCMC approach. However, especially near the present the step function employed in the generalized skyline plot leads to unrealistic jumps in the population size that are not present in the smooth estimate provided by the proposed MCMC method.</p></sec><sec><title>HCV in Egypt</title><p>In Egypt 10%-20% of the general population are infected with the Hepatitis C virus (HCV) [<xref ref-type="bibr" rid="B31">31</xref>]. This endemicity seems mainly to be caused by percutaneous medical procedures such as needle injections that took place during a countrywide health campaign between 1964 and 1982 against schistosomiasis. In order to investigate this phenomenon blood samples were obtained from various regions of Egypt and used to study the epidemic history of Hepatitis C. For instance, Tanaka et al. [<xref ref-type="bibr" rid="B32">32</xref>] analyzed the molecular evolution of HCV genotype 4a. Specifically, they utilized 47 sequences (AF217800-AF217812 [<xref ref-type="bibr" rid="B31">31</xref>] and AB103424-AB103457 [<xref ref-type="bibr" rid="B32">32</xref>]) from the NS5B region of the HCV subtype 4a to reconstruct the respective phylogeny, and subsequently applied the skyline plot method to infer the demographic history.</p><p>We repeated their analysis with the reversible jump MCMC approach developed in this paper. We downloaded the sequence data from the HCV sequence database [<xref ref-type="bibr" rid="B33">33</xref>] and inferred the corresponding maximum-likelihood genealogy using the TREEFINDER program [<xref ref-type="bibr" rid="B34">34</xref>]. This tree is depicted in Figure <xref ref-type="fig" rid="F4">4a</xref>, next to the demographic history estimated from it by the classic skyline plot (Figure <xref ref-type="fig" rid="F4">4b</xref>). In the bottom of the figure we show the estimated population size function and its 95% confidence bands as obtained by our rjMCMC method (Figure <xref ref-type="fig" rid="F4">4c</xref>) and we also compare our results with those of the generalized skyline plot (Figure <xref ref-type="fig" rid="F4">4d</xref>). For the generating the time axis in these plots we assumed an evolutionary rate of 0.00045 substitutions per year.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>HCV in Egypt </bold><italic>Top row</italic>: a) underlying reconstructed genealogy; b) classic skyline plot. <italic>Bottom row</italic>: c) population size function estimated with rjMCMC and corresponding 95% confidence band; d) comparison rjMCMC versus generalized skyline plot.</p></caption><graphic xlink:href="1471-2148-5-6-4"/></fig><p>Generally, the star-like shape of the inferred tree already is indicative of exponential growth. This is confirmed by both the skyline plot as well as by our analysis (Figure <xref ref-type="fig" rid="F4">4d</xref>). Moreover, it can be seen that around 1940 the growth rate increased (i.e. the slope of <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) in the log-plot changes). Near the present, the rate decreased again. Also note the broadening of the confidence interval since 1940 which reflects the sparsity of available observations. This implies that the claim of Tanaka et al. [<xref ref-type="bibr" rid="B32">32</xref>] that the demographic history recently changed back to constant population size after an exponential growth is not firmly backed by the data. For further biological analysis of the HCV data we refer to Pybus et al. [<xref ref-type="bibr" rid="B35">35</xref>].</p></sec></sec><sec><title>Conclusions</title><p>We have presented a new approach to non-parametric inference of demographic history from an inferred genealogy. This method is based on reversible jump MCMC sampling of the population size function <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>). Unlike its predecessors, the classic and generalized skyline plots, it returns a smooth and realistic estimate of the demographic history and thus overcomes the constraints due to assuming a step function. Moreover, it automatically provides confidence limits. Nevertheless, the procedure is still computationally fast and can be run on any standard PC hardware.</p><p>In our examples we demonstrated the advantage of non-parametric estimation of demographic history. Parametric estimation always assumes a certain functional form of population growth which may lead to problematic statements (cf. the HCV data set), in particular if the confidence bands of the estimated function <italic>N</italic><sub><italic>e</italic></sub>(<italic>t</italic>) are not taken into account.</p><p>From the methodological point of view, model selection via rjMCMC has the advantage that the effective dimension, i.e. the degree of smoothing, is automatically chosen in a data-driven manner. There is only one parameter (<italic>&#x003bb;</italic>) that controls the <italic>a priori </italic>degree of smoothing, and this is adjusted accordingly by the investigated data. In addition, a further advantage of our MCMC approach is that &#x02013; in contrast to the skyline plot &#x02013; at least in principle it is straightforward to incorporate it in more general MCMC sampling schemes that also take account of the uncertainty in the genealogy.</p><p>During the referee process we have learned that the authors of the software package BEAST [<xref ref-type="bibr" rid="B27">27</xref>] have developed a similar non-parametric method to Bayesian coalescent inference of population history (A.J. Drummond et al., in preparation). We plan to work with Dr. Drummond to make available in BEAST joint sampling of sampling of demographic histories and of trees. This would combine the present rjMCMC approach and the method developed by Drummond and colleagues.</p></sec><sec><title>Authors' contributions</title><p>This paper summarizes the main results from a master's thesis of R.O. supervised by K.S. and L.F. Accordingly, K.S. and L.F. jointly devised the project and R.O. carried out all analyses and simulations. All authors participated in the development of methodology. R.O. and K.S. wrote the manuscript. All authors approved of the final version.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>We are grateful for financial support from the Deutsche Forschungsgemeinschaft (DFG) in the Emmy Noether program (R.O. and K.S.) and from the SFB 386 (L.F). We thank G??nter Ra??er and Leonhard Held for valuable comments and discussion and Juliane Sch??fer for critical reading of the manuscript.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kingman</surname><given-names>JFC</given-names></name></person-group><article-title>The coalescent</article-title><source>Stoch Proc Applns</source><year>1982</year><volume>13</volume><fpage>235</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1016/0304-4149(82)90011-4</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kingman</surname><given-names>JFC</given-names></name></person-group><article-title>On the genealogy of large populations</article-title><source>J Appl Probab</source><year>1982</year><volume>19A</volume><fpage>27</fpage><lpage>43</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Donnelly</surname><given-names>P</given-names></name><name><surname>Tavar&#x000e9;</surname><given-names>S</given-names></name></person-group><article-title>Coalescents and genealogical structure under neutrality</article-title><source>Annu Rev Genet</source><year>1995</year><volume>29</volume><fpage>401</fpage><lpage>421</lpage><pub-id pub-id-type="pmid">8825481</pub-id><pub-id pub-id-type="doi">10.1146/annurev.ge.29.120195.002153</pub-id></citation></ref><ref id="B4"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Nordborg</surname><given-names>M</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Balding D, Bishop M, Cannings C</surname></name></person-group><article-title>Coalescent Theory</article-title><source>Handbook of Statistical Genetics</source><year>2001</year><publisher-name>Chichester: Wiley</publisher-name><fpage>179</fpage><lpage>212</lpage></citation></ref><ref id="B5"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Hein</surname><given-names>JJ</given-names></name><name><surname>Schierup</surname><given-names>MH</given-names></name><name><surname>Wiuf</surname><given-names>CH</given-names></name></person-group><source>Gene Genealogies, Variation and Evolution</source><year>2004</year><publisher-name>Oxford: Oxford University Press</publisher-name></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><article-title>Pairwise comparison of mitochondrial DNA sequences in stable and exponentially growing populations</article-title><source>Genetics</source><year>1991</year><volume>129</volume><fpage>555</fpage><lpage>562</lpage><pub-id pub-id-type="pmid">1743491</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Griffith</surname><given-names>RC</given-names></name><name><surname>Tavar&#x000e9;</surname><given-names>S</given-names></name></person-group><article-title>Sampling theory for neutral alleles in a varying environment</article-title><source>Phil Trans R Soc Lond B</source><year>1994</year><volume>344</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">7800710</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kuhner</surname><given-names>MK</given-names></name><name><surname>Yamato</surname><given-names>J</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Estimating effective population size and mutation rate from sequence data using Metropolis-Hastings sampling</article-title><source>Genetics</source><year>1995</year><volume>140</volume><fpage>1421</fpage><lpage>1430</lpage><pub-id pub-id-type="pmid">7498781</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kuhner</surname><given-names>MK</given-names></name><name><surname>Yamato</surname><given-names>J</given-names></name><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Maximum likelihood estimation of population growth rates based on the coalescent</article-title><source>Genetics</source><year>1998</year><volume>149</volume><fpage>429</fpage><lpage>434</lpage><pub-id pub-id-type="pmid">9584114</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>Inference in molecular population genetics (with discussion)</article-title><source>J R Statist Soc B</source><year>2000</year><volume>62</volume><fpage>605</fpage><lpage>655</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00254</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Nicholls</surname><given-names>GK</given-names></name><name><surname>Rodrigo</surname><given-names>AG</given-names></name><name><surname>Solomon</surname><given-names>W</given-names></name></person-group><article-title>Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data</article-title><source>Genetics</source><year>2002</year><volume>161</volume><fpage>1307</fpage><lpage>1320</lpage><pub-id pub-id-type="pmid">12136032</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</article-title><source>Genetics</source><year>2003</year><volume>164</volume><fpage>1645</fpage><lpage>1656</lpage><pub-id pub-id-type="pmid">12930768</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Estimating effective population size from samples of sequences: inefficiency of pairwise and segregating sites as compared to phylogenetic estimates</article-title><source>Genet Res</source><year>1992</year><volume>59</volume><fpage>139</fpage><lpage>147</lpage><pub-id pub-id-type="pmid">1628818</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Harvey</surname><given-names>PH</given-names></name></person-group><article-title>An integrated framework for the inference of viral population history from reconstructed genealogies</article-title><source>Genetics</source><year>2000</year><volume>155</volume><fpage>1429</fpage><lpage>1437</lpage><pub-id pub-id-type="pmid">10880500</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wiuf</surname><given-names>C</given-names></name></person-group><article-title>Inferring population history from genealogical trees</article-title><source>J Math Biol</source><year>2003</year><volume>46</volume><fpage>241</fpage><lpage>264</lpage><pub-id pub-id-type="pmid">12728335</pub-id><pub-id pub-id-type="doi">10.1007/s00285-002-0180-8</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Polanski</surname><given-names>A</given-names></name><name><surname>Kimmel</surname><given-names>M</given-names></name><name><surname>Chakraborty</surname><given-names>R</given-names></name></person-group><article-title>Application of a time-dependent coalescence process for inferring the history of population size changes from DNA changes</article-title><source>Proc Natl Acad Sci USA</source><year>1998</year><volume>95</volume><fpage>5456</fpage><lpage>5461</lpage><pub-id pub-id-type="pmid">9576903</pub-id><pub-id pub-id-type="doi">10.1073/pnas.95.10.5456</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Strimmer</surname><given-names>K</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name></person-group><article-title>Exploring the demographic history of a sample of DNA sequences using the generalized skyline plot</article-title><source>Mol Biol Evol</source><year>2001</year><volume>18</volume><fpage>2298</fpage><lpage>2305</lpage><pub-id pub-id-type="pmid">11719579</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>PJ</given-names></name></person-group><article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title><source>Biometrika</source><year>1995</year><volume>82</volume><fpage>711</fpage><lpage>732</lpage></citation></ref><ref id="B19"><citation citation-type="other"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><article-title>R: A language and environment for statistical computing</article-title><source>R Foundation for Statistical Computing, Vienna, Austria</source><year>2004</year><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org"/><comment>[ISBN 3-900051-07-0]</comment></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Paradis</surname><given-names>E</given-names></name><name><surname>Claude</surname><given-names>J</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name></person-group><article-title>APE: Analyses of phylogenetics and evolution in R language</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>289</fpage><lpage>290</lpage><pub-id pub-id-type="pmid">14734327</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id></citation></ref><ref id="B21"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Fahrmeir</surname><given-names>L</given-names></name><name><surname>Hamerle</surname><given-names>A</given-names></name><name><surname>Tutz</surname><given-names>G</given-names></name><collab>(Eds)</collab></person-group><source>Multivariate statistische Verfahren</source><year>1996</year><edition>2</edition><publisher-name>Berlin: Walter de Gryter &#x00026; Co</publisher-name></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>NA</given-names></name><name><surname>Nordborg</surname><given-names>M</given-names></name></person-group><article-title>Genealogical Trees, Coalescent Theory and the Analysis of Genetic Polymorphisms</article-title><source>Nat Rev Genet</source><year>2002</year><volume>3</volume><fpage>380</fpage><lpage>390</lpage><pub-id pub-id-type="pmid">11988763</pub-id><pub-id pub-id-type="doi">10.1038/nrg795</pub-id></citation></ref><ref id="B23"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><source>Inferring Phylogenies</source><year>2004</year><publisher-name>Sunderland, MA: Sinauer Associates</publisher-name></citation></ref><ref id="B24"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Burnham</surname><given-names>KP</given-names></name><name><surname>Anderson</surname><given-names>DR</given-names></name></person-group><source>Model Selection and Inference: A Practical Information -Theoretic Approach</source><year>1998</year><publisher-name>New York: Springer Verlag</publisher-name></citation></ref><ref id="B25"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Gilks</surname><given-names>W</given-names></name><name><surname>Richardson</surname><given-names>S</given-names></name><name><surname>Spiegelhalter</surname><given-names>D</given-names></name><collab>(Eds)</collab></person-group><source>Markov Chain Monto Carlo in Practice</source><year>1996</year><edition>4</edition><publisher-name>London: Chapman and Hall</publisher-name></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Larget</surname><given-names>B</given-names></name><name><surname>Simon</surname><given-names>DL</given-names></name></person-group><article-title>Markov chain Monte Carlo algorithms for the Bayesian analysis of phylogenetic trees</article-title><source>Mol Biol Evol</source><year>1999</year><volume>16</volume><fpage>750</fpage><lpage>759</lpage></citation></ref><ref id="B27"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name></person-group><article-title>BEAST: Bayesian Evolutionary Analysis Sampling Trees</article-title><ext-link ext-link-type="uri" xlink:href="http://evolve.zoo.ox.ac.uk/beast/"/></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vidal</surname><given-names>N</given-names></name><name><surname>Peeters</surname><given-names>M</given-names></name><name><surname>Mulanga-Kabeya</surname><given-names>C</given-names></name><name><surname>Nzilambi</surname><given-names>N</given-names></name><name><surname>Robertson</surname><given-names>D</given-names></name><name><surname>Ilunga</surname><given-names>W</given-names></name><name><surname>Sema</surname><given-names>H</given-names></name><name><surname>Tishimanga</surname><given-names>K</given-names></name><name><surname>Bongo</surname><given-names>B</given-names></name><name><surname>Delaporte</surname><given-names>E</given-names></name></person-group><article-title>Unprecedented degree of HIV-1 group M genetic diversity in the Democratic Republic of Congo suggests that the HIV-1 pandemic originated in Central Africa</article-title><source>J Virol</source><year>2000</year><volume>74</volume><fpage>10498</fpage><lpage>10507</lpage><pub-id pub-id-type="pmid">11044094</pub-id><pub-id pub-id-type="doi">10.1128/JVI.74.22.10498-10507.2000</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Robertson</surname><given-names>DL</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Peeters</surname><given-names>M</given-names></name><name><surname>Holmes</surname><given-names>EC</given-names></name></person-group><article-title>Phylogeny and the origin of HIV-1</article-title><source>Nature</source><year>2001</year><volume>410</volume><fpage>1047</fpage><lpage>1048</lpage><pub-id pub-id-type="pmid">11323659</pub-id><pub-id pub-id-type="doi">10.1038/35074179</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yusim</surname><given-names>K</given-names></name><name><surname>Peeters</surname><given-names>M</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Bhattacharya</surname><given-names>T</given-names></name><name><surname>Delaporte</surname><given-names>E</given-names></name><name><surname>Mulanga</surname><given-names>C</given-names></name><name><surname>Muldoon</surname><given-names>M</given-names></name><name><surname>Theiler</surname><given-names>J</given-names></name><name><surname>Korber</surname><given-names>B</given-names></name></person-group><article-title>Using HIV-1 sequences to infer historical features of the AIDS epidemic and HIV evolution</article-title><source>Phil Trans R Soc Lond B</source><year>2001</year><volume>356</volume><fpage>855</fpage><lpage>866</lpage><pub-id pub-id-type="pmid">11405933</pub-id><pub-id pub-id-type="doi">10.1098/rstb.2001.0859</pub-id></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ray</surname><given-names>SC</given-names></name><name><surname>Arthur</surname><given-names>RR</given-names></name><name><surname>Carella</surname><given-names>A</given-names></name><name><surname>Bukh</surname><given-names>J</given-names></name><name><surname>Thomas</surname><given-names>DL</given-names></name></person-group><article-title>Genetic Epidemiology of Hepatitis C Virus throughout Egypt</article-title><source>J Infect Dis</source><year>2000</year><volume>182</volume><fpage>698</fpage><lpage>707</lpage><pub-id pub-id-type="pmid">10950762</pub-id><pub-id pub-id-type="doi">10.1086/315786</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tanaka</surname><given-names>Y</given-names></name><name><surname>Agha</surname><given-names>S</given-names></name><name><surname>Saudy</surname><given-names>N</given-names></name><name><surname>Kurbanov</surname><given-names>F</given-names></name><name><surname>Orito</surname><given-names>E</given-names></name><name><surname>Kato</surname><given-names>T</given-names></name><name><surname>Abo-Zeid</surname><given-names>M</given-names></name><name><surname>Khalaf</surname><given-names>M</given-names></name><name><surname>Miyakawa</surname><given-names>Y</given-names></name><name><surname>Mizokami</surname><given-names>M</given-names></name></person-group><article-title>Exponential Spread of Hepatitis C Virus Genotype 4a in Egypt</article-title><source>J Mol Evol</source><year>2004</year><volume>58</volume><fpage>191</fpage><lpage>195</lpage><pub-id pub-id-type="pmid">15042339</pub-id><pub-id pub-id-type="doi">10.1007/s00239-003-2541-3</pub-id></citation></ref><ref id="B33"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Kuiken</surname><given-names>C</given-names></name><name><surname>Yusim</surname><given-names>K</given-names></name><name><surname>Boykin</surname><given-names>L</given-names></name><name><surname>Richardson</surname><given-names>R</given-names></name></person-group><article-title>The Los Alamos hepatitis C sequence database</article-title><source>Bioinformatics</source><year>2005</year><comment><ext-link ext-link-type="uri" xlink:href="http://hcv.lanl.gov"/></comment></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jobb</surname><given-names>G</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name></person-group><article-title>TREEFINDER: A Powerful Graphical Analysis Environment for Molecular Phylogenetics</article-title><source>BMC Evolutionary Biology</source><year>2004</year><volume>4</volume><fpage>18</fpage><pub-id pub-id-type="pmid">15222900</pub-id><pub-id pub-id-type="doi">10.1186/1471-2148-4-18</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Nakano</surname><given-names>T</given-names></name><name><surname>Robertson</surname><given-names>B</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name></person-group><article-title>The epidemiology and latrogenic transmission of Hepatitis C virus in Egypt: a Bayesian coalescent approach</article-title><source>Mol Biol Evol</source><year>2003</year><volume>20</volume><fpage>381</fpage><lpage>387</lpage><pub-id pub-id-type="pmid">12644558</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msg043</pub-id></citation></ref></ref-list></back></article>



