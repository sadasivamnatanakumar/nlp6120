<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS One</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-title-group><journal-title>PLOS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmc">PMC10732448</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0295027</article-id><article-id pub-id-type="publisher-id">PONE-D-23-19947</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Civil Engineering</subject><subj-group><subject>Transportation Infrastructure</subject><subj-group><subject>Roads</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Transportation</subject><subj-group><subject>Transportation Infrastructure</subject><subj-group><subject>Roads</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Remote Sensing</subject><subj-group><subject>Lidar</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Software Engineering</subject><subj-group><subject>Preprocessing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Software Engineering</subject><subj-group><subject>Preprocessing</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering Algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Clustering Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Equipment</subject><subj-group><subject>Communication Equipment</subject><subj-group><subject>Cell Phones</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Bioenergetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological Locomotion</subject><subj-group><subject>Walking</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Plants</subject><subj-group><subject>Trees</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>By cyclists, for cyclists: Road grade and elevation estimation from crowd-sourced fitness application data</article-title><alt-title alt-title-type="running-head">Road grade and elevation estimation from crowd-sourced fitness application data</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Berjisian</surname><given-names>Elmira</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role><role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role><role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role><role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff001" ref-type="aff"/></contrib><contrib contrib-type="author" corresp="yes"><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2253-2991</contrib-id><name><surname>Bigazzi</surname><given-names>Alexander</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role><role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="cor001" ref-type="corresp">*</xref><xref rid="aff001" ref-type="aff"/></contrib><contrib contrib-type="author"><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6964-4918</contrib-id><name><surname>Barkh</surname><given-names>Hamed</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role><role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff001" ref-type="aff"/></contrib></contrib-group><aff id="aff001">
<addr-line>Department of Civil Engineering, University of British Columbia, Vancouver, British Columbia, Canada</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>Yuan</surname><given-names>Quan</given-names></name><role>Editor</role><xref rid="edit1" ref-type="aff"/></contrib></contrib-group><aff id="edit1">
<addr-line>Tsinghua University, CHINA</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>abigazzi@civil.ubc.ca</email></corresp></author-notes><pub-date pub-type="epub"><day>20</day><month>12</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>18</volume><issue>12</issue><elocation-id>e0295027</elocation-id><history><date date-type="received"><day>26</day><month>6</month><year>2023</year></date><date date-type="accepted"><day>14</day><month>11</month><year>2023</year></date></history><permissions><copyright-statement>&#x000a9; 2023 Berjisian et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Berjisian et al</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0295027.pdf"/><abstract><p>Road grade or slope is a key factor for walking and cycling behavior and outcomes (influencing route, speed, energy, etc.). For this reason, the scarcity of precise road grade data presents a challenge for travel information and analysis. This paper examines the accuracy of using crowd-sourced GPS data from a fitness application to estimate roadway grade profiles, which can then be used to develop network-wide road grade datasets. We externally validate an elevation estimation method described by McKenzie and Janowicz using field surveying data, and then propose and evaluate modifications for estimation of road grade (which is more directly relevant than elevation for walking and cycling analysis). We find that a modest amount of crowd-sourced GPS data can be used to generate relatively accurate road grade estimates: better than commonly-used low-resolution elevation models, but not as accurate as high-resolution data derived from LiDAR (Light Detection and Ranging). We also find that the grade estimates are more reliable than the elevation estimates, relative to alternative data sources. The most accurate method to aggregate crowd-sourced GPS data builds a composite roadway grade profile using partition-around-medoid clustering of individual grade sequences, first smoothed with a Savitzky-Golay filter and cleaned with Density-Based Spatial Clustering of Applications with Noise (DBSCAN). Implementing this method with an average of 150 GPS traces per location yields a root mean square error (RMSE) of 1% road grade. The findings in this paper can be used to incorporate precise road grade information into street network datasets over a wide spatial scale, which is necessary for walking and cycling analysis that fully considers the physiological aspects of active transportation.</p></abstract><funding-group><award-group id="award001"><funding-source>
<institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap>
</funding-source><award-id>RGPIN-2016-04034</award-id><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2253-2991</contrib-id>
<name><surname>Bigazzi</surname><given-names>Alexander York</given-names></name>
</principal-award-recipient></award-group><award-group id="award002"><funding-source>
<institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000155</institution-id><institution>Social Sciences and Humanities Research Council of Canada</institution></institution-wrap>
</funding-source><award-id>430-2019-00049</award-id><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2253-2991</contrib-id>
<name><surname>Bigazzi</surname><given-names>Alexander York</given-names></name>
</principal-award-recipient></award-group><funding-statement>A.B., #430-2019-00049, Social Sciences and Humanities Research Council of Canada, <ext-link xlink:href="http://www.sshrc-crsh.gc.ca" ext-link-type="uri">www.sshrc-crsh.gc.ca</ext-link>; A.B., #RGPIN-2016-04034, Natural Science and Engineering Research Council of Canada, <ext-link xlink:href="http://www.nserc-crsng.gc.ca" ext-link-type="uri">www.nserc-crsng.gc.ca</ext-link>; the funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><fig-count count="4"/><table-count count="5"/><page-count count="18"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>The code (R script) to estimate elevation and grade profiles from crowd-sourced data using each method, as well as from the comparison data sources, is provided in a GitHub repository available at: <ext-link xlink:href="https://github.com/elmiraberjisian/CrowdsourcedGrade" ext-link-type="uri">https://github.com/elmiraberjisian/CrowdsourcedGrade</ext-link>.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>The code (R script) to estimate elevation and grade profiles from crowd-sourced data using each method, as well as from the comparison data sources, is provided in a GitHub repository available at: <ext-link xlink:href="https://github.com/elmiraberjisian/CrowdsourcedGrade" ext-link-type="uri">https://github.com/elmiraberjisian/CrowdsourcedGrade</ext-link>.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>The development of evidence-based strategies to promote active transportation (primarily walking and cycling) requires analysis of real-world active travel behavior. Fortunately, the widespread use of smartphones enables high-resolution spatial and temporal data collection from a large number of active travelers with a relatively low burden [<xref rid="pone.0295027.ref001" ref-type="bibr">1</xref>]. These rich crowd-sourced data are valuable in various types of walking and cycling analyses such as estimating volumes [<xref rid="pone.0295027.ref002" ref-type="bibr">2</xref>,<xref rid="pone.0295027.ref003" ref-type="bibr">3</xref>], studying air pollution exposure [<xref rid="pone.0295027.ref004" ref-type="bibr">4</xref>], identifying network improvements [<xref rid="pone.0295027.ref005" ref-type="bibr">5</xref>,<xref rid="pone.0295027.ref006" ref-type="bibr">6</xref>], and studying routes, accessibility, and traffic flow [<xref rid="pone.0295027.ref007" ref-type="bibr">7</xref>&#x02013;<xref rid="pone.0295027.ref009" ref-type="bibr">9</xref>].</p><p>Road grade or slope (longitudinal changes in elevation over a given distance) is a main determinant of the effort or energy used in active travel, and so is a key factor influencing walking and cycling behaviors (speeds, routes, etc.) and outcomes (travel time, energy expenditure, pollution inhalation, etc.) [<xref rid="pone.0295027.ref010" ref-type="bibr">10</xref>&#x02013;<xref rid="pone.0295027.ref016" ref-type="bibr">16</xref>]. Unfortunately, street network datasets usually lack elevation information [<xref rid="pone.0295027.ref017" ref-type="bibr">17</xref>], forcing researchers, analysts, and the traveler information industry (e.g., mapping and fitness applications) to rely on other data sources for roadway grade. Digital Elevation Models (DEM) and Digital Surface Models (DSM) are commonly used to estimate road grade, but their coarse resolution can result in poor road grade representation, and they often neglect elevated roadway surfaces [<xref rid="pone.0295027.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0295027.ref019" ref-type="bibr">19</xref>]. Other sources such as LiDAR (Light Detection and Ranging) cloud point data, vehicle trajectories (time-stamped sequences of positional data), field surveying, or geometric design databases can provide better information, but are costly to collect, not widely available, and/or require substantial processing [<xref rid="pone.0295027.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0295027.ref020" ref-type="bibr">20</xref>&#x02013;<xref rid="pone.0295027.ref023" ref-type="bibr">23</xref>].</p><p>Altitude information from GPS devices provides another source of elevation data, with relatively poor accuracy that can be partially compensated by repeated measurements [<xref rid="pone.0295027.ref024" ref-type="bibr">24</xref>,<xref rid="pone.0295027.ref025" ref-type="bibr">25</xref>]. Today, crowd-sourced GPS trajectories from fitness, navigation, and routing applications enable repeated measurements over large geographical areas at a lower cost than using probe vehicles. McKenzie and Janowicz [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] proposed a method to estimate roadway elevation profiles from crowd-sourced GPS data (sourced from a fitness application); their method uses the median elevation of GPS records closest to equidistant sampling points along each road segment. In this paper, we expand on that research by 1) externally validating the elevation estimation method of McKenzie and Janowicz with an independent crowd-sourced GPS dataset, in comparison to ground-truth data from field surveying, 2) proposing and evaluating an extension of the method to generate road grade information, which is more directly relevant for active travel analysis than elevation, and 3) proposing and evaluating modifications to the method for improved accuracy of grade inference. This paper contributes to the literature by reporting improved methods for deriving road grade information from crowd-sourced GPS data, and determining the accuracy in comparison to field surveying measurements and alternative road grade data sources.</p></sec><sec id="sec002"><title>Literature review</title><p>Raster elevation models (DEM, DSM) are the most commonly used data source in cycling studies to estimate roadway elevation changes or grade [<xref rid="pone.0295027.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0295027.ref027" ref-type="bibr">27</xref>&#x02013;<xref rid="pone.0295027.ref031" ref-type="bibr">31</xref>]. DEM and DSM are widely and readily available, but have the key shortcoming that they generally represent surrounding terrain rather than the travelled guideway, which can create substantial bias in inferred road grades [<xref rid="pone.0295027.ref018" ref-type="bibr">18</xref>]. Note that the terminology for elevation models varies; in this paper, we use DEM to refer to a model of bare-earth elevation and DSM to refer to a model that includes above-ground built and natural features (such as structures and vegetation). DEM represent bare-ground elevation, and hence fail to reflect elevation on roadway structures. Furthermore, DEM and DSM raster cells are usually coarse relative to the width of roadways, and so even a surface model (which includes structures) often misrepresents roadway elevations.</p><p>Grond [<xref rid="pone.0295027.ref030" ref-type="bibr">30</xref>] addressed the limitation of raster-based models by manually correcting elevation profiles on bridges, capping the grade at +/- 10%. Chen et al. [<xref rid="pone.0295027.ref020" ref-type="bibr">20</xref>] appended DEM and DSM data to a simplified Open Street Map (OSM) network, with heuristic corrections based on comparing the DEM and DSM, road design standards for tunnels, and an excessive grade threshold of 7%. Avoiding elevation models, Boyko and Funkhouser [<xref rid="pone.0295027.ref022" ref-type="bibr">22</xref>] proposed a method to extract roadway elevation profiles from dense three-dimensional LiDAR cloud point data. El Masri and Bigazzi [<xref rid="pone.0295027.ref018" ref-type="bibr">18</xref>] compared spatial data sources for road grade in active travel analysis and concluded that a high-resolution (0.5 m) DEM can generate reliable road grade information for non-elevated structures, whereas LiDAR cloud point data (processed using the Boyko and Funkhouser method) are needed for road grade information on elevated structures.</p><p>As an alternative to these areal spatial datasets, roadway elevation information can be derived by processing and aggregating probe vehicle trajectory data (typically, timestamped sequences of three-dimensional position records). Gupta et al. [<xref rid="pone.0295027.ref032" ref-type="bibr">32</xref>] aggregated probe vehicle data (acceleration, angular momentum, and speed) from 15 trips driven over a 9 km road segment to derive grade profiles based on a vehicle dynamic model with corrections from Google elevation data, achieving an accuracy of 0.5% grade compared to road inventory data. Fran et al. [<xref rid="pone.0295027.ref033" ref-type="bibr">33</xref>] used a fuel consumption model to estimate grade profiles from 90,000 sec of vehicle operating data, resulting in a root mean square error (RMSE) of 0.1% to 0.3% grade over a 4 km segment of mild-grade expressway.</p><p>GPS devices, such as included in most smartphones, can also provide traveler trajectory information, including altitude from satellite positioning, sometimes enhanced with barometric sensor data. Precision of moving horizontal position measurement for typical smartphone GPS data is 7 to 13 m [<xref rid="pone.0295027.ref034" ref-type="bibr">34</xref>], and vertical position error is around 1.5 to 3 times greater than horizontal position error [<xref rid="pone.0295027.ref035" ref-type="bibr">35</xref>,<xref rid="pone.0295027.ref036" ref-type="bibr">36</xref>]. A study comparing nine common GPS-based smartphone fitness applications reported errors in total elevation changes of 0 to 63 m over a 1 km running loop trip [<xref rid="pone.0295027.ref037" ref-type="bibr">37</xref>]. Meng et al. [<xref rid="pone.0295027.ref024" ref-type="bibr">24</xref>] used atmospheric pressure sensors to determine elevation changes, finding that barometry-based grade estimates (RMSE of 0.5% grade) were more accurate than estimates derived from GPS altitude information (RMSE of 2.6% grade). Another study comparing barometric altimeters reported standard errors of 1.5% to 1.9% in total elevation gain over a cycling trip using 28 different devices [<xref rid="pone.0295027.ref038" ref-type="bibr">38</xref>].</p><p>One approach to overcome the low precision of GPS-based altitude is to aggregate the information from many trajectories over the same roadway. John et al. [<xref rid="pone.0295027.ref019" ref-type="bibr">19</xref>] estimated elevation and grade from crowd-sourced GPS trajectories taken from OSM by averaging the values of nearby GPS trajectories, and evaluated against a high-resolution LiDAR-based DEM. Using 3,842 trajectories over 5,336 km of streets, they found an RMSE for elevation of 27 m and a mean grade error of 2.4%.</p><p>McKenzie and Janowicz [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] proposed a more sophisticated method to aggregate crowd-sourced GPS data into roadway elevation profiles. They first filter &#x0201c;efforts&#x0201d; (individual trajectories along a given roadway segment) to remove those with an insufficient number of GPS observations (no more than two standard deviations below the median number for the segment). A composite elevation profile is then created at 1-m intervals along the segment by aggregating from the most proximate elevation values in the filtered efforts (as the median or mean value at each 1-m node). Using a sample of 4 locations with 12,000 to 20,000 raw (unfiltered) efforts per location from Strava data, they report the accuracy of the method as RMSE of 1 to 5 m compared to LiDAR data. Accuracy for road grade inference was not investigated.</p><p>Beyond academic research, the traveler information industry also has an interest in providing road grade and elevation change data, particularly for mapping and fitness applications. For example, Google Maps, Strava, &#x0201c;Ride with GPS&#x0201d; (RwGPS), and others offer elevation profiles within their bicycle routing applications. RwGPS, which uses a low-resolution DEM, previously offered the option to manually correct elevations on elevated structures, and has recently reported improved estimation of elevation on such structures [<xref rid="pone.0295027.ref039" ref-type="bibr">39</xref>].</p></sec><sec sec-type="materials|methods" id="sec003"><title>Method</title><p><xref rid="pone.0295027.g001" ref-type="fig">Fig 1</xref> illustrates the study methodology. To accomplish the research objectives, we replicate the method described above from McKenzie and Janowicz [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] using an independent crowd-sourced dataset, and compare the results to several common alternative elevation data sources, as well as field surveying data. We also propose and compare the accuracy of modifications to the elevation estimation method (described below), as well as two methods of converting elevation information to road grade estimates.</p><fig position="float" id="pone.0295027.g001"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.g001</object-id><label>Fig 1</label><caption><title>Methodology framework.</title></caption><graphic xlink:href="pone.0295027.g001" position="float"/></fig><sec id="sec004"><title>Study locations</title><p>Sixteen study locations (road segments) in the City of Vancouver were selected based on the availability of ground-truth field surveying data, popularity indicated by crowd-sourced volumes, and representation of a range of cycling facilities. Ground-truth field surveying data were available for 8 locations from a previous study [<xref rid="pone.0295027.ref018" ref-type="bibr">18</xref>]. The 8 most frequently used street segments in the crowd-sourced GPS data (see below) were identified for the other half of the study locations. <xref rid="pone.0295027.t001" ref-type="table">Table 1</xref> gives the sample locations and their elevation and grade attributes (data sources described below).</p><table-wrap position="float" id="pone.0295027.t001"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.t001</object-id><label>Table 1</label><caption><title>Sample study locations.</title></caption><alternatives><graphic xlink:href="pone.0295027.t001" id="pone.0295027.t001g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Name</th><th align="center" rowspan="1" colspan="1">Length (m)</th><th align="center" rowspan="1" colspan="1">Elevated</th><th align="center" rowspan="1" colspan="1">Ground-truth survey data</th><th align="center" rowspan="1" colspan="1">Elevation (m)<xref rid="t001fn001" ref-type="table-fn"><sup>1</sup></xref></th><th align="center" rowspan="1" colspan="1">Grade (%)<sup>1</sup></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Burrard Bridge</td><td align="center" rowspan="1" colspan="1">1009</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">24.34 (5.80)</td><td align="right" rowspan="1" colspan="1">1.15 (2.71)</td></tr><tr><td align="left" rowspan="1" colspan="1">Main Street Bridge</td><td align="center" rowspan="1" colspan="1">253</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">9.72 (2.94)</td><td align="right" rowspan="1" colspan="1">-1.58 (6.07)</td></tr><tr><td align="left" rowspan="1" colspan="1">Cambie Ramp</td><td align="center" rowspan="1" colspan="1">129</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">8.38 (1.64)</td><td align="right" rowspan="1" colspan="1">4.36 (3.56)</td></tr><tr><td align="left" rowspan="1" colspan="1">West 10<sup>th</sup> Street</td><td align="center" rowspan="1" colspan="1">119</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">29.26 (1.10)</td><td align="right" rowspan="1" colspan="1">-2.85 (0.84)</td></tr><tr><td align="left" rowspan="1" colspan="1">Beach Avenue</td><td align="center" rowspan="1" colspan="1">88</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">8.84 (0.08)</td><td align="right" rowspan="1" colspan="1">0.11 (0.60)</td></tr><tr><td align="left" rowspan="1" colspan="1">Island Park</td><td align="center" rowspan="1" colspan="1">73</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">4.22 (0.60)</td><td align="right" rowspan="1" colspan="1">-2.43 (3.19)</td></tr><tr><td align="left" rowspan="1" colspan="1">Smithe Street</td><td align="center" rowspan="1" colspan="1">73</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">18.96 (1.33)</td><td align="right" rowspan="1" colspan="1">-5.82 (0.79)</td></tr><tr><td align="left" rowspan="1" colspan="1">Trafalgar Street</td><td align="center" rowspan="1" colspan="1">58</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="right" rowspan="1" colspan="1">28.40 (1.73)</td><td align="right" rowspan="1" colspan="1">-9.14 (1.49)</td></tr><tr><td align="left" rowspan="1" colspan="1">Cambie Bridge</td><td align="center" rowspan="1" colspan="1">338</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">17.40 (0.41)</td><td align="right" rowspan="1" colspan="1">0.04 (0.84)</td></tr><tr><td align="left" rowspan="1" colspan="1">Seaside</td><td align="center" rowspan="1" colspan="1">52</td><td align="center" rowspan="1" colspan="1">Yes</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">1.30 (0.00)</td><td align="right" rowspan="1" colspan="1">0.00 (0.00)</td></tr><tr><td align="left" rowspan="1" colspan="1">Adanac Street</td><td align="center" rowspan="1" colspan="1">173</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">13.75 (0.74)</td><td align="right" rowspan="1" colspan="1">-1.49 (0.18)</td></tr><tr><td align="left" rowspan="1" colspan="1">Stanley Park Drive</td><td align="center" rowspan="1" colspan="1">144</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">4.52 (0.09)</td><td align="right" rowspan="1" colspan="1">-0.24 (0.82)</td></tr><tr><td align="left" rowspan="1" colspan="1">False Creek</td><td align="center" rowspan="1" colspan="1">131</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">3.91 (0.25)</td><td align="right" rowspan="1" colspan="1">-0.58 (0.46)</td></tr><tr><td align="left" rowspan="1" colspan="1">Beach Street</td><td align="center" rowspan="1" colspan="1">123</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">8.86 (0.17)</td><td align="right" rowspan="1" colspan="1">0.50 (0.17)</td></tr><tr><td align="left" rowspan="1" colspan="1">Dunsmuir Street</td><td align="center" rowspan="1" colspan="1">100</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">28.43 (0.69)</td><td align="right" rowspan="1" colspan="1">2.15 (0.60)</td></tr><tr><td align="left" rowspan="1" colspan="1">Seawall</td><td align="center" rowspan="1" colspan="1">94</td><td align="center" rowspan="1" colspan="1">No</td><td align="center" rowspan="1" colspan="1">No</td><td align="right" rowspan="1" colspan="1">3.62 (0.31)</td><td align="right" rowspan="1" colspan="1">1.13 (0.58)</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="t001fn001"><p><sup>1</sup> mean (standard deviation) at 1 m intervals.</p></fn></table-wrap-foot></table-wrap></sec><sec id="sec005"><title>Crowd-sourced GPS data</title><p>We obtained crowd-sourced GPS trajectories from the now-retired fitness application Endomondo. Initially developed by Endomondo LLC, it was later acquired by UnderArmour Inc. The application was discontinued, along with its data interfaces on March 31, 2021. Before its termination, we gathered publicly available data for the Vancouver, Canada region in May 2020, by querying the Endomondo WorkoutAPI. The WorkoutAPI required two inputs: a UserID (a unique integer for each user) and a WorkoutID (with unique integers for each user, but not universally unique).</p><p>To identify relevant UserIDs, we sequentially submitted integers, starting from 1, to the Endomondo UserAPI, and then filtered for profiles with visibility set to &#x0201c;everyone&#x0201d; and with country set to Canada. We then queried WorkoutAPI for those UserIDs, only retaining those with activity timestamps using the Vancouver time zone (UTC offset of -7 during the summer months). Finally, we downloaded all summer (May through August) activities for these UserIDs from May 2010 through May 2020, yielding 27,052 raw trajectories in total. The activity files included the fields: UserID, WorkoutID, timestamp, latitude, longitude, altitude, distance, speed, duration, heart rate, sport (type of activity), and cadence.</p><p>The following rules were used to preprocess the trajectories, informed by the study objectives and past research using GPS data [<xref rid="pone.0295027.ref040" ref-type="bibr">40</xref>&#x02013;<xref rid="pone.0295027.ref043" ref-type="bibr">43</xref>].</p><list list-type="order"><list-item><p>Discard trajectories outside metropolitan Vancouver, Canada.</p></list-item><list-item><p>Remove GPS records in the remaining trajectories that lack any of the essential attributes: timestamp, latitude, longitude, or altitude.</p></list-item><list-item><p>Identify duplicate timestamps in the same trajectory and retain the earliest one.</p></list-item><list-item><p>Reorder reverse time sequences.</p></list-item><list-item><p>Remove location errors based on &#x0201c;position jumps&#x0201d; where the distance traveled surpasses a 30 m buffer at a speed exceeding 50 m/s.</p></list-item><list-item><p>Split trajectories at a time gap greater than 8 hours.</p></list-item><list-item><p>Remove trajectories with fewer than 120 records.</p></list-item></list><p>A total of 9,031 trajectories remained after preprocessing, with a mean logging interval of 6.8 seconds (ranging from 1 to 67 seconds, standard deviation of 4.3 seconds). These GPS trajectories were map-matched using the PgMapMatch algorithm, developed by Miller-Ball et al. [<xref rid="pone.0295027.ref044" ref-type="bibr">44</xref>], with street network data extracted from OSM using overpassID [<xref rid="pone.0295027.ref045" ref-type="bibr">45</xref>]. PgMapMatch was selected based on recently demonstrated good performance for cycling GPS data [<xref rid="pone.0295027.ref046" ref-type="bibr">46</xref>]. We next identified the GPS trajectories that traversed any of our 16 study locations from the map-matched routes. For each of these trajectories, we extracted a sample effort (a subset of GPS records within the trajectory) using a 50-meter buffer around the study location. Finally, sample efforts were filtered based on the number of GPS records, consistent with [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>], by removing any efforts with fewer than two standard deviations below the median number of records for efforts on that segment. The number of preprocessed and filtered efforts at each study location is given in <xref rid="pone.0295027.t002" ref-type="table">Table 2</xref>. The filtered efforts and field surveying data for each location are given in the supporting information <xref rid="pone.0295027.s001" ref-type="supplementary-material">S1 Dataset</xref>.</p><table-wrap position="float" id="pone.0295027.t002"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.t002</object-id><label>Table 2</label><caption><title>Number of crowd-sourced GPS traces (efforts) at each study location.</title></caption><alternatives><graphic xlink:href="pone.0295027.t002" id="pone.0295027.t002g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Study location</th><th align="center" rowspan="1" colspan="1">Preprocessed</th><th align="center" rowspan="1" colspan="1">Filtered</th><th align="center" rowspan="1" colspan="1">Cleaned (elevation)</th><th align="center" rowspan="1" colspan="1">Cleaned (grade)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Burrard Bridge</td><td align="center" rowspan="1" colspan="1">541</td><td align="center" rowspan="1" colspan="1">540</td><td align="center" rowspan="1" colspan="1">246</td><td align="center" rowspan="1" colspan="1">252</td></tr><tr><td align="left" rowspan="1" colspan="1">Main Street Bridge</td><td align="center" rowspan="1" colspan="1">21</td><td align="center" rowspan="1" colspan="1">21</td><td align="center" rowspan="1" colspan="1">10</td><td align="center" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">Cambie Ramp</td><td align="center" rowspan="1" colspan="1">82</td><td align="center" rowspan="1" colspan="1">82</td><td align="center" rowspan="1" colspan="1">71</td><td align="center" rowspan="1" colspan="1">9</td></tr><tr><td align="left" rowspan="1" colspan="1">West 10<sup>th</sup> Street</td><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">20</td><td align="center" rowspan="1" colspan="1">19</td><td align="center" rowspan="1" colspan="1">12</td></tr><tr><td align="left" rowspan="1" colspan="1">Beach Avenue</td><td align="center" rowspan="1" colspan="1">201</td><td align="center" rowspan="1" colspan="1">192</td><td align="center" rowspan="1" colspan="1">166</td><td align="center" rowspan="1" colspan="1">41</td></tr><tr><td align="left" rowspan="1" colspan="1">Island Park</td><td align="center" rowspan="1" colspan="1">179</td><td align="center" rowspan="1" colspan="1">176</td><td align="center" rowspan="1" colspan="1">162</td><td align="center" rowspan="1" colspan="1">59</td></tr><tr><td align="left" rowspan="1" colspan="1">Smithe Street</td><td align="center" rowspan="1" colspan="1">9</td><td align="center" rowspan="1" colspan="1">8</td><td align="center" rowspan="1" colspan="1">6</td><td align="center" rowspan="1" colspan="1">6</td></tr><tr><td align="left" rowspan="1" colspan="1">Trafalgar Street</td><td align="center" rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">11</td><td align="center" rowspan="1" colspan="1">11</td><td align="center" rowspan="1" colspan="1">10</td></tr><tr><td align="left" rowspan="1" colspan="1">Cambie Bridge</td><td align="center" rowspan="1" colspan="1">192</td><td align="center" rowspan="1" colspan="1">192</td><td align="center" rowspan="1" colspan="1">134</td><td align="center" rowspan="1" colspan="1">42</td></tr><tr><td align="left" rowspan="1" colspan="1">Seaside</td><td align="center" rowspan="1" colspan="1">365</td><td align="center" rowspan="1" colspan="1">329</td><td align="center" rowspan="1" colspan="1">327</td><td align="center" rowspan="1" colspan="1">222</td></tr><tr><td align="left" rowspan="1" colspan="1">Adanac Street</td><td align="center" rowspan="1" colspan="1">475</td><td align="center" rowspan="1" colspan="1">472</td><td align="center" rowspan="1" colspan="1">465</td><td align="center" rowspan="1" colspan="1">407</td></tr><tr><td align="left" rowspan="1" colspan="1">Stanley Park Drive</td><td align="center" rowspan="1" colspan="1">347</td><td align="center" rowspan="1" colspan="1">330</td><td align="center" rowspan="1" colspan="1">324</td><td align="center" rowspan="1" colspan="1">241</td></tr><tr><td align="left" rowspan="1" colspan="1">False Creek</td><td align="center" rowspan="1" colspan="1">379</td><td align="center" rowspan="1" colspan="1">374</td><td align="center" rowspan="1" colspan="1">356</td><td align="center" rowspan="1" colspan="1">193</td></tr><tr><td align="left" rowspan="1" colspan="1">Beach Street</td><td align="center" rowspan="1" colspan="1">528</td><td align="center" rowspan="1" colspan="1">507</td><td align="center" rowspan="1" colspan="1">481</td><td align="center" rowspan="1" colspan="1">382</td></tr><tr><td align="left" rowspan="1" colspan="1">Dunsmuir Street</td><td align="center" rowspan="1" colspan="1">400</td><td align="center" rowspan="1" colspan="1">393</td><td align="center" rowspan="1" colspan="1">376</td><td align="center" rowspan="1" colspan="1">273</td></tr><tr><td align="left" rowspan="1" colspan="1">Seawall</td><td align="center" rowspan="1" colspan="1">334</td><td align="center" rowspan="1" colspan="1">326</td><td align="center" rowspan="1" colspan="1">323</td><td align="center" rowspan="1" colspan="1">181</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec006"><title>Comparison elevation data sources</title><p>The accuracy of the crowd-sourced elevation and grade estimates are compared to several common elevation data sources:</p><list list-type="order"><list-item><p>A high-resolution (0.5 m grid) DEM for the City of Vancouver (CoVDEM) [<xref rid="pone.0295027.ref047" ref-type="bibr">47</xref>],</p></list-item><list-item><p>A low-resolution (20 m grid) DSM for Canada, the Canadian Digital Surface Model (CDSM) [<xref rid="pone.0295027.ref048" ref-type="bibr">48</xref>],</p></list-item><list-item><p>High-density LiDAR cloud point data for the City of Vancouver (CoVLiDAR) with a minimum density of 12 points per m<sup>2</sup> [<xref rid="pone.0295027.ref049" ref-type="bibr">49</xref>],</p></list-item><list-item><p>Low-density LiDAR cloud point data covering the province of British Columbia (BCLiDAR) with a target density of 8 points per square meter [<xref rid="pone.0295027.ref050" ref-type="bibr">50</xref>], and</p></list-item><list-item><p>Route information from the smartphone application RwGPS.</p></list-item></list><p>Elevation profiles for the study locations were extracted from each data source at 1 m intervals along the segment. Elevation profiles were extracted from raster data (CoVDEM, CDSM) using bilinear interpolation. Elevation profiles were extracted from LiDAR data using the Boyko &#x00026; Funkhouser method [<xref rid="pone.0295027.ref022" ref-type="bibr">22</xref>], which essentially fits a spline curve through the LiDAR cloud points. Elevation profiles were extracted from RwGPS by synthesizing the 1-m sampling points as a GPS trajectory and using the <italic toggle="yes">route planner</italic> and <italic toggle="yes">replace elevation</italic> features. Raw elevation data from the comparison data sources were smoothed using a Savitzky-Golay filter, consistent with previous studies [<xref rid="pone.0295027.ref051" ref-type="bibr">51</xref>,<xref rid="pone.0295027.ref052" ref-type="bibr">52</xref>]. Then road grade (in %) was calculated as changes in elevation at the same 1 m intervals along the elevation profile.</p></sec><sec id="sec007"><title>Modification and extension to the McKenzie and Janowicz method</title><p>We propose and test several improvements to the crowd-sourced elevation estimation method described above from McKenzie and Janowicz [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>], and extend its application to grade estimation. First, we smooth individual efforts (elevation profiles from a single GPS trajectory) using a Savitzky-Golay filter to reduce random error, as above. Second, we clean the efforts using Density-Based Spatial Clustering of Applications with Noise (DBSCAN) to mitigate systematic error [<xref rid="pone.0295027.ref053" ref-type="bibr">53</xref>]. DBSCAN groups the efforts into clusters and then labels any un-clustered efforts as Noise, which we then discarded.</p><p>DBSCAN requires two parameters: the minimum number of efforts needed to form a cluster (set as 2 in our case) and a cluster radius that determines how close efforts should be to each other to be part of the same cluster. For elevation, we set the cluster radius to account for the expected uncertainty in GPS-based vertical position. Assuming a Gaussian distribution in GPS error [<xref rid="pone.0295027.ref054" ref-type="bibr">54</xref>], we select 3 standard deviations as a threshold to capture the central 99.73% of the expected distribution of GPS records (i.e., excluding approximately 0.5% as outliers). The standard error of GPS-based vertical position is assumed to be around 15 m [<xref rid="pone.0295027.ref034" ref-type="bibr">34</xref>,<xref rid="pone.0295027.ref054" ref-type="bibr">54</xref>,<xref rid="pone.0295027.ref055" ref-type="bibr">55</xref>], leading to a cluster radius of 45 m for elevation. We set the cluster radius at 35% for grade, which is the maximum road grade in the world [<xref rid="pone.0295027.ref022" ref-type="bibr">22</xref>].</p><p>Our third modification involves testing two more sophisticated aggregation methods to create a composite profile from the filtered efforts, beyond the mean and median used in [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>]: the clustering algorithms partition-around-medoid and kmlShape, both of which return an archetype (representative) effort for a given cluster of efforts. Partition-around-medoid is a clustering algorithm similar to k-means, but which uses an observed effort (medoid) as the archetype, in contrast to k-means in which the archetype is an average of the cluster [<xref rid="pone.0295027.ref056" ref-type="bibr">56</xref>]. KmlShape is a clustering algorithm that is based on the shape of efforts rather than a proximity measure (such as Euclidean distance used in partition-around-medoid and k-means) [<xref rid="pone.0295027.ref057" ref-type="bibr">57</xref>].</p><p>In addition to these three modifications (smoothing, cleaning, and aggregation method), we also evaluate two possible methods of converting from elevation to road grade estimates (illustrated in <xref rid="pone.0295027.g001" ref-type="fig">Fig 1</xref>). The first approach (Grade Method 1) involves calculating road grade from the composite elevation profiles, computed as the ratio of difference in elevation to the horizontal distance between sampling points along the segment (expressed in %). The second approach (Grade Method 2) is to create a composite road grade profile directly from individual grade efforts, with the rationale that the effect of intra-effort systematic bias in elevation may be reduced by working directly with grade values. Grade efforts are calculated from each elevation effort in the same way as Grade Method 1 (i.e., as the ratio of differenced elevation to the horizontal distance between GPS points along the segment, in %). A composite grade profile is then calculated from the filtered grade efforts using the same aggregation methods as the composite elevation profile.</p><p><xref rid="pone.0295027.t002" ref-type="table">Table 2</xref> gives the number of preprocessed, filtered, and cleaned efforts at each study location. Note that no grade efforts remained for the Main Street Bridge location after cleaning, and so no Method 2 Grade estimates were generated for that location.</p></sec><sec id="sec008"><title>Accuracy evaluation</title><p>Our modifications are tested by comparing the elevation and road grade accuracy of composite profiles created in six different ways:</p><list list-type="order"><list-item><p>Fmean: means of the filtered efforts,</p></list-item><list-item><p>Fmedian: medians of the filtered efforts (these are the original two methods used in [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>]),</p></list-item><list-item><p>FSCmean: means of the filtered, smoothed, and cleaned efforts,</p></list-item><list-item><p>FSCmedian: medians of the filtered, smoothed, and cleaned efforts (these two show the effects of smoothing with Savitzky-Golay and cleaning with DBSCAN),</p></list-item><list-item><p>FSCpam: partition-around-medoid from the filtered, smoothed, and cleaned efforts, and</p></list-item><list-item><p>FSCkml: kmlShape from the filtered, smoothed, and cleaned efforts (these two show the effects of algorithmic aggregation rather than using mean or median).</p></list-item></list><p>For the eight locations with ground-truth data (see <xref rid="pone.0295027.t001" ref-type="table">Table 1</xref>), estimated elevation and grade profiles are compared to profiles created directly from the field surveying measurements. For the eight locations without ground-truth data, the best available elevation data source is used as a ground-truth proxy, based on the findings in [<xref rid="pone.0295027.ref018" ref-type="bibr">18</xref>]: high-resolution (0.5 m) CoVDEM data for the non-elevated segments and high-density CoVLiDAR cloud-point data for the elevated segments. For internal validation, the ground-truth proxy measures are also compared to the ground-truth elevations for the eight locations with ground-truth data. Low-resolution comparison estimates are also created using low-resolution (20 m) CDSM data for the non-elevated segments and low-density BCLiDAR cloud-point data for the elevated segments.</p><p>Four evaluation measures are used to evaluate accuracy, in meters for elevation and meter/meter for grade (the first three were previously used in [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>]):</p><list list-type="order"><list-item><p>Root mean squared error (RMSE) is the square root of the average squared difference between the profile values at the 1-m sampling points along each street segment,</p></list-item><list-item><p>Hausdorff distance (H) is the maximum distance between the profile values at the 1-m sampling points along each street segment,</p></list-item><list-item><p>Earth&#x02019;s Mover distance (EM) compares two distributions in terms of the cost of converting one to the other, and</p></list-item><list-item><p>Frechet distance (F) is often explained as the shortest leash necessary to connect a dog to her owner as they walk along their respective trajectories, without going back on their trajectory.</p></list-item></list><p>Due to the high correlations among these measures, we use factor analysis to obtain an aggregate (unit-less) &#x02018;Inaccuracy&#x02019; score that captures the maximum amount of common variance among the four evaluation measures [<xref rid="pone.0295027.ref058" ref-type="bibr">58</xref>]. The Inaccuracy score expression is obtained by the weighted sum score method [<xref rid="pone.0295027.ref059" ref-type="bibr">59</xref>] using Z-scores for each measure&#x02019;s distribution across all profiles and locations, separately for elevation and grade.</p><p>To examine causes of inaccuracy, a set of contextual variables was created to represent environment and GPS trajectory characteristics, listed in <xref rid="pone.0295027.t003" ref-type="table">Table 3</xref>, informed by the literature. Contextual land cover data were taken from the Metro Vancouver open data catalog (<ext-link xlink:href="http://www.metrovancouver.org/data" ext-link-type="uri">http://www.metrovancouver.org/data</ext-link>) and historical weather data from an online archive (<ext-link xlink:href="https://www.timeanddate.com/weather/canada/vancouver/" ext-link-type="uri">https://www.timeanddate.com/weather/canada/vancouver/</ext-link>). Systematic associations between the contextual variables and Inaccuracy scores were investigated using Pearson correlation coefficients for continuous variables and t-tests of mean difference for binary variables. Finally, to evaluate the effect of the number of efforts on accuracy, a sensitivity test was conducted by estimating elevation and grade profiles using a randomly selected subset of 20%, 40%, 60%, and 80% of the filtered efforts at each location.</p><table-wrap position="float" id="pone.0295027.t003"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.t003</object-id><label>Table 3</label><caption><title>Contextual variables used to examine sources of error.</title></caption><alternatives><graphic xlink:href="pone.0295027.t003" id="pone.0295027.t003g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Variable</th><th align="left" rowspan="1" colspan="1">Definition</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Elevated</td><td align="left" rowspan="1" colspan="1">If the street segment is elevated, based on OSM tag &#x0201c;bridge&#x0201d; (binary)</td></tr><tr><td align="left" rowspan="1" colspan="1">Length</td><td align="left" rowspan="1" colspan="1">Length of the street segment in meters (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Tree cover</td><td align="left" rowspan="1" colspan="1">Proportion (by length) of street segments with tree canopy land cover intersecting (completely or partially) a 50-meter buffer around the sample segment (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Building cover</td><td align="left" rowspan="1" colspan="1">Proportion (by length) of street segments with building land cover intersecting (completely or partially) a 50-meter buffer around the sample segment (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Ground-truth comparison</td><td align="left" rowspan="1" colspan="1">If (non-proxy) ground-truth data from surveying are available for the segment (binary)</td></tr><tr><td align="left" rowspan="1" colspan="1">Elevation</td><td align="left" rowspan="1" colspan="1">Average elevation for the segment, in m (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Number preprocessed efforts</td><td align="left" rowspan="1" colspan="1">Number of preprocessed efforts available in the crowd-sourced dataset (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Number filtered efforts</td><td align="left" rowspan="1" colspan="1">Number of efforts retained after filtering (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Number cleaned efforts</td><td align="left" rowspan="1" colspan="1">Number of cleaned*efforts used to create the composite profile (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Logging interval</td><td align="left" rowspan="1" colspan="1">Average temporal difference between consecutive GPS points for filtered/cleaned efforts&#x02019; trajectories (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Speed outliers</td><td align="left" rowspan="1" colspan="1">Average difference between maximum and 95<sup>th</sup> percentile speed, in m/s, for filtered/cleaned efforts&#x02019; trajectories (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Cloudy</td><td align="left" rowspan="1" colspan="1">Proportion of cloudy or rainy days when filtered/cleaned efforts occurred (continuous)</td></tr><tr><td align="left" rowspan="1" colspan="1">Mode</td><td align="left" rowspan="1" colspan="1">Whether the majority of filtered/cleaned efforts were recorded while cycling versus on foot (binary)</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="t003fn001"><p>* Filtered, smoothed, and cleaned for FSCmean, FSCmedian, FSCpam, FSCkml; only filtered for Fmean and Fmedian.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec sec-type="results" id="sec009"><title>Results</title><sec id="sec010"><title>Inaccuracy score</title><p>As expected, RMSE, H, and F measures across composite elevation and grade profiles were highly correlated (Pearson correlation coefficients of at least 0.91); EM was less correlated with the other three measures (Pearson correlation coefficients ranging from 0.06 to 0.18). Factor analysis yields Eqs <xref rid="pone.0295027.e001" ref-type="disp-formula">1</xref> and <xref rid="pone.0295027.e002" ref-type="disp-formula">2</xref> for elevation and grade Inaccuracy scores, respectively, explaining 72%-75% of the variation among individual measures, with Kaiser&#x02013;Meyer&#x02013;Olkin (0.72&#x02013;0.73) and Bartlett&#x02019;s test of sphericity (p&#x0003c;0.01) confirming sampling adequacy and sufficient correlation between variables, respectively.</p><disp-formula id="pone.0295027.e001">
<alternatives><graphic xlink:href="pone.0295027.e001.jpg" id="pone.0295027.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.98</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.99</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.24</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.99</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>E</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives>
<label>(1)</label>
</disp-formula><disp-formula id="pone.0295027.e002">
<alternatives><graphic xlink:href="pone.0295027.e002.jpg" id="pone.0295027.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.96</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.99</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.12</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.99</mml:mn><mml:mspace width="0.25em"/><mml:msub><mml:mi>Z</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives>
<label>(2)</label>
</disp-formula></sec><sec id="sec011"><title>Accuracy of elevation and grade estimates</title><p><xref rid="pone.0295027.g002" ref-type="fig">Fig 2</xref> reports the distributions of Inaccuracy scores across locations for each profile generation method. More accurate methods produce lower-value (less inaccurate) distributions. Profile generation methods only produced significantly different Inaccuracy results (ANOVA test with p&#x0003c;0.05) for Method 1 grade estimates, for which FSCmean produced the most accurate grades followed by FSCpam. The aggregation method did not substantially impact the accuracy of elevation estimates, or grade estimates by Method 2. Between the two grade estimates, Method 2 produced consistently more accurate results.</p><fig position="float" id="pone.0295027.g002"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.g002</object-id><label>Fig 2</label><caption><p>Elevation (A) and grade (B) Inaccuracy scores across 16 study locations for each profile generation method.</p></caption><graphic xlink:href="pone.0295027.g002" position="float"/></fig><p>The optimal profile generation methods, based on the lowest median Inaccuracy scores, are FSCkml for elevation, FSCmean for grade by Method 1, and FSCpam for grade by Method 2 (although, as noted above, the differences are not statistically significant for elevation or Method 2 grade). <xref rid="pone.0295027.t004" ref-type="table">Table 4</xref> gives the median (interquartile range) individual accuracy measures for these profiles across the 16 locations. Note that the accuracy measures for grade are expressed in % road grade, not percent errors. The grade profiles generated by Method 1 have about twice the inaccuracy of those generated by Method 2, as indicated by higher RMSE, H, and F.</p><table-wrap position="float" id="pone.0295027.t004"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.t004</object-id><label>Table 4</label><caption><title>Median (interquartile range) of accuracy measures for optimal profile generation methods.</title></caption><alternatives><graphic xlink:href="pone.0295027.t004" id="pone.0295027.t004g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Accuracy measure</th><th align="center" rowspan="1" colspan="1">Elevation using FSCkml</th><th align="center" rowspan="1" colspan="1">Grade Method 1, using FSCmean</th><th align="center" rowspan="1" colspan="1">Grade Method 2, using FSCpam</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">RMSE</td><td align="center" rowspan="1" colspan="1">5.6 m (4.9 m)</td><td align="center" rowspan="1" colspan="1">2% (5%)</td><td align="center" rowspan="1" colspan="1">1% (3%)</td></tr><tr><td align="left" rowspan="1" colspan="1">H</td><td align="center" rowspan="1" colspan="1">5.8 m (5.6 m)</td><td align="center" rowspan="1" colspan="1">5% (10%)</td><td align="center" rowspan="1" colspan="1">2% (5%)</td></tr><tr><td align="left" rowspan="1" colspan="1">EM (unit-less)</td><td align="center" rowspan="1" colspan="1">0.1 (0.2)</td><td align="center" rowspan="1" colspan="1">0.3 (0.3)</td><td align="center" rowspan="1" colspan="1">0.3 (0.1)</td></tr><tr><td align="left" rowspan="1" colspan="1">F</td><td align="center" rowspan="1" colspan="1">5.8 m (5.6 m)</td><td align="center" rowspan="1" colspan="1">5% (10%)</td><td align="center" rowspan="1" colspan="1">2% (5%)</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec012"><title>Sources of error</title><p><xref rid="pone.0295027.t005" ref-type="table">Table 5</xref> gives associations between contextual variables and Inaccuracy scores for the best-performing crowd-sourced data methods above (FSCkml for elevation, Method 2 with FSCpam for grade). Inaccuracy increased with fewer efforts available&#x02013;particularly (and significantly) for grade estimates. The correlation magnitude between Inaccuracy and the number of efforts is greatest for preprocessed efforts, followed by filtered and then cleaned efforts. Consistent with this, grades were less accurate for the ground-truth locations, for which fewer efforts were available. Crowd-sourced grade Inaccuracy also significantly increased with lower GPS logging frequency and decreased for cycling activities (vs. foot travel), both of which lead to lower spatial density of records in each effort. Trajectories collected on cloudy days were also associated with higher Inaccuracy, consistent with previous findings that inclement weather degrades GPS location accuracy [<xref rid="pone.0295027.ref060" ref-type="bibr">60</xref>].</p><table-wrap position="float" id="pone.0295027.t005"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.t005</object-id><label>Table 5</label><caption><title>Associations between crowd-sourced data Inaccuracy and contextual variables<sup>1</sup>.</title></caption><alternatives><graphic xlink:href="pone.0295027.t005" id="pone.0295027.t005g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Variable</th><th align="center" rowspan="1" colspan="1">Elevation</th><th align="center" rowspan="1" colspan="1">Grade</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Elevated</td><td align="center" rowspan="1" colspan="1">0.88</td><td align="center" rowspan="1" colspan="1">-0.91</td></tr><tr><td align="left" rowspan="1" colspan="1">Length</td><td align="center" rowspan="1" colspan="1">-0.21</td><td align="center" rowspan="1" colspan="1">-0.24</td></tr><tr><td align="left" rowspan="1" colspan="1">Tree cover</td><td align="center" rowspan="1" colspan="1">0.08</td><td align="center" rowspan="1" colspan="1">0.21</td></tr><tr><td align="left" rowspan="1" colspan="1">Building cover</td><td align="center" rowspan="1" colspan="1">-0.23</td><td align="center" rowspan="1" colspan="1">-0.29</td></tr><tr><td align="left" rowspan="1" colspan="1">Ground-truth comparison</td><td align="center" rowspan="1" colspan="1">-0.18</td><td align="center" rowspan="1" colspan="1">3.82<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">Elevation</td><td align="center" rowspan="1" colspan="1">-0.12</td><td align="center" rowspan="1" colspan="1">0.34</td></tr><tr><td align="left" rowspan="1" colspan="1">Number preprocessed efforts</td><td align="center" rowspan="1" colspan="1">-0.42</td><td align="center" rowspan="1" colspan="1">-0.73<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">Number filtered efforts</td><td align="center" rowspan="1" colspan="1">-0.43</td><td align="center" rowspan="1" colspan="1">-0.71<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">Number cleaned efforts</td><td align="center" rowspan="1" colspan="1">-0.32</td><td align="center" rowspan="1" colspan="1">-0.61<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">Logging interval</td><td align="center" rowspan="1" colspan="1">-0.08</td><td align="center" rowspan="1" colspan="1">0.58<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">Speed outliers</td><td align="center" rowspan="1" colspan="1">-0.23</td><td align="center" rowspan="1" colspan="1">0.39</td></tr><tr><td align="left" rowspan="1" colspan="1">Cloudy</td><td align="center" rowspan="1" colspan="1">0.52<xref rid="t005fn002" ref-type="table-fn">*</xref></td><td align="center" rowspan="1" colspan="1">0.63<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr><tr><td align="left" rowspan="1" colspan="1">Mode (cycling vs. foot)</td><td align="center" rowspan="1" colspan="1">-1.00</td><td align="center" rowspan="1" colspan="1">-3.38<xref rid="t005fn002" ref-type="table-fn">*</xref></td></tr></tbody></table></alternatives><table-wrap-foot><fn id="t005fn001"><p><sup>1</sup> Pearson correlation for continuous variables and mean difference for binary variables.</p></fn><fn id="t005fn002"><p>* significantly different from zero at p&#x0003c;0.05.</p></fn></table-wrap-foot></table-wrap></sec><sec id="sec013"><title>Effects of sample size (number of efforts)</title><p>Based on <xref rid="pone.0295027.t001" ref-type="table">Table 1</xref>, filtering removes 3% of preprocessed efforts (averaged across locations), while cleaning removes another 14% of efforts for elevation and 47% of efforts for grade. The proportion of efforts removed by cleaning was higher for the 8 ground-truth locations (which already had fewer preprocessed efforts) than the 8 non-ground-truth locations: 57% versus 36% removed by cleaning for grade, respectively, and 21% versus 6% removed by cleaning for elevation.</p><p><xref rid="pone.0295027.g003" ref-type="fig">Fig 3</xref> shows Inaccuracy scores (again for the best-performing crowd-sourced data methods: FSCkml for elevation and FSCpam for grade Method 2) versus the number of filtered (left) and cleaned (right) efforts at each location, varying sample sizes by randomly retaining 20%, 40%, 60%, 80%, and 100% of the available filtered efforts at each location. The figure suggests a downward trend in Inaccuracy (i.e., improved accuracy) with both number of filtered and number of cleaned efforts, consistent with <xref rid="pone.0295027.t005" ref-type="table">Table 5</xref>. However, the variation in Inaccuracy is wide, and the minimum Inaccuracy for each location is not always obtained with the most (100%) efforts. The risk of highly inaccurate crowd-sourced estimates appears to increase below around 200 filtered efforts, or 150 cleaned efforts, which could be considered a minimum threshold to use for elevation and grade estimates from crowd-sourced data. For a more quantitative estimate, we looked for local minima by fitting 4<sup>th</sup>-order polynomials to the data presented in each panel of <xref rid="pone.0295027.g003" ref-type="fig">Fig 3</xref>. The fitted curve for the filtered efforts has no real roots, but the fitted curve for the cleaned efforts (<italic toggle="yes">R</italic><sup>2</sup> = 0.24) has a local minim at 134 cleaned efforts. This threshold scales to 180 filtered efforts based on the linear relationship between the number of filtered and cleaned efforts at each location. The qualitative thresholds of 150 cleaned or 200 filtered efforts are similar but slightly more conservative.</p><fig position="float" id="pone.0295027.g003"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.g003</object-id><label>Fig 3</label><caption><p>Inaccuracy score versus number of crowd-sourced filtered (A) and cleaned (B) efforts, using 20%, 40%, 60%, 80%, and 100% of available filtered efforts at each location.</p></caption><graphic xlink:href="pone.0295027.g003" position="float"/></fig></sec><sec id="sec014"><title>Comparison to other elevation data sources</title><p><xref rid="pone.0295027.g004" ref-type="fig">Fig 4</xref> compares Inaccuracy scores among elevation and grade data sources: the optimal crowd-sourced profiles above (using Method 2 for grade), high-resolution sources (CoVDEM and CoVLiDAR), low-resolution sources (CDSM and BCLiDAR), and the RwGPS application. Z-scores for these Inaccuracy values (Eqs <xref rid="pone.0295027.e001" ref-type="disp-formula">1</xref>&#x02013;<xref rid="pone.0295027.e002" ref-type="disp-formula">2</xref>) were recomputed using all four data sources, limited to the eight study locations with ground-truth data. High-resolution DEM/LiDAR data are the most accurate source of elevation and grade data, and RwGPS is the least accurate (based on median value). Crowd-sourced grade estimates outperform low-resolution DEM/LiDAR data, but crowd-sourced elevation estimates do not.</p><fig position="float" id="pone.0295027.g004"><object-id pub-id-type="doi">10.1371/journal.pone.0295027.g004</object-id><label>Fig 4</label><caption><p>Elevation (A) and grade (B) Inaccuracy scores of different elevation sources for segments with ground-truth data. Note: for legibility, horizontal scale excludes a high Inaccuracy outlier value for App results.</p></caption><graphic xlink:href="pone.0295027.g004" position="float"/></fig><p>Median RMSE for crowd-sourced, high-resolution, low-resolution, and RwGPS data sources are 4.6, 0.3, 3.2, and 4.7 m, respectively, for elevation and 4%, 1%, 5%, and 8%, respectively, for road grade. Note that the eight ground-truth locations are poorer-performing for crowd-sourced grade data than the other locations because they had fewer efforts available. The ground-truth locations averaged 86 and 49 cleaned efforts for elevation and grade estimates, respectively, while the non-ground-truth locations averaged 348 and 243 (<xref rid="pone.0295027.t001" ref-type="table">Table 1</xref>). Hence, this comparison is conservative in presenting the relative accuracy of smaller-sample crowd-sourced data.</p><p>Comparing our elevation estimation results to McKenzie and Janowicz [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>], they found RMSE ranging from 1.2 to 5.0 m across 4 locations, whereas we find similar but slightly poorer performance using the same method on our dataset, with a median RMSE of 6.7 m using Fmedian to create composite profiles. The small performance difference could be due to several factors. Firstly, [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] only examined non-elevated road segments (which tend to have smaller elevation error), whereas 5 of our 16 study locations were elevated. In terms of data, [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] utilized a larger number of efforts per location, which also reduces elevation error. In addition, the studies used different GPS data sources (Endomondo vs. Strava in [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>]), and these applications might employ different (unpublished) pre-processing steps affecting the &#x0201c;raw&#x0201d; elevation data [<xref rid="pone.0295027.ref037" ref-type="bibr">37</xref>]. Methodologically, [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] applied an additional filter for devices with barometric altimeters, which might have restricted their dataset to higher-precision GPS records (this could not be implemented in our study due to a lack of device data in Endomondo). Finally, [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] measured accuracy compared to LiDAR data, whereas we compare to both LiDAR and field surveying data (although we did not find that a survey-based reference source degraded elevation accuracy).</p><p>Comparing our results to the crowd-sourced GPS method in [<xref rid="pone.0295027.ref019" ref-type="bibr">19</xref>] we find improved results for elevation (they report an RMSE of 27 m) and for grade (they report a mean error of 2.4% road grade). Trajectory-based methods using probe vehicle sensor data [<xref rid="pone.0295027.ref032" ref-type="bibr">32</xref>,<xref rid="pone.0295027.ref033" ref-type="bibr">33</xref>] have reported greater accuracy (RMSE of 0.1% to 0.5% road grade), but rely on additional sensors that are not available in crowd-sourced GPS data.</p><p>We can contextualize these results using the relationship between road grade and energy expenditure, since energy or effort is a primary mediator of cycling behavior and outcomes (as stated above). Using typical urban cyclist physical parameters, cycling power <italic toggle="yes">P</italic> in watts can be estimated as
<disp-formula id="pone.0295027.e003">
<alternatives><graphic xlink:href="pone.0295027.e003.jpg" id="pone.0295027.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1030</mml:mn><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.0077</mml:mn><mml:mo>+</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mn>0.342</mml:mn><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></alternatives>
<label>(3)</label>
</disp-formula>
where <italic toggle="yes">G</italic> is the road grade (unit-less) and <italic toggle="yes">v</italic> is the cycling speed in m/s [<xref rid="pone.0295027.ref061" ref-type="bibr">61</xref>]. Assuming a 20 km/hr (5.56 m/s) cycling speed on level ground [<xref rid="pone.0295027.ref062" ref-type="bibr">62</xref>], even an error of 1% road grade (<italic toggle="yes">G</italic>&#x000b1;0.01) leads to a 57 W (56%) error in calculated cycling effort. Supporting this, in cycling route choice research, a 1% road grade can be considered &#x0201c;steep&#x0201d;, and a 3.5% grade &#x0201c;very steep&#x0201d; [<xref rid="pone.0295027.ref063" ref-type="bibr">63</xref>]. Thus, accuracy differences of 1% road grade are physically and behaviorally meaningful in cycling analysis.</p></sec></sec><sec sec-type="conclusions" id="sec015"><title>Conclusion</title><p>The results demonstrate that crowd-sourced GPS data, even in modest amounts, can provide relatively accurate roadway grade estimates&#x02013;better than the commonly-used low-resolution DEM, but not as good as high-resolution DSM or cloud-point LiDAR data. Our external validation of the elevation estimation method proposed by McKenzie &#x00026; Janowicz [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] with field surveying data supports the reliability of the method, even on elevated structures. We have also demonstrated small accuracy improvements from several enhancements to the method, including smoothing, cleaning, and using a clustering algorithm to aggregate efforts into a composite profile. And we determined that the most accurate way to extract grade data from crowd-sourced GPS is to aggregate individual grade profiles directly, rather than calculating grade from a composite elevation profile (which yields twice the error).</p><p>A related important finding is that although roadway elevation and grade are closely related, methodological findings for one cannot be directly transferred to the other. The accuracy of crowd-sourced grade estimates improves with the amount and resolution of GPS data available, among other factors, whereas the accuracy of crowd-sourced elevation estimates was shown to be less sensitive to these data attributes. Compared to other data sources, crowd-sourced grade estimates are more competitive than crowd-sourced elevation estimates, out-performing low-resolution DEM/LiDAR data for grade but not for elevation estimates. High-resolution DEM/LiDAR data still proved to be the most accurate across all locations, and should be used wherever available.</p><p>We recommend that future work to develop network-wide road grade data (such as for integrating with OSM) from crowd-sourced GPS data use a partition-around-medoid clustering algorithm to aggregate individual grade efforts, after applying a Savitzky-Golay filter for smoothing and DBSCAN for cleaning, which provides a RMSE in road grade of around 1%. Our study suggests that a minimum sample of approximately 200 GPS traces (prior to cleaning) would serve as a reasonable threshold for crowd-soured elevation and grade estimates. More accurate road grades can be extracted from cloud-point LiDAR data, where they are available in densities sufficient for road grade estimation. Unfortunately, due to costs LiDAR data are inconsistently available, even in a region as populated as metropolitan Vancouver, Canada. Additionally, LiDAR data are often collected in urban areas, creating inequities in data quality for rural active travelers. Thus, crowd-sourced GPS data provide the opportunity to derive road grades for the complete street network.</p><p>We also recommend additional research to further validate the proposed grade estimation method with independent datasets in other locations. Without external validation, we cannot say with certainty that the accuracy improvements we observed are transferable to other datasets (e.g., those that are larger or generated from different applications or devices). Further investigations are also needed into the impacts of varying sources of trajectory data and DBSCAN parameters. Qualitatively, smaller/narrower thresholds for the DBSCAN cluster radius result in more trajectories being removed through cleaning, with a trade-off of fewer but higher-quality trajectories remaining for inference. This effect can be seen in the difference in our results between estimates using cleaned data (using our DBSCAN parameters) versus only filtered data (which larger/wider DBSCAN cluster radii approach at the limit). For example, at the Burrard Bridge study location all 540 filtered efforts are identified as valid with a very large DBSCAN cluster radius, whereas the 45 m radius removes 294 efforts through cleaning. Varying the threshold &#x000b1;15 m results in 335 efforts removed at a 30 m radius and 224 efforts removed at a 60 m radius. Further research is needed to determine the optimal DBSCAN parameters in varying contexts, potentially contingent on dataset attributes (size, GPS device types, temporal resolution, application pre-processing, etc.), segment attributes (length, grade, elevated or not, surrounding terrain and land use, etc.), and other factors.</p><p>Finally, we reiterate the suggestion in [<xref rid="pone.0295027.ref026" ref-type="bibr">26</xref>] that continued efforts be made to incorporate (precise) road grade information into publicly-available street network datasets such as OSM. Accurate road grade data are crucial for analysis of active travel behavior (speed, route choices) and outcomes (travel time, energy expenditure), and the current lack of reliable data impedes analysis that fully considers the physiological aspects of active travel.</p></sec><sec id="sec016" sec-type="supplementary-material"><title>Supporting information</title><supplementary-material id="pone.0295027.s001" position="float" content-type="local-data"><label>S1 Dataset</label><caption><title>The complete set of three-dimensional GPS and surveying data used in the analysis.</title><p>(XLSX)</p></caption><media xlink:href="pone.0295027.s001.xlsx"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><p>All authors reviewed the results and approved the final version of the manuscript. The authors would like to thank WestGrid (<ext-link xlink:href="http://www.westgrid.ca/" ext-link-type="uri">www.westgrid.ca</ext-link>) and Compute Canada (<ext-link xlink:href="http://www.computecanada.ca/" ext-link-type="uri">www.computecanada.ca</ext-link>) for providing computational support.</p></ack><ref-list><title>References</title><ref id="pone.0295027.ref001"><label>1</label><mixed-citation publication-type="journal"><name><surname>Nelson</surname><given-names>T</given-names></name>, <name><surname>Ferster</surname><given-names>C</given-names></name>, <name><surname>Laberee</surname><given-names>K</given-names></name>, <name><surname>Fuller</surname><given-names>D</given-names></name>, <name><surname>Winters</surname><given-names>M</given-names></name>. <article-title>Crowdsourced data for bicycling research and practice</article-title>. <source>Transport Reviews</source>. <year>2021</year>;<volume>41</volume>: <fpage>97</fpage>&#x02013;<lpage>114</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01441647.2020.1806943</pub-id></mixed-citation></ref><ref id="pone.0295027.ref002"><label>2</label><mixed-citation publication-type="journal"><name><surname>Hochmair</surname><given-names>HH</given-names></name>, <name><surname>Bardin</surname><given-names>E</given-names></name>, <name><surname>Ahmouda</surname><given-names>A</given-names></name>. <article-title>Estimating bicycle trip volume for Miami-Dade county from Strava tracking data</article-title>. <source>Journal of transport geography</source>. <year>2019</year>;<volume>75</volume>: <fpage>58</fpage>&#x02013;<lpage>69</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref003"><label>3</label><mixed-citation publication-type="journal"><name><surname>Haworth</surname><given-names>J.</given-names></name>
<article-title>Investigating the potential of activity tracking app data to estimate cycle flows in urban areas. ISPRS-International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences</article-title>. <source>Copernicus Gesellschaft MBH</source>; <year>2016</year>. pp. <fpage>515</fpage>&#x02013;<lpage>519</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref004"><label>4</label><mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>Y</given-names></name>, <name><surname>Mobasheri</surname><given-names>A</given-names></name>. <article-title>Utilizing crowdsourced data for studies of cycling and air pollution exposure: A case study using strava data</article-title>. <source>International journal of environmental research and public health</source>. <year>2017</year>;<volume>14</volume>: <fpage>274</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/ijerph14030274</pub-id>
<pub-id pub-id-type="pmid">28282865</pub-id>
</mixed-citation></ref><ref id="pone.0295027.ref005"><label>5</label><mixed-citation publication-type="journal"><name><surname>Figliozzi</surname><given-names>M</given-names></name>, <name><surname>Blanc</surname><given-names>B</given-names></name>. <article-title>Evaluating the use of crowdsourcing as a data collection method for bicycle performance measures and identification of facility improvement needs</article-title>. <source>Oregon. Dept. of Transportation. Research Section</source>; <year>2015</year>.</mixed-citation></ref><ref id="pone.0295027.ref006"><label>6</label><mixed-citation publication-type="journal"><name><surname>LaMondia</surname><given-names>J</given-names></name>, <name><surname>Watkins</surname><given-names>K</given-names></name>. <source>Using crowdsourcing to prioritize bicycle route network improvements</source>. <year>2017</year>.</mixed-citation></ref><ref id="pone.0295027.ref007"><label>7</label><mixed-citation publication-type="journal"><name><surname>Bergman</surname><given-names>C</given-names></name>, <name><surname>Oksanen</surname><given-names>J</given-names></name>. <article-title>Conflation of OpenStreetMap and mobile sports tracking data for automatic bicycle routing</article-title>. <source>Transactions in GIS</source>. <year>2016</year>;<volume>20</volume>: <fpage>848</fpage>&#x02013;<lpage>868</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref008"><label>8</label><mixed-citation publication-type="journal"><name><surname>Brauer</surname><given-names>A</given-names></name>, <name><surname>M&#x000e4;kinen</surname><given-names>V</given-names></name>, <name><surname>Oksanen</surname><given-names>J</given-names></name>. <article-title>Characterizing cycling traffic fluency using big mobile activity tracking data</article-title>. <source>Computers, Environment and Urban Systems</source>. <year>2021</year>;<volume>85</volume>: <fpage>101553</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref009"><label>9</label><mixed-citation publication-type="journal"><name><surname>Chou</surname><given-names>K-Y</given-names></name>, <name><surname>Paulsen</surname><given-names>M</given-names></name>, <name><surname>Nielsen</surname><given-names>OA</given-names></name>, <name><surname>Jensen</surname><given-names>AF</given-names></name>. <article-title>Analysis of cycling accessibility using detour ratios&#x02013;A large-scale study based on crowdsourced GPS data</article-title>. <source>Sustainable Cities and Society</source>. <year>2023</year>;<volume>93</volume>: <fpage>104500</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.scs.2023.104500</pub-id></mixed-citation></ref><ref id="pone.0295027.ref010"><label>10</label><mixed-citation publication-type="journal"><name><surname>Fl&#x000fc;gel</surname><given-names>S</given-names></name>, <name><surname>Hulleberg</surname><given-names>N</given-names></name>, <name><surname>Fyhri</surname><given-names>A</given-names></name>, <name><surname>Weber</surname><given-names>C</given-names></name>, <name><surname>&#x000c6;varsson</surname><given-names>G</given-names></name>. <article-title>Empirical speed models for cycling in the Oslo road network</article-title>. <source>Transportation</source>. <year>2019</year>; <fpage>1</fpage>&#x02013;<lpage>25</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref011"><label>11</label><mixed-citation publication-type="journal"><name><surname>Zimmermann</surname><given-names>M</given-names></name>, <name><surname>Mai</surname><given-names>T</given-names></name>, <name><surname>Frejinger</surname><given-names>E</given-names></name>. <article-title>Bike route choice modeling using GPS data without choice sets of paths</article-title>. <source>Transportation research part C: emerging technologies</source>. <year>2017</year>;<volume>75</volume>: <fpage>183</fpage>&#x02013;<lpage>196</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref012"><label>12</label><mixed-citation publication-type="journal"><name><surname>Mohamed</surname><given-names>A</given-names></name>, <name><surname>Bigazzi</surname><given-names>A</given-names></name>. <article-title>Speed and road grade dynamics of urban trips on electric and conventional bicycles</article-title>. <source>Transportmetrica B: transport dynamics</source>. <year>2019</year>;<volume>7</volume>: <fpage>1467</fpage>&#x02013;<lpage>1480</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref013"><label>13</label><mixed-citation publication-type="journal"><name><surname>Bigazzi</surname><given-names>AY</given-names></name>. <article-title>Determination of active travel speed for minimum air pollution inhalation</article-title>. <source>International Journal of Sustainable Transportation</source>. <year>2017</year>;<volume>11</volume>: <fpage>221</fpage>&#x02013;<lpage>229</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref014"><label>14</label><mixed-citation publication-type="journal"><name><surname>Broach</surname><given-names>J</given-names></name>, <name><surname>Dill</surname><given-names>J</given-names></name>, <name><surname>Gliebe</surname><given-names>J</given-names></name>. <article-title>Where do cyclists ride? A route choice model developed with revealed preference GPS data</article-title>. <source>Transportation Research Part A: Policy and Practice</source>. <year>2012</year>;<volume>46</volume>: <fpage>1730</fpage>&#x02013;<lpage>1740</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref015"><label>15</label><mixed-citation publication-type="journal"><name><surname>Tengattini</surname><given-names>S</given-names></name>, <name><surname>Bigazzi</surname><given-names>AY</given-names></name>. <article-title>Context-sensitive, first-principles approach to bicycle speed estimation</article-title>. <source>IET Intelligent Transport Systems</source>. <year>2017</year>;<volume>11</volume>: <fpage>411</fpage>&#x02013;<lpage>416</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref016"><label>16</label><mixed-citation publication-type="journal"><name><surname>Bigazzi</surname><given-names>AY</given-names></name>, <name><surname>Figliozzi</surname><given-names>MA</given-names></name>. <article-title>Dynamic ventilation and power output of urban bicyclists</article-title>. <source>Transportation Research Record: Journal of the Transportation Research Board</source>. <year>2015</year>; <fpage>52</fpage>&#x02013;<lpage>60</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref017"><label>17</label><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Zou</surname><given-names>Y</given-names></name>, <name><surname>Henrickson</surname><given-names>K</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Park</surname><given-names>B-J</given-names></name>. <article-title>Google Earth elevation data extraction and accuracy assessment for transportation applications</article-title>. <source>PloS one</source>. <year>2017</year>;<volume>12</volume>: <fpage>e0175756</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0175756</pub-id>
<pub-id pub-id-type="pmid">28445480</pub-id>
</mixed-citation></ref><ref id="pone.0295027.ref018"><label>18</label><mixed-citation publication-type="journal"><name><surname>El Masri</surname><given-names>O</given-names></name>, <name><surname>Bigazzi</surname><given-names>AY</given-names></name>. <article-title>Road grade estimates for bicycle travel analysis on a street network</article-title>. <source>Transportation Research Part C: Emerging Technologies</source>. <year>2019</year>;<volume>104</volume>: <fpage>158</fpage>&#x02013;<lpage>171</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref019"><label>19</label><mixed-citation publication-type="journal"><name><surname>John</surname><given-names>S</given-names></name>, <name><surname>Hahmann</surname><given-names>S</given-names></name>, <name><surname>Rousell</surname><given-names>A</given-names></name>, <name><surname>L&#x000f6;wner</surname><given-names>M-O</given-names></name>, <name><surname>Zipf</surname><given-names>A</given-names></name>. <article-title>Deriving incline values for street networks from voluntarily collected GPS traces</article-title>. <source>Cartography and Geographic Information Science</source>. <year>2017</year>;<volume>44</volume>: <fpage>152</fpage>&#x02013;<lpage>169</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref020"><label>20</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Yang</surname><given-names>X</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Feng</surname><given-names>J</given-names></name>. <article-title>An Automatic Approach to Extracting Large-Scale Three-Dimensional Road Networks Using Open-Source Data</article-title>. <source>Remote Sensing</source>. <year>2022</year>;<volume>14</volume>: <fpage>5746</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref021"><label>21</label><mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>X.</given-names></name>
<article-title>Airborne LiDAR for DEM generation: some critical issues</article-title>. <source>Progress in physical geography</source>. <year>2008</year>;<volume>32</volume>: <fpage>31</fpage>&#x02013;<lpage>49</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref022"><label>22</label><mixed-citation publication-type="journal"><name><surname>Boyko</surname><given-names>A</given-names></name>, <name><surname>Funkhouser</surname><given-names>T</given-names></name>. <article-title>Extracting roads from dense point clouds in large scale urban environment</article-title>. <source>ISPRS Journal of Photogrammetry and Remote Sensing</source>. <year>2011</year>;<volume>66</volume>: <fpage>S2</fpage>&#x02013;<lpage>S12</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref023"><label>23</label><mixed-citation publication-type="journal"><name><surname>Feng</surname><given-names>J</given-names></name>, <name><surname>Qin</surname><given-names>D</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>You</surname><given-names>Y</given-names></name>. <article-title>Real-time estimation of road slope based on multiple models and multiple data fusion</article-title>. <source>Measurement</source>. <year>2021</year>;<volume>181</volume>: <fpage>109609</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref024"><label>24</label><mixed-citation publication-type="journal"><name><surname>Meng</surname><given-names>X</given-names></name>, <name><surname>Pang</surname><given-names>K</given-names></name>, <name><surname>Di</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Road grade estimation for vehicle emissions modeling using electronic atmospheric pressure sensors</article-title>. <source>Frontiers in Environmental Science</source>. <year>2023</year>;<volume>10</volume>: <fpage>2522</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref025"><label>25</label><mixed-citation publication-type="journal"><name><surname>Boroujeni</surname><given-names>BY</given-names></name>, <name><surname>Frey</surname><given-names>HC</given-names></name>. <article-title>Road grade quantification based on global positioning system data obtained from real-world vehicle fuel use and emissions measurements</article-title>. <source>Atmospheric Environment</source>. <year>2014</year>;<volume>85</volume>: <fpage>179</fpage>&#x02013;<lpage>186</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref026"><label>26</label><mixed-citation publication-type="journal"><name><surname>McKenzie</surname><given-names>G</given-names></name>, <name><surname>Janowicz</surname><given-names>K</given-names></name>. <article-title>ISED: Constructing a high-resolution elevation road dataset from massive, low-quality in-situ observations derived from geosocial fitness tracking data</article-title>. <source>PloS one</source>. <year>2017</year>;<volume>12</volume>: <fpage>e0186474</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0186474</pub-id>
<pub-id pub-id-type="pmid">29028828</pub-id>
</mixed-citation></ref><ref id="pone.0295027.ref027"><label>27</label><mixed-citation publication-type="journal"><name><surname>Clarry</surname><given-names>A</given-names></name>, <name><surname>Imani</surname><given-names>AF</given-names></name>, <name><surname>Miller</surname><given-names>EJ</given-names></name>. <article-title>Where we ride faster? Examining cycling speed using smartphone GPS data</article-title>. <source>Sustainable Cities and Society</source>. <year>2019</year>;<volume>49</volume>: <fpage>101594</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref028"><label>28</label><mixed-citation publication-type="journal"><name><surname>Strauss</surname><given-names>J</given-names></name>, <name><surname>Miranda-Moreno</surname><given-names>LF</given-names></name>. <article-title>Speed, travel time and delay for intersections and road segments in the Montreal network using cyclist Smartphone GPS data</article-title>. <source>Transportation research part D: transport and environment</source>. <year>2017</year>;<volume>57</volume>: <fpage>155</fpage>&#x02013;<lpage>171</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref029"><label>29</label><mixed-citation publication-type="journal"><name><surname>Casello</surname><given-names>JM</given-names></name>, <name><surname>Usyukov</surname><given-names>V</given-names></name>. <article-title>Modeling cyclists&#x02019; route choice based on GPS data</article-title>. <source>Transportation Research Record</source>. <year>2014</year>;<volume>2430</volume>: <fpage>155</fpage>&#x02013;<lpage>161</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref030"><label>30</label><mixed-citation publication-type="book"><name><surname>Grond</surname><given-names>KA</given-names></name>. <source>Route Choice Modeling of Cyclists in Toronto</source>. <publisher-name>University of Toronto</publisher-name>. <year>2016</year>.</mixed-citation></ref><ref id="pone.0295027.ref031"><label>31</label><mixed-citation publication-type="journal"><name><surname>Menghini</surname><given-names>G</given-names></name>, <name><surname>Carrasco</surname><given-names>N</given-names></name>, <name><surname>Sch&#x000fc;ssler</surname><given-names>N</given-names></name>, <name><surname>Axhausen</surname><given-names>KW</given-names></name>. <article-title>Route choice of cyclists in Zurich</article-title>. <source>Transportation research part A: policy and practice</source>. <year>2010</year>;<volume>44</volume>: <fpage>754</fpage>&#x02013;<lpage>765</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref032"><label>32</label><mixed-citation publication-type="other">Gupta A, Hu S, Zhong W, Sadek A, Su L, Qiao C. Road grade estimation using crowd-sourced smartphone data. 2020 19th ACM/IEEE International Conference on Information Processing in Sensor Networks (IPSN). IEEE; 2020. pp. 313&#x02013;324.</mixed-citation></ref><ref id="pone.0295027.ref033"><label>33</label><mixed-citation publication-type="journal"><name><surname>Fan</surname><given-names>P</given-names></name>, <name><surname>Song</surname><given-names>G</given-names></name>, <name><surname>Zhu</surname><given-names>Z</given-names></name>, <name><surname>Wu</surname><given-names>Y</given-names></name>, <name><surname>Zhai</surname><given-names>Z</given-names></name>, <name><surname>Yu</surname><given-names>L</given-names></name>. <article-title>Road grade estimation based on Large-scale fuel consumption data of connected vehicles</article-title>. <source>Transportation Research Part D: Transport and Environment</source>. <year>2022</year>;<volume>106</volume>: <fpage>103262</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref034"><label>34</label><mixed-citation publication-type="journal"><name><surname>Merry</surname><given-names>K</given-names></name>, <name><surname>Bettinger</surname><given-names>P</given-names></name>. <article-title>Smartphone GPS accuracy study in an urban environment</article-title>. <source>PloS one</source>. <year>2019</year>;<volume>14</volume>: <fpage>e0219890</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0219890</pub-id>
<pub-id pub-id-type="pmid">31318933</pub-id>
</mixed-citation></ref><ref id="pone.0295027.ref035"><label>35</label><mixed-citation publication-type="journal"><name><surname>Sch&#x000fc;ssler</surname><given-names>N</given-names></name>, <name><surname>Axhausen</surname><given-names>KW</given-names></name>. <article-title>Identifying trips and activities and their characteristics from GPS raw data without further information</article-title>. <source>Arbeitsbericht Verkehrs-und Raumplanung</source>. <year>2008</year>;<volume>502</volume>.</mixed-citation></ref><ref id="pone.0295027.ref036"><label>36</label><mixed-citation publication-type="journal"><name><surname>Zandbergen</surname><given-names>P</given-names></name>, <name><surname>Barbeau</surname><given-names>S</given-names></name>. <article-title>Positional Accuracy of Assisted GPS Data from High-Sensitivity GPS-enabled Mobile Phones</article-title>. <source>Journal of Navigation</source>. <year>2011</year>;<volume>64</volume>: <fpage>381</fpage>&#x02013;<lpage>399</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1017/S0373463311000051</pub-id></mixed-citation></ref><ref id="pone.0295027.ref037"><label>37</label><mixed-citation publication-type="book"><name><surname>Bauer</surname><given-names>C.</given-names></name>
<part-title>On the (In-)Accuracy of GPS Measures of Smartphones: A Study of Running Tracking Applications</part-title>. <source>Proceedings of International Conference on Advances in Mobile Computing &#x00026; Multimedia</source>. <publisher-loc>New York, NY, USA</publisher-loc>: <publisher-name>Association for Computing Machinery</publisher-name>; <year>2013</year>. pp. <fpage>335</fpage>&#x02013;<lpage>341</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1145/2536853.2536893</pub-id></mixed-citation></ref><ref id="pone.0295027.ref038"><label>38</label><mixed-citation publication-type="journal"><name><surname>Menasp&#x000e0;</surname><given-names>P</given-names></name>, <name><surname>Haakonssen</surname><given-names>E</given-names></name>, <name><surname>Sharma</surname><given-names>A</given-names></name>, <name><surname>Clark</surname><given-names>B</given-names></name>. <article-title>Accuracy in measurement of elevation gain in road cycling</article-title>. <source>Journal of Science and Cycling</source>. <year>2016</year>;<volume>5</volume>: <fpage>10</fpage>&#x02013;<lpage>12</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref039"><label>39</label><mixed-citation publication-type="other">Ride with GPS. Bridge and Tunnel Elevation Data Improved. In: Retrieved from <ext-link xlink:href="https://ridewithgps.com/news/5657-bridge-and-tunnel-elevation-data-improve" ext-link-type="uri">https://ridewithgps.com/news/5657-bridge-and-tunnel-elevation-data-improve</ext-link>. 2021.</mixed-citation></ref><ref id="pone.0295027.ref040"><label>40</label><mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>C</given-names></name>, <name><surname>Jia</surname><given-names>H</given-names></name>, <name><surname>Juan</surname><given-names>Z</given-names></name>, <name><surname>Fu</surname><given-names>X</given-names></name>, <name><surname>Xiao</surname><given-names>G</given-names></name>. <article-title>A data-driven method for trip ends identification using large-scale smartphone-based GPS tracking data</article-title>. <source>IEEE Transactions on Intelligent Transportation Systems</source>. <year>2016</year>;<volume>18</volume>: <fpage>2096</fpage>&#x02013;<lpage>2110</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref041"><label>41</label><mixed-citation publication-type="book"><name><surname>Biljecki</surname><given-names>F.</given-names></name>
<source>Automatic segmentation and classification of movement trajectories for transportation modes</source>. <publisher-name>Delft University of Technology</publisher-name>. <year>2010</year>.</mixed-citation></ref><ref id="pone.0295027.ref042"><label>42</label><mixed-citation publication-type="journal"><name><surname>Schuessler</surname><given-names>N</given-names></name>, <name><surname>Axhausen</surname><given-names>KW</given-names></name>. <article-title>Processing raw data from global positioning systems without additional information</article-title>. <source>Transportation Research Record</source>. <year>2009</year>;<volume>2105</volume>: <fpage>28</fpage>&#x02013;<lpage>36</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref043"><label>43</label><mixed-citation publication-type="journal"><name><surname>Berjisian</surname><given-names>E</given-names></name>, <name><surname>Bigazzi</surname><given-names>A</given-names></name>. <article-title>Evaluation of methods to distinguish trips from activities in walking and cycling GPS data</article-title>. <source>Transportation Research Part C: Emerging Technologies</source>. <year>2022</year>;<volume>137</volume>: <fpage>103588</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.trc.2022.103588</pub-id></mixed-citation></ref><ref id="pone.0295027.ref044"><label>44</label><mixed-citation publication-type="journal"><name><surname>Millard-Ball</surname><given-names>A</given-names></name>, <name><surname>Hampshire</surname><given-names>RC</given-names></name>, <name><surname>Weinberger</surname><given-names>RR</given-names></name>. <article-title>Map-matching poor-quality GPS data in urban environments: the pgMapMatch package</article-title>. <source>Transportation Planning and Technology</source>. <year>2019</year>; <fpage>1</fpage>&#x02013;<lpage>15</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref045"><label>45</label><mixed-citation publication-type="other">OpenStreetMap contributors. Planet Dump Retrieved from <ext-link xlink:href="https://planet.openstreetmap.org" ext-link-type="uri">https://planet.openstreetmap.org</ext-link>, (Data file from July 2020). 2020.</mixed-citation></ref><ref id="pone.0295027.ref046"><label>46</label><mixed-citation publication-type="journal"><name><surname>Berjisian</surname><given-names>E</given-names></name>, <name><surname>Bigazzi</surname><given-names>A</given-names></name>. <article-title>Evaluation of map-matching algorithms for smartphone-based active travel data</article-title>. <source>IET Intelligent Transport Systems</source>. <year>2023</year>;<volume>17</volume>: <fpage>227</fpage>&#x02013;<lpage>242</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1049/itr2.12250</pub-id></mixed-citation></ref><ref id="pone.0295027.ref047"><label>47</label><mixed-citation publication-type="other">City of Vancouver. DEM. In: Retrieved from <ext-link xlink:href="https://opendata.vancouver.ca/explore/dataset/digital-elevation-model/information/" ext-link-type="uri">https://opendata.vancouver.ca/explore/dataset/digital-elevation-model/information/</ext-link>. 2013.</mixed-citation></ref><ref id="pone.0295027.ref048"><label>48</label><mixed-citation publication-type="other">Ministry of Natural Resources C. Canadian Digital Surface Model. 2014.</mixed-citation></ref><ref id="pone.0295027.ref049"><label>49</label><mixed-citation publication-type="other">The City of Vancouver. LiDAR 2013. In: Retrieved from <ext-link xlink:href="http://data.vancouver.ca/datacatalogue/LiDAR2013.htm" ext-link-type="uri">http://data.vancouver.ca/datacatalogue/LiDAR2013.htm</ext-link> (accessed 4.3.18). 2013.</mixed-citation></ref><ref id="pone.0295027.ref050"><label>50</label><mixed-citation publication-type="other">British Columbia. BC LiDAR. In: Retrieved from <ext-link xlink:href="https://www2.gov.bc.ca/gov/content/data/geographic-data-services/lidarbc" ext-link-type="uri">https://www2.gov.bc.ca/gov/content/data/geographic-data-services/lidarbc</ext-link>. 2018.</mixed-citation></ref><ref id="pone.0295027.ref051"><label>51</label><mixed-citation publication-type="journal"><name><surname>Lajevardi</surname><given-names>SM</given-names></name>. <source>An examination of heavy-duty trucks drivetrain options to reduce GHG emissions in British Columbia</source>. <year>2019</year>.</mixed-citation></ref><ref id="pone.0295027.ref052"><label>52</label><mixed-citation publication-type="book"><name><surname>Wood</surname><given-names>E</given-names></name>, <name><surname>Burton</surname><given-names>E</given-names></name>, <name><surname>Duran</surname><given-names>A</given-names></name>, <name><surname>Gonder</surname><given-names>J</given-names></name>. <source>Appending High-Resolution Elevation Data to GPS Speed Traces for Vehicle Energy Modeling and Simulation</source>. <publisher-name>National Renewable Energy Lab.(NREL)</publisher-name>, <publisher-loc>Golden, CO (United States)</publisher-loc>; <year>2014</year>.</mixed-citation></ref><ref id="pone.0295027.ref053"><label>53</label><mixed-citation publication-type="journal"><name><surname>Ester</surname><given-names>M</given-names></name>, <name><surname>Kriegel</surname><given-names>H-P</given-names></name>, <name><surname>Sander</surname><given-names>J</given-names></name>, <name><surname>Xu</surname><given-names>X</given-names></name>. <article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>. <source>kdd</source>. <year>1996</year>. pp. <fpage>226</fpage>&#x02013;<lpage>231</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref054"><label>54</label><mixed-citation publication-type="other">Newson P, Krumm J. Hidden Markov map matching through noise and sparseness. Proceedings of the 17th ACM SIGSPATIAL international conference on advances in geographic information systems. ACM; 2009. pp. 336&#x02013;343.</mixed-citation></ref><ref id="pone.0295027.ref055"><label>55</label><mixed-citation publication-type="journal"><name><surname>Schuessler</surname><given-names>N</given-names></name>, <name><surname>Axhausen</surname><given-names>KW</given-names></name>. <article-title>Map-matching of GPS traces on high-resolution navigation networks using the Multiple Hypothesis Technique (MHT)</article-title>. <source>Arbeitsberichte Verkehrsund Raumplanung</source>. <year>2009</year>;<volume>568</volume>: <fpage>1</fpage>&#x02013;<lpage>22</lpage>.</mixed-citation></ref><ref id="pone.0295027.ref056"><label>56</label><mixed-citation publication-type="book"><name><surname>Kaufman</surname><given-names>L</given-names></name>, <name><surname>Rousseeuw</surname><given-names>PJ</given-names></name>. <source>Finding groups in data: an introduction to cluster analysis</source>. <publisher-name>John Wiley &#x00026; Sons</publisher-name>; <year>2009</year>.</mixed-citation></ref><ref id="pone.0295027.ref057"><label>57</label><mixed-citation publication-type="journal"><name><surname>Genolini</surname><given-names>C</given-names></name>, <name><surname>Ecochard</surname><given-names>R</given-names></name>, <name><surname>Benghezal</surname><given-names>M</given-names></name>, <name><surname>Driss</surname><given-names>T</given-names></name>, <name><surname>Andrieu</surname><given-names>S</given-names></name>, <name><surname>Subtil</surname><given-names>F</given-names></name>. <article-title>kmlShape: an efficient method to cluster longitudinal data (time-series) according to their shapes</article-title>. <source>Plos one</source>. <year>2016</year>;<volume>11</volume>: <fpage>e0150738</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0150738</pub-id>
<pub-id pub-id-type="pmid">27258355</pub-id>
</mixed-citation></ref><ref id="pone.0295027.ref058"><label>58</label><mixed-citation publication-type="book"><name><surname>Field</surname><given-names>A</given-names></name>, <name><surname>Miles</surname><given-names>J</given-names></name>, <name><surname>Field</surname><given-names>Z</given-names></name>. <source>Discovering statistics using R</source>. <publisher-name>Sage publications</publisher-name>; <year>2012</year>.</mixed-citation></ref><ref id="pone.0295027.ref059"><label>59</label><mixed-citation publication-type="journal"><name><surname>DiStefano</surname><given-names>C</given-names></name>, <name><surname>Zhu</surname><given-names>M</given-names></name>, <name><surname>Mindrila</surname><given-names>D</given-names></name>. <article-title>Understanding and using factor scores: Considerations for the applied researcher</article-title>. <source>Practical Assessment, Research, and Evaluation</source>. <year>2009</year>;<volume>14</volume>: <fpage>20</fpage>.</mixed-citation></ref><ref id="pone.0295027.ref060"><label>60</label><mixed-citation publication-type="other">Yeh S-C, Hsu W-H, Su M-Y, Chen C-H, Liu K-H. A study on outdoor positioning technology using GPS and WiFi networks. 2009 International Conference on Networking, Sensing and Control. IEEE; 2009. pp. 597&#x02013;601.</mixed-citation></ref><ref id="pone.0295027.ref061"><label>61</label><mixed-citation publication-type="journal"><name><surname>Tengattini</surname><given-names>S</given-names></name>, <name><surname>Bigazzi</surname><given-names>AY</given-names></name>. <article-title>Physical characteristics and resistance parameters of typical urban cyclists</article-title>. <source>Journal of Sports Sciences</source>. <year>2018</year>;<volume>36</volume>: <fpage>2383</fpage>&#x02013;<lpage>2391</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/02640414.2018.1458587</pub-id>
<pub-id pub-id-type="pmid">29598811</pub-id>
</mixed-citation></ref><ref id="pone.0295027.ref062"><label>62</label><mixed-citation publication-type="book"><name><surname>Bigazzi</surname><given-names>AY</given-names></name>, <name><surname>Hassanpour</surname><given-names>A</given-names></name>. <source>Human-electric hybrid vehicles: Implications of new non-auto mobility options for street design and policy in the Vancouver region</source>. <publisher-loc>Vancouver, Canada</publisher-loc>: <publisher-name>Prepared for TransLink</publisher-name>; <year>2022</year>
<month>Jun</month> p. 105. Available: <ext-link xlink:href="https://reactlab.civil.ubc.ca/human-electric-hybrid-vehicles/" ext-link-type="uri">https://reactlab.civil.ubc.ca/human-electric-hybrid-vehicles/</ext-link>.</mixed-citation></ref><ref id="pone.0295027.ref063"><label>63</label><mixed-citation publication-type="journal"><name><surname>&#x00141;ukawska</surname><given-names>M</given-names></name>, <name><surname>Paulsen</surname><given-names>M</given-names></name>, <name><surname>Rasmussen</surname><given-names>TK</given-names></name>, <name><surname>Jensen</surname><given-names>AF</given-names></name>, <name><surname>Nielsen</surname><given-names>OA</given-names></name>. <article-title>A joint bicycle route choice model for various cycling frequencies and trip distances based on a large crowdsourced GPS dataset</article-title>. <source>Transportation Research Part A: Policy and Practice</source>. <year>2023</year>;<volume>176</volume>: <fpage>103834</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tra.2023.103834</pub-id></mixed-citation></ref></ref-list></back></article>
