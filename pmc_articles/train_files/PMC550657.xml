<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15705189</article-id><article-id pub-id-type="pmc">PMC550657</article-id><article-id pub-id-type="publisher-id">1471-2105-6-25</article-id><article-id pub-id-type="doi">10.1186/1471-2105-6-25</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Integrating alternative splicing detection into gene prediction</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Foissac</surname><given-names>Sylvain</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>foissac@toulouse.inra.fr</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Schiex</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>tschiex@toulouse.inra.fr</email></contrib></contrib-group><aff id="I1"><label>1</label>Unit&#x000e9; de Biom&#x000e9;trie et Intelligence Artificielle, INRA, 31326 Castanet Tolosan, France</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>10</day><month>2</month><year>2005</year></pub-date><volume>6</volume><fpage>25</fpage><lpage>25</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/25"/><history><date date-type="received"><day>27</day><month>7</month><year>2004</year></date><date date-type="accepted"><day>10</day><month>2</month><year>2005</year></date></history><copyright-statement>Copyright &#x000a9; 2005 Foissac and Schiex; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>Alternative splicing (AS) is now considered as a major actor in transcriptome/proteome diversity and it cannot be neglected in the annotation process of a new genome. Despite considerable progresses in term of accuracy in computational gene prediction, the ability to reliably predict AS variants when there is local experimental evidence of it remains an open challenge for gene finders.</p></sec><sec><title>Results</title><p>We have used a new integrative approach that allows to incorporate AS detection into <italic>ab initio </italic>gene prediction. This method relies on the analysis of genomically aligned transcript sequences (ESTs and/or cDNAs), and has been implemented in the dynamic programming algorithm of the graph-based gene finder EuG&#x000c8;NE. Given a genomic sequence and a set of aligned transcripts, this new version identifies the set of transcripts carrying evidence of alternative splicing events, and provides, in addition to the classical optimal gene prediction, alternative optimal predictions (among those which are consistent with the AS events detected). This allows for multiple annotations of a single gene in a way such that each predicted variant is supported by a transcript evidence (but not necessarily with a full-length coverage).</p></sec><sec><title>Conclusions</title><p>This automatic combination of experimental data analysis and <italic>ab initio </italic>gene finding offers an ideal integration of alternatively spliced gene prediction inside a single annotation pipeline.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Alternative splicing (AS) is a biological process that occurs during the maturation step of a pre-mRNA, allowing the production of different mature mRNA variants from a unique transcription unit. AS is known to play a key role in the regulation of gene expression and transcriptome/proteome diversity [<xref ref-type="bibr" rid="B1">1</xref>]. First considered as an exceptional event, AS is now thought to involve the majority of the human multi-exon genes, from 50% to 74% [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. This observation raises new issues for genome annotation, especially concerning the computational gene finding process that generally provides only one exon-intron structure per sequence.</p><p>In the context of structural gene prediction, two classes of approaches are usually considered. In the first approach, usually denoted as <italic>intrinsic </italic>or <italic>ab initio</italic>, the only type of information used for gene prediction lies in the statistical properties of the various gene elements (exons, splice sites and other biological signals). On the contrary, so-called <italic>extrinsic </italic>approaches essentially rely on the existence of similarities between the sequence to annotate and other known sequences (either proteins, transcripts or other genomic sequences). Several existing gene finding tools are essentially <italic>intrinsic </italic>(or <italic>ab initio</italic>): this is the case for Genscan [<xref ref-type="bibr" rid="B4">4</xref>], HMMgene [<xref ref-type="bibr" rid="B5">5</xref>] or SLAM [<xref ref-type="bibr" rid="B6">6</xref>]. For such a gene finder, the predicted gene structure is defined as an optimal prediction, that is the most probable according to its underlying probabilistic model. In the presence of AS however, a unique prediction is not sufficient. One obvious possibility is to look for suboptimal predictions. This can be done for a classic HMM-based gene finder by a modification of the Viterbi algorithm, thus providing the set of the <italic>k </italic>best predictions. This approach has been applied <italic>eg</italic>. in HMMgene or in FGENES-M (unpub.). Another way to obtain suboptimal solutions from a HMM is to do HMM sampling [<xref ref-type="bibr" rid="B7">7</xref>]. This method, which consists in randomly generating parses according to the posterior probabilities, has been implemented in the gene finder SLAM. Usually, a very large amount of samples are needed to generate just a single prediction that differs from the optimal one. Genscan adopt a different approach and search for alternative exons not represented in the optimal prediction. This is done using a forward-backward algorithm to identify potential exons for which the <italic>a posteriori </italic>likelihood is larger than a given threshold.</p><p>In addition to the fact that all these exclusively <italic>intrinsic </italic>approaches cannot take into account transcript evidences, they suffer from two major problems of sensibility and specificity:</p><p>First of all, these methods assume that predictions representing AS variants should have a probability which is very close to the optimal probability according to the underlying gene model. This is however quite arguable, especially when the alternative structure significantly differs from the optimal one. Actually, when an AS variant <italic>eg</italic>. shifts from a strong to a weak or a non-consensus splice site or shows a complete coding exon skipping event, it is quite unlikely that the probability will remain in the neighborhood of the optimum since it will not be able to incorporate the corresponding splicing or coding score.</p><p>Moreover, a strong specificity problem has been observed for this approach. Since a very large number of alternative predictions can always be produced for any sequence, it is essential to be able to distinguish those reflecting real AS variants from <italic>in silico </italic>false positives. To perform this, and as long as AS sites dedicated prediction tools are unavailable, the probability of a prediction alone cannot be sufficient and additional evidence is required.</p><p>In opposition to the purely <italic>intrinsic </italic>approach, the analysis of experimental data can provide useful information. More specifically, sequences of mature transcripts resulting from AS provide reliable evidence of the existence of the AS event. Large scale studies have already been undertaken to detect AS evidences from transcript alignments and to collect them in databases such as <italic>eg</italic>. HASDB [<xref ref-type="bibr" rid="B8">8</xref>], ASDB [<xref ref-type="bibr" rid="B9">9</xref>], ASAP [<xref ref-type="bibr" rid="B10">10</xref>], ASD [<xref ref-type="bibr" rid="B11">11</xref>], EASED [<xref ref-type="bibr" rid="B12">12</xref>] or ProSplicer [<xref ref-type="bibr" rid="B13">13</xref>]. Some software tools have also been designed to perform and/or exploit transcript alignment with the aim of identifying alternative gene structures. Such <italic>extrinsic </italic>annotation tools include GeneSeqer [<xref ref-type="bibr" rid="B14">14</xref>], ASPic [<xref ref-type="bibr" rid="B15">15</xref>], TAP [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>], and PASA [<xref ref-type="bibr" rid="B18">18</xref>]. Except for GeneSeqer which is more focused on performing spliced alignment, the three other software adopt the same strategy: using genomically aligned transcripts, the aim is to determine the exon-intron structure(s) compatible with the greatest number of transcripts. Another approach, Cluster Merge [<xref ref-type="bibr" rid="B19">19</xref>], has been recently used in the Ensembl annotation system [<xref ref-type="bibr" rid="B20">20</xref>] to identify minimal sets of transcript variants compatible with genomically aligned ESTs evidences.</p><p>Unlike <italic>intrinsic </italic>methods, <italic>extrinsic </italic>approaches take advantage of transcript information. However, they also suffer from some limitations : first they entirely depend on the availability of transcribed sequences which bounds their sensitivity. With little exceptions (like TAP that exploits genomic sequence properties to identify gene boundaries, including <italic>eg</italic>. a polyA site scanning step, or GeneSeqer, that contains an <italic>intrinsic </italic>splice sites scoring method), they cannot predict a splice site if it is not represented in a transcript-to-genome alignment and therefore require a total coverage of each gene with all exon-intron boundaries. This can be problematic considering the ESTs fragmented nature. Moreover, when such methods can take advantage of a total gene coverage, the CDS localization remains to be done and the pure transcript predictions may not respect elementary coding gene properties (such as the presence of an ORF w.r.t. a given frame). Furthermore, overlapping transcripts are sometimes assumed to come from the same mature mRNA and are therefore merged. This may lead to the fusion of two overlapping transcripts coming from exclusive inconsistent mRNA variants, thus forcing the prediction to respect a chimeric virtual assembly.</p><p>Finally, and because experimental transcripts cannot exist for every existing gene, both <italic>intrinsic </italic>and <italic>extrinsic </italic>information are needed inside an annotation pipeline [<xref ref-type="bibr" rid="B20">20</xref>]. The predictions provided by two different approaches can be different and even inconsistent, and merging them together requires a careful inspection of human curators, as performed in [<xref ref-type="bibr" rid="B18">18</xref>]. A fully integrative method alleviates all these problems. GrailEXP [<xref ref-type="bibr" rid="B21">21</xref>] seems to be the only gene finder that tried to go in this direction. However, it can only consider AS events leading to complete exon inclusion/retention, ignoring thus approximatively half of the AS cases [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. The underlying approach remains unpublished.</p><p>To extend the domain of application of gene prediction to alternatively spliced gene structure prediction, we have designed an <italic>intrinsic/extrinsic </italic>integrative annotation method with the following aims:</p><p>&#x02022; For a given genomic sequence, an optimal gene structure prediction is produced, as usual.</p><p>&#x02022; In addition to this optimal prediction, for every transcript sequence providing evidence of AS, an optimal prediction consistent with this splicing form is also provided.</p><p>&#x02022; Each additional or alternative gene structure prediction has to be supported by some biological evidence.</p><p>&#x02022; Full-length transcript coverage is not required for a complete gene structure identification.</p><p>&#x02022; Each prediction satisfies the usual constraints on gene structure. A correct proteic coding gene is defined by a succession of one or more exons separated by introns flanked by splice sites. It contains a CDS between a start and a stop codon, and no in-frame stop in coding exons.</p><p>Our aim is to combine the advantages of the <italic>intrinsic </italic>and <italic>extrinsic </italic>approaches in an integrative system allowing for AS detection based on the analysis of genomic aligned transcript sequences. The method has been implemented inside EuG&#x000c8;NE-M, a new version of the <italic>Arabidopsis thaliana </italic>EuG&#x000c8;NE gene finder [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>], and applied to a reference genes set.</p></sec><sec><title>Results</title><p>To evaluate the interest of EuG&#x000c8;NE-M compared to existing transcripts-based approaches, we applied it on the <italic>spl7 Arabidopsis thaliana </italic>gene. This gene codes for the squamosa promoter-binding protein-like 7, has 10 exons and two known alternative mature mRNA variants, both supported by a distinct full-length cDNA (accession AY063815 and AF367355, Figure <xref ref-type="fig" rid="F1">1</xref>). The genomic alignments of these cDNAs provide two correct and reliable gene structures used as reference annotations. The structures differ only by the 3' extremity of the 9th exon. However, beyond these 2 complete cDNAs, only the first and the two last exons are covered by ESTs. This partial EST coverage configuration is interesting because without the full-length cDNAs (unavailable in dbEST), finding a correct gene structure with pure <italic>extrinsic </italic>assembly tools would not be possible.</p><p>Given only the genomically ESTs alignments, we applied EuG&#x000c8;NE-M on the genomic sequence containing the <italic>spl7 </italic>gene. Since two ESTs (T04465 and AI995153) show <italic>incompatible </italic>alignments (see Methods), EuG&#x000c8;NE-M computes two additional predictions, each being consistent with one of them. The first <italic>alternative prediction </italic>is the same as the optimal one and corresponds to one variant; the second corresponds to the other variant.</p><p>For a more extensive test, we applied EuG&#x000c8;NE-M on AraSet [<xref ref-type="bibr" rid="B24">24</xref>], a data set of <italic>Arabidopsis thaliana </italic>curated genes recently used in the assessment of GeneSeqer [<xref ref-type="bibr" rid="B25">25</xref>]. Since EuG&#x000c8;NE has already been evaluated on this benchmark set, performing as one of the most accurate gene finder [<xref ref-type="bibr" rid="B22">22</xref>], the aim of this test is to provide an estimation of an alternatively spliced genes ratio on a reference set. Predictions are available in the additional files. On the 168 AraSet reference genes, 9 show at least two <italic>alternative predictions</italic>, that were carefully analyzed. This is summarized in Table <xref ref-type="table" rid="T1">1</xref>. All these predictions but two correspond to potential alternative splicing events. Among the two remaining ones, a first predicted AS event corresponds to an incompatibility caused by an apparently incompletely spliced EST. The other is more interesting since it is caused by two ESTs from two different genes lying on opposite strands and overlapping on their 3' ends. In this case, EuG&#x000c8;NE-M is forced to predict two overlapping genes, one on each strand, which effectively address the usual impossibility for existing gene models to predict overlapping genes. Of course, these predictions, as all <italic>in silico </italic>expertise, require experimental verifications to be confirmed. If we assume the 7 remaining genes are effectively subject to AS, this yield to an AS rate of ~4.2%, a ratio in the same order as previously estimated, from 1.5% [<xref ref-type="bibr" rid="B26">26</xref>] to 6.5% (computed from [<xref ref-type="bibr" rid="B18">18</xref>]).</p></sec><sec><title>Discussion</title><p>In the recent assessment of GeneSeqer on this AraSet data set, only three AS cases were reported [<xref ref-type="bibr" rid="B25">25</xref>]. However, the authors only reported AS cases that were detected in GeneSeqer high-quality alignments and producing introns differing from the AraSet annotated introns. We therefore verified that our alignments were consistent with the GeneSeqer assessment alignment data available in the <italic>Arabidopsis thaliana </italic>Genome Database AtGDB [<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B28">28</xref>]. We noticed an alignment difference for only one of our alternative EST (CF652136), not present in the AtGDB because of its dbEST entry date (Oct. 2003). We also checked if the AS variants predicted by EuG&#x000c8;NE-M were already reported in the AS sections of the AtGDB [<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B29">29</xref>] and of the TIGRdb [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. Only 3 of our detected AS predictions were already reported in both databases, and 3 were missing in all of them (Table <xref ref-type="table" rid="T1">1</xref>), confirming that this methodology can help to automatically discover new potential AS cases, even on a well studied dataset.</p><p>The analysis of these AS cases confirms that AS seems to be much less frequent in <italic>A. thaliana </italic>than in <italic>Homo sapiens</italic>. Nevertheless, this AS ratio estimation is expected to increase in the future with the growth of transcript data availability. Another interesting point is the nature of the variants: on this gene set, the majority of AS cases involves a simple acceptor or donor alternative splice site. Notice however that since EuG&#x000c8;NE-M's underlying model allows arbitrary alternative gene structure to be predicted, it is not limited to the prediction of such simple AS events and can perfectly cope with complex AS events, as found in mammals. This methodology can also be integrated in other existing gene finders where the score of a gene structure is defined as the sum of elementary scores of the signals and nucleotides involved in the gene structure (this includes HMM-based gene finders).</p></sec><sec><title>Conclusions</title><p>In this paper we have presented a new method to deal with alternative splicing in annotation and gene prediction. This integrative approach combines the advantages of an <italic>intrinsic </italic>and an <italic>extrinsic </italic>process to incorporate AS detection into <italic>ab initio </italic>gene finding. We showed that this method allows the discovery of new alternative spliced genes, with the reliability of <italic>extrinsic </italic>annotation and the potential exhaustiveness of <italic>ab initio </italic>gene prediction.</p></sec><sec sec-type="methods"><title>Methods</title><p>The process that goes from the original genomic sequence and associated aligned transcripts to the AS prediction is composed of three steps which we rapidly describe here :</p><p>&#x02022; first, the set of genomically aligned transcripts is analysed to detect AS evidences on the basis of splicing inconsistency between transcripts variants.</p><p>&#x02022; Then, the graph-model used in EuG&#x000c8;NE to model potential gene structures is modified to take into account these aligned transcripts. For each transcript variant, the graph used in EuG&#x000c8;NE for gene structure prediction is connected to an additional parallel graph subunit where local constraints are injected according to the exon-intron information provided by the corresponding transcript alignment.</p><p>&#x02022; Finally, an extended version of the dynamic programming algorithm used for obtaining an optimal prediction allows to identify, for each graph subunit, the best prediction consistent with the corresponding transcript alignment.</p><sec><title>Detection of AS evidences from transcripts analysis</title><p>Since EuG&#x000c8;NE already exploits transcripts information to improve the gene prediction process [<xref ref-type="bibr" rid="B22">22</xref>], the AS prediction only requires to consider transcripts providing evidence of AS. With this purpose, we focus on inconsistencies between transcript alignments.</p><p>Transcript sequences are first aligned against the genomic sequence using a spliced alignment tool. The choice of the source transcript database and the alignment tool is not <italic>a priori </italic>imposed by the method. Transcript sequences in our analysis were extracted from the <italic>A. thaliana </italic>section of dbEST [<xref ref-type="bibr" rid="B31">31</xref>] (release Dec. 2003: 190, 708 entries), and aligned in two steps. For the first step we used sim4 [<xref ref-type="bibr" rid="B32">32</xref>], a fast software that can deal with huge EST datasets. In the second step, we used GeneSeqer [<xref ref-type="bibr" rid="B14">14</xref>], usually more accurate on splice junction identification, to realign all transcripts aligned by sim4 that passed the following filtering process.</p><p>A first filtering step is performed on the basis of the transcript sequence and alignment quality. To be considered, an alignment has to satisfy some constraints defined by filtering parameters. For <italic>Arabidopsis thaliana</italic>, default parameters values are set as following: transcript length between 30 and 10000 bp, minimum alignment length = 95% of the transcript length, minimum identity score of 97%, maximum gap length of 5000 bp, maximum match length of 4000 bp. By default, and to avoid genomic contamination, unspliced transcripts are removed from the analysis. Moreover, because of the frequent weak alignment quality at the terminal regions, alignments extremities are shortened (by 15 bp by default).</p><p>The second filtering step depends on the relation between transcript alignments. To detect AS evidences, every pair of overlapping transcript alignments is analyzed. We consider two special types of pairwise relation : a transcript alignment <italic>A </italic>is labeled as <italic>included </italic>in <italic>B </italic>if and only if for each genomic position of <italic>A </italic>the same genomic position in <italic>B </italic>shares the same alignment information (either gap or match). Every transcript <italic>included </italic>in another transcript is ignored by default. Transcript alignments <italic>A </italic>and <italic>B </italic>are labeled as <italic>incompatible </italic>if and only if there is a genomic position for which both ESTs are informative and give an inconsistent information, that is a gap (representative of the presence of an intron) is faced with a match (representative of the presence of an exon, coding or not). Examples of <italic>incompatible </italic>ESTs are displayed in Figure <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F5">5</xref>. Since we focus on AS evidences, we only keep transcripts labeled as <italic>incompatible </italic>after all pairwise comparisons. Considering orientation of ESTs, the information on the clone-sequencing orientation that can be found with ESTs is totally ignored in this filtering process because of its unreliability. In practice, spliced EST can be reliably oriented by looking for splice sites on the hit-match frontier of the EST alignments and by choosing the strand for which such splice sites exist. The parameters of these two automatic filtering steps can be modified by the user through a simple text file. We will denote the resulting transcript alignments kept as <italic>alternative transcripts</italic>.</p></sec><sec><title>The gene-finder EuG&#x000e8;ne</title><sec><title>General description</title><p>EuG&#x000c8;NE is a gene finding software based on a directed acyclic graph gene model [<xref ref-type="bibr" rid="B22">22</xref>]. For each nucleotide of the genomic sequence, every possible annotation of this nucleotide is represented in the graph. The graph is designed to model the whole prediction space: all consistent gene structures can be represented by a path through the graph, whose weight is defined as the sum of its edges weights. The minimum weight path defines the optimal prediction. Several sources of evidence are used to weight the edges of the graph and a shortest-path dynamic programming algorithm (linear in time and space) scans the graph to provide an optimal path which represents the best gene prediction according to available evidences.</p></sec><sec><title>Structure of the initial graph</title><p>Each path through the graph represents a potential gene structure prediction for the genomic sequence (Figure <xref ref-type="fig" rid="F2">2</xref>). The graph is composed of <italic>k </italic>tracks that represent the possible annotations that can be attributed to each nucleotide (coding, intronic, intergenic and UTR, with specific strand and frame). Let &#x02113; be the genomic sequence length. For a given nucleotide's position <italic>i </italic>with (1 &#x0003c;<italic>i </italic>&#x0003c; &#x02113;) and for each track <italic>j </italic>with (1 &#x0003c;<italic>j </italic>&#x0003c;<italic>k</italic>) the two flanking vertices <inline-graphic xlink:href="1471-2105-6-25-i1.gif"/> and <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> are defined. Two edges are also built : a <italic>contents </italic>edge <inline-graphic xlink:href="1471-2105-6-25-i3.gif"/> linking <inline-graphic xlink:href="1471-2105-6-25-i1.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> and a <italic>transition </italic>edge <inline-graphic xlink:href="1471-2105-6-25-i4.gif"/> linking <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i5.gif"/> (Figure <xref ref-type="fig" rid="F3">3</xref>). Additional transition edges <inline-graphic xlink:href="1471-2105-6-25-i6.gif"/> are put from <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> to all <inline-graphic xlink:href="1471-2105-6-25-i7.gif"/> according to the occurrence of a potential biological signal allowing a switch from state <italic>j </italic>for the nucleotide at the position <italic>i </italic>to the state <italic>j</italic>' for the following nucleotide. For example, on the position <italic>i </italic>before the occurrence of an ATG, a transition edge <inline-graphic xlink:href="1471-2105-6-25-i6.gif"/> linking <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i7.gif"/> (where <italic>j </italic>corresponds to the UTR5' track and <italic>j</italic>' is the coding exon track on the appropriate frame) is present, as illustrated in Figure <xref ref-type="fig" rid="F3">3</xref>. Two special vertices <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> and <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/> are added at the extremities of the graph. They are respectively connected to all <inline-graphic xlink:href="1471-2105-6-25-i10.gif"/> and all <inline-graphic xlink:href="1471-2105-6-25-i11.gif"/>. Initially, all edges are oriented from left (5') to right (3'). It is easy to see that all possible gene structure can be represented by a path from <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/>.</p></sec><sec><title>Weighting the graph</title><p>The weight of a path is the sum of all the weights of the edges in the path. The edges are weighted according to the evidences used. EuG&#x000c8;NE can combine several sources of evidence such as probabilistic coding models, output of splice site or start codon prediction software and sequence similarities with transcripts, proteins, or other genomic sequences [<xref ref-type="bibr" rid="B33">33</xref>]. Contents and transition edges <italic>c </italic>and <italic>t </italic>are penalized respectively by weights <italic>Wc </italic>and <italic>Wt </italic>according to a weighting function characterized by parameters specifically set for the corresponding source of evidence. The set of parameters is optimized on a learning dataset by maximizing the overall accuracy of the software. For more information about the weighting methods, please refer to [<xref ref-type="bibr" rid="B22">22</xref>].</p></sec><sec><title>Example of transcript alignment integration</title><p>A transcript-to-genome alignment can easily be taken into account by weighting the appropriate edges of the graph. To favor a gene prediction in the alignment region, the intergenic track edges included in this region can be penalized by increasing their weight. More finely, the exon and the intron tracks edges can also be penalized at all positions involved respectively in a gap and in a match in the alignment. Thus, all gene structure prediction inconsistent with the transcript alignment information tends to be penalized. More drastically, it is possible to force the prediction to be consistent with the alignment by applying infinite penalty weights. Note that there are several such predictions since the start codon used is unknown and the transcript may be incomplete.</p></sec><sec><title>Initial algorithm</title><p>To identify the optimal path defined by the lowest weight, EuG&#x000c8;NE uses a dynamic programming algorithm inspired from Bellman's shortest-path algorithm [<xref ref-type="bibr" rid="B34">34</xref>], also used for HMM in its Viterbi's version. Improvements of this algorithm allow EuG&#x000c8;NE to take into account constraints on gene element lengths. For simplicity, we will not describe these sophistications in this paper. The algorithm of EuG&#x000c8;NE associates to each vertex <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> a variable <inline-graphic xlink:href="1471-2105-6-25-i18.gif"/> which contains the weight of the optimal path from <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> and a variable <inline-graphic xlink:href="1471-2105-6-25-i19.gif"/> which contains the vertex that precedes <inline-graphic xlink:href="1471-2105-6-25-i1.gif"/> in this optimal path. The weight of this path can be computed recursively from 5' to 3' as:</p><p><inline-graphic xlink:href="1471-2105-6-25-i20.gif"/></p><p>A short example is displayed in Figure <xref ref-type="fig" rid="F3">3</xref>. The vertex <inline-graphic xlink:href="1471-2105-6-25-i21.gif"/> that minimizes this value provides the previous <inline-graphic xlink:href="1471-2105-6-25-i19.gif"/>. At vertex <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/>, the best path is retrieved by a simple backtracing procedure through all <italic>&#x003c0;</italic>. This algorithm is linear in time and space in the length of the sequence (<italic>O</italic>(&#x02113;) complexity). It is important to note that the same algorithm can be used in a backward version (from <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/>), by computing at each vertex <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> the weight <inline-graphic xlink:href="1471-2105-6-25-i22.gif"/> of the best path from <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> as <inline-graphic xlink:href="1471-2105-6-25-i23.gif"/>.</p></sec></sec><sec><title>AS evidences integration</title><p>Given an <italic>alternative transcript </italic>genomic alignment, any prediction which is optimal among all the predictions that are consistent with the alignment evidence will be called an <italic>alternative prediction</italic>. Given the set of the previously detected <italic>alternative transcripts</italic>, we want EuG&#x000c8;NE-M to produce a set of <italic>alternative predictions </italic>such that every <italic>alternative transcript </italic>has a corresponding prediction in this set. A simple way to produce such an alternative prediction would be to inject the exon-intron structure information given by the transcript alignment into the graph as described above (using infinite weights to force the prediction to strictly respect the alignment evidence), and then to execute EuG&#x000c8;NE on the resulting graph. However, obtaining all <italic>alternative predictions </italic>would require one execution for each <italic>alternative transcript</italic>. <italic>n </italic>being the number of transcripts and <italic>l </italic>the genomic sequence length, this would result in a <italic>O</italic>(<italic>ln</italic>) time complexity, which is not appropriate for long genomic sequences and numerous transcripts.</p><p>Hopefully, this complexity can be drastically reduced. The general idea to achieve a realistic complexity is to duplicate the subsection of the graph region involved in an alignment to create a so called local "Parallel Graph Subunit" (PGS), connected to the main graph at its extremities. Each alignment information is taken into account as constraints in the corresponding PGS, in such a way that finding the optimal path going through the PGS provides a corresponding optimal alternative prediction.</p><sec><title>Extending the graph model with PGS</title><p>For a transcript alignment that extends from position <italic>g </italic>to <italic>h </italic>on the genomic sequence, the entire subsection of the graph between <italic>g </italic>and <italic>h </italic>is duplicated to create a Parallel Graph Subunit (PGS) (Figure <xref ref-type="fig" rid="F4">4</xref>). This PGS is connected to the main graph at its extremities by special so-called <italic>deviation </italic>edges. For each track <italic>j</italic>, a deviation edge links the source vertex <inline-graphic xlink:href="1471-2105-6-25-i24.gif"/> in the main graph to its copy at the PGS left extremity, and another connects the source vertex <inline-graphic xlink:href="1471-2105-6-25-i25.gif"/> in the main graph to its copy at the PGS right extremity. The deviation edges are all oriented from the main graph to the PGS. The weights of the PGS edges, initially identical to the weight of the original edges, are modified according to the corresponding transcript alignment : gaps and matches forbid respectively the exonic and the intronic tracks, and the entire PGS intergenic track is forbidden.</p></sec><sec><title>Finding<italic>alternative predictions</italic></title><p>The modified algorithm proceeds in two steps. A first scan starts from <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/> and applies the recursive formula described above to compute all <inline-graphic xlink:href="1471-2105-6-25-i18.gif"/>, branching into each PGS (Figure <xref ref-type="fig" rid="F5">5</xref>). Thus, at each nucleotide's position and for each track (including those in the PGS), the weight of the optimal path from the left extremity <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> is identified. At <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/>, the optimal path is obtained by backtracing. Furthermore, for any given PGS, the cost of an optimal path going from <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/>, through the PGS and then to each of the righmost vertices <inline-graphic xlink:href="1471-2105-6-25-i25.gif"/> is known.</p><p>Then all edges (except the deviation) are reversed, and the backward version of the same shortest-path algorithm is used from <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> to compute all <inline-graphic xlink:href="1471-2105-6-25-i22.gif"/>. This step ignores the PGS.</p><p>For a given PGS <italic>A</italic>, if we now consider the vertices <inline-graphic xlink:href="1471-2105-6-25-i25.gif"/> at the rightmost extremity of <italic>A</italic>, then the weight of an optimal path that goes from <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> to <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/> through <italic>A </italic>can be computed as <inline-graphic xlink:href="1471-2105-6-25-i26.gif"/>. From the given vertex, backtracing in both directions provides an optimal path that represents an optimal prediction in accordance with the transcript alignment evidence.</p></sec><sec><title>Output</title><p>Predictions are produced in the standard GFF format. The entire optimal annotation is first displayed, followed by the alternative ones. To enhance the readability and to avoid redundancy, for each <italic>alternative prediction </italic>the name of the corresponding transcript is mentioned and the region that differs from the optimal prediction is displayed. Besides, if several predictions are identical (regarding their predicted CDS only, UTR length differences being ignored), a single representative is displayed, along with the list of its associated transcripts.</p></sec></sec><sec><title>Computation time</title><p>The initial filtering and <italic>incompatible </italic>transcripts identification requires <italic>O</italic>(<italic>n</italic><sup>2</sup>) pairwise comparisons. Each comparison is itself linear in the maximum number of introns in the transcript compared, which is typically bounded by a small constant and the whole process is therefore in <italic>O</italic>(<italic>n</italic><sup>2</sup>).</p><p>The step that corresponds to the two dynamic programming scans (application of the recursive formula) requires a time and space complexity which is linear in the size of the input data. Indeed, if <italic>L </italic>is the total nucleic sequences length (genomic + kept <italic>alternative transcript</italic>), the weights of all (alternative and optimal) predictions can be computed in <italic>O</italic>(<italic>L</italic>).</p><p>For the backtracing and output step, since each alternative prediction has to be displayed in the region where it differs from the optimal one, and because this can extend beyond the alignment region, it is not possible to obtain an algorithm which is linear in the size of the input. However, it is possible to reach a linear complexity in the size of the output. This can be done by a simple modification of the standard backtracing procedure to avoid a full backtrace for each prediction. This is yet not implemented in the current version of the software.</p><p>A typical run of EuG&#x000c8;NE-M on an AMD Athlon 1.7 GHz takes 47 sec. for a 500 kb BAC (for which 945 transcript alignments were kept after the first quality filtering step).</p></sec></sec><sec><title>Authors' contributions</title><p>SF designed and implemented the filtering algorithm as well as the double dynamic programming algorithm for AS prediction. He also ran the experiments on the Araset dataset. TS directed the research. All authors read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional File 1</title><p><bold>EuG&#x000e8;ne's predictions on AraSet</bold>. The additional file (SupplementaryFiles.tar.gz) contains gene structure predictions in the standard GFF text format for every AraSet sequence. ESTs detected as <italic>Incompatible </italic>by the method are displayed at the top of each prediction (if any).</p></caption><media xlink:href="1471-2105-6-25-S1.gz" mimetype="application" mime-subtype="x-zip-compressed"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Modrek</surname><given-names>B</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name></person-group><article-title>A genomic view of alternative splicing</article-title><source>Nat Genet</source><year>2002</year><volume>30</volume><fpage>13</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">11753382</pub-id><pub-id pub-id-type="doi">10.1038/ng0102-13</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><collab>International Human Genome Sequencing Consortium</collab></person-group><article-title>Initial sequencing and analysis of the human genome</article-title><source>Nature</source><year>2001</year><volume>409</volume><fpage>860</fpage><lpage>921</lpage><pub-id pub-id-type="pmid">11237011</pub-id><pub-id pub-id-type="doi">10.1038/35057062</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>J</given-names></name><name><surname>Castle</surname><given-names>J</given-names></name><name><surname>Garrett-Engele</surname><given-names>P</given-names></name><name><surname>Kan</surname><given-names>Z</given-names></name><name><surname>Loerch</surname><given-names>P</given-names></name><name><surname>Armour</surname><given-names>C</given-names></name><name><surname>Santos</surname><given-names>R</given-names></name><name><surname>Schadt</surname><given-names>E</given-names></name><name><surname>Stoughton</surname><given-names>R</given-names></name><name><surname>Shoemaker</surname><given-names>D</given-names></name></person-group><article-title>Genome-wide survey of human alternative pre-mRNA splicing with exon junction microarrays</article-title><source>Science</source><year>2003</year><volume>302</volume><fpage>2141</fpage><lpage>4</lpage><pub-id pub-id-type="pmid">14684825</pub-id><pub-id pub-id-type="doi">10.1126/science.1090100</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Burge</surname><given-names>C</given-names></name><name><surname>Karlin</surname><given-names>S</given-names></name></person-group><article-title>Prediction of complete gene structures in human genomic DNA</article-title><source>J Mol Biol</source><year>1997</year><volume>268</volume><fpage>78</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">9149143</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1997.0951</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Krogh</surname><given-names>A</given-names></name></person-group><article-title>Using database matches with for HMMGene for automated gene detection in Drosophila</article-title><source>Genome Res</source><year>2000</year><volume>10</volume><fpage>391</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">10779478</pub-id><pub-id pub-id-type="doi">10.1101/gr.10.4.523</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Alexandersson</surname><given-names>M</given-names></name><name><surname>Cawley</surname><given-names>S</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>SLAM: cross-species gene finding and alignment with a generalized pair hidden Markov model</article-title><source>Genome Res</source><year>2003</year><volume>13</volume><fpage>496</fpage><lpage>502</lpage><pub-id pub-id-type="pmid">12618381</pub-id><pub-id pub-id-type="doi">10.1101/gr.424203</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cawley</surname><given-names>SL</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>HMM sampling and applications to gene finding and alternative splicing</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>II36</fpage><lpage>II41</lpage><pub-id pub-id-type="pmid">14534169</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Modrek</surname><given-names>B</given-names></name><name><surname>Resch</surname><given-names>A</given-names></name><name><surname>Grasso</surname><given-names>C</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name></person-group><article-title>Genome-wide detection of alternative splicing in expressed sequences of human genes</article-title><source>Nucleic Acids Res</source><year>2001</year><volume>29</volume><fpage>2850</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">11433032</pub-id><pub-id pub-id-type="doi">10.1093/nar/29.13.2850</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gelfand</surname><given-names>MS</given-names></name><name><surname>Dubchak</surname><given-names>I</given-names></name><name><surname>Dralyuk</surname><given-names>I</given-names></name><name><surname>Zorn</surname><given-names>M</given-names></name></person-group><article-title>ASDB: database of alternatively spliced genes</article-title><source>Nucleic Acids Res</source><year>1999</year><volume>27</volume><fpage>301</fpage><lpage>2</lpage><pub-id pub-id-type="pmid">9847209</pub-id><pub-id pub-id-type="doi">10.1093/nar/27.1.301</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Atanelov</surname><given-names>L</given-names></name><name><surname>Modrek</surname><given-names>B</given-names></name><name><surname>Xing</surname><given-names>Y</given-names></name></person-group><article-title>ASAP: the Alternative Splicing Annotation Project</article-title><source>Nucleic Acids Res</source><year>2003</year><volume>31</volume><fpage>101</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">12519958</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg029</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thanaraj</surname><given-names>TA</given-names></name><name><surname>Stamm</surname><given-names>S</given-names></name><name><surname>Clark</surname><given-names>F</given-names></name><name><surname>Riethoven</surname><given-names>JJ</given-names></name><name><surname>Le Texier</surname><given-names>V</given-names></name><name><surname>Muilu</surname><given-names>J</given-names></name></person-group><article-title>ASD: the Alternative Splicing Database</article-title><source>Nucleic Acids Res</source><year>2004</year><volume>32</volume><fpage>D64</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">14681360</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkh030</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pospisil</surname><given-names>H</given-names></name><name><surname>Herrmann</surname><given-names>A</given-names></name><name><surname>Bortfeldt</surname><given-names>RH</given-names></name><name><surname>Reich</surname><given-names>JG</given-names></name></person-group><article-title>EASED: Extended Alternatively Spliced EST Database</article-title><source>Nucleic Acids Res</source><year>2004</year><volume>32</volume><fpage>D70</fpage><lpage>4</lpage><pub-id pub-id-type="pmid">14681361</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkh136</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>HD</given-names></name><name><surname>Horng</surname><given-names>JT</given-names></name><name><surname>Lee</surname><given-names>CC</given-names></name><name><surname>Liu</surname><given-names>BJ</given-names></name></person-group><article-title>ProSplicer: a database of putative alternative splicing information derived from protein, mRNA and expressed sequence tag sequence data</article-title><source>Genome Biol</source><year>2003</year><volume>4</volume><fpage>R29</fpage><pub-id pub-id-type="pmid">12702210</pub-id><pub-id pub-id-type="doi">10.1186/gb-2003-4-4-r29</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Usuka</surname><given-names>J</given-names></name><name><surname>Zhu</surname><given-names>W</given-names></name><name><surname>Brendel</surname><given-names>V</given-names></name></person-group><article-title>Optimal spliced alignment of homologous cDNA to a genomic DNA template</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>203</fpage><lpage>211</lpage><pub-id pub-id-type="pmid">10869013</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/16.3.203</pub-id></citation></ref><ref id="B15"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Bonizzoni</surname><given-names>P</given-names></name><name><surname>Pesole</surname><given-names>G</given-names></name><name><surname>Rizzi</surname><given-names>R</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Benson G, Page R</surname></name></person-group><article-title>A Method to Detect Gene Structure and Alternative Splice Sites by Agreeing ESTs to a Genomic Sequence</article-title><source>Algorithms in Bioinformatics, 3rd International Workshop (WABI), LNCS</source><year>2003</year><publisher-name>Springer Verlag</publisher-name><fpage>63</fpage><lpage>77</lpage></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kan</surname><given-names>Z</given-names></name><name><surname>Rouchka</surname><given-names>E</given-names></name><name><surname>Gish</surname><given-names>W</given-names></name><name><surname>States</surname><given-names>D</given-names></name></person-group><article-title>Gene structure prediction and alternative splicing analysis using genomically aligned ESTs</article-title><source>Genome Res</source><year>2001</year><volume>11</volume><fpage>889</fpage><lpage>900</lpage><pub-id pub-id-type="pmid">11337482</pub-id><pub-id pub-id-type="doi">10.1101/gr.155001</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kan</surname><given-names>Z</given-names></name><name><surname>States</surname><given-names>D</given-names></name><name><surname>Gish</surname><given-names>W</given-names></name></person-group><article-title>Selecting for functional alternative splices in ESTs</article-title><source>Genome Res</source><year>2002</year><volume>12</volume><fpage>1837</fpage><lpage>45</lpage><pub-id pub-id-type="pmid">12466287</pub-id><pub-id pub-id-type="doi">10.1101/gr.764102</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname><given-names>B</given-names></name><name><surname>Delcher</surname><given-names>A</given-names></name><name><surname>Mount</surname><given-names>S</given-names></name><name><surname>Wortman</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>RJ</given-names></name><name><surname>Hannick</surname><given-names>L</given-names></name><name><surname>Maiti</surname><given-names>R</given-names></name><name><surname>Ronning</surname><given-names>C</given-names></name><name><surname>Rusch</surname><given-names>D</given-names></name><name><surname>Town</surname><given-names>C</given-names></name><name><surname>Salzberg</surname><given-names>S</given-names></name><name><surname>White</surname><given-names>O</given-names></name></person-group><article-title>Improving the Arabidopsis genome annotation using maximal transcript alignment assemblies</article-title><source>Nucleic Acids Res</source><year>2003</year><volume>31</volume><fpage>5654</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">14500829</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg770</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eyras</surname><given-names>E</given-names></name><name><surname>Caccamo</surname><given-names>M</given-names></name><name><surname>Curwen</surname><given-names>V</given-names></name><name><surname>Clamp</surname><given-names>M</given-names></name></person-group><article-title>ESTGenes: alternative splicing from ESTs in Ensembl</article-title><source>Genome Res</source><year>2004</year><volume>14</volume><fpage>976</fpage><lpage>87</lpage><pub-id pub-id-type="pmid">15123595</pub-id><pub-id pub-id-type="doi">10.1101/gr.1862204</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Curwen</surname><given-names>V</given-names></name><name><surname>Eyras</surname><given-names>E</given-names></name><name><surname>Andrews</surname><given-names>TD</given-names></name><name><surname>Clarke</surname><given-names>L</given-names></name><name><surname>Mongin</surname><given-names>E</given-names></name><name><surname>Searle</surname><given-names>SMJ</given-names></name><name><surname>Clamp</surname><given-names>M</given-names></name></person-group><article-title>The Ensembl automatic gene annotation system</article-title><source>Genome Res</source><year>2004</year><volume>14</volume><fpage>942</fpage><lpage>50</lpage><pub-id pub-id-type="pmid">15123590</pub-id><pub-id pub-id-type="doi">10.1101/gr.1858004</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Uberbacher</surname><given-names>E</given-names></name></person-group><article-title>Automated gene identification in large-scale genomic sequences</article-title><source>J Comput Biol</source><year>1997</year><volume>4</volume><fpage>325</fpage><lpage>38</lpage><pub-id pub-id-type="pmid">9278063</pub-id></citation></ref><ref id="B22"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Schiex</surname><given-names>T</given-names></name><name><surname>Moisan</surname><given-names>A</given-names></name><name><surname>Rouz&#x000e9;</surname><given-names>P</given-names></name></person-group><article-title>EuG&#x000e8;ne, an eukaryotic gene finder that combines several type of evidence</article-title><source>Computational Biology, selected papers from JOBIM' 2000, no 2066 in LNCS</source><year>2001</year><publisher-name>Springer Verlag</publisher-name><fpage>118</fpage><lpage>133</lpage></citation></ref><ref id="B23"><citation citation-type="other"><article-title>EuG&#x000e8;ne web site</article-title><ext-link ext-link-type="uri" xlink:href="http://www.inra.fr/bia/T/EuGene"/></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pavy</surname><given-names>N</given-names></name><name><surname>Rombauts</surname><given-names>S</given-names></name><name><surname>D&#x000e9;hais</surname><given-names>P</given-names></name><name><surname>Math&#x000e9;</surname><given-names>C</given-names></name><name><surname>Ramana</surname><given-names>D</given-names></name><name><surname>Leroy</surname><given-names>P</given-names></name><name><surname>Rouz&#x000e9;</surname><given-names>P</given-names></name></person-group><article-title>Evaluation of gene prediction software using a genomic data set: application to <italic>Arabidopsis thaliana </italic>sequences</article-title><source>Bioinformatics</source><year>1999</year><volume>15</volume><fpage>887</fpage><lpage>99</lpage><pub-id pub-id-type="pmid">10743555</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/15.11.887</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brendel</surname><given-names>V</given-names></name><name><surname>Xing</surname><given-names>L</given-names></name><name><surname>Zhu</surname><given-names>W</given-names></name></person-group><article-title>Gene structure prediction from consensus spliced alignment of multiple ESTs matching the same genomic locus</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1157</fpage><lpage>69</lpage><pub-id pub-id-type="pmid">14764557</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth058</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>W</given-names></name><name><surname>Schlueter</surname><given-names>S</given-names></name><name><surname>Brendel</surname><given-names>V</given-names></name></person-group><article-title>Refined annotation of the Arabidopsis genome by complete expressed sequence tag mapping</article-title><source>Plant Physiol</source><year>2003</year><volume>132</volume><fpage>469</fpage><lpage>84</lpage><pub-id pub-id-type="pmid">12805580</pub-id><pub-id pub-id-type="doi">10.1104/pp.102.018101</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>Q</given-names></name><name><surname>Schlueter</surname><given-names>SD</given-names></name><name><surname>Brendel</surname><given-names>V</given-names></name></person-group><article-title>PlantGDB, plant genome database and analysis tools</article-title><source>Nucleic Acids Res</source><year>2004</year><volume>32</volume><fpage>D354</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">14681433</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkh046</pub-id></citation></ref><ref id="B28"><citation citation-type="other"><article-title>GeneSeqer evaluation on AtGDB</article-title><ext-link ext-link-type="uri" xlink:href="http://www.plantgdb.org/AtGDB/prj/BXZ03B/AraSet/AraSet-AtGDB.php"/></citation></ref><ref id="B29"><citation citation-type="other"><article-title>Alternative splicing on AtGDB</article-title><ext-link ext-link-type="uri" xlink:href="http://www.plantgdb.org/AtGDB/prj/ZSB03PP/alternativeSplicing"/></citation></ref><ref id="B30"><citation citation-type="other"><article-title>Arabidopsis splicing variations on TIGR db</article-title><ext-link ext-link-type="uri" xlink:href="http://www.tigr.org/tdb/e2k1/ath1/altsplicing/splicing_variations.shtml"/></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boguski</surname><given-names>MS</given-names></name><name><surname>Lowe</surname><given-names>TM</given-names></name><name><surname>Tolstoshev</surname><given-names>CM</given-names></name></person-group><article-title>dbEST-database for expressed sequence tags</article-title><source>Nat Genet</source><year>1993</year><volume>4</volume><fpage>332</fpage><lpage>3</lpage><pub-id pub-id-type="pmid">8401577</pub-id><pub-id pub-id-type="doi">10.1038/ng0893-332</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Florea</surname><given-names>L</given-names></name><name><surname>Hartzell</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Rubin</surname><given-names>G</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name></person-group><article-title>A computer program for aligning a cDNA sequence with a genomic DNA sequence</article-title><source>Genome Res</source><year>1998</year><volume>8</volume><fpage>967</fpage><lpage>974</lpage><pub-id pub-id-type="pmid">9750195</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Foissac</surname><given-names>S</given-names></name><name><surname>Bardou</surname><given-names>P</given-names></name><name><surname>Moisan</surname><given-names>A</given-names></name><name><surname>Cros</surname><given-names>MJ</given-names></name><name><surname>Schiex</surname><given-names>T</given-names></name></person-group><article-title>EUGENE'HOM: A generic similarity-based gene finder using multiple homologous sequences</article-title><source>Nucleic Acids Res</source><year>2003</year><volume>31</volume><fpage>3742</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">12824408</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg586</pub-id></citation></ref><ref id="B34"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Bellman</surname><given-names>R</given-names></name></person-group><source>Dynamic Programming</source><year>1957</year><publisher-name>Princeton, New Jersey: Princeton Univ Press</publisher-name></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>EST/cDNA alignments on the spl7 gene region</bold>. Thick lines represent matches an dotted lines, gaps. Above the genomic sequence, the 2 full-length cDNAs that provide the two correct reference gene structures are presented. Arrows indicate the start and stop codons. The ESTs T04465 and AI995153 present inconsistent splicing profiles and are labeled as <italic>incompatible</italic>.</p></caption><graphic xlink:href="1471-2105-6-25-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>EuG&#x000e8;ne's directed acyclic graph for a short example sequence</bold>. For simplicity purposes, only the forward strand is considered. The DNA sequence is shown above the graph. Horizontal tracks represent the different possible annotations: intergenic (bottom), UTR 5' and 3', exon in the 3 frames, intron in 3 phases (the phase of an intron is defined according to the splicing position in the last codon of the previous exon). On each track, 2 vertices are used to represent each nucleotide. These 2 vertices are linked horizontally by a contents and a transition edge (see the text and Figure 4 for details). Dotted arrows show occurrences of biological signals (like start/stop codons and donor/acceptor splice sites). They produce additional transition edges at the corresponding position. Since this version of EuG&#x000c8;NE does not include any promoter or polyA site prediction tool, transitions from intergenic to UTR and vice-versa are allowed at every nucleotide position. All consistent gene structures can be represented by a path connecting the initial and terminal vertices <inline-graphic xlink:href="1471-2105-6-25-i8.gif"/> and <inline-graphic xlink:href="1471-2105-6-25-i9.gif"/>.</p></caption><graphic xlink:href="1471-2105-6-25-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Detail of EuG&#x000e8;ne's directed acyclic graph and algorithm</bold>. The zoomed region contains the two first nucleotides of the example sequence of Figure 3 (C at position <italic>i </italic>- 1, and A at position <italic>i</italic>), and two annotation tracks (UTR5' for <italic>j </italic>and exon in frame 2 for <italic>j </italic>+ 1). The contents edges <italic>c </italic>connect the <italic>l </italic>vertices to the following <italic>r </italic>vertices of the same track. Transition edges <italic>t </italic>are either horizontal and link the <italic>r </italic>vertices to the <italic>l </italic>vertices of the same track, or transversal and link the <italic>r </italic>vertices to all possible <italic>l </italic>vertices according to the occurrence of a biological signal in the sequence. In this example, between <inline-graphic xlink:href="1471-2105-6-25-i12.gif"/> and <inline-graphic xlink:href="1471-2105-6-25-i13.gif"/> a vertex <inline-graphic xlink:href="1471-2105-6-25-i14.gif"/> allows the transition from the UTR5' track at position <italic>i </italic>- 1 to the exonic track at <italic>i </italic>because the A nucleotide at position <italic>i </italic>is the first nucleotide of a potential start codon ATG. The dynamic programming algorithm used in EuG&#x000c8;NE determines, for each vertex <italic>r</italic>, which vertex precedes <italic>r </italic>in the optimal path. In this example, at position <italic>i </italic>for the track <italic>j </italic>the best path leading to <inline-graphic xlink:href="1471-2105-6-25-i2.gif"/> from the left has a weight <inline-graphic xlink:href="1471-2105-6-25-i15.gif"/> (only one origin is possible). For the track <italic>j </italic>+ 1, the best path leading to <inline-graphic xlink:href="1471-2105-6-25-i16.gif"/> will be attributed a weight of either <inline-graphic xlink:href="1471-2105-6-25-i17.gif"/>, whatever the lower.</p></caption><graphic xlink:href="1471-2105-6-25-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Extension of EuG&#x000e8;ne's graph by a PCS to incorporate a single alternative transcript alignment</bold>. From the main graph (bottom) described in Figure 3, a Parallel Graph Subunit (PGS) is built (above) by duplicating the whole graph section involved in the EST alignment (between the graphs). Gene structure evidences provided by the alignment are taken into account in the PGS by forbidding the intergenic track all along the alignment, intronic tracks at match positions (light grey), and exonic tracks in gap positions (dark grey). Dotted arrows represent the two algorithm scans, the forward version from left to right, and the backward version from right to left. At the junction point in the PGS, an optimal prediction is obtained. Figure not to scale.</p></caption><graphic xlink:href="1471-2105-6-25-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Integration of several incompatible ESTs in EuG&#x000e8;ne-M's graph and algorithm</bold>. A: EST alignments (plain lines represent exons, dotted lines, intron) on a genomic sequence (thick line). Each displayed EST is <italic>incompatible </italic>with at least another one. B: Multiple extensions of EuG&#x000c8;NE's graph model after having processed these alignments. Each PGS (Figure 3) contains the information provided by its source EST. The dotted arrows show the algorithm progression through the resulting graph during the first scan, from the left to the right.</p></caption><graphic xlink:href="1471-2105-6-25-5"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Analysis of the AS cases detected by EuG&#x000e8;ne-M in the AraSet genes data set. First, sequence IDs, genes and EST involved are reported. The TIGR and AtGDB columns indicate if each AS case is reported in these databases. The AS status is described as follows: ACC = alternative acceptor splice site, DON = alternative donor splice site, -EX = exon skipping (an entire exon lacks in the reported variant), +IN = intron inclusion (an internal part of an exon is spliced), FP = false positive AS. nt = nucleotide. Some ESTs of the At2g39780 gene in seq16 are not correctly aligned: the use of either GeneSeqer or sim4 with default options leads to a missed 4 nt exon (not involved in AS). In seq50, the 168 nt additional (+IN) intron from the EST CF652136 is flanked by GC-CT (instead of the canonical GT-AG). In seq62, the EST AV542276 from the gene At4g37040 overlaps with an intron of EST AV562725 from the neighboring gene At4g37050. In seq65, the EST BE521212 is not spliced between the exon 5 and 6 of the gene At2g44100 (intron retention case), and is thus suspected of incomplete maturation. Except for CF652136, all alignments can be browsed on the AtGDB site.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">AraSet sequence</td><td align="center">Gene ID</td><td align="center">EST evidence</td><td align="center">TIGR</td><td align="center">AtGDB</td><td align="center">AS status</td><td align="left">Note</td></tr></thead><tbody><tr><td align="center">seq14</td><td align="center">At2g47640</td><td align="center">AI998209</td><td align="center">Y</td><td align="center">N</td><td align="center">ACC</td><td align="left">skip 3 nt</td></tr><tr><td align="center">seq16</td><td align="center">At2g39780</td><td align="center">AV832175</td><td align="center">N</td><td align="center">N</td><td align="center">-EX</td><td align="left">incorrect alignments</td></tr><tr><td align="center">seq50</td><td align="center">At5g46290</td><td align="center">CF652136</td><td align="center">N</td><td align="center">N</td><td align="center">+IN</td><td align="left">non consensus splice sites</td></tr><tr><td align="center">seq53</td><td align="center">At3g51800</td><td align="center">AV544387</td><td align="center">Y</td><td align="center">Y</td><td align="center">ACC</td><td align="left">add 27 nt</td></tr><tr><td align="center">seq62</td><td align="center">At4g37070</td><td align="center">AU236122</td><td align="center">Y</td><td align="center">Y</td><td align="center">DON</td><td align="left">add 33 nt</td></tr><tr><td align="center">seq62</td><td align="center">At4g37050</td><td align="center">AV542276</td><td align="center">N</td><td align="center">N</td><td align="center">FP</td><td align="left">overlapping genes</td></tr><tr><td align="center">seq65</td><td align="center">At2g44100</td><td align="center">BE521212</td><td align="center">N</td><td align="center">N</td><td align="center">FP</td><td align="left">incomplete splicing</td></tr><tr><td align="center">seq65</td><td align="center">At2g44120</td><td align="center">BE524396</td><td align="center">Y</td><td align="center">N</td><td align="center">ACC</td><td align="left">skip 33 nt</td></tr><tr><td align="center">seq69</td><td align="center">At4gl4350</td><td align="center">AV547538</td><td align="center">Y</td><td align="center">Y</td><td align="center">+IN</td><td align="left">skip 105 nt</td></tr></tbody></table></table-wrap></sec></back></article>



