<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Biomagn Res Technol</journal-id><journal-title>Biomagnetic Research and Technology</journal-title><issn pub-type="epub">1477-044X</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15341659</article-id><article-id pub-id-type="pmc">PMC519033</article-id><article-id pub-id-type="publisher-id">1477-044X-2-6</article-id><article-id pub-id-type="doi">10.1186/1477-044X-2-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Simultaneous suppression of disturbing fields and localization of magnetic markers by means of multipole expansion</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Hilgenfeld</surname><given-names>Bernd</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>bhi@biomag.uni-jena.de</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Haueisen</surname><given-names>Jens</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>haueisen@biomag.uni-jena.de</email></contrib></contrib-group><aff id="I1"><label>1</label>Biomagnetic Center, Department of Neurology, Friedrich Schiller University Jena, Germany</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>1</day><month>9</month><year>2004</year></pub-date><volume>2</volume><fpage>6</fpage><lpage>6</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomagres.com/content/2/1/6"/><history><date date-type="received"><day>14</day><month>7</month><year>2004</year></date><date date-type="accepted"><day>1</day><month>9</month><year>2004</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2004 Hilgenfeld and Haueisen; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2004</copyright-year><copyright-holder>Hilgenfeld and Haueisen; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Hilgenfeld
               Bernd
               
               bhi@biomag.uni-jena.de
            </dc:author><dc:title>
            Simultaneous suppression of disturbing fields and localization of magnetic markers by means of multipole expansion
         </dc:title><dc:date>2004</dc:date><dcterms:bibliographicCitation>BioMagnetic Research and Technology 2(1): 6-. (2004)</dcterms:bibliographicCitation><dc:identifier type="sici">1477-044X(2004)2:1&#x0003c;6&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1477-044X</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Magnetically marked capsules serve for the analysis of peristalsis and throughput times within the intestinal tract. Moreover, they can be used for the targeted disposal of drugs. The capsules get localized in time by field measurements with a superconducting quantum interference device (SQUID) magnetometer array. Here it is important to ensure an online localization with high speed and high suppression of disturbing fields. In this article we use multipole expansions for the simultaneous localization and suppression of disturbing fields.</p></sec><sec sec-type="methods"><title>Methods</title><p>We expand the measurement data in terms of inner and outer multipoles. Thereby we obtain directly a separation of marker field and outer disturbing fields. From the inner dipoles and quadrupoles we compute the magnetization and position of the capsule. The outer multipoles get eliminated.</p></sec><sec><title>Results</title><p>The localization goodness has been analyzed depending on the order of the multipoles used and depending on the systems noise level. We found upper limits of the noise level for the usage of certain multipole moments. Given a signal to noise ratio of 40 and utilizing inner dipoles and quadrupoles and outer dipoles, the method enables an accuracy of 5 mm with a speed of 10 localizations per second.</p></sec><sec><title>Conclusion</title><p>The multipole localization is an effective method and is capable of online-tracking magnetic markers.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The transport of capsules in the alimentary tract underlies complex influencing factors like the patients peristalsis, the hydration and the form and size of the capsules. A procedure which allows the instantaneous localization of the capsules supports a number of patient examinations as well as examinations of new drug forms [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. Capsules can be marked radioactively (scintigraphy) or magnetically. The scintigraphy [<xref ref-type="bibr" rid="B5">5</xref>] has a lower time resolution compared to the magnetic localization, and due to radiation it is not appropriate for examinations with healthy probands.</p><p>The localization of magnetically marked capsules (magnetic markers) must be spatially accurate and with high temporal resolution. For the spatial localization the marker field must be separated from the external magnetic disturbing fields. This separation can be achieved by splitting the magnetic field in multipole moments [<xref ref-type="bibr" rid="B6">6</xref>]. The method proposed utilizes the multipole moments directly for the determination of the position and the magnetic moment of the marker. Thus, the separation of disturbing fields and the localization are integrated numerically effective into one procedure. This allows a fast online-localization of the marker capsules.</p><p>Multipole expansions are used also to model spatially distributed biological sources such as brain currents [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>].</p><p>The application of multipoles for the localization of magnetic dipoles is described in [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>], and is used in other technical areas without disturbing field suppression [<xref ref-type="bibr" rid="B11">11</xref>].</p><p>Marking of capsules and pills takes place by partially filling them with black iron oxide (Fe<sub>3</sub>O<sub>4</sub>) which is subsequently magnetized up to saturation. The magnetic field measurement is performed within magnetically shielded rooms by the use of highly sensitive SQUID arrays. For the investigation at hand we conduct simulation runs to determine the performance of the multipole localization.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Algorithm</title><p>The field of a magnetic marker located adjacent to the point of origin can be expressed by a multipole expansion in Cartesian coordinates (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, <italic>x</italic><sub>3</sub>). If the distance <inline-graphic xlink:href="1477-044X-2-6-i1.gif"/> between marker and origin is small compared to the distance <inline-graphic xlink:href="1477-044X-2-6-i2.gif"/> between a magnetic sensor and the origin, the field of the marker at the sensor position is given by the first elements of the multipole expansion. With the notation</p><p><inline-graphic xlink:href="1477-044X-2-6-i3.gif"/></p><p>follows</p><p><inline-graphic xlink:href="1477-044X-2-6-i4.gif"/></p><p>with <italic>c</italic><sup>m </sup>being the dipole, quadrupole and octopole moments of the field expansion.</p><p>The form functions <inline-graphic xlink:href="1477-044X-2-6-i5.gif"/> arise from a Taylor series expansion in the parameter <inline-graphic xlink:href="1477-044X-2-6-i6.gif"/> with <inline-graphic xlink:href="1477-044X-2-6-i7.gif"/> and <inline-graphic xlink:href="1477-044X-2-6-i8.gif"/>. It holds</p><p><inline-graphic xlink:href="1477-044X-2-6-i9.gif"/></p><p>With the Kronecker delta <inline-graphic xlink:href="1477-044X-2-6-i10.gif"/> follows</p><p><inline-graphic xlink:href="1477-044X-2-6-i11.gif"/></p><p><inline-graphic xlink:href="1477-044X-2-6-i12.gif"/></p><p>and</p><p><inline-graphic xlink:href="1477-044X-2-6-i13.gif"/></p><p>Conversely, a Taylor series expansion of &#x02013; compared to the sensor coordinates &#x02013; far away located field sources in the parameter <inline-graphic xlink:href="1477-044X-2-6-i14.gif"/> with <inline-graphic xlink:href="1477-044X-2-6-i15.gif"/> yields a multipole expansion of external disturbing fields:</p><p><inline-graphic xlink:href="1477-044X-2-6-i16.gif"/></p><p>We denote the multipole moments <italic>c</italic><sup>ex </sup>of the expansion of fields of external sources as "outer moments" to distinguish them from the "inner moments" <italic>c</italic><sup>m</sup>.</p><p>To get the same normalization and symmetry properties for the outer and inner form functions, we define the outer form functions <inline-graphic xlink:href="1477-044X-2-6-i17.gif"/> by</p><p><inline-graphic xlink:href="1477-044X-2-6-i18.gif"/></p><p>It follows</p><p><inline-graphic xlink:href="1477-044X-2-6-i19.gif"/></p><p><inline-graphic xlink:href="1477-044X-2-6-i20.gif"/></p><p>and</p><p><inline-graphic xlink:href="1477-044X-2-6-i21.gif"/></p><p>The tensors of 3<sup>rd </sup>order <inline-graphic xlink:href="1477-044X-2-6-i22.gif"/> and of 4<sup>th </sup>order <inline-graphic xlink:href="1477-044X-2-6-i23.gif"/> own the following symmetry features which are identical for the inner and outer multipole expansion:</p><p><inline-graphic xlink:href="1477-044X-2-6-i24.gif"/></p><p><inline-graphic xlink:href="1477-044X-2-6-i25.gif"/></p><p>We combine the resulting 3, 5 and 7 linearly independent components of the tensors of 2<sup>nd</sup>, 3<sup>rd </sup>and 4<sup>th </sup>order to one vector for the marker field <inline-graphic xlink:href="1477-044X-2-6-i26.gif"/> and one vector for the external disturbing field <inline-graphic xlink:href="1477-044X-2-6-i27.gif"/>:</p><p><inline-graphic xlink:href="1477-044X-2-6-i28.gif"/></p><p>The summation of equation (1) and equation (6) yields the field expansion for a magnetic marker with disturbing fields. We truncate this expansion after the octopole terms, and transcript it into a linear equation system for the determination of equivalent multipole moments <bold>c </bold>for a measurement <bold>B</bold><sub>meas</sub>:</p><p><inline-graphic xlink:href="1477-044X-2-6-i29.gif"/></p><p>The structure of the vectors <bold>B</bold><sub>meas </sub>and <bold>c </bold>and the matrix <bold>F </bold>is given below in the formulas (15...24). The residuals 0(&#x000b7;) are sufficiently small, if the coordinates of the marker are small compared to the coordinates of the field sensors <inline-graphic xlink:href="1477-044X-2-6-i30.gif"/>, and if the coordinates of the field sensors are small compared to the coordinates of the external disturbing field sources <inline-graphic xlink:href="1477-044X-2-6-i31.gif"/>.</p><p><bold>B</bold><sub>meas </sub>is a vector with the measurement values of the magnetometer sensor field in the positions <inline-graphic xlink:href="1477-044X-2-6-i32.gif"/> with the directions <inline-graphic xlink:href="1477-044X-2-6-i33.gif"/>:</p><p><inline-graphic xlink:href="1477-044X-2-6-i34.gif"/></p><p>The matrix <bold>F </bold>is built from the linearly independent form functions for inner and outer field sources given in equation (13). Their scalar product with the sensor normal directions <inline-graphic xlink:href="1477-044X-2-6-i33.gif"/> yields one row for every sensor:</p><p><inline-graphic xlink:href="1477-044X-2-6-i35.gif"/></p><p>The number of columns of <bold>F </bold>is the sum of the numbers of inner and outer field functions used. Each column describes the field of one specific magnetic moment with unit strength measured by the sensor system. The Matrix <bold>F </bold>is called the forward matrix of all moments considered. The Matrix <bold>F </bold>is structured into submatrices for different moments:</p><p><inline-graphic xlink:href="1477-044X-2-6-i36.gif"/></p><p>Matrix <inline-graphic xlink:href="1477-044X-2-6-i37.gif"/> and <inline-graphic xlink:href="1477-044X-2-6-i38.gif"/> are the forward matrices for inner and outer dipoles:</p><p><inline-graphic xlink:href="1477-044X-2-6-i39.gif"/></p><p>Matrix <inline-graphic xlink:href="1477-044X-2-6-i40.gif"/> and <inline-graphic xlink:href="1477-044X-2-6-i41.gif"/> are the forward matrices for inner and outer quadrupoles. The size of <inline-graphic xlink:href="1477-044X-2-6-i42.gif"/> is (<italic>Nsen</italic>/5) with the rows belonging to quadrupole moments with indices (1,1; 3,3; 1,2; 2,3; 3,1).</p><p><inline-graphic xlink:href="1477-044X-2-6-i43.gif"/></p><p>Matrix <inline-graphic xlink:href="1477-044X-2-6-i44.gif"/> and <inline-graphic xlink:href="1477-044X-2-6-i45.gif"/> are the forward matrices for inner and outer octopoles. The size of <inline-graphic xlink:href="1477-044X-2-6-i46.gif"/> is (<italic>Nsen</italic>/7) with the rows belonging to octopole moments with indices (1,2,2; 2,3,3; 3,1,1; 1,3,3; 2,1,1; 3,2,2; 1,2,3).</p><p><inline-graphic xlink:href="1477-044X-2-6-i47.gif"/></p><p>The vector of multipole moments <bold>c </bold>is composed of inner and outer dipole moments <bold>c</bold><sub>d</sub>, quadrupole moments <bold>c</bold><sub>q </sub>and octopole moments <bold>c</bold><sub>o</sub>:</p><p><inline-graphic xlink:href="1477-044X-2-6-i48.gif"/></p><p>The inner dipole moments <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/> describe a dipole at the point of origin, the outer dipole moments <inline-graphic xlink:href="1477-044X-2-6-i50.gif"/> describe a homogeneous disturbing field:</p><p><inline-graphic xlink:href="1477-044X-2-6-i51.gif"/></p><p>The <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/> represent a quadrupole at the point of origin. The <inline-graphic xlink:href="1477-044X-2-6-i53.gif"/> describe an external gradient field, whose field strength vanishes at the origin and which has no spatial derivations of 2<sup>nd </sup>or higher order. This field can be measured by five ideal gradiometers at the origin and can be compared with the creation of software gradiometers.</p><p><inline-graphic xlink:href="1477-044X-2-6-i54.gif"/></p><p>The <inline-graphic xlink:href="1477-044X-2-6-i55.gif"/> represent an octopole at the origin. The <inline-graphic xlink:href="1477-044X-2-6-i56.gif"/> describe an external gradient field of 2<sup>nd </sup>order, which has no spatial derivations of 3<sup>rd </sup>or higher order and whose field strength and spatial derivatives of 1<sup>st </sup>order vanish at the origin. This field could be measured by 7 ideal second order gradiometers at the origin, it can be compared with the creation of software gradiometers of 2<sup>nd </sup>order:</p><p><inline-graphic xlink:href="1477-044X-2-6-i57.gif"/></p><p>Due to its small spatial extension, the magnetic marker can be described as a dipole of strength <inline-graphic xlink:href="1477-044X-2-6-i58.gif"/> at position <inline-graphic xlink:href="1477-044X-2-6-i1.gif"/> as a good approximation. The field of this dipole is</p><p><inline-graphic xlink:href="1477-044X-2-6-i59.gif"/></p><p>With the Taylor series expansion</p><p><inline-graphic xlink:href="1477-044X-2-6-i60.gif"/></p><p>follows in analogy to equation (1)</p><p><inline-graphic xlink:href="1477-044X-2-6-i61.gif"/></p><p>A comparison of coefficients of (1) and (27) yields</p><p><inline-graphic xlink:href="1477-044X-2-6-i62.gif"/></p><p>and</p><p><inline-graphic xlink:href="1477-044X-2-6-i63.gif"/></p><p>The dipole strength <inline-graphic xlink:href="1477-044X-2-6-i58.gif"/> can be determined by the dipole moment <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>. An equation system for the adjacent calculation of the dipole position <inline-graphic xlink:href="1477-044X-2-6-i1.gif"/> from the dipole strength <inline-graphic xlink:href="1477-044X-2-6-i58.gif"/> and the quadrupole moment <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/> follows from (29) and (23):</p><p><inline-graphic xlink:href="1477-044X-2-6-i64.gif"/></p><p>with</p><p><inline-graphic xlink:href="1477-044X-2-6-i65.gif"/></p><p>This equation system is named shift equation in analogy to [<xref ref-type="bibr" rid="B10">10</xref>]. It is overdetermined, and can be solved by means of the pseudo inverse of <bold>m</bold>.</p><p><inline-graphic xlink:href="1477-044X-2-6-i66.gif"/></p><p>We get the multipole moments <bold>c</bold>, which are required for the localization of the marker dipole, from solving the overdetermined equation system (14) by means of the pseudo inverse of <bold>F</bold>:</p><p><bold>c </bold>= (<bold>F</bold><sup>T</sup>&#x000b7;<bold>F</bold>)<sup>-1</sup>&#x000b7;<bold>F</bold><sup>T</sup>&#x000b7;<bold>B</bold><sub>meas</sub>. &#x000a0;&#x000a0;&#x000a0; (33)</p><p>Here, the matrix of form functions <bold>F </bold>must contain columns at least for the moments <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/> and <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>.</p><p>Iterative dipole localization for a fixed dipole (e.g. one time point) is achieved by using the localization position as a new point of origin. The step length of the last localization step serves as a stop criterion for the iterative localization procedure. This is justified by considering the residuals of equation (14) within the convergence range of the procedure, and will practically be shown by the results of the following simulations.</p><p>The tracking of a moved dipole based on measurements at consecutive time steps works by updating both the point of origin and the measurement data set after each localization step (Fig. <xref ref-type="fig" rid="F1">1</xref>). The localization step must be monitored, since it contains information about the marker speed and the noise dependent and speed dependent localization errors.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Flow chart of the algorithm for online localization. </bold>This algorithm is meant for online localization, and therefore comprises only one iteration. A high signal to noise ratio and a high computing speed render 2&#x02013;3 iterations per measurement cycle possible.</p></caption><graphic xlink:href="1477-044X-2-6-1"/></fig></sec><sec><title>Measurement system</title><p>The simulations to determine the performance of the algorithm use the sensor geometry of the multi channel SQUID system Argos 200 from AtB (Advanced Technologies Biomagnetics, Pescara, Italy). The ARGOS 200 system contains fully integrated planar SQUID magnetometers produced using Nb technology with integrated pick-up loops. The sensing area is a square of 8 mm side length. The intrinsic noise level of the built in 195 SQUID sensors is below 5 fT Hz<sup>-1/2 </sup>at 10 Hz. Three sensors form one orthogonal triplet in each case. The measurement plane with a diameter of 23 cm consists of 56 of those triplets. The reference array consists of seven SQUID sensor triplets located in the second level in a plane which is positioned parallel to the measurement plane at a distance of 98 mm. The third (196 mm above the first plane) and fourth (254 mm above the first plane) levels contain one triplet each (Fig. <xref ref-type="fig" rid="F2">2</xref>).</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>SQUID Array Argos 200. </bold>The ATB SQUID Array Argos 200 consists of 195 magnetometers which are arranged in orthogonal sensor triplets in four levels. The measurement area of each sensor is a square of 8 mm edge length.</p></caption><graphic xlink:href="1477-044X-2-6-2"/></fig><p>The measurement system is positioned within a magnetically shielded room, consisting of 3 highly permeable shieldings and one eddy current shielding. The shielding performance is 38 db at 1 Hz, 55 db at Hz and 80 db at 20 Hz.</p><p>The sensor arrangement in orthogonal triplets facilitates the measurement of all 3 spatial components of the magnetic field. Thus, the required field coverage for the localization of a magnetic marker with unknown dipole strength is achieved.</p><p>The subdivision into 168 measurement and 27 reference sensors is meant for the creation of software gradiometers. We can use all sensors simultaneously for the multipole method which integrates the suppression of disturbing fields.</p><p>With the above described measurement system we performed simulations with different signal to noise ratios.</p></sec></sec><sec><title>Results</title><p>We examined the localization characteristics of the multipole method by means of simulation runs at the sensor geometry of the measurement system Argos 200 (Fig. <xref ref-type="fig" rid="F2">2</xref>). All simulations performed are based on a dipole at position (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) = (0, 0, -300 mm), i.e. 30 cm below the measurement plane, with a dipole strength of 20 Amm<sup>2</sup>. This is a realistic dipole position for an examination within the digestive tract. The dipole field was superimposed by uncorrelated, Gauss distributed noise. The noise level in fT is also given as signal-to-noise-ratio (SNR), based on the channel with the strongest amplitude of the dipole field.</p><p>The average localization accuracy over 100 simulations has been determined depending on the noise level and on the number of the multipole moments used in the vector <bold>c </bold>(21) (Fig. <xref ref-type="fig" rid="F3">3</xref>).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Noise-dependent localization error. </bold>The mean squared localization error e<italic>rr</italic>(<inline-graphic xlink:href="1477-044X-2-6-i1.gif"/>) over 100 simulations has been determined depending on the noise level and on the different number of multipole moments used. The curves are plotted up to the noise level, where all simulations still produced a stable localization result. We used the inner moments up to the 3<sup>rd </sup>order <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>, plotted in curves 3&#x003c7; and the inner moments up to the 4<sup>th </sup>order <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i55.gif"/>, plotted in curves 4&#x003c7;. The outer moments which were used to model the disturbing fields were none (curves &#x003c7;0), 2<sup>nd </sup>order moments (curves &#x003c7;2: homogeneous fields), 2<sup>nd </sup>and 3<sup>rd </sup>order moments (curves &#x003c7;3: homogeneous and gradient fields), and 2<sup>nd </sup>to 4<sup>th </sup>order moments (curves &#x003c7;4: external fields up to 2<sup>nd </sup>order). The simplest disturbing field to model is a homogeneous field having index &#x003c7;2. The dipole field of a dipole with a strength of 20 Amm<sup>2 </sup>at position (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) = (0, 0, -300 mm) is superimposed by white, Gaussian distributed noise, which is given in fT and as the signal to noise ratio (SNR).</p></caption><graphic xlink:href="1477-044X-2-6-3"/></fig><p>The localization was run up to a stable point. We define the localization error as the mean quadratic error of the 100 stable points based on the true dipole position. The localization error increases if we use higher order multipole moments. This holds true for the inner moments <bold>c</bold><sup>m </sup>and for the outer moments <bold>c</bold><sup>ex </sup>as well. As a good approximation the interrelationship between noise level and localization error is linear, with raising proportionality factor for higher mode numbers. This corresponds to parallel translation of the curves in double logarithmic plotting.</p><p>We examined the localization speed depending on the distance of the starting point to the dipole position. For any tested distance the starting point has been moved from the dipole position into 100 random directions. The remaining mean distance to the dipole position after one localization step is depicted in Fig. <xref ref-type="fig" rid="F4">4</xref>. The localization speed turns to be significantly higher when using inner octopoles. It gets higher with a shorter starting distance in both an absolute and a relative manner based on the starting distance. Both effects are to be expected directly from the residuals of equation (14). The influence of the outer multipoles on the localization speed is low. The convergence radius at which the dipole was found from all 100 directions decreases slightly with the raising number of outer multipoles used, and increases slightly if inner octopoles are used (unequal right ends of the respective curves in Fig. <xref ref-type="fig" rid="F4">4</xref>). The convergence radius ranges between 6 and 10 cm. The maximum number of iterations for a target accuracy of 1 mm can be estimated from Fig. <xref ref-type="fig" rid="F4">4</xref> as 3.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Localization error depending on the starting point distance for one iteration. </bold>For each distance <italic>d</italic><sub><italic>s </italic></sub>the start position has been moved from the dipole into 100 random directions. The mean remaining distance <italic>d</italic><sub><italic>r </italic></sub>after one localization step is shown. The curves are plotted until the starting distance <italic>d</italic><sub><italic>r </italic></sub>where the localization was still stable from all 100 directions. To get the result after multiple iterative localization steps, the <italic>d</italic><sub>r</sub>-value has to be taken as the starting distance <italic>d</italic><sub><italic>s </italic></sub>of the following step. We used the inner moments up to the 3<sup>rd </sup>order <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>, plotted in curves 3&#x003c7; and the inner moments up to the 4<sup>th </sup>order <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i55.gif"/>, plotted in curves 4&#x003c7;. The outer moments which were used to model the disturbing fields were none (curves &#x003c7;0), 2<sup>nd </sup>order moments (curves &#x003c7;2: homogeneous fields), 2<sup>nd </sup>and 3<sup>rd </sup>order moments (curves &#x003c7;3: homogeneous and gradient fields), and 2<sup>nd </sup>to 4<sup>th </sup>order moments (curves &#x003c7;4: external fields up to 2<sup>nd </sup>order).</p></caption><graphic xlink:href="1477-044X-2-6-4"/></fig><p>In the following we examined the interrelationship between the convergence distance at y-direction and the noise level. The maximum y-distance of the starting position to the dipole, at which the dipole could be found with 100 random noise distributions, is depicted in Fig. <xref ref-type="fig" rid="F5">5</xref>. It shows that the convergence distance remains unchanged almost up to the point of critical noise level (see Fig. <xref ref-type="fig" rid="F3">3</xref>) at which localization becomes impossible. The convergence distance, also compare the maximum convergence radius from the curve ends of plot (Fig. <xref ref-type="fig" rid="F4">4</xref>), depends only marginally on the choice of the inner ansatz functions. It decreases slightly when using outer multipoles. Having a convergence radius of at least 6 cm for the dipole position tested, the choice of the starting position can be regarded as noncritical.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Convergence distance depending on noise level. </bold>The maximum y-distance <italic>dy </italic>between starting position and dipole position, at which for 100 random noise distributions the dipole could still get localized, is plotted. We used the inner moments up to the 3<sup>rd </sup>order <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>, plotted in curves 3&#x003c7; and the inner moments up to the 4<sup>th </sup>order <inline-graphic xlink:href="1477-044X-2-6-i49.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i52.gif"/>, <inline-graphic xlink:href="1477-044X-2-6-i55.gif"/>, plotted in curves 4&#x003c7;. The outer moments which were used to model the disturbing fields were none (curves &#x003c7;0), 2<sup>nd </sup>order moments (curves &#x003c7;2: homogeneous fields), 2<sup>nd </sup>and 3<sup>rd </sup>order moments (curves &#x003c7;3: homogeneous and gradient fields), and 2<sup>nd </sup>to 4<sup>th </sup>order moments (curves &#x003c7;4: external fields up to 2<sup>nd </sup>order). The dipole field of a dipole with a strength of 20 Amm<sup>2 </sup>at position (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) = (0, 0, -300 mm) is superimposed by white, Gaussian distributed noise given in fT and as the signal to noise ratio (SNR).</p></caption><graphic xlink:href="1477-044X-2-6-5"/></fig><p>The computing time used for one localization step is 5 ms with an implementation in Matlab at a standard Windows PC with a 2 GHz clock frequency. With maximum 3 iterations per localization step and additional computing time needed for data transfer and a basic visualization, 10 localizations per second are possible. This rate is normally sufficient for marker localizations.</p></sec><sec><title>Discussion</title><p>The localization speed rises when using inner octopoles <inline-graphic xlink:href="1477-044X-2-6-i55.gif"/>, but this is associated with a higher localization error. At a signal to noise ratio lower than 10<sup>3 </sup>inner octopoles cannot be used. An SNR of at least 10<sup>2 </sup>is required for a source positioned 30 cm below the measurement plane.</p><p>The outer moments <bold>c</bold><sup>ex </sup>used enlarge the localization error depending on the uncorrelated sensor noise, as shown in Fig. <xref ref-type="fig" rid="F3">3</xref>. Contrary, the localization error depending on the spatially correlated residual field within the measurement room lowers when using outer moments. Depending on the ratio between correlated and uncorrelated noise which has to be found with practical test series, noise suppression of homogeneous disturbing fields using <inline-graphic xlink:href="1477-044X-2-6-i50.gif"/> and possibly noise suppression of gradient fields using <inline-graphic xlink:href="1477-044X-2-6-i53.gif"/> are applicable. To ensure convergence, the starting point for the algorithm has to be within the convergence radius given in Fig. <xref ref-type="fig" rid="F4">4</xref>. With typical measurement conditions, thus, a starting point 10 cm below the center of the measurement system will suffice.</p></sec><sec><title>Conclusions</title><p>The multipole localization is an effective algorithm because it unites a method for the suppression of disturbing fields with a localization method. It can be used iteratively and online for the tracking of magnetic marker timelines within the intestinal tract.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work has been partially supported by the joint research project "MagMon/NET0158" within the "InnoNet" program of the German Federal Government Department of Research (BMWA).</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Weitschies</surname><given-names>W</given-names></name><name><surname>Hartmann</surname><given-names>V</given-names></name><name><surname>Grutzmann</surname><given-names>R</given-names></name><name><surname>Breitkreutz</surname><given-names>J</given-names></name></person-group><article-title>Determination of the disintegration behavior of magnetically marked tablets</article-title><source>Eur J Pharm Biopharm</source><year>2001</year><volume>52</volume><fpage>221</fpage><lpage>226</lpage><pub-id pub-id-type="pmid">11522489</pub-id><pub-id pub-id-type="doi">10.1016/S0939-6411(01)00178-3</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kosch</surname><given-names>O</given-names></name><name><surname>Osmanoglou</surname><given-names>E</given-names></name><name><surname>Weitschies</surname><given-names>W</given-names></name><name><surname>Wiedenmann</surname><given-names>B</given-names></name><name><surname>M&#x000f6;nnikes</surname><given-names>H</given-names></name><name><surname>Trahms</surname><given-names>L</given-names></name></person-group><article-title>Online localisation of a magnetized capsule for investigation of the gastrointestinal passage</article-title><source>Biomed Tech</source><year>2003</year><volume>48</volume><fpage>244</fpage><lpage>245</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>M&#x000f6;nnikes</surname><given-names>H</given-names></name><name><surname>Osmanoglou</surname><given-names>E</given-names></name><name><surname>Kosch</surname><given-names>O</given-names></name><name><surname>Fach</surname><given-names>K</given-names></name><name><surname>van der Voort</surname><given-names>IR</given-names></name><name><surname>Strenzke</surname><given-names>A</given-names></name><name><surname>Weitschies</surname><given-names>W</given-names></name><name><surname>Wiedenmann</surname><given-names>B</given-names></name><name><surname>Trahms</surname><given-names>L</given-names></name></person-group><article-title>Evaluation of esophageal motility and transport of solid drug dosage forms by manometry and magnetometry</article-title><source>Biomed Tech</source><year>2003</year><volume>48</volume><fpage>376</fpage><lpage>377</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kosch</surname><given-names>O</given-names></name><name><surname>Osmanoglou</surname><given-names>E</given-names></name><name><surname>Hartmann</surname><given-names>V</given-names></name><name><surname>Strenzke</surname><given-names>A</given-names></name><name><surname>Weitschies</surname><given-names>W</given-names></name><name><surname>Wiedenmann</surname><given-names>B</given-names></name><name><surname>M&#x000f6;nnikes</surname><given-names>H</given-names></name><name><surname>Trahms</surname><given-names>L</given-names></name></person-group><article-title>Investigation of gastrointestinal transport by magnetic marker localization</article-title><source>Biomed Tech (Berl)</source><year>2002</year><volume>47</volume><fpage>506</fpage><lpage>509</lpage><pub-id pub-id-type="pmid">12465220</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mughal</surname><given-names>MM</given-names></name><name><surname>Marples</surname><given-names>M</given-names></name><name><surname>Bancewicz</surname><given-names>J</given-names></name></person-group><article-title>Scintigraphic assessment of esophageal motility: what does it show and how reliable is it?</article-title><source>Gut</source><year>1986</year><volume>27</volume><fpage>946</fpage><lpage>953</lpage><pub-id pub-id-type="pmid">3732902</pub-id></citation></ref><ref id="B6"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Taulu</surname><given-names>S</given-names></name><name><surname>Kajola</surname><given-names>M</given-names></name><name><surname>Simola</surname><given-names>J</given-names></name></person-group><article-title>The Signal Space Separation Method</article-title><source>Abstract book of NFSI</source><year>2003</year><publisher-name>Chieti, Italy</publisher-name><fpage>A79</fpage></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nolte</surname><given-names>G</given-names></name><name><surname>Curio</surname><given-names>G</given-names></name></person-group><article-title>Current multipole expansion to estimate lateral extent of neuronal activity: a theoretical analysis</article-title><source>IEEE Trans Biomed Eng</source><year>2000</year><volume>47</volume><fpage>1347</fpage><lpage>55</lpage><pub-id pub-id-type="pmid">11059169</pub-id><pub-id pub-id-type="doi">10.1109/10.871408</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nolte</surname><given-names>G</given-names></name><name><surname>Curio</surname><given-names>G</given-names></name></person-group><article-title>On the calculation of magnetic fields based on multiple modeling of focal biological current sources</article-title><source>Biophys J</source><year>1997</year><volume>73</volume><fpage>1253</fpage><lpage>62</lpage><pub-id pub-id-type="pmid">9284293</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wikswo</surname><given-names>JP</given-names></name><name><surname>Swinney</surname><given-names>KR</given-names></name></person-group><article-title>A comparison of scalar multipole expansions</article-title><source>J Appl Phys</source><year>1984</year><volume>56</volume><fpage>3039</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1063/1.333885</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wikswo</surname><given-names>JP</given-names></name><name><surname>Swinney</surname><given-names>KR</given-names></name></person-group><article-title>Scalar multipole expansions and their dipole equivalents</article-title><source>J Appl Phys</source><year>1985</year><volume>57</volume><fpage>4301</fpage><lpage>08</lpage><pub-id pub-id-type="doi">10.1063/1.334589</pub-id></citation></ref><ref id="B11"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>HC</given-names></name><name><surname>Saglembeni</surname><given-names>A</given-names></name><name><surname>Rakijas</surname><given-names>M</given-names></name><name><surname>Kohnen</surname><given-names>KK</given-names></name></person-group><article-title>Linear perturbation method for kalman filter tracking of magnetic field sources</article-title><source>United States Patent No: US 6292758 B1</source><comment>Sep 18, 2001</comment></citation></ref></ref-list></back></article>



