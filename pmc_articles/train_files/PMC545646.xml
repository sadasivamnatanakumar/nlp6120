<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genet</journal-id><journal-title>BMC Genetics</journal-title><issn pub-type="epub">1471-2156</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15588316</article-id><article-id pub-id-type="pmc">PMC545646</article-id><article-id pub-id-type="publisher-id">1471-2156-5-32</article-id><article-id pub-id-type="doi">10.1186/1471-2156-5-32</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Screening large-scale association study data: exploiting interactions using random forests</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Lunetta</surname><given-names>Kathryn L</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>klunetta@bu.edu</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Hayward</surname><given-names>L Brooke</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>brooke.hayward@yahoo.com</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Segal</surname><given-names>Jonathan</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I3">3</xref><email>jonathan.segal@genizon.com</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Van Eerdewegh</surname><given-names>Paul</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I3">3</xref><xref ref-type="aff" rid="I4">4</xref><email>paul.vaneerdewegh@genizon.com</email></contrib></contrib-group><aff id="I1"><label>1</label>Oscient Pharmaceuticals, Inc. (formerly Genome Therapeutics Corporation), Waltham, Massachusetts, USA</aff><aff id="I2"><label>2</label>Department of Biostatistics, Boston University School of Public Health, Boston, Massachusetts, USA</aff><aff id="I3"><label>3</label>Genizon BioSciences Inc., Montreal, Quebec, Canada</aff><aff id="I4"><label>4</label>Department of Psychiatry, Harvard Medical School, Boston, Massachusetts, USA</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>10</day><month>12</month><year>2004</year></pub-date><volume>5</volume><fpage>32</fpage><lpage>32</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2156/5/32"/><history><date date-type="received"><day>25</day><month>6</month><year>2004</year></date><date date-type="accepted"><day>10</day><month>12</month><year>2004</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2004 Lunetta et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2004</copyright-year><copyright-holder>Lunetta et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Lunetta
               L
               Kathryn
               
               
               klunetta@bu.edu
            </dc:author><dc:title>
            Screening large-scale association study data: exploiting interactions using random forests
         </dc:title><dc:date>2004</dc:date><dcterms:bibliographicCitation>BMC Genetics 5(1): 32-. (2004)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2156(2004)5:1&#x0003c;32&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2156</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Genome-wide association studies for complex diseases will produce genotypes on hundreds of thousands of single nucleotide polymorphisms (SNPs). A logical first approach to dealing with massive numbers of SNPs is to use some test to screen the SNPs, retaining only those that meet some criterion for futher study. For example, SNPs can be ranked by p-value, and those with the lowest p-values retained. When SNPs have large interaction effects but small marginal effects in a population, they are unlikely to be retained when univariate tests are used for screening. However, model-based screens that pre-specify interactions are impractical for data sets with thousands of SNPs. Random forest analysis is an alternative method that produces a single measure of importance for each predictor variable that takes into account interactions among variables without requiring model specification. Interactions increase the importance for the individual interacting variables, making them more likely to be given high importance relative to other variables. We test the performance of random forests as a screening procedure to identify small numbers of risk-associated SNPs from among large numbers of unassociated SNPs using complex disease models with up to 32 loci, incorporating both genetic heterogeneity and multi-locus interaction.</p></sec><sec><title>Results</title><p>Keeping other factors constant, if risk SNPs interact, the random forest importance measure significantly outperforms the Fisher Exact test as a screening tool. As the number of interacting SNPs increases, the improvement in performance of random forest analysis relative to Fisher Exact test for screening also increases. Random forests perform similarly to the univariate Fisher Exact test as a screening tool when SNPs in the analysis do not interact.</p></sec><sec><title>Conclusions</title><p>In the context of large-scale genetic association studies where unknown interactions exist among true risk-associated SNPs or SNPs and environmental covariates, screening SNPs using random forest analyses can significantly reduce the number of SNPs that need to be retained for further study compared to standard univariate screening methods.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Genome-wide association studies for complex diseases such as asthma, schizophrenia, diabetes, and hypertension will soon produce genotypes on hundreds of thousands of single nucleotide polymorphisms (SNPs). Due to the large number of SNPs tested and the potential for both genetic and environmental interactions, determining which SNPs modify the risk of disease is a methodological challenge. While the number of genotypes produced by candidate gene approaches will be somewhat less daunting, on the order of hundreds to thousands of SNPs, it will still be a considerable challenge to weed out the noise and identify the SNPs contributing to complex traits.</p><p>A logical first approach to dealing with massive numbers of SNPs is to first conduct univariate association tests on each individual SNP, in order to screen-out those with no evidence for disease association. The primary goal of such a procedure is not to prove that a particular variant or set of variants influences disease risk, but to prioritize SNPs for further study. Using a univariate test at this stage will result in low power for SNPs with very small marginal effects in the population, even if the SNPs have large interaction effects. Of course, in addition to taking all individual SNPs, all SNP pairs could also be tested for association. However, when dealing with multiple thousands of SNPs at the outset, such an approach is cumbersome, and raises the question of where to stop: why not all sets of three, four, or even five SNPs as well?</p><p>Many model-building methods exist for dealing with large numbers of predictors. For example, stochastic search variable selection (SSVS) [<xref ref-type="bibr" rid="B1">1</xref>], a form of Bayesian model selection, has been explored as a tool to discover joint effects of multiple loci in the context of genetic linkage studies [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. However, these methods are limited in the number of predictors that can be included at one time, causing some researchers to resort to a two-stage approach, in which only main effects are considered in a first stage, and interactions between loci with strong main effects are considered in a second stage. This approach can lead to the loss of important interactions with only weak main effects.</p><p>Multivariate adaptive regression splines (MARS) models have also been explored in the context of genetic linkage and association studies [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>] with some degree of success. However, these and other model selection methods appear to be limited in the number of predictors that can reasonably be accommodated in one analysis, and the types of possible interactions that are allowed must be specified in advance. They are not suited to the initial task of identifying from a massive set of SNPs a subset for further analyses.</p><p>Combinatorial partitioning and multifactor dimensionality reduction [<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B10">10</xref>] are closely related methods developed specifically to detect higher-order interactions among polymorphisms that predict trait variation. However, these methods are meant to identify interactions among small sets of SNPs, and have minimal power in the presence of genetic heterogeneity [<xref ref-type="bibr" rid="B10">10</xref>]. They are therefore inappropriate for use as a screening tool for searching through thousands of SNPs to identify those contributing to phenotypes in the context of whole-genome association studies. The problem remains: how do we reasonably weed down from thousands or hundreds of thousands of SNPs to a number that can be used by available modeling methods, without losing the interactions that we hope to model in the first place?</p><p>An additional concern to be considered is genetic heterogeneity. We define genetic heterogeneity to mean that there are multiple possible ways to acquire a disease or trait that can involve different subsets of genes. Traditional regression models are limited in their ability to deal with underlying genetic heterogeneity (see, <italic>e.g</italic>., [<xref ref-type="bibr" rid="B11">11</xref>]). If genetic heterogeneity also leads to phenotypic heterogeneity, then methods that classify individuals into phenotypic subgroups for further analysis can be successful. Likewise, if heterogeneity in genetic etiology is primarily due to ethnic background, sub-dividing samples by self-reported ethnicity or genetically defined subgroups can be a powerful antecedent to data analyses for the identification of complex disease genes. However, even in the realm of Mendelian genetic diseases, heterogeneity is rarely so simple. For example, multiple polymorphisms in each of two different genes are responsible for familial breast cancer in the relatively homogeneous sub-population of Ashkenazi Jewish women [<xref ref-type="bibr" rid="B12">12</xref>]. When the root of the heterogeneity is not known <italic>a priori</italic>, traditional regression models, which lump all individuals into a single group and estimate average effects over the entire sample, are unlikely to successfully identify the genetic causes of diseases.</p><sec><title>Classification trees and random forests</title><p>Tree-based methods consist of non-parametric statistical approaches for conducting regression and classification analyses by recursive partitioning (see, e.g., Hastie et al. [<xref ref-type="bibr" rid="B13">13</xref>]). These methods can be very efficient at selecting from large numbers of predictor variables such as genetic polymorphisms those that best explain a phenotype. Tree methods are useful when predictors may be associated in some non-linear fashion, as no implicit assumptions about the form of underlying relationships between the predictor variables and the response are made. They are well-adapted to dealing with some types of genetic heterogeneity, as separate models are automatically fit to subsets of data defined by early splits in the tree.</p><p>The ease of interpretation of classification trees, along with their flexibility in accommodating large numbers of predictors and ability to handle heterogeneity, has resulted in increasing interest in their application to genetic association and linkage studies. Classification trees have been adapted for use with sibling pairs to subdivide pairs into more homogenous subgroups defined by non-genetic covariates [<xref ref-type="bibr" rid="B14">14</xref>], thus increasing the power to detect linkage under heterogeneity [<xref ref-type="bibr" rid="B15">15</xref>]. They have also shown promise for the dissection of complex traits for both linkage and association [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>], and for exploring interactions [<xref ref-type="bibr" rid="B6">6</xref>]. A related adaptive regression method has also shown promise in selecting a small number of predictive SNPs from a set of hundreds of potential predictors [<xref ref-type="bibr" rid="B18">18</xref>]. Tree methods have also been used to identify homogeneous groups of cases for further analyses [<xref ref-type="bibr" rid="B19">19</xref>], and as an adjunct to more traditional association methods [<xref ref-type="bibr" rid="B20">20</xref>].</p><p>Classification trees are grown by recursively partitioning the observations into subgroups with a more homogeneous categorical response [<xref ref-type="bibr" rid="B21">21</xref>]. At each node, the explanatory variable (e.g., SNP) giving the most homogeneous sub-groups is selected. Choosing alternative predictors that produce slightly sub-optimal splits can result in very different trees that have similar prediction accuracy. The Random Forests methodology [<xref ref-type="bibr" rid="B22">22</xref>] builds on several other methods using multiple trees to increase prediction accuracy [<xref ref-type="bibr" rid="B23">23</xref>-<xref ref-type="bibr" rid="B25">25</xref>]. A random forest is a collection of classification or regression trees with two features that distinguish it from trees built in a deterministic manner. First, the trees are grown on bootstrap samples of the observations. Second, a random selection of the potential predictors is used to determine the best split at each node. For each tree, a bootstrap sample is obtained by drawing a sample with replacement from the original sample of observations. The bootstrap sample has the same number of individuals as the original sample, but some individuals are represented multiple times, while others are left out. The left-out individuals, sometimes called "out-of-bag", are used to estimate prediction error. Because a different bootstrap sample is used to grow each tree, there is a different set of out-of-bag individuals for each tree. With a forest of classification trees, each tree predicts the class of an individual. For each individual, the predictions, or "votes", are counted across all trees for which the individual was out-of-bag, and the class with the most votes is the individual's predicted class. Random forests produce an importance score for each variable that measures its importance. This score can be used to prioritize the variables, much as p-values from test statistics are used.</p><p>Using ensembles of trees built in this manner increases the probability that some trees will capture interactions among variables with no strong main effect. Unlike variable selection methods, interactions among predictors do not need to be explicitly specified in order to be utilized by a forest of trees. Instead, any interactions between variables serve to increase the importance of the individual interacting variables, making them more likely to be given high importance relative to other variables. Thus, random forests appear to be particularly well-suited to address a primary problem posed by large scale association studies. In preliminary studies, we have shown the potential of random forests in the context of linkage analysis [<xref ref-type="bibr" rid="B26">26</xref>]. Other investigators are beginning to recognize the potential of the Random Forest methodology for studying SNP association [<xref ref-type="bibr" rid="B27">27</xref>] and classification [<xref ref-type="bibr" rid="B28">28</xref>].</p><p>To fully understand the basis of complex disease, it is important to identify the critical genetic factors involved, and to understand the complex relationships between genotypes, environment, and phenotypes. The few successes to date in identifying genes for complex disease suggest that despite carefully collected large samples, novel approaches are needed in the pursuit to dissect the multiple and varying factors that lead to complex human traits. Ultimately, the challenge in identifying polymorphisms that modulate the risk of complex disease is to find methods that can seamlessly handle large numbers of predictors, capitalize on and identify interactions, and tease apart the multiple heterogeneous etiologies. Here, we explore the use of the Random Forest methodology [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B29">29</xref>] as a screening tool for identifying SNPs associated with disease in the presence of interaction, heterogeneity, and large amounts of noise due to unassociated polymorphisms.</p></sec></sec><sec><title>Results</title><sec><title>Genetic models</title><p>We simulated complex diseases with sibling recurrence risk ratio for the disease (<italic>&#x003bb;</italic><sub>s</sub>) fixed at 2.0 and population disease prevalence <italic>K</italic><sub><italic>p </italic></sub>equal to 0.10. These values are consistent with or lower than estimates from known complex genetic traits, such as Alzheimer disease, where estimates of cumulative prevalence in siblings of affected range from 30&#x02013;40%, compared to a population prevalence of 10% at age 80 [<xref ref-type="bibr" rid="B30">30</xref>]. Such traits are understood to be caused by multiple interacting genetic and environmental factors. Our genetic models incorporate both genetic heterogeneity and multiplicative interaction as defined by Risch [<xref ref-type="bibr" rid="B31">31</xref>]: we simulate sets of 4, 8, 16, and 32 risk SNPs ("rSNPs") in linkage equilibrium, interacting in independent pairs or quartets to increase disease risk, and contributing equally to the overall sibling recurrence risk ratio of 2 and population disease prevalence of 0.10. For simplicity, we simulated the models such that each rSNP pair or quartet accounts for the same proportion of the genetic risk, and each SNP within a pair/quartet is responsible for an equal proportion of the genetic risk. Thus, all of the rSNPs simulated for a model have the same allele frequency and the same observed marginal effect in the population. We denote the models using the shorthand HhMm, where H = h (=2, 4, 8, 16) is the number of heterogeneous systems, and M = m (=2 or 4) is the number of multiplicatively interacting SNPs within each system. For example, 16 loci are responsible for the total <italic>&#x003bb;</italic><sub>s </sub>= 2 and <italic>K</italic><sub><italic>p </italic></sub>= .10 for models H4M4 and H8M2, and 32 loci are responsible for models H8M4 and H16M2. Table <xref ref-type="table" rid="T1">1</xref> presents relevant features of our models. The Methods section describes the genetic models in more detail.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Genetic models used for simulating case-control data.</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="2">Risk SNPs</td><td></td><td></td><td></td><td></td><td></td><td align="center" colspan="2">Case Genotype Correlation</td></tr><tr><td></td><td></td><td align="center">Allele</td><td align="center" colspan="2">Marginal GRR</td><td align="center" colspan="3">Penetrance Factors</td><td align="center">Within System</td><td align="center">Between System</td></tr><tr><td align="center">Model</td><td align="center">Number</td><td align="center">Frequency</td><td align="center">Het</td><td align="center">Hom</td><td align="center">0</td><td align="center">1</td><td align="center">2</td><td></td><td></td></tr></thead><tbody><tr><td align="center">H2M2</td><td align="center">4</td><td align="center">0.207</td><td align="center">2.85</td><td align="center">4.71</td><td align="center">2.4E-02</td><td align="center">0.51</td><td align="center">1</td><td align="center">0.30</td><td align="center">-0.32</td></tr><tr><td align="center">H4M2</td><td align="center">8</td><td align="center">0.160</td><td align="center">1.99</td><td align="center">2.96</td><td align="center">3.9E-04</td><td align="center">0.50</td><td align="center">1</td><td align="center">0.35</td><td align="center">-0.12</td></tr><tr><td align="center">H8M2</td><td align="center">16</td><td align="center">0.104</td><td align="center">1.66</td><td align="center">2.18</td><td align="center">8.0E-06</td><td align="center">0.56</td><td align="center">1</td><td align="center">0.32</td><td align="center">-0.05</td></tr><tr><td align="center">H16M2</td><td align="center">32</td><td align="center">0.069</td><td align="center">1.46</td><td align="center">1.78</td><td align="center">1.4E-05</td><td align="center">0.59</td><td align="center">1</td><td align="center">0.28</td><td align="center">-0.02</td></tr><tr><td align="center">H4M4</td><td align="center">16</td><td align="center">0.282</td><td align="center">1.63</td><td align="center">1.79</td><td align="center">1.2E-08</td><td align="center">0.79</td><td align="center">1</td><td align="center">0.17</td><td align="center">-0.06</td></tr><tr><td align="center">H8M4</td><td align="center">32</td><td align="center">0.214</td><td align="center">1.34</td><td align="center">1.40</td><td align="center">2.8E-03</td><td align="center">0.86</td><td align="center">1</td><td align="center">0.14</td><td align="center">-0.02</td></tr></tbody></table></table-wrap></sec><sec><title>Simulation and analysis</title><p>All analyses were performed on 100 replicate data sets of 500 cases and 500 controls. In addition to the rSNPs contributing to the trait, we simulated noise SNPs ("nSNPs"), independent of disease status, with allele frequencies distributed equally across the range .01&#x02013;.99. To simulate the results of an association study, in which we do not expect to be lucky enough to genotype all polymorphisms related to a trait, we included only a subset of the total number of rSNPs in each analysis. We denote the analysis design using the shorthand KkSsNn, where K = k is the total number of rSNPs genotyped in the analysis, S = s is the number of SNPs within each interaction system genotyped, and N = n is the total number of SNPs genotyped in the design. Thus, N-K is the total number of nSNPs in the analysis. For example, suppose the genetic model is H8M4, and the design is K4S2N100. Then out of the total of 8 &#x000d7; 4 = 32 rSNPs that contribute to the trait, four are genotyped: two interacting SNPs from within each of two heterogeneity systems. Six heterogeneity systems are not represented at all in the analysis. In addition to the four genotyped rSNPs, 100-4 = 96 total nSNPs are also genotyped in the design.</p><sec><title>Comparison of raw and standardized importance scores</title><p>Random forests version 5 software [<xref ref-type="bibr" rid="B29">29</xref>] produces both raw (<italic>I</italic><sub><italic>T</italic></sub>) and standardized (<italic>Z</italic><sub><italic>T</italic></sub>) variable importance scores (see Methods section for definitions of the scores). Little is known about the properties of importance indices under different distributions of the predictor variables. We use simulation to investigate their properties in the context of discrete predictors such as genetic polymorphisms conferring susceptibility to a complex trait.</p><p>We first compared the raw and standardized scores, in order to determine whether one might outperform the other in screening. We considered a K4S2N100 analysis design for each genetic model described in Table <xref ref-type="table" rid="T1">1</xref>. <italic>I</italic><sub><italic>T </italic></sub>and <italic>Z</italic><sub>T </sub>are highly correlated; the average correlation coefficient over 100 replicate data sets ranged from .93 (H8M4) to &#x0003e;.99 (H2M2 and H4M2) (Table <xref ref-type="table" rid="T2">2</xref>). The average correlation between the ranks based on <italic>I</italic><sub><italic>T </italic></sub>and <italic>Z</italic><sub><italic>T </italic></sub>for the 100 SNPs over the 100 replicate data sets was 0.98 for each of the six models (Table <xref ref-type="table" rid="T2">2</xref>). Comparing the ranks of the four rSNPs among all SNPs, neither importance measure outperforms the other for all models (Table <xref ref-type="table" rid="T3">3</xref>). The mean ranks of the rSNPs for the two measures are significantly different only for the H16M2 and H8M4 models. For H16M2, the average rank of the rSNPs is higher for <italic>Z</italic><sub><italic>T </italic></sub>than for <italic>I</italic><sub><italic>T</italic></sub>. The opposite is true for H8M4 (see Table <xref ref-type="table" rid="T3">3</xref>).</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Summary of the correlation between <italic>I</italic><sub><italic>T </italic></sub>and <italic>Z</italic><sub><italic>T </italic></sub>("raw") and rank(<italic>I</italic><sub><italic>T</italic></sub>) and rank(<italic>Z</italic><sub><italic>T</italic></sub>) ("rank") for four rSNPs and 96 nSNPs over 100 replicate data sets: K4S2N100 analysis design.</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="2">H2M2</td><td align="center" colspan="2">H4M2</td><td align="center" colspan="2">H8M2</td><td align="center" colspan="2">H4M4</td><td align="center" colspan="2">H16M2</td><td align="center" colspan="2">H8M4</td></tr><tr><td align="left"><italic>r</italic><sup>2</sup></td><td align="center">raw</td><td align="center">rank</td><td align="center">raw</td><td align="center">rank</td><td align="center">raw</td><td align="center">rank</td><td align="center">raw</td><td align="center">rank</td><td align="center">raw</td><td align="center">rank</td><td align="center">raw</td><td align="center">rank</td></tr></thead><tbody><tr><td align="left">Mean</td><td align="center">0.996</td><td align="center">0.983</td><td align="center">0.990</td><td align="center">0.982</td><td align="center">0.975</td><td align="center">0.982</td><td align="center">0.957</td><td align="center">0.982</td><td align="center">0.964</td><td align="center">0.982</td><td align="center">0.933</td><td align="center">0.982</td></tr><tr><td align="left">SD</td><td align="center">0.001</td><td align="center">0.006</td><td align="center">0.003</td><td align="center">0.006</td><td align="center">0.009</td><td align="center">0.006</td><td align="center">0.013</td><td align="center">0.007</td><td align="center">0.013</td><td align="center">0.006</td><td align="center">0.018</td><td align="center">0.007</td></tr><tr><td align="left">Min</td><td align="center">0.990</td><td align="center">0.963</td><td align="center">0.980</td><td align="center">0.957</td><td align="center">0.941</td><td align="center">0.960</td><td align="center">0.921</td><td align="center">0.955</td><td align="center">0.926</td><td align="center">0.962</td><td align="center">0.891</td><td align="center">0.953</td></tr><tr><td align="left">Max</td><td align="center">0.998</td><td align="center">0.993</td><td align="center">0.996</td><td align="center">0.992</td><td align="center">0.989</td><td align="center">0.993</td><td align="center">0.984</td><td align="center">0.992</td><td align="center">0.983</td><td align="center">0.994</td><td align="center">0.970</td><td align="center">0.992</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Comparison of ranks based on <italic>Z</italic><sub><italic>T </italic></sub>and <italic>I</italic><sub><italic>T </italic></sub>for the four rSNPs over 100 replicate data sets: K4S2N100 analysis design.</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="2">H2M2</td><td align="center" colspan="2">H4M2</td><td align="center" colspan="2">H8M2</td><td align="center" colspan="2">H4M4</td><td align="center" colspan="2">H16M2</td><td align="center" colspan="2">H8M4</td></tr><tr><td align="left">Rank:</td><td align="center"><italic>Z</italic><sub><italic>T</italic></sub></td><td align="center"><italic>I</italic><sub><italic>T</italic></sub></td><td align="center"><italic>Z</italic><sub><italic>T</italic></sub></td><td align="center"><italic>I</italic><sub><italic>T</italic></sub></td><td align="center"><italic>Z</italic><sub><italic>T</italic></sub></td><td align="center"><italic>I</italic><sub><italic>T</italic></sub></td><td align="center"><italic>Z</italic><sub><italic>T</italic></sub></td><td align="center"><italic>I</italic><sub><italic>T</italic></sub></td><td align="center"><italic>Z</italic><sub><italic>T</italic></sub></td><td align="center"><italic>I</italic><sub><italic>T</italic></sub></td><td align="center"><italic>Z</italic><sub><italic>T</italic></sub></td><td align="center"><italic>I</italic><sub><italic>T</italic></sub></td></tr></thead><tbody><tr><td align="left">Mean</td><td align="center">2.5</td><td align="center">2.5</td><td align="center">2.5</td><td align="center">2.5</td><td align="center">2.51</td><td align="center">2.52</td><td align="center">2.64</td><td align="center">2.61</td><td align="center">5.16</td><td align="center">5.94</td><td align="center">9.35</td><td align="center">8.69</td></tr><tr><td align="left">SD</td><td align="center">1.12</td><td align="center">1.12</td><td align="center">1.12</td><td align="center">1.12</td><td align="center">1.13</td><td align="center">1.16</td><td align="center">1.74</td><td align="center">1.62</td><td align="center">8.06</td><td align="center">8.33</td><td align="center">13.67</td><td align="center">13.9</td></tr><tr><td align="left">Max</td><td align="center">4</td><td align="center">4</td><td align="center">4</td><td align="center">4</td><td align="center">6</td><td align="center">8</td><td align="center">23</td><td align="center">21.5</td><td align="center">77</td><td align="center">62.5</td><td align="center">83</td><td align="center">88.5</td></tr><tr><td align="left">p-value*</td><td align="center" colspan="2">0.94</td><td align="center" colspan="2">1.00</td><td align="center" colspan="2">0.77</td><td align="center" colspan="2">0.12</td><td align="center" colspan="2">1.32E-20</td><td align="center" colspan="2">2.91E-12</td></tr></tbody></table><table-wrap-foot><p>*p-value for the Wilcoxon signed-rank test comparing the rSNP ranks based on <italic>I</italic><sub><italic>T </italic></sub>and <italic>Z</italic><sub><italic>T</italic></sub></p></table-wrap-foot></table-wrap></sec><sec><title>Ranking SNPs based on Z<sub>T </sub>and Fisher p-value</title><p>We next compared the ranking of rSNPs by importance score (Z<sub>T</sub>) to ranking by Fisher Exact test p-value using K4S2N100 and K4S2N1000 analysis designs, where two SNPs from each of the first two interaction systems are in the analysis. Figure <xref ref-type="fig" rid="F1">1</xref> shows the proportion of replicates for which the top ranked 1, top 2, top 3, and top 4 SNPs are the four genotyped rSNPs in the data set for each of the four most complex genetic models. For N100, the random forest Z<sub>T </sub>criterion ranks the four rSNPs as the most significant SNPs more often than the univariate Fisher Exact test association p-value under all genetic models. The difference between the random forest and association p-value ranking is less extreme for N1000. For the H8M4 genetic model, the results do not suggest that one ranking system is better than the other overall. Figure <xref ref-type="fig" rid="F2">2</xref> shows the proportion of replicates for which all rSNPs are among the top N SNPs. In other words, it is the proportion of data sets for which none of the genotyped rSNPs are screened out, if the top ranking N SNPs are chosen for further study. For N100, a consistently higher proportion of replicates ranked using Z<sub>T </sub>contain all of the rSNPs. Thus, for a given probability of retaining all of the rSNPs, more SNPs can be eliminated using the Z<sub>T </sub>criterion than the Fisher exact test p-value. For example, for model H16M2, only 15 SNPs must be retained to have 80% probability that the 4 rSNPs are in the retained set, while 44 SNPs must be retained if the p-value criterion is used. The difference is less dramatic for H8M4: 37 SNPs give 80% probability that the four genotyped rSNPs are in the retained set for the Z<sub>T </sub>criterion, compared to 43 for the p-value criterion. For N1000, the advantage of the Z<sub>T </sub>criterion is clear for the H8M2 and H16M2 models. For H4M4, the advantage of Z<sub>T </sub>is minor, while for H8M4, ranking by Z<sub>T </sub>appears to give poorer results than the p-value criterion for the higher cutoff values of N. A second interpretation of Figure <xref ref-type="fig" rid="F2">2</xref> is that, for any number of retained (not screened-out) SNPs, the probability that all of the genotyped rSNPs are retained is higher for the Z<sub>T </sub>criterion than for the univariate p-value criterion for all but the H8M4 model with 1000 total SNPs.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Proportion of replicates for which the most significant 1, 2, 3, and 4 SNPs are all rSNPs for K4S2N100 and K4S2N1000 analysis designs. Genetic models are listed on the plots. "RF" and "Fisher" refer to the random forest importance index Z<sub>T </sub>and the Fisher Exact test p-value. See text for notation description.</p></caption><graphic xlink:href="1471-2156-5-32-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p>Proportion of replicates for which all rSNPs are among the top-ranking N SNPs for K4S2N100 and K4S2N1000 analysis designs. Other notation as in Figure 1.</p></caption><graphic xlink:href="1471-2156-5-32-2"/></fig><p>Noticing that the analyses with all SNPs from an interacting system (e.g., the H16M2K4S2 simulations) had a more substantial improvement in ranking using Z<sub>T </sub>over p-value than the analyses with subsets of SNPs from an interacting system, we hypothesized that the interactions among the pairs of analyzed rSNPs influenced the improved ranking performance of the random forests over the univariate tests. To confirm this, we used the H8M4 genetic model and analyzed the data in the following manner. For a constant number of analyzed rSNPs included in the model (K = 4, 8, or 16) and a constant 96 nSNPs, we looked at the effect of increasing S, the number of rSNPs from each interaction system that were genotyped. Thus, for K8S1, along with 96 nSNPs, one SNP from each of the first 8 systems was included in the analysis, while for K8S4, all four SNPs in the first two systems were included in the analysis. For K8S3, three SNPs from the first two systems, and one from the third were included. Assuming that the random forest analysis was taking advantage of the interactions among the rSNPs, and that this was responsible for the improved performance of the random forests over the univariate tests, we expected the Fisher p-values and random forest importance Z<sub>T </sub>to perform similarly when only a single rSNP was genotyped from each system, and the random forests to perform increasingly better than the univariate Fisher tests as S increased from 1 to 4. Figures <xref ref-type="fig" rid="F3">3</xref> and <xref ref-type="fig" rid="F4">4</xref> show the results, which are consistent with this hypothesis. For the Fisher p-values, the proportion of replicates for which the N most significant SNPs were rSNPs is similar for each S. For the random forest importance Z<sub>T</sub>, the S = 1 analyses for each K were similar to the Fisher results, while for each increase in S, the proportion of replicates for which the N most significant SNPs were rSNPs increases (Figure <xref ref-type="fig" rid="F3">3</xref>) and the proportion of replicates for which all rSNPs are present at any cutoff point increases (Figure <xref ref-type="fig" rid="F4">4</xref>). The differences can be substantial: for the H8M4 model, with K = 4 rSNPs in the analysis, the number of most significant SNPs required to have 80% probability that all four rSNPs are included is 50, 34, 22, and 5, respectively for S1, S2, S2, and S4. We conclude that for a given number of rSNPs within a set of potential predictors, the more interacting SNPs there are, and the larger the groups of SNPs that interact, the greater the performance increase of the random forest analysis as compared to a univariate analysis.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>Proportion of replicates for which the most significant N SNPs are all rSNPs. H8M4 genetic model. Analysis designs include 96 noise SNPs; K and S are listed on the plots. Other notation as in Figure 1.</p></caption><graphic xlink:href="1471-2156-5-32-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p>Proportion of replicates for which all rSNPs are among the top-ranking N SNPs for H8M4 genetic model. Analysis designs include 96 noise SNPs; K and S are listed on the plots.</p></caption><graphic xlink:href="1471-2156-5-32-4"/></fig></sec><sec><title>Magnitude of difference</title><p>Beyond simply ranking SNPs, we may wish to use the magnitude of the difference in importance or p-value to determine which subset of top-ranked SNPs should be prioritized for further study. Thus, particularly for the cases where the rSNPs are among the top-ranked SNPs, we want to determine not just that Z<sub>T </sub>ranks interacting rSNPs higher than the univariate test, but also that the differences in rank correspond to differences in magnitude of Z<sub>T </sub>that are meaningful. In other words, we want to know how much "better" in terms of Z<sub>T </sub>(or p-value) the rSNPs are than the nSNPs. Toward this goal, we computed the difference between the importance Z<sub>T </sub>of the top ranked rSNP and the top ranked nSNP:</p><p>D<sub>max</sub>(Z<sub>T</sub>) = max<sub><italic>rSNP</italic></sub>(<italic>Z</italic><sub><italic>T</italic></sub>) - max<sub><italic>nSNP</italic></sub>(<italic>Z</italic><sub><italic>T</italic></sub>),</p><p>as well as the lowest ranked rSNP and the top ranked nSNP:</p><p>D<sub>min</sub>(Z<sub>T</sub>) = min<sub><italic>rSNP</italic></sub>(<italic>Z</italic><sub><italic>T</italic></sub>) - max<sub><italic>nSNP</italic></sub>(<italic>Z</italic><sub><italic>T</italic></sub>).</p><p>Thus, D<sub>min</sub>(Z<sub>T</sub>) is positive when the lowest ranked rSNP is larger than the highest ranked nSNP, and negative when the lowest ranked rSNP is smaller than the highest ranked nSNP.</p><p>We computed the analogous quantities, D<sub>max</sub>(-log p) and D<sub>min</sub>(-log p), for the -log<sub>10 </sub>transformed Fisher Exact test p-values. In Figure <xref ref-type="fig" rid="F5">5</xref>, we have plotted box plots of these differences for several models using analysis designs K4S2N100 and K4S2N1000. P-values for a paired T-test of whether the mean difference is equal to 0 are also placed on the plot. For H8M2, the lowest ranking rSNP has Z<sub>T </sub>that is significantly higher than the highest ranking nSNP for both N100 and N1000, while the difference in -log10(p) is not significantly different from 0 for N100, and is significantly less than 0 for N1000. These plots illustrate that the positive differences are typically more extreme for Z<sub>T </sub>than for -log p, and that the negative differences are less extreme.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>Distribution of difference in importance ZT between the top ranked rSNP and the top ranked nSNP (Dmax(ZT), and lowest ranked rSNP (Dmin(ZT)) and top ranked nSNP. Dmax(-log p) and Dmin(-log p): differences using -log10 p-value from the Fisher exact test. Beside each boxplot is the p-value for the test of whether the mean difference over the 100 replicates is significantly different from 0. Genetic models listed in plot. Analysis design: K4S2, with N100 and N1000 shown on plot.</p></caption><graphic xlink:href="1471-2156-5-32-5"/></fig></sec></sec></sec><sec><title>Discussion</title><p>A key advantage of the random forest approach is that the investigator does not have to propose a model of any kind. This is important in an initial genome-wide or candidate region association study, where little is known about the genetic architecture of the trait. If interactions among SNPs exist, they will be exploited within the trees, and the variable importance scores will reflect the interactions. Therefore, we expect that when unknown interactions between true risk SNPs exist, the random forest approach to screening large numbers of SNPs will outperform a univariate ranking method in finding the risk SNPs among a large number of irrelevant SNPs. Our genetic models for simulation feature both multiplicative interaction and genetic heterogeneity. The multiplicative interaction results in a marginal effect in the population, the size of which is dependent on many factors, including the amount of heterogeneity. Thus, we have highlighted models in which univariate tests still have power, and shown that the random forest analysis can outperform these tests for selecting subsets of SNPs for further study. For models with genetic heterogeneity and interactions resulting in no main effect, similar to the models described by Ritchie et al. [<xref ref-type="bibr" rid="B10">10</xref>], the performance of random forests compares considerably more favorably to univariate tests (data not shown), since the univariate tests have no power when main effects are absent. Further investigation of how to determine a cutoff for SNPs to keep for further analysis is needed. Unfortunately, this task is likely to be strongly dependent on information that is impossible for an investigator to know <italic>a priori</italic>, such as the underlying genetic model and the ratio of associated risk SNPs to noise SNPs in an analysis.</p><p>Our results from analyses with four risk SNPs among 1000 SNPs suggest that even when a high proportion of the analyzed SNPs are unassociated, a random forest can rank interacting SNPs considerably higher than a univariate test, and that the proportional difference in importance between the risk SNPs and the best of the noise SNPs can be larger on average for a random forest. In our scale-up from 100 to 1000 total SNPs, we kept the number of risk SNPs constant. In practice, as we increase the number of SNPs genotyped, we expect that we will also increase the number of risk SNPs (or SNPs in linkage disequilibrium with risk SNPs) that are captured in an analysis. Thus, as a larger and large proportion of the genome or candidate region is captured by a scan, the more likely we will be to have all or most of sets of SNPs that interact, and thus the more likely we are to be in situations where random forest screening will outperform univariate screening of SNP data.</p><p>It is important to consider the tuning parameters for such analyses. Consistent with the recommendations made by Breiman and Cutler [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B29">29</xref>], the number of variables randomly selected at each split seems to have minimal effect over a wide range of values surrounding the square root of the number of covariates (SNPs). Breiman and Cutler do not recommend a method to determine the number of trees necessary for an analysis. The documentation examples typically use on the order of 100&#x02013;1000 trees, but these examples are primarily in the context of prediction, without computing estimates of variable importance. In our experience with the simulated data sets presented here, in which the truly associated covariates are outnumbered considerably by those that are noise, multiple thousands of trees must be used in order to get stable estimates of the variable importance. In practice, we recommend building several forests for a data set with a given number of trees. If the ranking of variables by importance does not change significantly from forest to forest, then the number of trees is adequate.</p><p>We have examined the use of random forests in the context of association studies for complex disease with uncorrelated SNP predictors. Random forests can also be used when predictors are correlated, as is the case with multiple SNPs in linkage disequilibrium within a small genetic region. For any analysis procedure, the more highly correlated variables are, the more they can serve as surrogates for each other, weakening the evidence for association for any one of the correlated variables to the outcome. In a random forest analysis, limited simulations suggest that correlated variables lead to diminished variable importance for each correlated risk SNP (data not shown). One way to limit the problems presented by SNPs in linkage disequilibrium is to use haplotypes instead of SNPs as predictor variables in a random forest. Future challenges include quantifying more completely the effect of linkage disequilibrium among SNPs submitted to a random forest analysis, and developing random forests in the context of haplotypes.</p></sec><sec><title>Conclusions</title><p>With the increasing size of association studies, two-stage analyses, in which in the first stage a subset of the loci are retained for further analyses, are becoming more common. The most frequently voiced concern for these analyses is that variables that interact to increase disease risk but have minimal main effects in the population will be missed. Random forest analyses address this concern by presenting a summary importance of each SNP that takes into account its interactions with other SNPs. Current implementations of random forests can accommodate up to one thousand of SNPs in one analysis with the computation of importance. Further, there is no reason to restrict the input variables to SNPs. Potential environmental covariates can also be easily accommodated, allowing for SNPs with no strong main effect, but environmental interactions, to be distinguished from unassociated SNPs. We have shown that when unknown interactions among SNPs exist in a data set consisting of hundreds to thousands of SNPs, random forest analysis can be significantly more efficient than standard univariate screening methods in ranking the true disease-associated SNPs highly. After identifying the top-ranked SNPs and other variables, and weeding out those unlikely to be associated with the phenotype, more thorough statistical analyses, including model building procedures, can be performed.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Variable importance</title><p>Rather than selecting variables for modeling, a random forest uses all available covariates to predict response. Here, we use measures of variable importance to determine which covariates (SNPs, in our case) or sets of covariates are important in the prediction. Breiman [<xref ref-type="bibr" rid="B22">22</xref>] proposed to quantify the importance of a predictor variable by disrupting the dependence between the variable and the response and measuring the change in the tree votes compared to the original observations. In practice, this is achieved by permuting the variable values among all observations in the out-of-bag sample of each tree. If the variable is predictive of the response, it will be present in a large proportion of trees and be near the root of those trees. Observations with a changed variable value may be directed to the wrong side of the tree, leading to vote changes from the right to the wrong class. Conversely, if the variable is not related to the response, it will be present in few trees and, when present, it will be near a terminal node, so that few tree votes will be changed. In Random Forests (version 5) Breiman and Cutler [<xref ref-type="bibr" rid="B29">29</xref>] define the importance index as follows. For individual i, let <bold>X</bold><sub>i </sub>represent the vector of predictor variable values, y<sub>i </sub>its true class, V<sub>j</sub>(<bold>X</bold><sub>i</sub>) the vote of tree j and t<sub>ij </sub>an indicator taking value 1 when individual i is out-of-bag for tree j and 0 otherwise. Let <bold>X</bold><sup>(A,j) </sup>= (<bold>X</bold><sub>1</sub><sup>(A,j)</sup>,..., <bold>X</bold><sub>N</sub><sup>(A,j)</sup>) represent the vector of predictor variables with the value of variable <bold>A </bold>randomly permuted among the out-of-bag observations for tree j, and <bold>X</bold><sup>(A) </sup>the collection of <bold>X</bold><sup>(A,j) </sup>for all trees where N is the total number of individuals in the sample. Letting 1(C) denote the indicator function taking value 1 when the condition C is true and 0 otherwise, the importance index averages over the trees of the forest, and is defined as:</p><p><inline-graphic xlink:href="1471-2156-5-32-i1.gif"/></p><p>where <italic>N</italic><sub><italic>j </italic></sub>represents the number of out-of-bag individuals for tree j and T is the total number of trees.</p><p>The importance index can be standardized by dividing by a standard error derived from the between-tree variance of the raw index <italic>I</italic><sub><italic>T</italic></sub>, <inline-graphic xlink:href="1471-2156-5-32-i2.gif"/>. The standardized index is defined as:</p><p><inline-graphic xlink:href="1471-2156-5-32-i3.gif"/></p><p>The variance <inline-graphic xlink:href="1471-2156-5-32-i2.gif"/> represents the tree to tree variance of <italic>I</italic><sub><italic>T</italic></sub>, rather than the variance of <italic>I</italic><sub><italic>T </italic></sub>due to the sampling of the individuals from a population: the magnitude of <italic>Z</italic><sub><italic>T </italic></sub>increases with the number of trees in the forest, and the number of trees is limited only by computing time. Thus, this standardized index cannot be treated as a Z-score in the traditional sense.</p></sec><sec><title>Simulation models and methods</title><p>For simplicity, assume each locus has the same effect, and let (q<sub>0</sub>, q<sub>1</sub>, q<sub>2</sub>) represent the penetrance factors for 0, 1, or 2 risk alleles for an individual locus in a given model. Let G = {g<sub>11</sub>, g<sub>12</sub>, . ., g<sub>HM</sub>} be the multilocus genotype for an individual, where g<sub>hm</sub>(=0, 1, 2 risk alleles) indicates the individual's genotype at locus m (=1, . ., M) of heterogeneity system h (=1, . ., H). Then the penetrance for genotype G is defined as:</p><p><inline-graphic xlink:href="1471-2156-5-32-i4.gif"/></p><p>For example, for model H2M2, an individual with genotype G = {0101} would have penetrance <italic>P</italic><sub><italic>G </italic></sub>= 1 - (1 - <italic>q</italic><sub>0</sub><italic>q</italic><sub>1</sub>)<sup>2 </sup>= 2<italic>q</italic><sub>0</sub><italic>q</italic><sub>1 </sub>- (<italic>q</italic><sub>0</sub><italic>q</italic><sub>1</sub>)<sup>2</sup>.</p><p>The penetrance factors (q<sub>0</sub>, q<sub>1</sub>, q<sub>2</sub>) and risk allele frequencies, as well as other features of our genetic models, are listed in Table <xref ref-type="table" rid="T1">1</xref>. For a given model type, such as H4M4, and a given <italic>&#x003bb;</italic><sub>s </sub>and <italic>K</italic><sub><italic>p</italic></sub>, there is a unique allele frequency when we make the assumption that each SNP subunit has equal effect (the given penetrance factor vector) in the population. We chose penetrance factors such that the risk alleles at each locus for the H2M2, H4M2, H8M2, and H16M2 models are approximately additive in effect on the penetrance factor scale. For H4M4 and H8M4, we chose penetrance factor vectors such that the risk alleles show a moderate degree of dominance.</p><p>The marginal genotype relative risks (GRRs) listed in Table <xref ref-type="table" rid="T1">1</xref> are the relative penetrances for heterozygote and homozygote carriers of each risk allele, as compared to non-carriers in the population, which would be observed if only a single rSNP were considered at a time. Thus, this is a measure of the observed effect size of each of the rSNPs in the population. The marginal GRRs are modest, in line with what might be expected when there are a large number of small effects contributing to a complex phenotype. For cases, the genotypes for pairs/quartets of SNPs within an interacting system are positively correlated, while SNPs from distinct systems are negatively correlated. The magnitude of the correlations decreases with increasing number of heterogeneity systems and increasing number of equal-effect SNPs interacting within each system.</p></sec><sec><title>Analysis</title><p>All analyses were performed on 100 replicate data sets of 500 cases and 500 controls. We treated the SNPs as ordinal predictors. Random forests have one primary tuning parameter: "mtry" the number of randomly picked covariates to choose among for each split. The Random Forest v5 manual [<xref ref-type="bibr" rid="B29">29</xref>] recommends trying the square root of the number of predictors, along with values smaller and larger than the square root, and choosing the value that minimizes the out of bag prediction error rate. We considered both the prediction error and the stability of the variable importance estimates when determining the values of mtry to use and the number of trees to grow. We found that the prediction error rate was very stable over a wide range of mtry for the number of trees we required for consistent measures of importance. We analyzed each replicate data set with 4&#x02013;16 rSNPs and 96 nSNPs using a random forest of 5000 trees, choosing the best split from among a different randomly-selected set of 35 SNPs at each node (mtry = 35). On average, each replicate data set with 100 total SNPs took 40 minutes to complete on a 2.6 Ghz Intel Xeon processor. For data sets with 4 rSNPs and 996 nSNPs (1000 SNPs total), we used 15000 trees, and chose from among 125 SNPs at each node (mtry = 125). Analysis of each replicate of these data sets took 123 minutes on average. User time could potentially be substantially decreased by parallel-processing: trees could be grown on separate nodes, and combined for analysis of importance. However, parallel tree-building is not yet available in the Random Forest progream. To compare the performance of random forests with that of a univariate, one-SNP-at-a-time approach, we tested for association between genotypes for each individual SNP and disease status using a Fisher Exact test [<xref ref-type="bibr" rid="B32">32</xref>].</p></sec><sec><title>Ranking of rSNPs</title><p>The random forest analysis produces the raw and standardized importance indices (<italic>I</italic><sub><italic>T</italic></sub>, <italic>Z</italic><sub><italic>T</italic></sub>,), which can be used to rank order the importance of SNPs much as p-values from association tests are used. Using either method, the ranking of the SNPs in an analysis can be used to prioritize which sets of SNPs (or genome regions) should be followed up with further genotyping and/or additional analyses. We use the convention that a rank of 1 is the highest ranking SNP.</p><p>We compare the ranking of the raw and standardized importance measures, and further compare these with the rank based on p-values from a test of association, the Fisher Exact test, to determine whether the random forest can better discriminate susceptibility SNPs from SNPs unrelated to disease status when there is interaction and heterogeneity among and between SNPs.</p></sec></sec><sec><title>Authors' contributions</title><p>KLL conceived of and led the design of the study, coordinated all phases of simulation and analysis, and drafted the manuscript. LBH and JS automated the simulation and random forest analysis procedures, and participated in the design and analysis of study results. PVE added critical insight to the development of the genetic models and participated in the interpretation of study results. All authors provided comments on a draft manuscript and read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgments</title><p>We thank Kathleen Falls for her help with earlier versions of this work.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>George</surname><given-names>EI</given-names></name><name><surname>McCulloch</surname><given-names>RE</given-names></name></person-group><article-title>Variable Selection via Gibbs Sampling</article-title><source>Journal of the American Statistical Association</source><year>1993</year><volume>88</volume><fpage>881</fpage><lpage>889</lpage></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Oh</surname><given-names>C</given-names></name><name><surname>Ye</surname><given-names>KQ</given-names></name><name><surname>He</surname><given-names>Q</given-names></name><name><surname>Mendell</surname><given-names>NR</given-names></name></person-group><article-title>Locating disease genes using Bayesian variable selection with the Haseman-Elston method</article-title><source>BMC Genet</source><year>2003</year><volume>4</volume><fpage>S69</fpage><pub-id pub-id-type="pmid">14975137</pub-id><pub-id pub-id-type="doi">10.1186/1471-2156-4-S1-S69</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Suh</surname><given-names>YJ</given-names></name><name><surname>Ye</surname><given-names>KQ</given-names></name><name><surname>Mendell</surname><given-names>NR</given-names></name></person-group><article-title>A method for evaluating the results of Bayesian model selection: application to linkage analyses of attributes determined by two or more genes.</article-title><source>Hum Hered</source><year>2003</year><volume>55</volume><fpage>147</fpage><lpage>152</lpage><pub-id pub-id-type="pmid">12931054</pub-id><pub-id pub-id-type="doi">10.1159/000072320</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yi</surname><given-names>N</given-names></name><name><surname>George</surname><given-names>V</given-names></name><name><surname>Allison</surname><given-names>DB</given-names></name></person-group><article-title>Stochastic search variable selection for identifying multiple quantitative trait loci.</article-title><source>Genetics</source><year>2003</year><volume>164</volume><fpage>1129</fpage><lpage>1138</lpage><pub-id pub-id-type="pmid">12871920</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>York</surname><given-names>TP</given-names></name><name><surname>Eaves</surname><given-names>LJ</given-names></name></person-group><article-title>Common disease analysis using Multivariate Adaptive Regression Splines (MARS): Genetic Analysis Workshop 12 simulated sequence data</article-title><source>Genet Epidemiol</source><year>2001</year><volume>21 Suppl 1</volume><fpage>S649</fpage><lpage>54</lpage><pub-id pub-id-type="pmid">11793755</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>NR</given-names></name><name><surname>Zee</surname><given-names>RY</given-names></name><name><surname>Ridker</surname><given-names>PM</given-names></name></person-group><article-title>Tree and spline based association analysis of gene-gene interaction models for ischemic stroke</article-title><source>Stat Med</source><year>2004</year><volume>23</volume><fpage>1439</fpage><lpage>1453</lpage><pub-id pub-id-type="pmid">15116352</pub-id><pub-id pub-id-type="doi">10.1002/sim.1749</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>MR</given-names></name><name><surname>Kardia</surname><given-names>SL</given-names></name><name><surname>Ferrell</surname><given-names>RE</given-names></name><name><surname>Sing</surname><given-names>CF</given-names></name></person-group><article-title>A combinatorial partitioning method to identify multilocus genotypic partitions that predict quantitative trait variation</article-title><source>Genome Res</source><year>2001</year><volume>11</volume><fpage>458</fpage><lpage>470</lpage><pub-id pub-id-type="pmid">11230170</pub-id><pub-id pub-id-type="doi">10.1101/gr.172901</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>MD</given-names></name><name><surname>Hahn</surname><given-names>LW</given-names></name><name><surname>Roodi</surname><given-names>N</given-names></name><name><surname>Bailey</surname><given-names>LR</given-names></name><name><surname>Dupont</surname><given-names>WD</given-names></name><name><surname>Parl</surname><given-names>FF</given-names></name><name><surname>Moore</surname><given-names>JH</given-names></name></person-group><article-title>Multifactor-dimensionality reduction reveals high-order interactions among estrogen-metabolism genes in sporadic breast cancer</article-title><source>Am J Hum Genet</source><year>2001</year><volume>69</volume><fpage>138</fpage><lpage>147</lpage><pub-id pub-id-type="pmid">11404819</pub-id><pub-id pub-id-type="doi">10.1086/321276</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hahn</surname><given-names>LW</given-names></name><name><surname>Ritchie</surname><given-names>MD</given-names></name><name><surname>Moore</surname><given-names>JH</given-names></name></person-group><article-title>Multifactor dimensionality reduction software for detecting gene-gene and gene-environment interactions</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>376</fpage><lpage>382</lpage><pub-id pub-id-type="pmid">12584123</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btf869</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>MD</given-names></name><name><surname>Hahn</surname><given-names>LW</given-names></name><name><surname>Moore</surname><given-names>JH</given-names></name></person-group><article-title>Power of multifactor dimensionality reduction for detecting gene-gene interactions in the presence of genotyping error, missing data, phenocopy, and genetic heterogeneity</article-title><source>Genet Epidemiol</source><year>2003</year><volume>24</volume><fpage>150</fpage><lpage>157</lpage><pub-id pub-id-type="pmid">12548676</pub-id><pub-id pub-id-type="doi">10.1002/gepi.10218</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Province</surname><given-names>MA</given-names></name><name><surname>Shannon</surname><given-names>WD</given-names></name><name><surname>Rao</surname><given-names>DC</given-names></name></person-group><article-title>Classification methods for confronting heterogeneity</article-title><source>Adv Genet</source><year>2001</year><volume>42</volume><fpage>273</fpage><lpage>286</lpage><pub-id pub-id-type="pmid">11037327</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Levy-Lahad</surname><given-names>E</given-names></name><name><surname>Catane</surname><given-names>R</given-names></name><name><surname>Eisenberg</surname><given-names>S</given-names></name><name><surname>Kaufman</surname><given-names>B</given-names></name><name><surname>Hornreich</surname><given-names>G</given-names></name><name><surname>Lishinsky</surname><given-names>E</given-names></name><name><surname>Shohat</surname><given-names>M</given-names></name><name><surname>Weber</surname><given-names>BL</given-names></name><name><surname>Beller</surname><given-names>U</given-names></name><name><surname>Lahad</surname><given-names>A</given-names></name><name><surname>Halle</surname><given-names>D</given-names></name></person-group><article-title>Founder BRCA1 and BRCA2 mutations in Ashkenazi Jews in Israel: frequency and differential penetrance in ovarian cancer and in breast-ovarian cancer families</article-title><source>Am J Hum Genet</source><year>1997</year><volume>60</volume><fpage>1059</fpage><lpage>1067</lpage><pub-id pub-id-type="pmid">9150153</pub-id></citation></ref><ref id="B13"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Hastie</surname><given-names>T</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Friedman</surname><given-names>JH</given-names></name></person-group><article-title>The elements of statistical learning : data mining, inference, and prediction</article-title><source>Springer series in statistics</source><year>2001</year><publisher-name>New York , Springer</publisher-name><fpage>xvi, 533</fpage></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Costello</surname><given-names>TJ</given-names></name><name><surname>Swartz</surname><given-names>MD</given-names></name><name><surname>Sabripour</surname><given-names>M</given-names></name><name><surname>Gu</surname><given-names>X</given-names></name><name><surname>Sharma</surname><given-names>R</given-names></name><name><surname>Etzel</surname><given-names>CJ</given-names></name></person-group><article-title>Use of tree-based models to identify subgroups and increase power to detect linkage to cardiovascular disease traits</article-title><source>BMC Genet</source><year>2003</year><volume>4 Suppl 1</volume><fpage>S66</fpage><pub-id pub-id-type="pmid">14975134</pub-id><pub-id pub-id-type="doi">10.1186/1471-2156-4-S1-S66</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shannon</surname><given-names>WD</given-names></name><name><surname>Province</surname><given-names>MA</given-names></name><name><surname>Rao</surname><given-names>DC</given-names></name></person-group><article-title>Tree-based recursive partitioning methods for subdividing sibpairs into relatively more homogeneous subgroups</article-title><source>Genet Epidemiol</source><year>2001</year><volume>20</volume><fpage>293</fpage><lpage>306</lpage><pub-id pub-id-type="pmid">11255239</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Bonney</surname><given-names>G</given-names></name></person-group><article-title>Use of classification trees for association studies</article-title><source>Genet Epidemiol</source><year>2000</year><volume>19</volume><fpage>323</fpage><lpage>332</lpage><pub-id pub-id-type="pmid">11108642</pub-id><pub-id pub-id-type="doi">10.1002/1098-2272(200012)19:4&#x0003c;323::AID-GEPI4&#x0003e;3.0.CO;2-5</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Tsai</surname><given-names>CP</given-names></name><name><surname>Yu</surname><given-names>CY</given-names></name><name><surname>Bonney</surname><given-names>G</given-names></name></person-group><article-title>Tree-based linkage and association analyses of asthma</article-title><source>Genet Epidemiol</source><year>2001</year><volume>21 Suppl 1</volume><fpage>S317</fpage><lpage>22</lpage><pub-id pub-id-type="pmid">11793691</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kooperberg</surname><given-names>C</given-names></name><name><surname>Ruczinski</surname><given-names>I</given-names></name><name><surname>LeBlanc</surname><given-names>ML</given-names></name><name><surname>Hsu</surname><given-names>L</given-names></name></person-group><article-title>Sequence analysis using logic regression</article-title><source>Genet Epidemiol</source><year>2001</year><volume>21 Suppl 1</volume><fpage>S626</fpage><lpage>31</lpage><pub-id pub-id-type="pmid">11793751</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>CJ</given-names></name><name><surname>Fann</surname><given-names>CS</given-names></name></person-group><article-title>Using data mining to address heterogeneity in the Southampton data</article-title><source>Genet Epidemiol</source><year>2001</year><volume>21 Suppl 1</volume><fpage>S180</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">11793666</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wilcox</surname><given-names>MA</given-names></name><name><surname>Smoller</surname><given-names>JW</given-names></name><name><surname>Lunetta</surname><given-names>KL</given-names></name><name><surname>Neuberg</surname><given-names>D</given-names></name></person-group><article-title>Using recursive partitioning for exploration and follow-up of linkage and association analyses</article-title><source>Genet Epidemiol</source><year>1999</year><volume>17 Suppl 1</volume><fpage>S391</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">10597468</pub-id></citation></ref><ref id="B21"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group><article-title>Classification and regression trees</article-title><source>The Wadsworth statistics/probability series</source><year>1984</year><publisher-name>Belmont, Calif. , Wadsworth International Group</publisher-name><fpage>358 p.</fpage></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group><article-title>Random Forests</article-title><source>Machine Learning</source><year>2001</year><volume>45</volume><fpage>5</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name></person-group><article-title>Bagging Predictors</article-title><source>Machine Learning</source><year>1996</year><volume>26</volume><fpage>123</fpage><lpage>140</lpage></citation></ref><ref id="B24"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Freund</surname><given-names>Y</given-names></name><name><surname>Schapire</surname><given-names>R</given-names></name></person-group><article-title>Experiments with a new boosting algorithm</article-title><source>Machine Learning: Proceedings of the Thirteenth International Conference</source><year>1996</year><fpage>148</fpage><lpage>156</lpage></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schapire</surname><given-names>R</given-names></name><name><surname>Freund</surname><given-names>Y</given-names></name><name><surname>Bartlett</surname><given-names>P</given-names></name><name><surname>Lee</surname><given-names>W</given-names></name></person-group><article-title>Boosting the margin:  A new explanation for the effectiveness of voting methods.</article-title><source>The Annals of Statisics</source><year>1998</year><volume>26</volume><fpage>1651</fpage><lpage>1686</lpage><pub-id pub-id-type="doi">10.1214/aos/1024691352</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bureau</surname><given-names>A</given-names></name><name><surname>Dupuis</surname><given-names>J</given-names></name><name><surname>Hayward</surname><given-names>B</given-names></name><name><surname>Falls</surname><given-names>K</given-names></name><name><surname>Van Eerdewegh</surname><given-names>P</given-names></name></person-group><article-title>Mapping complex traits using Random Forests</article-title><source>BMC Genet</source><year>2003</year><volume>4 Suppl 1</volume><fpage>S64</fpage><pub-id pub-id-type="pmid">14975132</pub-id><pub-id pub-id-type="doi">10.1186/1471-2156-4-S1-S64</pub-id></citation></ref><ref id="B27"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>Kraft</surname><given-names>P</given-names></name></person-group><article-title>Using Random Forests to Detect Covariate Interaction Effects in Case-Control Studies: Applications to Screening for Disease Genes</article-title><source>Joint Statistical Meetings</source><year>2003</year><volume>Abstract #301988</volume><publisher-name>San Francisco </publisher-name></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schwender</surname><given-names>H</given-names></name><name><surname>Zucknick</surname><given-names>M</given-names></name><name><surname>Ickstadt</surname><given-names>K</given-names></name><name><surname>Bolt</surname><given-names>HM</given-names></name><collab>The GENICA network</collab></person-group><article-title>A pilot study on the application of statistical classification procedures to molecular epidemiological data</article-title><source>Toxicol Lett</source><year>2004</year><volume>151.</volume><fpage>291</fpage><lpage>299</lpage><pub-id pub-id-type="pmid">15177665</pub-id><pub-id pub-id-type="doi">10.1016/j.toxlet.2004.02.021</pub-id></citation></ref><ref id="B29"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Breiman</surname><given-names>L</given-names></name><name><surname>Cutler</surname><given-names>A</given-names></name></person-group><source>Random Forests</source><year>2004</year><edition>Version 5</edition><ext-link ext-link-type="uri" xlink:href="http://stat-www.berkeley.edu/users/breiman/RandomForests/cc_home.htm"/></citation></ref><ref id="B30"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Farrer</surname><given-names>LA</given-names></name><name><surname>Cupples</surname><given-names>LA</given-names></name></person-group><person-group person-group-type="editor"><name><surname>L HJ, Pericak-Vance MA</surname></name></person-group><article-title>Determining the Genetic Component of a Disease</article-title><source>Approaches to Gene Mapping in Complex Disease</source><year>1998</year><publisher-name>New York , John Wiley and Sons</publisher-name><fpage>93</fpage><lpage>129</lpage></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Risch</surname><given-names>N</given-names></name></person-group><article-title>Linkage strategies for genetically complex traits. II. The power of affected relative pairs</article-title><source>Am J Hum Genet</source><year>1990</year><volume>46</volume><fpage>229</fpage><lpage>241</lpage><pub-id pub-id-type="pmid">2301393</pub-id></citation></ref><ref id="B32"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Agresti</surname><given-names>A</given-names></name></person-group><source>Categorical Data Analysis</source><year>1990</year><edition>1</edition><publisher-name>New York , John Wiley &#x00026; Sons</publisher-name><fpage>558</fpage></citation></ref></ref-list></back></article>



