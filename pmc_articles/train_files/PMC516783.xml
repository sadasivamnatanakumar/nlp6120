<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Biomed Eng Online</journal-id><journal-title>BioMedical Engineering OnLine</journal-title><issn pub-type="epub">1475-925X</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15333132</article-id><article-id pub-id-type="pmc">PMC516783</article-id><article-id pub-id-type="publisher-id">1475-925X-3-28</article-id><article-id pub-id-type="doi">10.1186/1475-925X-3-28</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Real time electrocardiogram QRS detection using combined adaptive threshold</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Christov</surname><given-names>Ivaylo I</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Ivaylo.Christov@clbme.bas.bg</email></contrib></contrib-group><aff id="I1"><label>1</label>Center of Biomedical Engineering, Bulgarian Academy of Sciences, Acad. G. Bonchev str., blok 105, 1113, Sofia, Bulgaria</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>27</day><month>8</month><year>2004</year></pub-date><volume>3</volume><fpage>28</fpage><lpage>28</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedical-engineering-online.com/content/3/1/28"/><history><date date-type="received"><day>4</day><month>6</month><year>2004</year></date><date date-type="accepted"><day>27</day><month>8</month><year>2004</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2004 Christov; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2004</copyright-year><copyright-holder>Christov; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Christov
               I
               Ivaylo
               
               Ivaylo.Christov@clbme.bas.bg
            </dc:author><dc:title>
            Real time electrocardiogram QRS detection using combined adaptive threshold
         </dc:title><dc:date>2004</dc:date><dcterms:bibliographicCitation>BioMedical Engineering OnLine 3(1): 28-. (2004)</dcterms:bibliographicCitation><dc:identifier type="sici">1475-925X(2004)3:1&#x0003c;28&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1475-925X</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>QRS and ventricular beat detection is a basic procedure for electrocardiogram (ECG) processing and analysis. Large variety of methods have been proposed and used, featuring high percentages of correct detection. Nevertheless, the problem remains open especially with respect to higher detection accuracy in noisy ECGs</p></sec><sec sec-type="methods"><title>Methods</title><p>A real-time detection method is proposed, based on comparison between absolute values of summed differentiated electrocardiograms of one of more ECG leads and adaptive threshold. The threshold combines three parameters: an adaptive slew-rate value, a second value which rises when high-frequency noise occurs, and a third one intended to avoid missing of low amplitude beats.</p><p>Two algorithms were developed: Algorithm 1 detects at the current beat and Algorithm 2 has an RR interval analysis component in addition.</p><p>The algorithms are self-adjusting to the thresholds and weighting constants, regardless of resolution and sampling frequency used. They operate with any number <italic>L </italic>of ECG leads, self-synchronize to QRS or beat slopes and adapt to beat-to-beat intervals.</p></sec><sec><title>Results</title><p>The algorithms were tested by an independent expert, thus excluding possible author's influence, using all 48 full-length ECG records of the MIT-BIH arrhythmia database. The results were: sensitivity <italic>Se </italic>= 99.69 % and specificity <italic>Sp </italic>= 99.65 % for Algorithm 1 and <italic>Se </italic>= 99.74 % and <italic>Sp </italic>= 99.65 % for Algorithm 2.</p></sec><sec><title>Conclusion</title><p>The statistical indices are higher than, or comparable to those, cited in the scientific literature.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The QRS complexes and ventricular beats in an electrocardiogram represent the depolarization phenomenon of the ventricles and yield useful information about their behavior. Beat detection is a procedure preceding any kind of ECG processing and analysis. For morphological analysis this is the reference for detection of other ECG waves and parameter measurements. Rhythm analysis requires classification of QRS and other ventricular beat complexes as normal and abnormal. Real-time ventricular beat detection is essential for monitoring of patients in critical heart condition.</p><p>Correct beats recognition is impeded by power-line interference, electromyogram noise and baseline wander often present in the ECG signal.</p><p>In long-term monitoring electrode impedance can increase considerably, resulting in very low signal-to-noise ratio, which can make detection practically impossible in a single lead. Therefore, usually two or three leads are used for monitoring [<xref ref-type="bibr" rid="B1">1</xref>].</p><p>Friesen <italic>et al. </italic>[<xref ref-type="bibr" rid="B2">2</xref>] have presented a comparison of nine QRS detection algorithms, based on: i) amplitude and first derivative, ii) first derivative only, iii) first and second derivative, and iv) digital filtering. Daskalov <italic>et al</italic>. [<xref ref-type="bibr" rid="B3">3</xref>] applied these algorithms to selected signals containing records with pronounced baseline drift. The results were unsatisfactory, which was probably due to the use of fixed detection thresholds, whereas adaptive ones would be more appropriate.</p><p>Poli <italic>et al</italic>. [<xref ref-type="bibr" rid="B4">4</xref>] used a generic algorithm for QRS detection. The complexes were emphasized with respect to the rest of the signal by polynomial filters and compared to an adaptive threshold. The authors reported 99.60 % sensitivity (Se) and 99.51 % specificity (Sp) with the MIT-BIH Arrhythmia Database. The method is inapplicable in real-time.</p><p>Afonso <italic>et al. </italic>[<xref ref-type="bibr" rid="B5">5</xref>] proposed hardware filter banks for ECG signal decomposition, where several parameters were independently computed and combined in a decision rule. The authors reported Se = 99.59 % and Sp = 99.56 % for their real-time, single-channel beat detection algorithm tested with the MIT-BIH Arrhythmia Database.</p><p>Dotsinsky and Stoyanov [<xref ref-type="bibr" rid="B6">6</xref>] developed a heuristic, pseudo-real-time algorithm for ventricular beat detection for single-channel ECG, based on steep edges and sharp peaks evaluation criteria. They reported Se = 99.04% and Sp = 99.62%, obtained with two channel recordings from AHA and MIT-BIH Arrhythmia Database</p><p>Moraes <italic>et al</italic>. [<xref ref-type="bibr" rid="B1">1</xref>] combined logically two different algorithms working in parallel &#x02013; the first has been taken from the work of Englese and Zeelenberg [<xref ref-type="bibr" rid="B7">7</xref>] and the other was based on Pan and Tompkins [<xref ref-type="bibr" rid="B8">8</xref>], and Ligtenberg and Kunt [<xref ref-type="bibr" rid="B9">9</xref>]. Moraes <italic>et al</italic>. [<xref ref-type="bibr" rid="B1">1</xref>] reported Se = 99.22 % and Sp = 99.73 % after having excluded records of patients with pacemaker. After excluding a few more recordings 108, 200, 201 and 203, containing high amplitude noise (according to the authors), the statistical indices rises to Se = 99.56 % and Sp = 99.82 %.</p><p>Li <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>] have used wavelet transforms for detection. They reported 0.15 % false detections out of 46 files from the MIT-BIH Arrhythmia Database, but with exclusion of files 214 and 215. In addition, we found some errors in their Table II. After correction, the reported accuracy slightly decreased.</p><p>The large variety of QRS detection algorithms, and the continuous efforts for their enhancement, proves that universally acceptable solution has not been found yet. Difficulties arise mainly from the huge diversity of the QRS complex waveforms and the noise and artifacts accompanying the ECG signals.</p></sec><sec><title>ECG databases</title><p>All 48 ECG recordings of MIT-BIH Arrhythmia database were used, without exception. Each one has a duration of 30 min and includes two leads &#x02013; the modified limb lead II and one of the modified leads V1, V2, V4 or V5 [<xref ref-type="bibr" rid="B11">11</xref>]. The sampling frequency is 360 Hz with resolution 5 &#x003bc;V/bit. Two cardiologists have annotated all beats. Approximately 70 % of the beats are annotated as <italic>Normal</italic>. Four of the records are from patients with pacemakers.</p><p>The American Heart Association (AHA) database was also considered, during the evaluation of the method, mostly due to the fact that it contains patients with premature ventricular beats of contraction of R-over-T type, some of them very difficult to detect because of their closeness to the previous complex. Statistical indices for this database are not derived, because they can be compared with limited number of articles working with AHA. The database consists of 80 recordings: 2-leads, 250 Hz sampling rate and 5 &#x003bc;V/bit resolution.</p></sec><sec sec-type="methods"><title>Method</title><p>The differentiated and summed signals from <italic>L </italic>leads are compared to the absolute value of a threshold <italic>MFR </italic>= <italic>M </italic>+ <italic>F </italic>+ <italic>R </italic>&#x02013; a combination of three independent adaptive thresholds, where:</p><p>&#x02022; <italic>M </italic>&#x02013; Steep-slope threshold;</p><p>&#x02022; <italic>F </italic>&#x02013; Integrating threshold for high-frequency signal components;</p><p>&#x02022; <italic>R </italic>&#x02013; Beat expectation threshold.</p><p>Two algorithms were developed:</p><p><italic>Algorithm 1 </italic>detects at the current beat.</p><p><italic>Algorithm 2 </italic>Pseudo-real-time detection with additional triggering of potentially missed heart beat in the last interval by RR interval analyses.</p><p>The algorithms are self-adjusting to the thresholds and weighting constants, regardless of resolution and sampling frequency used. They operate with any number <italic>L </italic>of ECG leads, self-synchronize to QRS or beat slopes and adapt to beat-to-beat intervals.</p><sec><title>Preprocessing</title><p>&#x02022; Moving averaging filter for power-line interference suppression: averages samples in one period of the power-line interference frequency with a first zero at this frequency.</p><p>&#x02022; Moving averaging of samples in 28 ms interval for electromyogram noise suppression &#x02013; a filter with first zero at about 35 Hz.</p><p>&#x02022; Moving averaging of a complex lead (the sintesis is explained in the next section) in 40 ms intervals &#x02013; a filter with first zero at about 25 Hz. It is suppressing the noise magnified by the differentiation procedure used in the process of the complex lead sintesis.</p></sec><sec><title>Complex lead</title><p>The algorithm operates with a complex lead <italic>Y </italic>of several primary leads <italic>L</italic>. In cases of 12-standard leads, synthesis of the three quasi-orthogonal Frank leads is recommended first [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B12">12</xref>], thus determining the complex lead as a spatial vector. The complex lead is obtained as:</p><p><inline-graphic xlink:href="1475-925X-3-28-i1.gif"/></p><p>where <italic>Xj(i) </italic>is the amplitude value of the sample <italic>i </italic>in lead <italic>j</italic>, and <italic>Y(i) </italic>is the current complex lead.</p><p>The above formula (except the normalizing coefficient 1/L and the absolute value) was initially adopted from the work of Bakardjian [<xref ref-type="bibr" rid="B13">13</xref>]. Operating with unsigned (absolute) values proved convenient when dealing with QRSs and extrasystoles having different, for example positive (in one lead) and negative (in the other lead) deflections.</p></sec><sec><title>Adaptive steep-slope threshold &#x02013; M</title><p>&#x02022; Initially <italic>M </italic>= 0.6*<italic>max(Y) </italic>is set for the first 5 s of the signal, where at least 2 QRS complexes should occur. A buffer with 5 steep-slope threshold values is preset:</p><p><italic>MM </italic>= [<italic>M</italic><sub>1</sub><italic>M</italic><sub>2</sub><italic>M</italic><sub>3</sub><italic>M</italic><sub>4</sub><italic>M</italic><sub>5</sub>],</p><p>where <italic>M</italic><sub>1 </sub>&#x000f7; <italic>M</italic><sub>5 </sub>are equal to <italic>M</italic>.</p><p>&#x02022; QRS or beat complex is detected if <italic>Yi </italic>&#x02265; <italic>MFR</italic>,</p><p>&#x02022; No detection is allowed 200 ms after the current one. In the interval QRS &#x000f7; QRS<sub>+200<italic>ms </italic></sub>a new value of <italic>M</italic><sub>5 </sub>is calculated:</p><p><italic>newM</italic><sub>5 </sub>= 0.6*<italic>max(Yi)</italic></p><p>The estimated <italic>newM</italic><sub>5 </sub>value can become quite high, if steep slope premature ventricular contraction or artifact appeared, and for that reason it is limited to <italic>newM</italic><sub>5 </sub>= 1.1* <italic>M</italic><sub>5 </sub>if <italic>newM</italic><sub>5 </sub>&#x0003e; 1.5* <italic>M</italic><sub>5</sub>.</p><p>The <italic>MM </italic>buffer is refreshed excluding the oldest component, and including <italic>M</italic><sub>5 </sub>= <italic>newM</italic><sub>5</sub>. <italic>M </italic>is calculated as an average value of <italic>MM</italic>.</p><p>&#x02022; <italic>M </italic>is decreased in an interval 200 to 1200 ms following the last QRS detection at a low slope, reaching 60 % of its refreshed value at 1200 ms.</p><p>&#x02022; After 1200 ms <italic>M </italic>remains unchanged.</p><p>The thresholds definitions are presented in more detail with the help of several examples. Two ECG leads are shown in Fig. <xref ref-type="fig" rid="F1">1a</xref>. Detected QRSs are marked with 'red O' on Lead 1. The summary lead and the steep-slope threshold are represented in Fig. <xref ref-type="fig" rid="F1">1b</xref>.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Adaptive steep-slope threshold</p></caption><graphic xlink:href="1475-925X-3-28-1"/></fig></sec><sec><title>Adaptive integrating threshold &#x02013; <italic>F</italic></title><p>The integrating threshold <italic>F </italic>is intended to raise the combined threshold if electromyogram noise is accompanying the ECG, thus protecting the algorithm against 'erroneous beat detection'.</p><p>Initially <italic>F </italic>is the mean value of the pseudo-spatial velocity <italic>Y </italic>for 350 ms.</p><p>With every signal sample, <italic>F </italic>is updated adding the maximum of <italic>Y </italic>in the latest 50 ms of the 350 ms interval and subtracting <italic>maxY </italic>in the earliest 50 ms of the interval.</p><p>F = F + (max(Y<sub>in latest 50 ms in the 350 ms interval</sub>) - max(Y<sub>in earliest 50 ms in the 350 ms interval</sub>))/150</p><p>The way <italic>F </italic>is updated means that not every sample in the interval is integrated, but just the envelope of the pseudo-spatial velocity <italic>Y</italic>. The weight coefficient 1/150 is empirically derived.</p><p>Two ECG leads are shown in Fig. <xref ref-type="fig" rid="F2">2a</xref>. The pseudo-spatial velocity <italic>Y </italic>and the integrated threshold are presented in Fig. <xref ref-type="fig" rid="F2">2b</xref>. The correct detection is due to the rise of <italic>F </italic>(hence of <italic>MFR</italic>) with about 0.2 mV. The beat complex is included in the integration process (note the high rise of <italic>F </italic>after any of the complexes), thus making almost impossible a close detection to the previous complex.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p>Adaptive integrating threshold</p></caption><graphic xlink:href="1475-925X-3-28-2"/></fig></sec><sec><title>Adaptive beat expectation threshold &#x02013; <italic>R</italic></title><p>The beat expectation threshold <italic>R </italic>is intended to deal with heartbeats of normal amplitude followed by a beat with very small amplitude (and respectively with very small slew rate). This can be observed for example in cases of electrode artifacts. Conversely to the integrating threshold protecting against erroneous QRS detection, <italic>R </italic>is protecting against 'QRS misdetection'.</p><p>A buffer with the 5 last RR intervals is updated at any new QRS detection. <italic>Rm </italic>is the mean value of the buffer.</p><p>&#x02022; <italic>R </italic>= 0 <italic>V </italic>in the interval from the last detected QRS to 2/3 of the expected <italic>Rm</italic>.</p><p>&#x02022; In the interval QRS + Rm * 2/3 to QRS + Rm, <italic>R </italic>decreases 1.4 times slower then the decrease of the previously discussed steep slope threshold (<italic>M </italic>in the 200&#x02013;1200 ms interval).</p><p>&#x02022; After QRS + Rm the decrease of <italic>R </italic>is stopped.</p><p>The time-course of the beat expectation threshold <italic>R </italic>is shown in Fig. <xref ref-type="fig" rid="F3">3</xref>. The decrease of <italic>R </italic>(respectively <italic>MFR</italic>) with about 0.2 mV at the fourth QRS allows its detection, despite the lack of complex in Lead 2, which leads to a two-fold decrease of the summary lead amplitude <italic>Y </italic>(Fig. <xref ref-type="fig" rid="F3">3b</xref>).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>Adaptive beat expectation threshold</p></caption><graphic xlink:href="1475-925X-3-28-3"/></fig></sec><sec><title>Combined adaptive threshold &#x02013; <italic>MFR</italic></title><p>The combined adaptive threshold is a sum of the adaptive steep-slope threshold, adaptive integrating threshold and adaptive beat expectation thresholds. (Fig. <xref ref-type="fig" rid="F4">4</xref>)</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>Combined adaptive threshold</p></caption><graphic xlink:href="1475-925X-3-28-4"/></fig><p><italic>MFR </italic>= <italic>M </italic>+ <italic>F </italic>+ <italic>R</italic></p></sec><sec><title>Algorithm 2: pseudo-real-time detection with additional triggering of eventually missed heart beat in the last detected RR interval</title><p>All previous considerations relate to Algorithm 1, which detects a beat at its occurrence. Additional checking for an eventually missed heartbeat is performed by Algorithm 2. Its function is explained by the signal in Fig. <xref ref-type="fig" rid="F5">5</xref>. The fourth complex at the 15.2 s in Fig. <xref ref-type="fig" rid="F5">5b</xref> should be missed due to the fact that, <italic>MFR </italic>is greater then the summary lead <italic>Y</italic>.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>Pseudo-real-time detection with additional triggering of eventually missed heart beat in the last RR interval.</p></caption><graphic xlink:href="1475-925X-3-28-5"/></fig><p>Let's mark the previous RR interval with <italic>t1 </italic>and the last &#x02013; with <italic>t2 </italic>(Fig. <xref ref-type="fig" rid="F5">5a</xref>).</p><p>If <italic>t1 </italic>is not shortened, which is tested by logic OR of the 2 conditions t1&#x0003e;Rm OR Rm-t1&#x0003c;0.12*Rm AND in the same time <italic>t2 </italic>is quite long to fulfill the condition abs(t2-2*Rm)&#x0003c;0.5*Rm, the interval is subjected to check for a missed complex.</p><p>A test is performed on each of the primary leads where a sharp peak is searched (defined as a product &#x0003e; 4 &#x003bc;V of two signal differences having one central and two lateral points 8 ms apart). If the test is passed, a second one is carried out for the amplitude of the summary lead at that point, which should be bigger then 1/3 of the mean value of the buffer <italic>MM</italic>, in order to define this point as a missed QRS complex.</p></sec></sec><sec><title>Results and discussion</title><p>Normally the statistical indices Se and Sp are derived from the following parameters: correctly detected beats TP (true positive), falsely detected beats FP (false positive) and undetected beats FN (false negative). In addition, we used two parameters, adopted from Dotsinsky and Stoyanov [<xref ref-type="bibr" rid="B6">6</xref>], as described below.</p><p>SP &#x02013; shifted positive error was introduced in order to explain cases like the one shown in Fig. <xref ref-type="fig" rid="F6">6</xref>. Here the algorithm made a false positive error before the 3rd QRS and missed the following QRS. Formally, this is a false positive error, immediately followed by a false negative. However, if the time interval between these two detections is reasonably short, for example &#x02264; 200 ms, we accepted this as one error only, labeled as <italic>Shifted False Positive Error </italic>(SP).</p><fig position="float" id="F6"><label>Figure 6</label><caption><p>Shifted positive error at the P wave</p></caption><graphic xlink:href="1475-925X-3-28-6"/></fig><p>Another example of SP error as a result of artifacts just before the normal complexes is shown in Fig. <xref ref-type="fig" rid="F7">7</xref>.</p><fig position="float" id="F7"><label>Figure 7</label><caption><p>Shifted positive errors, false positive + false negative twins</p></caption><graphic xlink:href="1475-925X-3-28-7"/></fig><p>SN &#x02013; shifted negative error was assumed by the same principle as SP, but in the opposite sense. It also included twin FN+FP error occurring within 200 ms. The first incoming FP or FN error of the shifted is defining it as SP or SN.</p><p>The logic of using shifted errors (instead of FP and FN or FN and FP in cases when they appear within 200 ms of each other) is that thus the total number of beats in a record retains its value. Otherwise it would change depending on the type and number of errors and thus impede correct computation of Se and Sp.</p><p>The sensitivity Se is calculated by summing FN <inline-graphic xlink:href="1475-925X-3-28-i2.gif"/> SN, while the specificity Sp &#x02013; by summing FP+SP.</p><p><inline-graphic xlink:href="1475-925X-3-28-i3.gif"/></p><p>The method was developed in Matlab. All 48 recordings from the MIT-BIH Arrhythmia database, without any exception, were used for testing the two algorithms.</p><p>The processed files containing detection marks were automatically compared with the original MIT-BIH annotated beats by specially designed software. It shows all cases where the annotation and detection marks differ by more than 60 ms. These cases were examined by an independent expert, thus excluding possible author's influence.</p><p>The results for the two algorithms are presented in Table <xref ref-type="table" rid="T1">1</xref>.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Statistical results for the two algorithms</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">File</td><td align="center">Annotated beats</td><td align="center" colspan="5">Algorithm 1</td><td align="center" colspan="5">Algorithm 2</td></tr><tr><td></td><td></td><td colspan="5"><hr></hr></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td></td><td align="center">TP</td><td align="center">FN</td><td align="center">FP</td><td align="center">SN</td><td align="center">SP</td><td align="center">TP</td><td align="center">FN</td><td align="center">FP</td><td align="center">SN</td><td align="center">SP</td></tr></thead><tbody><tr><td align="center">100</td><td align="center">2273</td><td align="center">2273</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2273</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">101</td><td align="center">1863</td><td align="center">1862</td><td align="center">1</td><td align="center">4</td><td align="center">0</td><td align="center">0</td><td align="center">1862</td><td align="center">1</td><td align="center">4</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">102</td><td align="center">2187</td><td align="center">2187</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2187</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">103</td><td align="center">2084</td><td align="center">2062</td><td align="center">2</td><td align="center">54</td><td align="center">11</td><td align="center">9</td><td align="center">2065</td><td align="center">0</td><td align="center">58</td><td align="center">12</td><td align="center">7</td></tr><tr><td align="center">104</td><td align="center">2212</td><td align="center">2211</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2211</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">105</td><td align="center">2567</td><td align="center">2543</td><td align="center">2</td><td align="center">35</td><td align="center">8</td><td align="center">14</td><td align="center">2544</td><td align="center">2</td><td align="center">36</td><td align="center">8</td><td align="center">13</td></tr><tr><td align="center">106</td><td align="center">2027</td><td align="center">2017</td><td align="center">1</td><td align="center">1</td><td align="center">0</td><td align="center">9</td><td align="center">2018</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">9</td></tr><tr><td align="center">107</td><td align="center">2137</td><td align="center">2135</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2137</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">108</td><td align="center">1763</td><td align="center">1664</td><td align="center">2</td><td align="center">40</td><td align="center">3</td><td align="center">94</td><td align="center">1674</td><td align="center">1</td><td align="center">42</td><td align="center">3</td><td align="center">85</td></tr><tr><td align="center">109</td><td align="center">2532</td><td align="center">2521</td><td align="center">11</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">2527</td><td align="center">5</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td colspan="12"><hr></hr></td></tr><tr><td align="center">111</td><td align="center">2124</td><td align="center">2124</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2124</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">112</td><td align="center">2539</td><td align="center">2539</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2539</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">113</td><td align="center">1797</td><td align="center">1797</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1797</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">114</td><td align="center">1879</td><td align="center">1879</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1879</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">115</td><td align="center">1953</td><td align="center">1951</td><td align="center">0</td><td align="center">4</td><td align="center">1</td><td align="center">1</td><td align="center">1952</td><td align="center">0</td><td align="center">4</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">116</td><td align="center">2412</td><td align="center">2389</td><td align="center">22</td><td align="center">2</td><td align="center">0</td><td align="center">1</td><td align="center">2392</td><td align="center">19</td><td align="center">2</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">117</td><td align="center">1535</td><td align="center">1535</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1535</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">118</td><td align="center">2275</td><td align="center">2275</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2275</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">119</td><td align="center">1987</td><td align="center">1987</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1987</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">121</td><td align="center">1863</td><td align="center">1863</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1863</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td colspan="12"><hr></hr></td></tr><tr><td align="center">122</td><td align="center">2476</td><td align="center">2476</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2476</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">123</td><td align="center">1518</td><td align="center">1516</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1516</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">124</td><td align="center">1619</td><td align="center">1617</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1619</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">200</td><td align="center">2601</td><td align="center">2549</td><td align="center">9</td><td align="center">39</td><td align="center">18</td><td align="center">25</td><td align="center">2552</td><td align="center">6</td><td align="center">41</td><td align="center">20</td><td align="center">23</td></tr><tr><td align="center">201</td><td align="center">1963</td><td align="center">1902</td><td align="center">60</td><td align="center">0</td><td align="center">0</td><td align="center">1</td><td align="center">1902</td><td align="center">60</td><td align="center">0</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">202</td><td align="center">2136</td><td align="center">2130</td><td align="center">6</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2130</td><td align="center">6</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">203</td><td align="center">2978</td><td align="center">2901</td><td align="center">71</td><td align="center">13</td><td align="center">3</td><td align="center">3</td><td align="center">2911</td><td align="center">62</td><td align="center">27</td><td align="center">3</td><td align="center">2</td></tr><tr><td align="center">205</td><td align="center">2656</td><td align="center">2652</td><td align="center">4</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2652</td><td align="center">4</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">207</td><td align="center">1862</td><td align="center">1860</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1862</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">208</td><td align="center">2954</td><td align="center">2937</td><td align="center">14</td><td align="center">7</td><td align="center">2</td><td align="center">1</td><td align="center">2939</td><td align="center">11</td><td align="center">7</td><td align="center">2</td><td align="center">2</td></tr><tr><td colspan="12"><hr></hr></td></tr><tr><td align="center">209</td><td align="center">3004</td><td align="center">3004</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">3004</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">210</td><td align="center">2647</td><td align="center">2591</td><td align="center">56</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">2603</td><td align="center">44</td><td align="center">1</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">212</td><td align="center">2748</td><td align="center">2748</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2748</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">213</td><td align="center">3551</td><td align="center">3548</td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3550</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">214</td><td align="center">2260</td><td align="center">2258</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">0</td><td align="center">2256</td><td align="center">4</td><td align="center">1</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">215</td><td align="center">3362</td><td align="center">3362</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3362</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">217</td><td align="center">2208</td><td align="center">2204</td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">1</td><td align="center">2205</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">219</td><td align="center">2154</td><td align="center">2153</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2153</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">220</td><td align="center">2048</td><td align="center">2048</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2048</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">221</td><td align="center">2427</td><td align="center">2426</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2426</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td colspan="12"><hr></hr></td></tr><tr><td align="center">222</td><td align="center">2483</td><td align="center">2480</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">1</td><td align="center">2482</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">223</td><td align="center">2595</td><td align="center">2585</td><td align="center">10</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2590</td><td align="center">5</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">228</td><td align="center">2053</td><td align="center">2053</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2053</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">230</td><td align="center">2256</td><td align="center">2256</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2256</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">231</td><td align="center">1886</td><td align="center">1886</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">1886</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">232</td><td align="center">1767</td><td align="center">1766</td><td align="center">0</td><td align="center">12</td><td align="center">0</td><td align="center">1</td><td align="center">1766</td><td align="center">0</td><td align="center">12</td><td align="center">0</td><td align="center">1</td></tr><tr><td align="center">233</td><td align="center">3076</td><td align="center">3073</td><td align="center">3</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">3074</td><td align="center">2</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">234</td><td align="center">2753</td><td align="center">2753</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">2753</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td colspan="12"><hr></hr></td></tr><tr><td align="center">Sum</td><td align="center">110050</td><td align="center">109548</td><td align="center">294</td><td align="center">215</td><td align="center">47</td><td align="center">161</td><td align="center">109615</td><td align="center">240</td><td align="center">239</td><td align="center">48</td><td align="center">147</td></tr></tbody></table></table-wrap><p>Of all 110050 annotated beats ('unknown' or 'questionable' were excluded from the study), true detected are 109548 for Algorithm 1 and 109616 for Algorithm 2. The statistical indices are:</p><p><bold>Algorithm 1</bold>: Se = 99.69 %, Sp = 99.66 %;</p><p><bold>Algorithm 2</bold>: Se = 99.74 %, Sp = 99.65 %.</p><p>The standard way of Se and Sp calculation,</p><p><inline-graphic xlink:href="1475-925X-3-28-i4.gif"/></p><p>considering the joint SP and SN errors as two separate errors gives the following results:</p><p><bold>Algorithm 1</bold>: Se = 99.54 %, Sp = 99.61 %;</p><p><bold>Algorithm 2</bold>: Se = 99.60 %, Sp = 99.60 %.</p><p>Algorithm 2 improved the sensitivity by 0.05 % (0.06 % for the standard evaluation) as a result of decreased number of undetected beats. This result can be observed for example in recordings 109,203, 210 and 223, where the additionally detected beats are respectively 6, 9, 12 and 5. The performance of both algorithms was especially tested with the file A5001 from the AHA containing R-over-T premature ventricular complexes, very close to the previous normal QRS complex (Fig. <xref ref-type="fig" rid="F5">5a</xref>). An improvement of 74 undetected by Algorithm 1 R-on-T complexes was observed. The detection of such premature ventricular complexes occurring at the time of ventricular repolarization was considered important, having in mind possible risk of ventricular fibrillation triggering by R-on-T events.</p></sec><sec><title>Conclusions</title><p>The proposed algorithms for real-time and pseudo-real-time implementation are adaptive, independent of thresholds and constants values. They are self-synchronized to the QRS steep slope and the heart rhythm, regardless of the resolution and sampling frequency used. Due to the integration threshold, the algorithms are practically insensitive to electromyogram and similar high-frequency noise.</p><p>The algorithms can operate with one, two or more leads, using a combined lead signal derived from the sum of absolute values of the differentiated lead signals.</p><p>The statistical indices are higher than, or comparable to those, cited in the scientific literature.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>The author gratefully acknowledges the contribution of Prof. Ivan Dotsinsky, Centre of Biomedical Engineering, Bulgarian Academy of Sciences, for examining and testing the results of the proposed algorithms.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Moreas</surname><given-names>JCTB</given-names></name><name><surname>Seixas</surname><given-names>MO</given-names></name><name><surname>Vilani</surname><given-names>FN</given-names></name><name><surname>Costa</surname><given-names>EV</given-names></name></person-group><article-title>A QRS complex detection algorithm using electrocardiogram leads</article-title><source>Comp in Card</source><year>2002</year><volume>29</volume><fpage>205</fpage><lpage>208</lpage></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Friesen</surname><given-names>GM</given-names></name><name><surname>Jannett</surname><given-names>TC</given-names></name><name><surname>Jadallah</surname><given-names>MA</given-names></name><name><surname>Yates</surname><given-names>SL</given-names></name><name><surname>Quint</surname><given-names>SR</given-names></name><name><surname>Nagle</surname><given-names>HT</given-names></name></person-group><article-title>A comparison of the noise sensitivity of nine QRS detection algorithms</article-title><source>IEEE Trans on Biomed Eng</source><year>1990</year><volume>37</volume><fpage>85</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1109/10.43620</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Daskalov</surname><given-names>IK</given-names></name><name><surname>Dotsinsky</surname><given-names>IA</given-names></name><name><surname>Christov</surname><given-names>II</given-names></name></person-group><article-title>Developments in ECG acquisition, preprocessing, parameter measurement and recording</article-title><source>IEEE Eng in Med &#x00026; Biol</source><year>1998</year><volume>17</volume><fpage>50</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1109/51.664031</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Poli</surname><given-names>R</given-names></name><name><surname>Cagnoni</surname><given-names>S</given-names></name><name><surname>Valli</surname><given-names>G</given-names></name></person-group><article-title>Generic design of optimum linear and nonlinear QRS detection</article-title><source>IEEE Trans on Biomed Eng</source><year>1995</year><volume>42</volume><fpage>1137</fpage><lpage>1141</lpage><pub-id pub-id-type="doi">10.1109/10.469381</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Afonso</surname><given-names>VX</given-names></name><name><surname>Tompkins</surname><given-names>WJ</given-names></name><name><surname>Nguyen</surname><given-names>TQ</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name></person-group><article-title>ECG beat detection using filter banks</article-title><source>Trans Biomed Eng</source><year>1999</year><volume>2</volume><fpage>192</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1109/10.740882</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dotsinsky</surname><given-names>I</given-names></name><name><surname>Stoyanov</surname><given-names>T</given-names></name></person-group><article-title>Ventricular beat detection in single channel electrocardiograms</article-title><source>BioMed Eng OnLine</source><year>2004</year><volume>3</volume><fpage>3</fpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedical-engineering-online.com/content/3/1/3"/><pub-id pub-id-type="pmid">14750981</pub-id><pub-id pub-id-type="doi">10.1186/1475-925X-3-3</pub-id></citation></ref><ref id="B7"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Englese</surname><given-names>WAH</given-names></name><name><surname>Zeelenberg</surname><given-names>C</given-names></name></person-group><article-title>A single scan algorithm for QRS detection and feature extraction</article-title><source>IEEE Comp in Card</source><year>1979</year><fpage>37</fpage><lpage>42</lpage></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>J</given-names></name><name><surname>Tompkins</surname><given-names>W</given-names></name></person-group><article-title>A real-time QRS detection algorithm</article-title><source>IEEE Trans Biomed Eng</source><year>1985</year><volume>32</volume><fpage>230</fpage><lpage>236</lpage><pub-id pub-id-type="pmid">3997178</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ligtenberg</surname><given-names>A</given-names></name><name><surname>Kunt</surname><given-names>M</given-names></name></person-group><article-title>A robust-digital QRS detection algorithm for arrhythmia monitoring</article-title><source>Computers and Biomed Res</source><year>1983</year><volume>16</volume><fpage>273</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1016/0010-4809(83)90027-7</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Zheng</surname><given-names>C</given-names></name><name><surname>Tai</surname><given-names>C</given-names></name></person-group><article-title>Detection of ECG characteristic points using wavelet transforms</article-title><source>IEEE Trans on Biomed Eng</source><year>1995</year><volume>42</volume><fpage>21</fpage><lpage>28</lpage><pub-id pub-id-type="doi">10.1109/10.362922</pub-id></citation></ref><ref id="B11"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Mark</surname><given-names>R</given-names></name><name><surname>Moody</surname><given-names>G</given-names></name></person-group><article-title>MIT-BIH Arrhythmia data base directory</article-title><source>Cambridge: Massachusetts Institute of Technology</source><year>1988</year></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Levkov</surname><given-names>C</given-names></name></person-group><article-title>Orthogonal electrocardiogram derived from the limb and chest electrodes of the conventional 12-lead system</article-title><source>Med Biol Eng Comput</source><year>1987</year><volume>25</volume><fpage>155</fpage><lpage>164</lpage><pub-id pub-id-type="pmid">3695618</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bakardjian</surname><given-names>H</given-names></name></person-group><article-title>Ventricular beat classifier using fractal number clustering</article-title><source>Med Biol Eng Comput</source><year>1992</year><volume>30</volume><fpage>495</fpage><lpage>502</lpage><pub-id pub-id-type="pmid">1284086</pub-id></citation></ref></ref-list></back></article>



