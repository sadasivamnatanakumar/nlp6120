<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="product-review"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-title>BMC Genomics</journal-title><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15357875</article-id><article-id pub-id-type="pmc">PMC521069</article-id><article-id pub-id-type="publisher-id">1471-2164-5-64</article-id><article-id pub-id-type="doi">10.1186/1471-2164-5-64</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title>A method for detecting and correcting feature misidentification on expression microarrays</article-title></title-group><contrib-group><contrib id="A1" equal-contrib="yes" corresp="yes" contrib-type="author"><name><surname>Tu</surname><given-names>I-Ping</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I6">6</xref><email>iping@stat.sinica.edu.tw</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Schaner</surname><given-names>Marci</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>marci.schaner@stanford.edu</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Diehn</surname><given-names>Maximilian</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>diehn@stanford.edu</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Sikic</surname><given-names>Branimir I</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>brandy@stanford.edu</email></contrib><contrib id="A5" contrib-type="author"><name><surname>Brown</surname><given-names>Patrick O</given-names></name><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I5">5</xref><email>pbrown@cmgm.stanford.edu</email></contrib><contrib id="A6" contrib-type="author"><name><surname>Botstein</surname><given-names>David</given-names></name><xref ref-type="aff" rid="I4">4</xref><email>botstein@princeton.edu</email></contrib><contrib id="A7" equal-contrib="yes" corresp="yes" contrib-type="author"><name><surname>Fero</surname><given-names>Michael J</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>mike.fero@stanford.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Functional Genomics Facility, Stanford University School of Medicine, Stanford, CA, USA</aff><aff id="I2"><label>2</label>Department of Biochemistry, Stanford University School of Medicine, Stanford, CA, USA</aff><aff id="I3"><label>3</label>Oncology Division, Department of Medicine, Stanford University School of Medicine, Stanford, CA, USA</aff><aff id="I4"><label>4</label>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, NJ, USA</aff><aff id="I5"><label>5</label>Howard Hughes Medical Institute, Stanford University School of Medicine, Stanford, CA, USA</aff><aff id="I6"><label>6</label>Institute of Statistical Science, Academia Sinica, Taipei, Taiwan, R.O.C</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>9</day><month>9</month><year>2004</year></pub-date><volume>5</volume><fpage>64</fpage><lpage>64</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2164/5/64"/><history><date date-type="received"><day>6</day><month>7</month><year>2004</year></date><date date-type="accepted"><day>9</day><month>9</month><year>2004</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2004 Tu et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2004</copyright-year><copyright-holder>Tu et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Tu
               I-Ping
               
               
               iping@stat.sinica.edu.tw
            </dc:author><dc:title>
            A method for detecting and correcting feature misidentification on expression microarrays
         </dc:title><dc:date>2004</dc:date><dcterms:bibliographicCitation>BMC Genomics 5(1): 64-. (2004)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2164(2004)5:1&#x0003c;64&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2164</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Much of the microarray data published at Stanford is based on mouse and human arrays produced under controlled and monitored conditions at the Brown and Botstein laboratories and at the Stanford Functional Genomics Facility (SFGF). Nevertheless, as large datasets based on the Stanford Human array began to accumulate, a small but significant number of discrepancies were detected that required a serious attempt to track down the original source of error. Due to a controlled process environment, sufficient data was available to accurately track the entire process leading to up to the final expression data. In this paper, we describe our statistical methods to detect the inconsistencies in microarray data that arise from process errors, and discuss our technique to locate and fix these errors.</p></sec><sec><title>Results</title><p>To date, the Brown and Botstein laboratories and the Stanford Functional Genomics Facility have together produced 40,000 large-scale (10&#x02013;50,000 feature) cDNA microarrays. By applying the heuristic described here, we have been able to check most of these arrays for misidentified features, and have been able to confidently apply fixes to the data where needed. Out of the 265 million features checked in our database, problems were detected and corrected on 1.3 million of them.</p></sec><sec><title>Conclusion</title><p>Process errors in any genome scale high throughput production regime can lead to subsequent errors in data analysis. We show the value of tracking multi-step high throughput operations by using this knowledge to detect and correct misidentified data on gene expression microarrays.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Expression microarrays, with the capability to measure the mRNA expression level of tens of thousands of genes simultaneously, have found broad application in both clinical and basic research [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B7">7</xref>]. With the generation of large data sets from microarray experiments, statistical methods are needed to extract useful information. Many methods have had specific implementations written for the analysis of gene expression data, such as various forms of clustering, self ordered maps, singular value decomposition and significance analysis [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B13">13</xref>]. However, these methods all rely on the assumption that there are no gross process errors in the original data. Previous analyses of systematic errors in microarray data have focused on problems at the level of sample preparation, labelling, or hybridization. This report focuses on steps in the microarray production process prior to hybridization that may ultimately result in errors in the underlying data. Much of the microarray data published at Stanford is based on mouse and human arrays produced under controlled and monitored conditions at the Brown and Botstein laboratories and at the Stanford Functional Genomics Facility (SFGF). Nevertheless, as large datasets based on the Stanford Human array began to accumulate, a small but significant number of discrepancies were detected that required a serious attempt to track down the original source of error. Due to a controlled process environment, sufficient data was available to accurately track the entire process leading to up to the final expression data. In this paper, we describe our statistical methods to detect the inconsistencies in microarray data that arise from process errors, and discuss our technique to locate and fix these errors. We are able to fix those errors that originate at the level of any microtiter plate used during a multi-step microarray production process. The major process fail points in cDNA microarray production at Stanford are shown in Table <xref ref-type="table" rid="T1">1</xref>. It is at these points that misidentifications can occur. Other types of processes resulting in expression data will have their own possible fail points. Regardless of the particular process, for the sake of subsequent error checking it is important to track every instance where samples have moved from one microtiter plate to another, or from microtiter plate to microarray. Our process involves four such reallocations: From an archival 96-well block to a 96-well growth block, then to a 96-well PCR plate, then to four 384-well print plates and finally to 250 10&#x02013;40 thousand element microarrays. Even in highly automated bar-coded and vision controlled systems the possibility exists that plates might become swapped, skipped, misordered, or rotated by 180 degrees during one of the process steps. Our own process is fairly well automated, but like most academic and commercial efforts our process involves hand loading of robots. For example in our case, during the transfer from 96 to 384-well format, it is possible to accidentally rotate a 96-well plate or misorder the 96 or 384-well plates. During printing a 384-well plate might be accidentally skipped, swapped or printed in the wrong orientation (rotated by 180 degrees). Even with the best engineering controls to prevent plate rotations, the potential exists for misidentified plates. Inconsistencies in our data were first detected both by visual inspection of microarray data as well as the appearance of anomalously large first components in singular value decomposition analyses of Ovarian Tumour data [<xref ref-type="bibr" rid="B6">6</xref>] traced to different production batches of arrays. Our algorithm was developed to detect and repair these types of errors, using the similarities in expression levels between sets of spots from different microarrays. The algorithm was used to check all of the microarray data in our database for which there was a sufficient process record. The general idea, illustrated in Figure <xref ref-type="fig" rid="F1">1</xref>, is as follows: Partition the microarray expression data from a single microarray into sets based on the various microtiter plates the samples have been in throughout their process history. For example, at Stanford we keep our process fairly simple, with a minimum of plate changes, so our spotting material can be said to have existed in either 96 well or 384-well format during its entire process history. Thus, we partition the data into sets corresponding to the 96 or 384-well plate history. Next, an expression vector for each element of the partition (each plate) based on absolute (not relative) expression levels is formed and compared to every other expression vector from every other plate on many other array batches. A rank matrix of correlation coefficients is formed which should be close to unity on the diagonal and far from unity off the diagonal. Non-unitary diagonal elements indicate problems with that plate comparison. A rank comparison of the best correlations can be made to find swapped plates. The algorithm can be repeated assuming a rotated plate to check to see if the discrepancy can be attributed to a plate rotation. It should be noted that in cases where no process error is indicated, the method can still indicate the presence of problem plates, print batches or PCR rounds that should be flagged for particular attention in downstream analyses. Our algorithm (named MuFu for "MixupFixup") is for arrays produced in the Brown and Botstein laboratories and the Stanford Functional Genomics Facility. However, the ideas are general and can be applied to many other types of high throughput operations. In most of the research studies using our human microarray, a common reference [<xref ref-type="bibr" rid="B14">14</xref>] is compared against a tumour or tissue specimen. The common reference is usually labelled with the Cy3 dye, pseudo-colour green in most visualizations of the data, while the sample specimens are labelled with Cy5 dye, pseudo-colour red. Subtle corrections due to background subtraction issues and normalization are not important for this analysis. Because a common reference is used in a large number of hybridization experiments at Stanford, all of the Cy3 intensities (or Cy5 in some cases) across various kinds of experiments are comparable. We measure the similarities of two sets of spots by taking the correlations between the common reference intensities of these two sets of spots. For those experiments that do not use common reference, the comparison is made using experiments with similar samples in either the Cy3 or Cy5 channel.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>MuFu flowchart. </bold>Flow of the MuFu algorithm. Looping and re-partitions of the data are not shown.</p></caption><graphic xlink:href="1471-2164-5-64-1"/></fig></sec><sec><title>Results</title><sec><title>Finding misidentified data</title><p>This example is from the analysis of experiments from an ovarian tumor dataset[<xref ref-type="bibr" rid="B6">6</xref>] that first led us to develop MuFu. Here, it was noticed that similar tissues were not clustering across batch boundaries as expected. Also, an anomalously large first component in a singular value decomposition analysis[<xref ref-type="bibr" rid="B9">9</xref>] pointed to problems at the array batch level. After some detective work, visual inspection uncovered anomalies in certain print plates as seen in Figure <xref ref-type="fig" rid="F2">2</xref>. We were able to isolate the problem to distinct sets of 96-well plates that had been swapped during an upstream process step, probably during the transfer from 96-well plates to 384-well plates. Not wishing to go through this sort of process again and again, MuFu was developed to more succinctly recapitulate this finding and apply it to all data.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Ovarian tumour data. </bold>Visual inspection of the anomalous spots from the Ovarian tumor data before and after applying MuFu. In each case the top row shows that the feature alignment is inconsistent with the contents of the plate. In the bottom row features group together as expected.</p></caption><graphic xlink:href="1471-2164-5-64-2"/></fig><p>With MuFu, a check using a 384-well plate partition of the data shows a discrepancy but no obvious plate rotation or misidentification. We then repartition and repeat our tests at the 96-well plate level. The results are shown in Table <xref ref-type="table" rid="T2">2a</xref> where we show a 12 way pair wise comparison. The first four comparisons are for batches whose print plates are made from the first PCR round. The middle four compare the first PCR round to the second, and the last four compare batches from the second PCR round. Mismatches are evident in the middle set of comparisons. From Table <xref ref-type="table" rid="T2">2b</xref> we see that the distance matrix identifies a match between plate <italic>h </italic>and plate <italic>i </italic>and plate <italic>n </italic>and plate <italic>o </italic>for all four comparisons of the first PCR round to the second.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Test for 96 well plate handling error. a) In this table we see that the middle bank of comparisons indicates a discrepancy between data from the first PCR run and the second, at the 96-well plate level. b) A check of the distance matrix results show that the swapped plates are <italic>h </italic>and <italic>i </italic>in one case, and <italic>n </italic>and <italic>o </italic>in the other. Bold indicates P-value = 0.3, italic indicates P-values between 1.0E-03 and 1.0E-04, while regular font indicates P-values &#x0003c; 1.0E-04.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">a)</td><td align="center" colspan="12">R_{m, m}</td></tr><tr><td></td><td colspan="12"><hr></hr></td></tr><tr><td></td><td align="center" colspan="4">PCR Round 1 vs 1</td><td align="center" colspan="4">PCR Round 1 vs 2</td><td align="center" colspan="4">PCR Round 2 vs 2</td></tr></thead><tbody><tr><td align="left">Plates</td><td align="center">A1 v A2</td><td align="center">A2 v A3</td><td align="center">A3 v A4</td><td align="center">A4 v A5</td><td align="center">A2 v B1</td><td align="center">A3 v B2</td><td align="center">A4 v B3</td><td align="center">A5 v B4</td><td align="center">B1 v B2</td><td align="center">B5 v B3</td><td align="center">B1 v B4</td><td align="center">B5 v B4</td></tr><tr><td colspan="13"><hr></hr></td></tr><tr><td align="left">{a, a}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td></tr><tr><td align="left">{b, b}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">7</td><td align="center">1</td><td align="center">3</td><td align="center">1</td></tr><tr><td align="left">{c, c}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{d, d}</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">5</td><td align="center">9</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{e, e}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td></tr><tr><td align="left">{f, f}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{g, g}</td><td align="center">3</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{h, h}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center"><bold>343</bold></td><td align="center"><bold>322</bold></td><td align="center"><bold>408</bold></td><td align="center"><bold>294</bold></td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{i, i}</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center"><bold>421</bold></td><td align="center"><bold>290</bold></td><td align="center"><bold>402</bold></td><td align="center"><bold>359</bold></td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{j, j}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">4</td><td align="center">1</td></tr><tr><td align="left">{k, k}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{l, l}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">2</td></tr><tr><td align="left">{m, m}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{n, n}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center"><bold>255</bold></td><td align="center"><bold>141</bold></td><td align="center"><bold>20</bold></td><td align="center"><bold>167</bold></td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{o, o}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center"><bold>330</bold></td><td align="center"><bold>248</bold></td><td align="center"><bold>357</bold></td><td align="center"><bold>277</bold></td><td align="center">3</td><td align="center">1</td><td align="center">5</td><td align="center">6</td></tr><tr><td align="left">{p, p}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">3</td><td align="center">1</td><td align="center">1</td><td align="center">3</td><td align="center">2</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{q, q}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">4</td><td align="center">3</td><td align="center">3</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{r, r}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">5</td><td align="center">1</td><td align="center">1</td><td align="center">5</td><td align="center">1</td></tr><tr><td align="left">{s, s}</td><td align="center">3</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{t, t}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{u, u}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{v, v}</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">7</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="left">{w, w}</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">16</td><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="left">b)</td><td align="center" colspan="3">A2 v B1</td><td align="center" colspan="3">A3 v B2</td><td align="center" colspan="3">A4 v B3</td><td align="center" colspan="3">A5 v B4</td></tr><tr><td></td><td colspan="12"><hr></hr></td></tr><tr><td></td><td align="right">D_{mm}</td><td></td><td align="left">D_{mn}</td><td align="right">D_{mm}</td><td></td><td align="left">D_{mn}</td><td align="right">D_{mm}</td><td></td><td align="left">D_{mn}</td><td align="right">D_{mm}</td><td></td><td align="left">D_{mn}</td></tr><tr><td colspan="13"><hr></hr></td></tr><tr><td align="left">MEAN</td><td align="right">0.33</td><td></td><td align="left">0.97</td><td align="right">0.34</td><td></td><td align="left">0.89</td><td align="right">0.44</td><td></td><td align="left">0.98</td><td align="right">0.37</td><td></td><td align="left">0.96</td></tr><tr><td align="left">SD</td><td align="right">0.2</td><td></td><td align="left">0.11</td><td align="right">0.2</td><td></td><td align="left">0.13</td><td align="right">0.21</td><td></td><td align="left">0.11</td><td align="right">0.21</td><td></td><td align="left">0.12</td></tr><tr><td align="left">{h, h}</td><td align="right">0.99</td><td></td><td></td><td align="right">1.02</td><td></td><td></td><td align="right"><italic>1.07</italic></td><td></td><td></td><td align="right"><italic>1</italic></td><td></td><td></td></tr><tr><td align="left">{i, i}</td><td align="right">1.09</td><td></td><td></td><td align="right">1</td><td></td><td></td><td align="right"><italic>1.07</italic></td><td></td><td></td><td align="center">1.06</td><td></td></tr><tr><td align="left">{h, i}</td><td></td><td></td><td align="left">0.22</td><td></td><td></td><td align="left">0.09</td><td></td><td></td><td align="left">0.33</td><td></td><td></td><td align="left">0.31</td></tr><tr><td align="left">{i, h}</td><td></td><td></td><td align="left">0.28</td><td></td><td></td><td align="left">0.07</td><td></td><td></td><td align="left">0.11</td><td></td><td></td><td align="left">0.14</td></tr><tr><td align="left">{n, n}</td><td align="right">0.98</td><td></td><td></td><td align="right"><italic>0.91</italic></td><td></td><td></td><td align="right"><bold>0.85</bold></td><td></td><td></td><td align="right"><italic>0.92</italic></td><td></td><td></td></tr><tr><td align="left">{o, o}</td><td align="right">1.01</td><td></td><td></td><td align="right">1.02</td><td></td><td></td><td align="right"><italic>1.07</italic></td><td></td><td></td><td align="right">1.02</td><td></td><td></td></tr><tr><td align="left">{n, o}</td><td></td><td></td><td align="left">0.1</td><td></td><td></td><td align="left"><italic>0.51</italic></td><td></td><td></td><td align="left">0.45</td><td></td><td></td><td align="left">0.52</td></tr><tr><td align="left">{o, n}</td><td></td><td></td><td align="left">0.04</td><td></td><td></td><td align="left">0.17</td><td></td><td></td><td align="left">0.11</td><td></td><td></td><td align="left">0.05</td></tr></tbody></table></table-wrap><p>In all four comparisons, the two distributions resolve themselves well, as can be seen in Figure <xref ref-type="fig" rid="F3">3</xref>, leading to the conclusion that <italic>h </italic>and <italic>i </italic>are swapped, and <italic>n </italic>and <italic>o </italic>are swapped, most likely in the plates from the first PCR round. The ambiguity is broken by sequencing a small sampling of wells, which confirms that the misidentifications are in the print plates from the first round of PCR, and not the second. In Figure <xref ref-type="fig" rid="F4">4</xref> we show the effect on the Ovarian data after the correction has been applied. Also, in Figure <xref ref-type="fig" rid="F2">2</xref> we show how, via visual inspection of the actual spots on an array, one can verify that the fix has properly reorganized the data. The figure shows spots from the four different affected 96-well plates before and after the fix is applied.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Match, mismatch distance distributions. </bold>Good separation between match and mismatch distance distributions at the 96-well plate level lends confidence to our ability to discriminate between chance matches and actual matches. The green bars refer to the distance distributions of matched plates and the red bars for mis-matched plates.</p></caption><graphic xlink:href="1471-2164-5-64-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Ovarian tumour clusters. </bold>In Ovarian tumor data it was noticed that similar experiments were not clustering as expected (upper cluster diagram). Using MuFu we were able to isolate the problem to a distinct set of 96-well plates that had been swapped during an upstream process step, probably during the transfer from 96-well plates to 384-well plates. The samples cluster together as expected after correction (lower cluster diagram).</p></caption><graphic xlink:href="1471-2164-5-64-4"/></fig></sec><sec><title>Finding a 384-well plate rotation</title><p>We compare four arrays A1, A2, A3 and A4 from a particular print production batch A to four arrays B, C, D and E from four other distinct print production batches. The total number of 384 well microtiter plates in print batch A is 113. The results of the plate rotation test are shown in Table <xref ref-type="table" rid="T3">3a</xref>. Here we see plate <italic>p</italic>, identified in both the rank and rotated-rank matrices across print batches is a clear candidate for a plate rotation. The data from the distance matrix comparisons is shown in Table <xref ref-type="table" rid="T3">3b</xref>. In Figure <xref ref-type="fig" rid="F5">5</xref> we show the distributions of the diagonal elements of the distance matrix and the rotated-distance matrix. These distributions are well resolved and allow us to easily distinguish data due to a plate rotation from noisy data.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Test for rotated plates. a) Plate rotation results from the rank matrices R and R' . The flagged comparisons indicate a plate rotation for plate <italic>p</italic>. b) Plate rotation distance matrix comparison. The data meet the criteria for a plate rotation.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">a)</td><td align="center" colspan="2">A1 v B</td><td align="center" colspan="2">A2 v C</td><td align="center" colspan="2">A3 v D</td><td align="center" colspan="2">A4 v E</td></tr></thead><tbody><tr><td align="left">Plates</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="left">{i, i}</td><td align="center">1</td><td align="center">102</td><td align="center"><italic>1</italic></td><td align="center">95</td><td align="center"><italic>1</italic></td><td align="center">82</td><td align="center"><italic>1</italic></td><td align="center">93</td></tr><tr><td align="left">{j, j}</td><td align="center">1</td><td align="center">18</td><td align="center"><italic>1</italic></td><td align="center">102</td><td align="center"><italic>1</italic></td><td align="center">16</td><td align="center"><italic>1</italic></td><td align="center">64</td></tr><tr><td align="left">{k, k}</td><td align="center">1</td><td align="center">52</td><td align="center"><italic>1</italic></td><td align="center">99</td><td align="center"><italic>1</italic></td><td align="center">102</td><td align="center"><italic>1</italic></td><td align="center">41</td></tr><tr><td align="left">{l, l}</td><td align="center">6</td><td align="center">108</td><td align="center"><italic>3</italic></td><td align="center">35</td><td align="center"><bold>9</bold></td><td align="center">76</td><td align="center"><italic>1</italic></td><td align="center">22</td></tr><tr><td align="left">{m, m}</td><td align="center">1</td><td align="center">51</td><td align="center"><italic>1</italic></td><td align="center">79</td><td align="center"><italic>1</italic></td><td align="center">85</td><td align="center"><italic>1</italic></td><td align="center">68</td></tr><tr><td align="left">{n, n}</td><td align="center">1</td><td align="center">14</td><td align="center"><italic>1</italic></td><td align="center">35</td><td align="center"><italic>1</italic></td><td align="center">41</td><td align="center"><italic>1</italic></td><td align="center">93</td></tr><tr><td align="left">{o, o}</td><td align="center">1</td><td align="center">92</td><td align="center"><italic>1</italic></td><td align="center">92</td><td align="center"><italic>1</italic></td><td align="center">102</td><td align="center"><italic>1</italic></td><td align="center">76</td></tr><tr><td align="left">{p, p}</td><td align="center"><bold>78</bold></td><td align="center"><bold>1</bold></td><td align="center"><bold>48</bold></td><td align="center"><bold>1</bold></td><td align="center"><bold>46</bold></td><td align="center"><bold>1</bold></td><td align="center"><bold>65</bold></td><td align="center"><bold>1</bold></td></tr><tr><td align="left">{q, q}</td><td align="center">1</td><td align="center">117</td><td align="center"><italic>1</italic></td><td align="center">96</td><td align="center"><italic>1</italic></td><td align="center">87</td><td align="center"><italic>1</italic></td><td align="center">111</td></tr><tr><td align="left">{r, r}</td><td align="center">1</td><td align="center">118</td><td align="center"><italic>1</italic></td><td align="center">110</td><td align="center"><italic>1</italic></td><td align="center">115</td><td align="center"><italic>1</italic></td><td align="center">112</td></tr><tr><td align="left">{s, s}</td><td align="center">1</td><td align="center">116</td><td align="center"><italic>1</italic></td><td align="center">108</td><td align="center"><italic>1</italic></td><td align="center">109</td><td align="center"><italic>1</italic></td><td align="center">113</td></tr><tr><td align="left">{t, t}</td><td align="center">1</td><td align="center">69</td><td align="center"><italic>1</italic></td><td align="center">93</td><td align="center"><italic>3</italic></td><td align="center">20</td><td align="center"><italic>1</italic></td><td align="center">103</td></tr><tr><td align="left">{u, u}</td><td align="center">1</td><td align="center">116</td><td align="center"><italic>1</italic></td><td align="center">103</td><td align="center"><italic>1</italic></td><td align="center">72</td><td align="center"><italic>1</italic></td><td align="center">84</td></tr><tr><td align="left">{v, v}</td><td align="center">1</td><td align="center">83</td><td align="center"><italic>1</italic></td><td align="center">104</td><td align="center"><italic>1</italic></td><td align="center">85</td><td align="center"><italic>1</italic></td><td align="center">64</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="left">b)</td><td align="center" colspan="2">A1 v B</td><td align="center" colspan="2">A2 v C</td><td align="center" colspan="2">A3 v D</td><td align="center" colspan="2">A4 v E</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td></td><td align="center">D_{mm}</td><td align="center">D'_{mm}</td><td align="center">D_{mm}</td><td align="center">D'_{mm}</td><td align="center">D_{mm}</td><td align="center">D'_{mm}</td><td align="center">D_{mm}</td><td align="center">D'_{mm}</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="left">MEAN</td><td align="center">0.26</td><td align="center">0.96</td><td align="center">0.23</td><td align="center">0.88</td><td align="center">0.19</td><td align="center">0.81</td><td align="center">0.21</td><td align="center">0.88</td></tr><tr><td align="left">SD</td><td align="center">0.14</td><td align="center">0.1</td><td align="center">0.14</td><td align="center">0.14</td><td align="center">0.1</td><td align="center">0.17</td><td align="center">0.13</td><td align="center">0.14</td></tr><tr><td align="left">{pp}</td><td align="center">0.95</td><td></td><td align="center">0.84</td><td></td><td align="center">0.85</td><td></td><td align="center">0.97</td><td></td></tr><tr><td align="left">{pp}</td><td></td><td align="center">0.21</td><td></td><td align="center">0.14</td><td></td><td align="center">0.23</td><td></td><td align="center">0.24</td></tr><tr><td align="left">P-value</td><td align="center">4.10E-07</td><td align="center">3.20E-14</td><td align="center">6.60E-06</td><td align="center">6.30E-08</td><td align="center">2.10E-11</td><td align="center">3.20E-04</td><td align="center">2.50E-09</td><td align="center">2.40E-06</td></tr></tbody></table></table-wrap><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Plate rotation distance comparison. </bold>Histogram of the distance comparisons for the plate rotated and not rotated cases. The distributions are well separated, where the green bars refer to the distance distributions for non-rotated plates and the red bars for rotated plates.</p></caption><graphic xlink:href="1471-2164-5-64-5"/></fig></sec><sec><title>Finding a misidentified 384-well plate</title><p>In this example we compare four arrays A1, A2, A3 and A4 from a particular print batch A to four other arrays B, C, D and E from four other distinct print batches. As seen in Table <xref ref-type="table" rid="T4">4a</xref> no plate is found to be a candidate for plate rotation, however we do find that plate <italic>q </italic>has a poor self-match comparison. Indeed, when the distance matrix is examined, we see the plate matches instead plate <italic>r </italic>across the four array comparisons. We check the three criteria for plate misidentification and summarize these data in Table <xref ref-type="table" rid="T4">4b</xref>. In Figure <xref ref-type="fig" rid="F6">6</xref> we show the distributions of the match and mismatch distributions. These distributions are quite distinct and give us confidence that we can distinguish the proper match from an accidental match.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Test for swapped plates. a) Plate <italic>r </italic>is seen here to have a problem, but from the table we see that it is most certainly not a plate rotation. b) A check of the distance matrix shows the <italic>{r, q} </italic>comparison to be quite good and satisfies the criteria for a match, indicating that plates <italic>r </italic>and <italic>q </italic>have been accidentally swapped.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">a)</td><td align="center" colspan="2">A1 v B</td><td align="center" colspan="2">A2 v C</td><td align="center" colspan="2">A3 v D</td><td align="center" colspan="2">A4 v E</td></tr></thead><tbody><tr><td align="left">Plates</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td><td align="center">R_{mm}</td><td align="center">R'_{mm}</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="left">{i, i}</td><td align="center">1</td><td align="center">82</td><td align="center">1</td><td align="center">48</td><td align="center">1</td><td align="center">107</td><td align="center">1</td><td align="center">76</td></tr><tr><td align="left">{j, j}</td><td align="center">1</td><td align="center">45</td><td align="center">1</td><td align="center">87</td><td align="center">1</td><td align="center">87</td><td align="center">1</td><td align="center">89</td></tr><tr><td align="left">{k, k}</td><td align="center">1</td><td align="center">18</td><td align="center">1</td><td align="center">45</td><td align="center">1</td><td align="center">63</td><td align="center">1</td><td align="center">15</td></tr><tr><td align="left">{l, l}</td><td align="center">1</td><td align="center">85</td><td align="center">1</td><td align="center">106</td><td align="center">1</td><td align="center">103</td><td align="center">1</td><td align="center">93</td></tr><tr><td align="left">{m, m}</td><td align="center">1</td><td align="center">30</td><td align="center">1</td><td align="center">49</td><td align="center">1</td><td align="center">53</td><td align="center">1</td><td align="center">37</td></tr><tr><td align="left">{n, n}</td><td align="center">1</td><td align="center">115</td><td align="center">1</td><td align="center">113</td><td align="center">1</td><td align="center">37</td><td align="center">1</td><td align="center">102</td></tr><tr><td align="left">{o, o}</td><td align="center">1</td><td align="center">24</td><td align="center">1</td><td align="center">64</td><td align="center">1</td><td align="center">82</td><td align="center">1</td><td align="center">100</td></tr><tr><td align="left">{p, p}</td><td align="center">1</td><td align="center">110</td><td align="center">1</td><td align="center">102</td><td align="center">1</td><td align="center">104</td><td align="center">1</td><td align="center">93</td></tr><tr><td align="left">{q, q}</td><td align="center">1</td><td align="center">118</td><td align="center">1</td><td align="center">111</td><td align="center">1</td><td align="center">110</td><td align="center">1</td><td align="center">91</td></tr><tr><td align="left">{r, r}</td><td align="center"><bold>77</bold></td><td align="center">7</td><td align="center"><bold>48</bold></td><td align="center">12</td><td align="center"><bold>51</bold></td><td align="center">22</td><td align="center"><bold>16</bold></td><td align="center">23</td></tr><tr><td align="left">{s, s}</td><td align="center">1</td><td align="center">55</td><td align="center">1</td><td align="center">44</td><td align="center">1</td><td align="center">90</td><td align="center">1</td><td align="center">88</td></tr><tr><td align="left">{t, t}</td><td align="center">1</td><td align="center">115</td><td align="center">1</td><td align="center">101</td><td align="center">1</td><td align="center">110</td><td align="center">1</td><td align="center">99</td></tr><tr><td align="left">{u, u}</td><td align="center">1</td><td align="center">118</td><td align="center">1</td><td align="center">93</td><td align="center">1</td><td align="center">74</td><td align="center">1</td><td align="center">95</td></tr><tr><td align="left">{v, v}</td><td align="center">1</td><td align="center">15</td><td align="center">1</td><td align="center">13</td><td align="center">1</td><td align="center">29</td><td align="center">1</td><td align="center">71</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="left">b)</td><td align="center" colspan="2">A1 v B</td><td align="center" colspan="2">A2 v C</td><td align="center" colspan="2">A3 v D</td><td align="center" colspan="2">A4 v E</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td></td><td align="center">D_{mm}</td><td align="center">D_{mn}</td><td align="center">D_{mm}</td><td align="center">D_{mn}</td><td align="center">D_{mm}</td><td align="center">D_{mn}</td><td align="center">D_{mm}</td><td align="center">D_{mn}</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="left">MEAN</td><td align="center">0.19</td><td align="center">0.93</td><td align="center">0.25</td><td align="center">0.94</td><td align="center">0.28</td><td align="center">0.95</td><td align="center">0.2</td><td align="center">0.81</td></tr><tr><td align="left">SD</td><td align="center">0.14</td><td align="center">0.07</td><td align="center">0.19</td><td align="center">0.07</td><td align="center">0.17</td><td align="center">0.07</td><td align="center">0.16</td><td align="center">0.1</td></tr><tr><td align="left">{rq}</td><td></td><td align="center">0.3</td><td></td><td align="center">0.26</td><td></td><td align="center">0.25</td><td></td><td align="center">0.34</td></tr><tr><td align="left">{rr}</td><td align="center">0.97</td><td></td><td align="center">0.95</td><td></td><td align="center">0.98</td><td></td><td align="center">0.72</td><td></td></tr><tr><td align="left">P-value</td><td align="center">1.30E-08</td><td align="center">0</td><td align="center">1.10E-04</td><td align="center">0</td><td align="center">1.90E-05</td><td align="center">0</td><td align="center">5.80E-04</td><td align="center">1.30E-06</td></tr></tbody></table></table-wrap><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Misidentification distance comparison. </bold>Misidentified plate distance histogram showing good separation between the match and mismatch distance distributions. The green bars refer to the distance distributions of matched plates and the red bars for mis-matched plates.</p></caption><graphic xlink:href="1471-2164-5-64-6"/></fig></sec></sec><sec><title>Discussion</title><p>Out of the 265 million features checked in our database using MuFu, problems were detected and corrected on 1.3 million of them. That we were able to find and correct both previously known and unknown problems gives us confidence in the algorithm. That so few problems existed overall (0.5%) reassures us as to the robustness of our process in general.</p><p>Microarray data, by its sheer volume, presents interesting laboratory information management challenges. The data arrive at the investigators desk after a significant number of steps. We have found that the better you track production, quality control, and experimental steps, the better chance you have of uncovering the reasons behind discrepancies that may appear in the data. Often, statistical analyses look only at the data presented as final expression values or ratios, without taking into account relevant quality control data. In our effort to understand our errors and the source of large systematic discrepancies in our data we have found the MuFu algorithm a useful test of certain classes of process errors, and as a check for general problems with specific process steps or microtiter plates. We use MuFu to find, verify and fix problems that can be attributed to an error in plate processing. We also flag plates for which we can find no specific problem but we see yield inconsistent results. These may be plates that, at some point in the process, had a problem (cross contamination, a PCR problem) that was not detected while the process step was being carried out. The fact that we can test the data, using our standard quality control hybridizations, for these types of quality issues is reassuring and has helped us gain confidence in our data.</p><p>Obviously, there are many other classes of error that creep into microarray data. Aside from the gross process errors that are amenable to detection, as we have described here, there is also a large class of more subtle systematic errors that can contribute to the overall systematic error on the expression ratio measurement. Isolating the source of these individual errors is sometimes quite difficult. Properties of the microarray feature such as spot size, shape and uniformity can contribute, but the majority of systematic errors are introduced at the time the experiment is performed. Slide post processing, RNA quality, labelling, hybridization and washing all lend the possibility for introducing systematic errors. Improvements in protocols and hybridization apparatus have helped reduce these errors and should continue to do so in the future. As these sources of error are identified and eliminated, expression microarrays will continue to provide progressively more sensitive measures of gene expression.</p></sec><sec><title>Conclusions</title><p>Process errors in any genome scale high throughput production regime can lead to subsequent errors in data analysis. We have shown the value of tracking multi-step high throughput operations by using this knowledge to detect and correct misidentified data on gene expression microarrays. We generalized our procedure using a simple heuristic, which found and fixed several problems with the proper assignment of gene identifier with physical microarray feature. We found thirteen print runs (9K arrays) that had four plates mistracked, six print runs with single 384 plate rotations, and one instance of a plate rotation at the 96 well plate level. One skipped plate was detected, as well as one plate printed twice. Out of the 265 million features checked in our database using MuFu, problems were detected and corrected on 1.3 million of them. That we were able to find and correct both previously known and unknown problems gives us confidence in the algorithm. That so few problems existed overall (0.5%) reassures us as to the robustness of our process in general. A list of corrected arrays can be found at <ext-link ext-link-type="uri" xlink:href="http://www.microarray.org/mufu"/>.</p></sec><sec sec-type="methods"><title>Methods</title><p>We follow the simple heuristic outlined here. The flowchart for the program is shown in Figure <xref ref-type="fig" rid="F1">1</xref>. In the figure we do not include additional loops needed to repartition the data in different ways for different scenarios.</p><sec><title>Data partitioning</title><p>1. Begin by partitioning the gene expression data on an array into subsets according to plate. Other partitions can also be made but the plate level partition is the most useful for our purposes. Let <italic>A</italic><sub><italic>ij </italic></sub>be the intensity measurements of array <italic>A</italic>, subset <italic>i </italic>and gene index <italic>j</italic>. The measurements are usually of the channel (Cy3 or Cy5) used as a common reference. For example, if we partition the data by the 384-well plate each feature once occupied at some point in its process history, <italic>A </italic>is the array id, <italic>i </italic>is the plate id, and <italic>j </italic>is the well index between 1&#x02013;384. Let <italic>A</italic><sub><italic>i </italic></sub>be the vector (<italic>A</italic><sub><italic>i</italic>1</sub>,...,<italic>A</italic><sub><italic>i</italic>384</sub>). In our vernacular this is the 384-well plate expression vector for plate <italic>i</italic>. Let <italic>B</italic><sub><italic>ij </italic></sub>and<italic>B</italic><sub><italic>i </italic></sub>be the similar definitions for array <italic>B</italic>. We also reverse the data vectors from array <italic>A </italic>and label it <italic>A</italic><sub><italic>i</italic></sub>' . In our notation, <italic>A</italic><sub><italic>i</italic></sub>' = (<italic>A</italic><sub><italic>i</italic>384</sub>,...,<italic>A</italic><sub><italic>i</italic>1</sub>) is the expression vector for a plate rotated by 180&#x000b0;.</p><p>2. Generate a distance matrix {<italic>D</italic><sub><italic>mn</italic></sub>, 1 &#x02264; <italic>m, n </italic>&#x02264; <italic>N</italic>} in which each element <italic>D</italic><sub><italic>mn </italic></sub>= 1 - <italic>corr</italic>(<italic>A</italic><sub><italic>m</italic></sub>, <italic>B</italic><sub><italic>n</italic></sub>). For the 384-well plate example, <italic>A</italic><sub><italic>m </italic></sub>is the 384-well expression vector for plate <italic>m </italic>on array <italic>A</italic>, <italic>B</italic><sub><italic>n </italic></sub>is the 384-well expression vector for plate <italic>n </italic>on array <italic>B</italic>, and <italic>D</italic><sub><italic>mn </italic></sub>is the distance between the two vectors in this 384 dimensional space. We also generate the corresponding rotated-distance matrix {<italic>D'</italic><sub><italic>mn</italic></sub>, 1 &#x02264; <italic>m, n </italic>&#x02264; <italic>N</italic>} for the plate rotation case, in which each element <italic>D'</italic><sub><italic>mn </italic></sub>= 1 - <italic>corr</italic>(<italic>A'</italic><sub><italic>m</italic></sub>, <italic>B</italic><sub><italic>n</italic></sub>). We tried several correlation functions including Euclidean and Pearson but found the Pearson to be best suited to this task.</p><p>3. Generate a rank matrix {<italic>R</italic><sub><italic>mn</italic></sub>, 1 &#x02264; <italic>m, n </italic>&#x02264; <italic>N</italic>} by converting the distances to ranks such that the row <italic>m </italic>in the rank matrix is the order statistic of the row <italic>m </italic>of the distance matrix. We also generate the corresponding rotated-rank matrix {<italic>R'</italic><sub><italic>mn</italic></sub>} for {<italic>D'</italic><sub><italic>mn</italic></sub>}. Ideally, for the case where we are comparing identical subsets from two different arrays we expect the diagonal elements of the rank matrix to all be equal to one, which means that each subset of genes from the first array matches its corresponding subset in the second array the best. In general, due to the statistical variation in array data, the diagonal elements are not all equal to one, even if there are no misidentification errors. The examples show that this does not hinder us from making a clear distinction between real problems in the data and statistical fluctuations.</p></sec><sec><title>Identification of rotated plates</title><p>A plate rotation may have an affect on a single microarray batch if it occurs during array printing or may persist across many print batches if it happens during a 96-well (PCR) process step. In any case, the mismatch will persist across many array comparisons. To check for plate rotations in a print batch, we compare an array sample (<italic>A1, A2, A3, A4 </italic>in the example) from the print batch in question to a control sample of arrays (<italic>B, C, D, E </italic>in the example) selected from several distinct print batches. By comparing the rank <italic>R</italic>, and rotated-rank <italic>R'</italic>, matrix assignments for comparisons across array batch boundaries we can quickly flag possible rotated plates. A visualization of this test is shown in Table <xref ref-type="table" rid="T3">3a</xref>. In the table we have flagged the top 5% of all ranks in the rotated column and the bottom 95% in the unrotated column. If the flags agree across all comparisons, we have a strong indication that a plate rotation has occurred. If we see a flag raised in this test, but we cannot attribute it to a plate rotation, this may indicate a different class of process error. In particular, if the flag is raised for all pairwise comparisons of the batch being tested (in this case batch <italic>A</italic>) against all of the control batches (in this case batches <italic>B, C, D </italic>and <italic>E</italic>) in the non-rotated case, we conclude that the corresponding flagged plate or partition from batch <italic>A </italic>may be misidentified. Note that in the limit that the partitions of the array are all uniform in expression ratios there is a 5% probability of a spurious flag. For this reason it is better to use high quality, highly variegated control arrays for such tests. Next, to better resolve ambiguous cases and to check our rank matrix determination we use the distance rather than rank matrix. If, for example, a plate <italic>x </italic>is to be considered a rotated plate, the following three criteria must be met.</p><p>1. <italic>D'</italic><sub><italic>xx </italic></sub>&#x0003c;<italic>D</italic><sub><italic>xx</italic></sub>. The rotated-distance must be less than the non-rotated distance.</p><p>2. <italic>D'</italic><sub><italic>xx </italic></sub>is close to the mean of the distribution, {<italic>D</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>}, and D<sub><italic>xx </italic></sub>is close to the mean of the distribution {<italic>D'</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>}.</p><p>3. <italic>D'</italic><sub><italic>xx </italic></sub>is an outlier of the distribution {<italic>D'</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>}, and <italic>D</italic><sub><italic>xx </italic></sub>is an outlier of the distribution {<italic>D</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>}.</p><p>The second and third criteria above are valid if the distributions of {<italic>D'</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>} and {<italic>D</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>} separate well. In Figure <xref ref-type="fig" rid="F5">5</xref> we showed that our data support this model.</p></sec><sec><title>Finding misidentified plates</title><p>If a plate has consistently poor self-match rankings and a plate rotation has been excluded as a possible source of error, this next step tests for a plate misidentification. From the rank matrix we can identify the best alternative match. We test a suspect plate <italic>x </italic>for a match with plate <italic>y </italic>with the following criteria:</p><p>1. <italic>D</italic><sub><italic>xy </italic></sub>&#x0003c;<italic>D</italic><sub><italic>xx</italic></sub>. The mismatch distance is shorter than the match distance.</p><p>2. <italic>D</italic><sub><italic>xy </italic></sub>is close to the mean of the distribution {<italic>D</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>}, and <italic>D</italic><sub><italic>xx </italic></sub>is close to the mean of the distribution {<italic>D</italic><sub><italic>mn</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02260; <italic>n </italic>&#x02264; <italic>N</italic>}.</p><p>3. <italic>D</italic><sub><italic>xx </italic></sub>is an outlier of the distribution {<italic>D</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>}, and <italic>D</italic><sub><italic>xy </italic></sub>is an outlier of the distribution {<italic>D</italic><sub><italic>mn</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02260; <italic>n </italic>&#x02264; <italic>N</italic>}.</p><p>Again, the second and third criteria above are valid if the distributions of {<italic>D</italic><sub><italic>mm</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02264; <italic>N</italic>} and {<italic>D</italic><sub><italic>mn</italic></sub>, 1 &#x02264; <italic>m </italic>&#x02260; <italic>n </italic>&#x02264; <italic>N</italic>} are well resolved.</p></sec></sec><sec><title>Authors' contributions</title><p>IT, MF developed the heuristic and carried out analysis and implementation.</p><p>MS brought this problem to our attention and provided test data.</p><p>MD provided advice and checked our work with an alternative technique.</p><p>All authors read and approved the final manuscript.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Process steps The process fail points for cDNA based microarray production. Steps shown in italics are accessible to the testing methods outlined here. Earlier steps may require sequencing to test. The process ID is used to identify steps where the problems, if any, are found.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Process ID</td><td align="left">Problem Type</td><td align="left">Note</td></tr></thead><tbody><tr><td align="left">-999</td><td align="left">Unidentified</td><td></td></tr><tr><td align="left">0.0</td><td align="left">Source.General</td><td align="left">persists across all arrays at clone, 96 level</td></tr><tr><td align="left">0.1</td><td align="left">Source.Contamination</td><td></td></tr><tr><td align="left">0.2</td><td align="left">Source.MisID</td><td></td></tr><tr><td align="left">1.0</td><td align="left">Prep.General</td><td align="left">persists across all arrays at clone, 96 level</td></tr><tr><td align="left">1.1</td><td align="left">Prep.Contamination</td><td></td></tr><tr><td align="left">1.2</td><td align="left">Prep.MisID</td><td></td></tr><tr><td align="left">1.2.1</td><td align="left">Prep.MisID.OrderError</td><td></td></tr><tr><td align="left">1.2.2</td><td align="left">Prep.MisID.Rot</td><td></td></tr><tr><td align="left">1.3</td><td align="left">Prep.Fail</td><td></td></tr><tr><td align="left">2.0</td><td align="left"><italic>PCR.General</italic></td><td align="left">persists for 1 PCR round at 96 level</td></tr><tr><td align="left">2.1</td><td align="left"><italic>PCR.Contamination</italic></td><td></td></tr><tr><td align="left">2.2</td><td align="left"><italic>PCR.MisID</italic></td><td></td></tr><tr><td align="left">2.3</td><td align="left"><italic>PCR.Fail</italic></td><td></td></tr><tr><td align="left">2.4</td><td align="left"><italic>PCR.Cleanup</italic></td><td></td></tr><tr><td align="left">3.0</td><td align="left"><italic>Replate.General</italic></td><td align="left">persists for 1 PCR round at 96 level</td></tr><tr><td align="left">3.1</td><td align="left"><italic>Replate.Contamination</italic></td><td></td></tr><tr><td align="left">3.2</td><td align="left"><italic>Replate.MisID</italic></td><td></td></tr><tr><td align="left">3.2.1</td><td align="left"><italic>Replate.MisID.OrderError</italic></td><td></td></tr><tr><td align="left">3.2.2</td><td align="left"><italic>Replate.MisID.96Rot</italic></td><td></td></tr><tr><td align="left">3.2.3</td><td align="left"><italic>Replate.MisID.384Rot</italic></td><td></td></tr><tr><td align="left">4.0</td><td align="left"><italic>Print.General</italic></td><td align="left">persists for 1 print run batch at 384 level</td></tr><tr><td align="left">4.1</td><td align="left"><italic>Print.Contamination</italic></td><td></td></tr><tr><td align="left">4.2</td><td align="left"><italic>Print.MisID</italic></td><td></td></tr><tr><td align="left">4.2.1</td><td align="left"><italic>Print.MisID.OrderError</italic></td><td></td></tr><tr><td align="left">4.2.2</td><td align="left"><italic>Print.MisID.Rot</italic></td><td></td></tr><tr><td align="left">4.3</td><td align="left"><italic>Print.Fail</italic></td><td align="left">dried out plate, too concentrated, too weak etc.</td></tr><tr><td align="left">5.0</td><td align="left">Scan.General</td><td align="left">anything after array production</td></tr></tbody></table></table-wrap></sec></body><back><ack><sec><title>Acknowledgements</title><p>We thank members of the Brown and Botstein labs for encouragement and support. This work was supported in part by a grant from the National Cancer Institute.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Alizadeh</surname><given-names>A</given-names></name></person-group><article-title>Probing lymphocyte biology by genomic-scale gene expression analysis</article-title><source>J Clin Immunol</source><year>1998</year><volume>18</volume><fpage>373</fpage><lpage>379</lpage><pub-id pub-id-type="pmid">9857281</pub-id><pub-id pub-id-type="doi">10.1023/A:1023293621057</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lossos</surname><given-names>IS</given-names></name><name><surname>Alizadeh</surname><given-names>AA</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Chan</surname><given-names>WC</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Staudt</surname><given-names>LM</given-names></name><name><surname>Levy</surname><given-names>R</given-names></name></person-group><article-title>Ongoing immunoglobulin somatic mutation in germinal center B cell-like but not in activated B cell-like diffuse large cell lymphomas</article-title><source>Proc Natl Acad Sci U S A</source><year>2000</year><volume>97</volume><fpage>10209</fpage><lpage>13</lpage><pub-id pub-id-type="pmid">10954754</pub-id><pub-id pub-id-type="doi">10.1073/pnas.180316097</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>DePrimo</surname><given-names>SE</given-names></name><name><surname>Diehn</surname><given-names>M</given-names></name><name><surname>Nelson</surname><given-names>JB</given-names></name><name><surname>Reiter</surname><given-names>RE</given-names></name><name><surname>Matese</surname><given-names>J</given-names></name><name><surname>Fero</surname><given-names>M</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Brooks</surname><given-names>JD</given-names></name></person-group><article-title>Transcriptional programs activated by exposure of human prostate cancer cells to androgen</article-title><source>Genome Biol</source><year>2002</year><volume>3</volume><fpage>RESEARCH0032</fpage><pub-id pub-id-type="pmid">12184806</pub-id><pub-id pub-id-type="doi">10.1186/gb-2002-3-7-research0032</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jeffrey</surname><given-names>SS</given-names></name><name><surname>Fero</surname><given-names>MJ</given-names></name><name><surname>B&#x000f8;rresen-Dale</surname><given-names>A-L</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Expression array technology: applications for the diagnosis and treatment of breast cancer</article-title><source>Mol Interv</source><year>2002</year><volume>2</volume><fpage>101</fpage><lpage>109</lpage><pub-id pub-id-type="pmid">14993355</pub-id><pub-id pub-id-type="doi">10.1124/mi.2.2.101</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>TO</given-names></name><name><surname>West</surname><given-names>RB</given-names></name><name><surname>Linn</surname><given-names>SC</given-names></name><name><surname>Alter</surname><given-names>O</given-names></name><name><surname>Knowling</surname><given-names>MA</given-names></name><name><surname>O'Connell</surname><given-names>JX</given-names></name><name><surname>Zhu</surname><given-names>S</given-names></name><name><surname>Fero</surname><given-names>M</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><name><surname>Pollack</surname><given-names>JR</given-names></name><etal></etal></person-group><article-title>Molecular characterisation of soft tissue tumours: a gene expression study</article-title><source>Lancet</source><year>2002</year><volume>359</volume><fpage>1301</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">11965276</pub-id><pub-id pub-id-type="doi">10.1016/S0140-6736(02)08270-3</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schaner</surname><given-names>ME</given-names></name><name><surname>Ross</surname><given-names>DT</given-names></name><name><surname>Ciaravino</surname><given-names>G</given-names></name><name><surname>Sorlie</surname><given-names>T</given-names></name><name><surname>Troyanskaya</surname><given-names>O</given-names></name><name><surname>Diehn</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>YC</given-names></name><name><surname>Duran</surname><given-names>GE</given-names></name><name><surname>Sikic</surname><given-names>TL</given-names></name><name><surname>Caldeira</surname><given-names>S</given-names></name><etal></etal></person-group><article-title>Gene expression patterns in ovarian carcinomas</article-title><source>Mol Biol Cell</source><year>2003</year><volume>14</volume><fpage>4376</fpage><lpage>86</lpage><pub-id pub-id-type="pmid">12960427</pub-id><pub-id pub-id-type="doi">10.1091/mbc.E03-05-0279</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Higgins</surname><given-names>JP</given-names></name><name><surname>Shinghal</surname><given-names>R</given-names></name><name><surname>Gill</surname><given-names>H</given-names></name><name><surname>Reese</surname><given-names>JH</given-names></name><name><surname>Terris</surname><given-names>M</given-names></name><name><surname>Cohen</surname><given-names>RJ</given-names></name><name><surname>Fero</surname><given-names>M</given-names></name><name><surname>Pollack</surname><given-names>JR</given-names></name><name><surname>van de Rijn</surname><given-names>M</given-names></name><name><surname>Brooks</surname><given-names>JD</given-names></name></person-group><article-title>Gene expression patterns in renal cell carcinoma assessed by complementary DNA microarray</article-title><source>Am J Pathol</source><year>2003</year><volume>162</volume><fpage>925</fpage><lpage>32</lpage><pub-id pub-id-type="pmid">12598325</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hastie</surname><given-names>T</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Alizadeh</surname><given-names>A</given-names></name><name><surname>Levy</surname><given-names>R</given-names></name><name><surname>Staudt</surname><given-names>L</given-names></name><name><surname>Chan</surname><given-names>WC</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Brown</surname><given-names>P</given-names></name></person-group><article-title>'Gene shaving' as a method for identifying distinct sets of genes with similar expression patterns</article-title><source>Genome Biol</source><year>2000</year><volume>1</volume><fpage>RESEARCH0003</fpage><pub-id pub-id-type="pmid">11178228</pub-id><pub-id pub-id-type="doi">10.1186/gb-2000-1-2-research0003</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Alter</surname><given-names>O</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Singular value decomposition for genome-wide expression data processing and modeling</article-title><source>Proc Natl Acad Sci U S A</source><year>2000</year><volume>97</volume><fpage>10101</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">10963673</pub-id><pub-id pub-id-type="doi">10.1073/pnas.97.18.10101</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Troyanskaya</surname><given-names>O</given-names></name><name><surname>Cantor</surname><given-names>M</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><name><surname>Brown</surname><given-names>P</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Altman</surname><given-names>RB</given-names></name></person-group><article-title>Missing value estimation methods for DNA microarrays</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>520</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">11395428</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/17.6.520</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Cluster analysis and display of genome-wide expression patterns</article-title><source>Proc Natl Acad Sci U S A</source><year>1998</year><volume>95</volume><fpage>14863</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">9843981</pub-id><pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sherlock</surname><given-names>G</given-names></name></person-group><article-title>Analysis of large-scale gene expression data</article-title><source>Brief Bioinform</source><year>2001</year><volume>2</volume><fpage>350</fpage><lpage>62</lpage><pub-id pub-id-type="pmid">11808747</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tusher</surname><given-names>VG</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Chu</surname><given-names>G</given-names></name></person-group><article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title><source>Proc Natl Acad Sci USA</source><year>2001</year><volume>98</volume><fpage>5116</fpage><lpage>21</lpage><pub-id pub-id-type="pmid">11309499</pub-id><pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id></citation></ref><ref id="B14"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Natalia Novoradovskaya</surname><given-names>MLW</given-names></name><name><surname>Lee Basehore</surname><given-names>S</given-names></name><name><surname>Alexey</surname><given-names>Novoradovsky</given-names></name><name><surname>Robert</surname><given-names>Pesich</given-names></name><name><surname>Jerry</surname><given-names>Usary</given-names></name><name><surname>Mehmet</surname><given-names>Karaca</given-names></name><name><surname>Olga</surname><given-names>Aprelikova</given-names></name><name><surname>Winston Wong</surname><given-names>K</given-names></name><name><surname>Michael</surname><given-names>Fero</given-names></name><name><surname>Charles Perou</surname><given-names>M</given-names></name><name><surname>David</surname><given-names>Botstein</given-names></name><name><surname>Jeff</surname><given-names>Braman</given-names></name></person-group><article-title>Universal Reference RNA as a standard for microarray experiments</article-title><source>Accepted for publication &#x02013; BMC Genomics</source><year>2004</year></citation></ref></ref-list></back></article>



