<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id><journal-title>BMC Evolutionary Biology</journal-title><issn pub-type="epub">1471-2148</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15629063</article-id><article-id pub-id-type="pmc">PMC544347</article-id><article-id pub-id-type="publisher-id">1471-2148-5-2</article-id><article-id pub-id-type="doi">10.1186/1471-2148-5-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Rooting a phylogenetic tree with nonreversible substitution models</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Yap</surname><given-names>Von Bing</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>vonbing@math.berkeley.edu</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Speed</surname><given-names>Terry</given-names></name><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>terry@stat.berkeley.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Mathematics Department, University of California, 970 Evans Hall, Berkeley, CA 94720, USA</aff><aff id="I2"><label>2</label>Statistics Department, University of California, 367 Evans Hall, Berkeley, CA 94720, USA</aff><aff id="I3"><label>3</label>Division of Genetics and Bioinformatics, The Walter &#x00026; Eliza Hall Institute of Medical Research, 1G Royal Parade, Parkville, Vic 3052, Australia</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>4</day><month>1</month><year>2005</year></pub-date><volume>5</volume><fpage>2</fpage><lpage>2</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2148/5/2"/><history><date date-type="received"><day>5</day><month>8</month><year>2004</year></date><date date-type="accepted"><day>4</day><month>1</month><year>2005</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2005 Yap and Speed; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2005</copyright-year><copyright-holder>Yap and Speed; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Yap
               Von Bing
               
               vonbing@math.berkeley.edu
            </dc:author><dc:title>
            Rooting a phylogenetic tree with nonreversible substitution models
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Evolutionary Biology 5(1): 2-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2148(2005)5:1&#x0003c;2&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2148</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>We compared two methods of rooting a phylogenetic tree: the stationary and the nonstationary substitution processes. These methods do not require an outgroup.</p></sec><sec sec-type="methods"><title>Methods</title><p>Given a multiple alignment and an unrooted tree, the maximum likelihood estimates of branch lengths and substitution parameters for each associated rooted tree are found; rooted trees are compared using their likelihood values. Site variation in substitution rates is handled by assigning sites into several classes before the analysis.</p></sec><sec><title>Results</title><p>In three test datasets where the trees are small and the roots are assumed known, the nonstationary process gets the correct estimate significantly more often, and fits data much better, than the stationary process. Both processes give biologically plausible root placements in a set of nine primate mitochondrial DNA sequences.</p></sec><sec><title>Conclusions</title><p>The nonstationary process is simple to use and is much better than the stationary process at inferring the root. It could be useful for situations where an outgroup is unavailable.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Several approaches for inferring a phylogenetic tree from the substitution patterns in multiply aligned sequences are available; they include maximum parsimony, distance-based, maximum likelihood and Bayesian methods [<xref ref-type="bibr" rid="B1">1</xref>]. Typically, the inferred tree is unrooted, because the explicit or implicit substitution process used is usually time-reversible. An effective way to put the root on the unrooted tree is to perform a phylogenetic analysis on the sequences of interest together with an outgroup, which is a set of distantly related sequences [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>]. If the ingroup is monophyletic in the combined phylogenetic tree, then the point where the outgroup touches the ingroup tree is the estimated root. The practical challenge is to find suitable outgroups, and if no such outgroup is available, then one is forced to root the tree using just the ingroup. Several such methods include the molecular clock and nonreversible substitution processes. It seems clear that compared to the outgroup method, the success of these methods is more dependent on the extent to which the accompanying assumptions about the substitution process are satisfied in the data. For example, the molecular clock method should work well if the lineages indeed evolved more or less at the same rate. Likewise, as shown by Huelsenbeck <italic>et al</italic>. [<xref ref-type="bibr" rid="B4">4</xref>], a nonreversible process is more likely to succeed the less reversible the real substitution process is.</p><p>The nonreversible substitution process, introduced by Yang [<xref ref-type="bibr" rid="B5">5</xref>], is <italic>stationary</italic>, i.e., the sequence composition is unchanged in time, and is equal to the equilibrium distribution of the rate matrix <italic>Q</italic>. The consensus is that it does not have enough power to discriminate among the candidate rooted trees. In this paper, we investigate a slightly more general, nonstationary process: in which the initial distribution <italic>&#x003c0; </italic>may not be the equilibrium distribution of the rate matrix <italic>Q</italic>. A priori, giving up stationarity is expected to produce a much better fit to data, since sequence composition is known to evolve, and should be accounted for. Indeed, substitution models where each branch has its own rate matrices had been used to resolve deep splittings in certain phylogenetic trees; see Yang and Roberts, and Galtier and Gouy [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. Our process, which to our knowledge has not been investigated in this context, may be viewed as the simplest case of such nonstationary processes, with many fewer parameters. Thus, it can be used to decide whether the substitution processes on certain branches should be modeled differently. The input to our procedure is a multiple alignment and the topology of an unrooted binary tree. For each rooted tree associated with the given unrooted tree, we seek the maximum likelihood (ML) estimates of the branch lengths, <italic>&#x003c0; </italic>and <italic>Q</italic>. The rooted trees are then ranked in descending order of likelihoods. We model systematic variation in substitution rates among sites by assigning sites into several classes, and the relative rate for each class is estimated by ML; this is equivalent to the combined analysis framework of Yang [<xref ref-type="bibr" rid="B8">8</xref>].</p><p>We compared the ability of the stationary and nonstationary processes to place the root in three groups of species where the answer is considered well-known: (1) human, chimpanzee and gorilla, (2) human, chimpanzee, gorilla and orangutan, (3) human, mouse, chicken and frog (<italic>xenopus laevis</italic>). The analyses were based on all available mitochondrial protein-coding genes, as well as two nuclear protein-coding genes. Next, we applied the methods to a set of primate mitochondrial DNA sequences.</p></sec><sec><title>Results</title><sec><title>Verification studies</title><p>We fitted the nonstationary (NONSTA), stationary (STA) and reversible (REV) substitution models to all available mitochondrial protein-coding genes, as well as the nuclear genes <italic>albumin </italic>and <italic>c-myc</italic>, for three groups of organisms: (1) human, chimpanzee and gorilla, (2) human, chimpanzee, gorilla and orangutan, and (3) human, mouse, chicken and frog (<italic>xenopus laevis</italic>). The sequences were downloaded from Genbank and aligned using the CLUSTALW alignment of the amino acid sequences. Most alignments looked quite solid [see Additional files]. The beginning of the alignments for the genes <italic>COX1</italic>, <italic>CYTB</italic>, <italic>ND1 </italic>and <italic>ND6 </italic>were slightly adjusted. The root positions are assumed to be on the (1) gorilla, (2) orangutan, and (3) frog branch, respectively. The branches on a tree are referred to by the organism names, except for the case of four taxa, where there is an internal branch (Figure <xref ref-type="fig" rid="F1">1</xref>). For groups (2) and (3), it was assumed that human was most closely related to chimpanzee and mouse respectively; thus the unrooted tree is determined.</p><p>In group 1, the NONSTA and STA processes correctly placed the root in 8 and 6 genes respectively, out of 13 genes (Table <xref ref-type="table" rid="T1">1</xref>). In group 2, NONSTA correctly placed the root in 9 genes out of 13 genes, compared to 2 genes for STA (Table <xref ref-type="table" rid="T2">2</xref>). In group 3, NONSTA correctly placed the root in 11 genes out of 15 genes, compared to 7 genes for STA (Table <xref ref-type="table" rid="T3">3</xref>). Furthermore, NONSTA gives stronger signal, or has better discriminative power: the highest-scoring rooted tree often has noticeably higher log likelihoods than competing rooted trees; this is not so with STA. Thus, NONSTA is much better than STA in placing the root at the individual gene level. Combining the log likelihoods across genes yields overall evidence for the root placements. Table <xref ref-type="table" rid="T4">4</xref> shows that NONSTA is unambiguously correct in all three analyses, while STA only gets the root correctly in group 3, and the signal is weak.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Unrooted tree with four taxa </bold>The four branches adjacent to leaf nodes will be referred to by the corresponding taxon names.</p></caption><graphic xlink:href="1471-2148-5-2-1"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Human, chimpanzee and gorilla Log-likelihoods (rounded to closest integer) of the MLEs for three rooted trees under the nonstationary (NONSTA), stationary (STA) and reversible (REV) models. If NONSTA or STA places the root correctly, the corresponding log likelihood appears in bold.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">gene</td><td align="left">root placement</td><td align="left">NONSTA</td><td align="center">STA</td><td align="center">REV</td></tr></thead><tbody><tr><td></td><td align="left">human</td><td align="right">-1320</td><td align="right">-1324</td><td align="right">-1324</td></tr><tr><td align="left">ATP6</td><td align="left">chimp</td><td align="right">-1318</td><td align="right">-1323</td><td align="right">-1324</td></tr><tr><td></td><td align="left">gorilla</td><td align="right">-1318</td><td align="right"><bold>-1322</bold></td><td align="right">-1324</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-384</td><td align="right">-389</td><td align="right">-392</td></tr><tr><td align="left">ATP8</td><td align="left">chimp</td><td align="right">-384</td><td align="right">-389</td><td align="right">-392</td></tr><tr><td></td><td align="left">gorilla</td><td align="right">-384</td><td align="right">-389</td><td align="right">-392</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2842</td><td align="right">-2876</td><td align="right">-2877</td></tr><tr><td align="left">COX1</td><td align="left">chimp</td><td align="right">-2846</td><td align="right">-2874</td><td align="right">-2876</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-2834</bold></td><td align="right">-2875</td><td align="right">-2876</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1285</td><td align="right">-1293</td><td align="right">-1295</td></tr><tr><td align="left">COX2</td><td align="left">chimp</td><td align="right">-1286</td><td align="right">-1294</td><td align="right">-1295</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-1281</bold></td><td align="right"><bold>-1292</bold></td><td align="right">-1295</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1477</td><td align="right">-1493</td><td align="right">-1496</td></tr><tr><td align="left">COX3</td><td align="left">chimp</td><td align="right">-1476</td><td align="right">-1493</td><td align="right">-1496</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-1472</bold></td><td align="right">-1493</td><td align="right">-1496</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2205</td><td align="right">-2236</td><td align="right">-2236</td></tr><tr><td align="left">CYTB</td><td align="left">chimp</td><td align="right">-2208</td><td align="right">-2235</td><td align="right">-2236</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-2203</bold></td><td align="right">-2235</td><td align="right">-2236</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1787</td><td align="right">-1804</td><td align="right">-1805</td></tr><tr><td align="left">ND1</td><td align="left">chimp</td><td align="right">-1783</td><td align="right">-1804</td><td align="right">-1805</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-1776</bold></td><td align="right"><bold>-1802</bold></td><td align="right">-1805</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1949</td><td align="right">-1974</td><td align="right">-1975</td></tr><tr><td align="left">ND2</td><td align="left">chimp</td><td align="right">-1950</td><td align="right">-1974</td><td align="right">-1975</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-1941</bold></td><td align="right">-1974</td><td align="right">-1975</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-663</td><td align="right">-679</td><td align="right">-680</td></tr><tr><td align="left">ND3</td><td align="left">chimp</td><td align="right">-666</td><td align="right">-679</td><td align="right">-680</td></tr><tr><td></td><td align="left">gorilla</td><td align="right">-665</td><td align="right"><bold>-679</bold></td><td align="right">-680</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2593</td><td align="right">-2612</td><td align="right">-2613</td></tr><tr><td align="left">ND4</td><td align="left">chimp</td><td align="right">-2589</td><td align="right">-2612</td><td align="right">-2613</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-2579</bold></td><td align="right">-2612</td><td align="right">-2613</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-519</td><td align="right">-525</td><td align="right">-525.8</td></tr><tr><td align="left">ND4L</td><td align="left">chimp</td><td align="right">-523</td><td align="right">-525</td><td align="right">-525.8</td></tr><tr><td></td><td align="left">gorilla</td><td align="right">-520</td><td align="right">-526</td><td align="right">-525.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-3600</td><td align="right">-3624</td><td align="right">-3629</td></tr><tr><td align="left">ND5</td><td align="left">chimp</td><td align="right">-3611</td><td align="right">-3628</td><td align="right">-3629</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-3583</bold></td><td align="right"><bold>-3628</bold></td><td align="right">-3629</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-913</td><td align="right">-917</td><td align="right">-918</td></tr><tr><td align="left">ND6</td><td align="left">chimp</td><td align="right">-912</td><td align="right">-917</td><td align="right">-918</td></tr><tr><td></td><td align="left">gorilla</td><td align="right">-913</td><td align="right"><bold>-917</bold></td><td align="right">-918</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Human, chimpanzee, gorilla and orangutan Log-likelihoods (rounded to closest integer) of the MLEs for five rooted trees under the nonstationary (NONSTA), stationary (STA) and reversible (REV) models. If NONSTA or STA places the root correctly, the corresponding log likelihood appears in bold.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">gene</td><td align="left">root placement</td><td align="left">NONSTA</td><td align="center">STA</td><td align="center">REV</td></tr></thead><tbody><tr><td></td><td align="left">human</td><td align="right">-1649</td><td align="right">-1654</td><td align="right">-1655</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-1647</td><td align="right">-1654</td><td align="right">-1655</td></tr><tr><td align="left">ATP6</td><td align="left">gorilla</td><td align="right">-1647</td><td align="right">-1654</td><td align="right">-1655</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-1642</bold></td><td align="right"><bold>-1654</bold></td><td align="right">-1655</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1647</td><td align="right">-1654</td><td align="right">-1655</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-510</td><td align="right">-514</td><td align="right">-517</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-510</td><td align="right">-515</td><td align="right">-517</td></tr><tr><td align="left">ATP8</td><td align="left">gorilla</td><td align="right">-509</td><td align="right">-515</td><td align="right">-517</td></tr><tr><td></td><td align="left">orangutan</td><td align="right">-509</td><td align="right">-515</td><td align="right">-517</td></tr><tr><td></td><td align="left">interior</td><td align="right">-509</td><td align="right">-515</td><td align="right">-517</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-3456</td><td align="right">-3465</td><td align="right">-3467</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-3450</td><td align="right">-3464</td><td align="right">-3467</td></tr><tr><td align="left">COX1</td><td align="left">gorilla</td><td align="right">-3448</td><td align="right">-3465</td><td align="right">-3467</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-3437</bold></td><td align="right">-3465</td><td align="right">-3467</td></tr><tr><td></td><td align="left">interior</td><td align="right">-3453</td><td align="right">-3465</td><td align="right">-3467</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1485</td><td align="right">-1496</td><td align="right">-1497</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-1485</td><td align="right">-1496</td><td align="right">-1497</td></tr><tr><td align="left">COX2</td><td align="left">gorilla</td><td align="right">-1481</td><td align="right">-1492</td><td align="right">-1497</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-1479</bold></td><td align="right">-1492</td><td align="right">-1497</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1480</td><td align="right">-1492</td><td align="right">-1497</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1769</td><td align="right">-1791</td><td align="right">-1796</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-1780</td><td align="right">-1791</td><td align="right">-1796</td></tr><tr><td align="left">COX3</td><td align="left">gorilla</td><td align="right">-1781</td><td align="right">-1794</td><td align="right">-1796</td></tr><tr><td></td><td align="left">orangutan</td><td align="right">-1772</td><td align="right">-1794</td><td align="right">-1796</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1780</td><td align="right">-1791</td><td align="right">-1796</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2593</td><td align="right">-2673</td><td align="right">-2674</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-2594</td><td align="right">-2673</td><td align="right">-2674</td></tr><tr><td align="left">CYTB</td><td align="left">gorilla</td><td align="right">-2590</td><td align="right">-2672</td><td align="right">-2674</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-2581</bold></td><td align="right">-2672</td><td align="right">-2674</td></tr><tr><td></td><td align="left">interior</td><td align="right">-2588</td><td align="right">-2672</td><td align="right">-2674</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2214</td><td align="right">-2234</td><td align="right">-2236</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-2210</td><td align="right">-2235</td><td align="right">-2236</td></tr><tr><td align="left">ND1</td><td align="left">gorilla</td><td align="right">-2205</td><td align="right">-2234</td><td align="right">-2236</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-2191</bold></td><td align="right"><bold>-2233</bold></td><td align="right">-2236</td></tr><tr><td></td><td align="left">interior</td><td align="right">-2209</td><td align="right">-2235</td><td align="right">-2236</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2441</td><td align="right">-2469</td><td align="right">-2470</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-2443</td><td align="right">-2469</td><td align="right">-2470</td></tr><tr><td align="left">ND2</td><td align="left">gorilla</td><td align="right">-2437</td><td align="right">-2469</td><td align="right">-2470</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-2423</bold></td><td align="right">-2469</td><td align="right">-2470</td></tr><tr><td></td><td align="left">interior</td><td align="right">-2437</td><td align="right">-2469</td><td align="right">-2470</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-837</td><td align="right">-855</td><td align="right">-856</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-840</td><td align="right">-855</td><td align="right">-856</td></tr><tr><td align="left">ND3</td><td align="left">gorilla</td><td align="right">-838</td><td align="right">-856</td><td align="right">-856</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-834</bold></td><td align="right">-855</td><td align="right">-856</td></tr><tr><td></td><td align="left">interior</td><td align="right">-838</td><td align="right">-855</td><td align="right">-856</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-3151</td><td align="right">-3206</td><td align="right">-3209</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-3149</td><td align="right">-3205</td><td align="right">-3209</td></tr><tr><td align="left">ND4</td><td align="left">gorilla</td><td align="right">-3141</td><td align="right">-3205</td><td align="right">-3209</td></tr><tr><td></td><td align="left">orangutan</td><td align="right">-3169</td><td align="right">-3207</td><td align="right">-3209</td></tr><tr><td></td><td align="left">interior</td><td align="right">-3145</td><td align="right">-3206</td><td align="right">-3209</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-623</td><td align="right">-631</td><td align="right">-631</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-622</td><td align="right">-631</td><td align="right">-631</td></tr><tr><td align="left">ND4L</td><td align="left">gorilla</td><td align="right">-620</td><td align="right">-631</td><td align="right">-631</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-619</bold></td><td align="right">-631</td><td align="right">-631</td></tr><tr><td></td><td align="left">interior</td><td align="right">-621</td><td align="right">-631</td><td align="right">-631</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-4469</td><td align="right">-4501</td><td align="right">-4503</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-4474</td><td align="right">-4502</td><td align="right">-4503</td></tr><tr><td align="left">ND5</td><td align="left">gorilla</td><td align="right">-4453</td><td align="right">-4502</td><td align="right">-4503</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-4448</bold></td><td align="right">-4503</td><td align="right">-4503</td></tr><tr><td></td><td align="left">interior</td><td align="right">-4466</td><td align="right">-4502</td><td align="right">-4503</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1069</td><td align="right">-1076</td><td align="right">-1078</td></tr><tr><td></td><td align="left">chimp</td><td align="right">-1067</td><td align="right">-1076</td><td align="right">-1078</td></tr><tr><td align="left">ND6</td><td align="left">gorilla</td><td align="right">-1070</td><td align="right">-1077</td><td align="right">-1078</td></tr><tr><td></td><td align="left">orangutan</td><td align="right">-1068</td><td align="right">-1077</td><td align="right">-1078</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1069</td><td align="right">-1076</td><td align="right">-1078</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Human, mouse, chicken and frog Log-likelihoods (rounded to closest integer) of the MLEs for five rooted trees under the nonstationary (NONSTA), stationary (STA) and reversible (REV) models. If NONSTA or STA places the root correctly, the corresponding log likelihood appears in bold.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">gene</td><td align="left">root placement</td><td align="left">NONSTA</td><td align="center">STA</td><td align="center">REV</td></tr></thead><tbody><tr><td></td><td align="left">human</td><td align="right">-7722</td><td align="right">-7728</td><td align="right">-7731</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-7708</td><td align="right">-7728</td><td align="right">-7731</td></tr><tr><td align="left">Albumin</td><td align="left">chicken</td><td align="right">-7723</td><td align="right">-7731</td><td align="right">-7731</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-7705</bold></td><td align="right"><bold>-7728</bold></td><td align="right">-7731</td></tr><tr><td></td><td align="left">interior</td><td align="right">-7723</td><td align="right">-7728</td><td align="right">-7731</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2608</td><td align="right">-2619</td><td align="right">-2620</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-2607</td><td align="right">-2619</td><td align="right">-2620</td></tr><tr><td align="left">ATP6</td><td align="left">chicken</td><td align="right">-2590</td><td align="right">-2619</td><td align="right">-2620</td></tr><tr><td></td><td align="left">frog</td><td align="right"><italic>-2585</italic></td><td align="right">-2618</td><td align="right">-2620</td></tr><tr><td></td><td align="left">interior</td><td align="right">-2585</td><td align="right">-2618</td><td align="right">-2620</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-679</td><td align="right">-680</td><td align="right">-682</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-677</td><td align="right">-681</td><td align="right">-682</td></tr><tr><td align="left">ATP8</td><td align="left">chicken</td><td align="right">-675</td><td align="right">-679</td><td align="right">-682</td></tr><tr><td></td><td align="left">frog</td><td align="right">-678</td><td align="right">-680</td><td align="right">-682</td></tr><tr><td></td><td align="left">interior</td><td align="right">-675</td><td align="right">-680</td><td align="right">-682</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-3872</td><td align="right">-3885</td><td align="right">-3887</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-3869</td><td align="right">-3885</td><td align="right">-3887</td></tr><tr><td align="left">Cmyc</td><td align="left">chicken</td><td align="right">-3854</td><td align="right">-3883</td><td align="right">-3887</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-3814</bold></td><td align="right"><bold>-3882</bold></td><td align="right">-3887</td></tr><tr><td></td><td align="left">interior</td><td align="right">-3853</td><td align="right">-3883</td><td align="right">-3887</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-4704</td><td align="right">-4792</td><td align="right">-4794</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-4709</td><td align="right">-4791</td><td align="right">-4794</td></tr><tr><td align="left">COX1</td><td align="left">chicken</td><td align="right">-4700</td><td align="right">-4794</td><td align="right">-4794</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-4679</bold></td><td align="right"><bold>-4791</bold></td><td align="right">-4794</td></tr><tr><td></td><td align="left">interior</td><td align="right">-4698</td><td align="right">-4792</td><td align="right">-4794</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2382</td><td align="right">-2399</td><td align="right">-2400</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-2382</td><td align="right">-2399</td><td align="right">-2400</td></tr><tr><td align="left">COX2</td><td align="left">chicken</td><td align="right">-2377</td><td align="right">-2398</td><td align="right">-2400</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-2375</bold></td><td align="right"><bold>-2398</bold></td><td align="right">-2400</td></tr><tr><td></td><td align="left">interior</td><td align="right">-2376</td><td align="right">-2399</td><td align="right">-2400</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2502</td><td align="right">-2537</td><td align="right">-2542</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-2503</td><td align="right">-2540</td><td align="right">-2542</td></tr><tr><td align="left">COX3</td><td align="left">chicken</td><td align="right">-2483</td><td align="right">-2538</td><td align="right">-2542</td></tr><tr><td></td><td align="left">frog</td><td align="right">-2485</td><td align="right">-2539</td><td align="right">-2542</td></tr><tr><td></td><td align="left">interior</td><td align="right">-2486</td><td align="right">-2540</td><td align="right">-2542</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-3782</td><td align="right">-3833</td><td align="right">-3836</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-3783</td><td align="right">-3832</td><td align="right">-3836</td></tr><tr><td align="left">CYTB</td><td align="left">chicken</td><td align="right">-3760</td><td align="right">-3832</td><td align="right">-3836</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-3747</bold></td><td align="right"><bold>-3832</bold></td><td align="right">-3836</td></tr><tr><td></td><td align="left">interior</td><td align="right">-3760</td><td align="right">-3833</td><td align="right">-3836</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-3457</td><td align="right">-3483</td><td align="right">-3486</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-3443</td><td align="right">-3483</td><td align="right">-3486</td></tr><tr><td align="left">ND1</td><td align="left">chicken</td><td align="right">-3435</td><td align="right">-3484</td><td align="right">-3486</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-3434</bold></td><td align="right"><bold>-3482</bold></td><td align="right">-3486</td></tr><tr><td></td><td align="left">interior</td><td align="right">-3442</td><td align="right">-3482</td><td align="right">-3486</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-4275</td><td align="right">-4298</td><td align="right">-4300</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-4275</td><td align="right">-4298</td><td align="right">-4300</td></tr><tr><td align="left">ND2</td><td align="left">chicken</td><td align="right">-4258</td><td align="right">-4298</td><td align="right">-4300</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-4253</bold></td><td align="right"><bold>-4296</bold></td><td align="right">-4300</td></tr><tr><td></td><td align="left">interior</td><td align="right">-4255</td><td align="right">-4299</td><td align="right">-4300</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1348</td><td align="right">-1353</td><td align="right">-1355</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-1347</td><td align="right">-1351</td><td align="right">-1355</td></tr><tr><td align="left">ND3</td><td align="left">chicken</td><td align="right">-1337</td><td align="right">-1353</td><td align="right">-1355</td></tr><tr><td></td><td align="left">frog</td><td align="right">-1335</td><td align="right">-1352</td><td align="right">-1355</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1335</td><td align="right">-1353</td><td align="right">-1355</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-5382</td><td align="right">-5406</td><td align="right">-5406</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-5380</td><td align="right">-5406</td><td align="right">-5406</td></tr><tr><td align="left">ND4</td><td align="left">chicken</td><td align="right">-5366</td><td align="right">-5404</td><td align="right">-5406</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-5345</bold></td><td align="right">-5405</td><td align="right">-5406</td></tr><tr><td></td><td align="left">interior</td><td align="right">-5365</td><td align="right">-5405</td><td align="right">-5406</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-1259</td><td align="right">-1261</td><td align="right">-1265</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-1259</td><td align="right">-1264</td><td align="right">-1265</td></tr><tr><td align="left">ND4L</td><td align="left">chicken</td><td align="right">-1254</td><td align="right">-1262</td><td align="right">-1265</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-1245</bold></td><td align="right">-1263</td><td align="right">-1265</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1254</td><td align="right">-1263</td><td align="right">-1265</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-7053</td><td align="right">-7089</td><td align="right">-7094</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-7053</td><td align="right">-7091</td><td align="right">-7094</td></tr><tr><td align="left">ND5</td><td align="left">chicken</td><td align="right">-7034</td><td align="right">-7093</td><td align="right">-7094</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-7006</bold></td><td align="right">-7090</td><td align="right">-7094</td></tr><tr><td></td><td align="left">interior</td><td align="right">-7029</td><td align="right">-7091</td><td align="right">-7094</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-2022</td><td align="right">-2025</td><td align="right">-2028</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-2020</td><td align="right">-2025</td><td align="right">-2028</td></tr><tr><td align="left">ND6</td><td align="left">chicken</td><td align="right">-1995</td><td align="right">-2023</td><td align="right">-2028</td></tr><tr><td></td><td align="left">frog</td><td align="right">-1998</td><td align="right">-2025</td><td align="right">-2028</td></tr><tr><td></td><td align="left">interior</td><td align="right">-1998</td><td align="right">-2025</td><td align="right">-2028</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Combined analysis Combined log likelihoods over all genes under the nonstationary (NONSTA), stationary (STA), and reversible (REV) models. If NONSTA or STA places the root correctly, the corresponding log likelihood appears in bold.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">group</td><td align="left">root placement</td><td align="left">NONSTA</td><td align="center">STA</td><td align="center">REV</td></tr></thead><tbody><tr><td></td><td align="left">human</td><td align="right">-21536</td><td align="right">-21743</td><td align="right">-21765</td></tr><tr><td align="left">1</td><td align="left">chimp</td><td align="right">-21551</td><td align="right">-21746</td><td align="right">-21765</td></tr><tr><td></td><td align="left">gorilla</td><td align="right"><bold>-21470</bold></td><td align="right">-21744</td><td align="right">-21765</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-26266</td><td align="right">-26566</td><td align="right">-26589</td></tr><tr><td align="left">2</td><td align="left">chimp</td><td align="right">-26270</td><td align="right">-26567</td><td align="right">-26589</td></tr><tr><td></td><td align="left">gorilla</td><td align="right">-26223</td><td align="right">-26566</td><td align="right">-26589</td></tr><tr><td></td><td align="left">orangutan</td><td align="right"><bold>-26172</bold></td><td align="right">-26566</td><td align="right">-26589</td></tr><tr><td></td><td align="left">interior</td><td align="right">-26241</td><td align="right">-26563</td><td align="right">-26589</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="left">human</td><td align="right">-53049</td><td align="right">-53387</td><td align="right">-53427</td></tr><tr><td></td><td align="left">mouse</td><td align="right">-53029</td><td align="right">-53393</td><td align="right">-53427</td></tr><tr><td align="left">3</td><td align="left">chicken</td><td align="right">-52848</td><td align="right">-53388</td><td align="right">-53427</td></tr><tr><td></td><td align="left">frog</td><td align="right"><bold>-52682</bold></td><td align="right"><bold>-53382</bold></td><td align="right">-53427</td></tr><tr><td></td><td align="left">interior</td><td align="right">-52833</td><td align="right">-53391</td><td align="right">-53427</td></tr></tbody></table></table-wrap><p>The nuclear genes <italic>albumin </italic>and <italic>c-myc </italic>and three mitochondrial genes, <italic>COX1</italic>, <italic>COX2 </italic>and <italic>ATP6 </italic>from group 3 (with some mouse genes replaced with rat genes) were studied by Huelsenbeck <italic>et al</italic>. [<xref ref-type="bibr" rid="B4">4</xref>]. For these five genes, NONSTA and STA performed equally, getting all the correct root placements, except for <italic>ATP6</italic>, with NONSTA again noticeably more discriminative.</p></sec><sec><title>Primate mitochondrial DNA</title><p>Brown <italic>et al</italic>. and Yang [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B9">9</xref>] studied a set of mitochondrial DNA (mtDNA) sequences from human, chimpanzee, gorilla, orangutan, gibbon, crab-eating monkey, squirrel monkey, tarsier and lemur. The topology of Yang's unrooted tree and the branch labels are shown in Figure <xref ref-type="fig" rid="F2">2</xref>. The mtDNA sequences consist of two protein-coding fragments, separated by three RNA genes. Thus, four site classes are required. Analysis with NONSTA shows that the root is most likely on the tarsier branch, followed closely by the lemur and "f" branches, and the corresponding log likelihoods are quite different from the others (see Table <xref ref-type="table" rid="T5">5</xref>). Under STA, the most likely root placements are on the squirrel monkey and lemur branches. Thus, both processes give predictions that are consistent (NONSTA more than STA) with the idea that the root should be somewhere near tarsier and lemur. However, as observed before, NONSTA has much greater discriminative power, and fits the data much better, than STA.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Unrooted tree for nine primate mtDNA sequences </bold>The assumed unrooted tree is that presented in Yang [5]. The branches adjacent to leaf nodes are referred to by the corresponding organisms, while the interior branches are labelled <italic>a </italic>through <italic>f </italic>as indicated.</p></caption><graphic xlink:href="1471-2148-5-2-2"/></fig><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Nine primates Log-likelihoods (rounded to closest integer) of the MLEs for 15 rooted trees under the nonstationary (NONSTA), stationary (STA) and reversible (REV) models.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">root placement</td><td align="center">NONSTA</td><td align="center">STA</td><td align="center">REV</td></tr></thead><tbody><tr><td align="left">human</td><td align="center">-4960</td><td align="center">-4965</td><td align="center">-4965</td></tr><tr><td align="left">chimp</td><td align="center">-4959</td><td align="center">-4965</td><td align="center">-4965</td></tr><tr><td align="left">gorilla</td><td align="center">-4961</td><td align="center">-4965</td><td align="center">-4965</td></tr><tr><td align="left">orangutan</td><td align="center">-4961</td><td align="center">-4965</td><td align="center">-4965</td></tr><tr><td align="left">gibbon</td><td align="center">-4962</td><td align="center">-4964</td><td align="center">-4965</td></tr><tr><td align="left">crab-eating macaque</td><td align="center">-4955</td><td align="center">-4963</td><td align="center">-4965</td></tr><tr><td align="left">squirrel monkey</td><td align="center">-4941</td><td align="center">-4961</td><td align="center">-4965</td></tr><tr><td align="left">tarsier</td><td align="center">-4932</td><td align="center">-4963</td><td align="center">-4965</td></tr><tr><td align="left">lemur</td><td align="center">-4935</td><td align="center">-4961</td><td align="center">-4965</td></tr><tr><td align="left">a</td><td align="center">-4962</td><td align="center">-4965</td><td align="center">-4965</td></tr><tr><td align="left">b</td><td align="center">-4961</td><td align="center">-4965</td><td align="center">-4965</td></tr><tr><td align="left">c</td><td align="center">-4961</td><td align="center">-4964</td><td align="center">-4965</td></tr><tr><td align="left">d</td><td align="center">-4957</td><td align="center">-4964</td><td align="center">-4965</td></tr><tr><td align="left">e</td><td align="center">-4948</td><td align="center">-4963</td><td align="center">-4965</td></tr><tr><td align="left">f</td><td align="center">-4936</td><td align="center">-4963</td><td align="center">-4965</td></tr></tbody></table></table-wrap></sec></sec><sec><title>Discussion</title><p>Our results confirmed earlier findings that the stationary process (STA) is not very good at discriminating among rooted trees corresponding to the same unrooted tree. In contrast, the nonstationary (NONSTA) process seems much more effective, with individual genes, and with combined genes. It is quite clear that the difference in log likelihoods between fitting STA and the reversible process (REV) is often small, and statistically insignificant, based on the likelihood ratio test, while those between NONSTA and STA, and between NONSTA and REV, are often large, and statistically very significant. Though the chi-square distribution may be inappropriate [<xref ref-type="bibr" rid="B10">10</xref>], it seems to be satisfatory in practice [<xref ref-type="bibr" rid="B11">11</xref>]. This indicates that NONSTA fits the data much better than STA and REV. Thus it appears that allowing an initial distribution that is uncoupled with the rate matrix gives a better description of the data, and that the greater capacity of NONSTA over STA at estimating the root placement may stem from the ability of NONSTA to allow for some amount of evolution in base composition.</p><p>Although Huelsenbeck <italic>et al</italic>.'s analysis using STA failed to place the root correctly in any of the genes <italic>albumin</italic>, <italic>c-myc</italic>, <italic>COX1</italic>, <italic>COX2 </italic>and <italic>ATP6</italic>, there are some differences between the analyses. The raw data were different: the rat <italic>albumin </italic>and <italic>c-myc </italic>genes were used by Huelsenbeck <italic>et al</italic>.; since mouse and rat are very similar, this is not likely to matter much. Secondly, the alignments were probably different, though since the sequences are quite similar, this should not be too important. It is plausible that most of the discrepancies between the results is due to the difference in the estimation procedure (maximum likelihood vs. Bayesian) and to the fact that in Huelsenbeck <italic>et al</italic>., site variation was modeled by the gamma distribution [<xref ref-type="bibr" rid="B12">12</xref>], whereas here we only accounted for the codon position effect.</p><p>Estimates of the relative rates are quite independent of the model used, and their relative magnitudes are largely within expectations. In particular, for group 3, the relative rates for codon positions 1, 2, and 3 fall between .2 and 1.1, .1 and .6, and 1.5 and 2.7 respectively. For all genes, the third codon position evolved the fastest, followed by the first and second positions. To gauge the contribution from the third codon position, we left out the corresponding bases in group 3 and reran the analysis with NONSTA. This gave the correct root placement in only three genes: <italic>albumin</italic>, <italic>c-myc </italic>and <italic>ND2</italic>, showing the usefulness of the third codon position in this dataset, despite its markedly higher substitution rates. We also found that the pairwise identity at the third codon positions for all genes in groups 3 ranges from 34% to 61%. Base composition being generally nonuniform, the expected pairwise identity at saturation (i.e., infinite evolutionary distance) is lower than 25%. This seems to indicate that the third codon position is not saturated, and hence the phylogenetic information from this position is not just the base composition at each taxon. In addition, the base composition at the third codon position for some genes is quite different from the other positions. Our model does not fit these genes as well as a model where separate processes are associated with the codon positions. Such a model will be investigated in future.</p><p>The NONSTA process is only slightly more complicated to apply, compared to the STA and REV processes. The fact that it works quite well in the verification studies and predicts biologically plausible roots for the nine-primate data demonstrates its utility and perhaps argues for its use in routine phylogenetic analysis. In any case, if no suitable outgroup is available, it could be worthwhile to try it. Though the NONSTA process is the most general time-homogeneous Markov process, it is still simplistic and imposes a severe constraint on the evolution of base composition: if two leaf nodes are at the same distance from the root, then the process stipulates that the corresponding sequences must have the same composition. This is patently unrealistic: once lineages split, they should evolve quite independently, and may explain the failure of the process at estimating the root placement for some genes. However, it is still valuable even if it does not always work, in that it can serve as a base from which exploration of richer models can be launched. For instance, one could identify lineages where the evolution significantly deviates from expectations, and then allow these lineages to have different rate matrices, which brings us closer to the very rich models of [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>].</p></sec><sec><title>Conclusions</title><p>The nonstationary substitution process is simple to use, has much greater power at estimating the root compared to the stationary process, and also fits data much better than the stationary and reversible processes. It seems feasible to use this process in analyses where a suitable outgroup is not easily available. It is also a good starting point for conducting more sophisticated phylogenetic analysis with richer models.</p></sec><sec sec-type="methods"><title>Methods</title><p>Substitutions in DNA sequences are assumed to occur independently at each site according to a Markov process, i.e., given the present base, future substitutions are independent of past substitutions.</p><p>Furthermore, it is assumed that the process is time-homogeneous, i.e., substitution rates stay constant in time. As usual, the substitution rate from base <italic>a </italic>to <italic>b </italic>is the (<italic>a</italic>, <italic>b</italic>)-entry in a 4 &#x000d7; 4 rate matrix <italic>Q</italic>; the diagonal entries are such that each row sums to 0. For any <italic>t </italic>&#x0003e; 0, the transition probability <italic>P</italic>(<italic>t</italic>) is given by <italic>P</italic>(<italic>t</italic>) = exp(<italic>Qt</italic>). Let <italic>&#x003c0; </italic>be a probability distribution on the DNA bases. The pair (<italic>&#x003c0;</italic>, <italic>Q</italic>) defines a substitution process on a rooted tree, as follows: pick a base at the root according to <italic>&#x003c0;</italic>, then run the substitution process according to <italic>Q </italic>down the tree, splitting into independent copies whenever a branching is encountered. The joint probability of the observed bases at the leaf nodes can be computed using almost exactly the same algorithm by [<xref ref-type="bibr" rid="B15">15</xref>].</p><p>There are two important special cases of the time-homogeneous process (<italic>&#x003c0;</italic>, <italic>Q</italic>). Associated with the rate matrix <italic>Q </italic>is a unique distribution <italic>&#x003c0;</italic><sub><italic>Q</italic></sub>, called the equilibrium distribution of <italic>Q</italic>, such that the matrix product <italic>&#x003c0;</italic><sub><italic>Q </italic></sub>&#x000d7; <italic>Q </italic>is the zero vector. The process (<italic>&#x003c0;</italic><sub><italic>Q</italic></sub>, <italic>Q</italic>) is <italic>stationary</italic>, i.e., the sequence composition remains unchanged through time, and is described by <italic>&#x003c0;</italic><sub><italic>Q</italic></sub>. <italic>Q </italic>is said to be <italic>reversible </italic>if it satisfies the detailed balance condition:</p><p>&#x003a0;<sub><italic>Q</italic></sub><italic>Q </italic>= <italic>Q</italic>'&#x003a0;<sub><italic>Q</italic></sub></p><p>where &#x003a0;<sub><italic>Q </italic></sub>is the diagonal form of <italic>&#x003c0;</italic><sub><italic>Q </italic></sub>and <italic>Q</italic>' is the transpose of <italic>Q</italic>. The process (<italic>&#x003c0;</italic><sub><italic>Q</italic></sub>, <italic>Q</italic>) is then <italic>reversible</italic>, i.e., statistically the process looks the same in forward and backward time. In particular, as shown in [<xref ref-type="bibr" rid="B15">15</xref>], the joint distribution of the leaf bases is the same regardless of where the root is placed on the tree. The reversible process is known as the REV or time-reversible process in the molecular evolution literature [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. Special cases of the REV process include those by Jukes and Cantor, Kimura, Felsenstein (two processes), Hasegawa, Kishino and Yano, and Tamura and Nei [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B22">22</xref>]. The nonreversible stationary process was first explored by Yang [<xref ref-type="bibr" rid="B5">5</xref>], and subsequently by Huelsenbeck <italic>et al</italic>. [<xref ref-type="bibr" rid="B4">4</xref>]. Yang referred to this process as "unrestricted", but we use the abbreviation STA here. We shall refer to the nonstationary process as NONSTA. The numbers of free parameters in the NONSTA, STA and REV processes are respectively 15 (3 in <italic>&#x003c0; </italic>and 12 off-diagonal entries in <italic>Q</italic>), 12 (off-diagonal entries in <italic>Q</italic>) and 9 (3 in <italic>&#x003c0;</italic><sub><italic>Q </italic></sub>and 12 off-diagonal entries in <italic>Q</italic>, minus 6 detailed balance constraints). Since the models are nested, the likelihood ratio test can be used to assess the relative goodness-of-fit of the MLEs. It is standard practice to allow only calibrated rate matrices, i.e., <italic>Q </italic>satisfies</p><p><inline-graphic xlink:href="1471-2148-5-2-i1.gif"/></p><p>so that a branch length is the average number of substitution events per site. We adopt this practice, and remark that for the nonstationary process (<italic>&#x003c0;</italic>, <italic>Q</italic>), with calibrated <italic>Q</italic>, since in general <italic>&#x003c0; </italic>&#x02260; <italic>&#x003c0;</italic><sub><italic>Q</italic></sub>, it is not true that the expected number of substitutions in 1 time unit is 1, but the difference gets arbitrarily small as time goes to infinity.</p><p>The sites in a DNA sequences can have very different substitution rates, the most well-known example being coding sequences, where the third codon positions evolved much faster than the others because of the degeneracy of the genetic code. In cases where the assignment of sites into several classes is known in advance, such as a coding sequence, the easiest way to deal with it is to associate to class <italic>i </italic>an unknown positive number <italic>r</italic><sub><italic>i</italic></sub>, with the constraint that</p><p><inline-graphic xlink:href="1471-2148-5-2-i2.gif"/></p><p>where <italic>n</italic><sub><italic>i </italic></sub>is the number of sites in class <italic>i</italic>. The relative rate <italic>r</italic><sub><italic>i </italic></sub>either expands or shrinks the tree depending on whether it is more or less than 1. The constraint gives a new interpretation of a branch length: it is now the average over all sites of their expected number of substitutions. Thus, this approach is similar to [<xref ref-type="bibr" rid="B8">8</xref>]: effectively, the classes are treated as separate datasets. In this study, coding sequences are divided into three classes by codon position. In the last dataset consisting of nine primate mitochondrial sequences, an additional class is created to account for the RNA-coding bases. Another source of site variation is related to the three-dimensional structure of the protein. For example, hydrophilic residues are usually exposed, hence tend to evolve faster than hydrophobic residues which are deeply buried. Our present approach does not model this and other less obvious sources of site variation. Possible remedies include using the gamma distribution [<xref ref-type="bibr" rid="B12">12</xref>] or the hidden Markov model [<xref ref-type="bibr" rid="B23">23</xref>].</p><p>Given a rooted tree relating aligned coding sequences, we seek the ML estimates of the branch lengths, the substitution parameters, and the relative rates. For other sequences, the relative rates are not estimated. Gradient-based methods are perhaps the most efficient at finding the maximum. The EM algorithm [<xref ref-type="bibr" rid="B24">24</xref>] is another possibility. We implemented the simplex method [<xref ref-type="bibr" rid="B25">25</xref>], which is slower but is less likely to be misled to local maxima than gradient-based methods. To further reduce the chance of being fooled by local maxima, different initial estimates were used, and the final estimates with the highest likelihood was picked. The initial estimates were obtained by first deriving a reversible rate matrix from a pairwise comparison of two sequences, then using the associated REV process to find the most likely branch lengths and relative rates; all pairwise comparisons were used in this study, so that, for example, four taxa give six initial estimates.</p><p>The estimation procedure was implemented in C, and the source code can be requested from the first author.</p></sec><sec><title>Authors' contributions</title><p>The idea was conceived by the first author and was inspired and refined by the second author. The first author composed the code and performed the data analysis.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional File 1</title><p>A text file containing the amino acid sequence alignments for group 1.</p></caption><media xlink:href="1471-2148-5-2-S1.aln" mimetype="text" mime-subtype="plain"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional File 2</title><p>A text file containing the amino acid sequence alignments for group 2.</p></caption><media xlink:href="1471-2148-5-2-S2.aln" mimetype="text" mime-subtype="plain"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S3"><caption><title>Additional File 3</title><p>A text file containing the amino acid sequence alignments for group 3.</p></caption><media xlink:href="1471-2148-5-2-S3.aln" mimetype="text" mime-subtype="plain"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>Ziheng Yang kindly provided the alignment of the primate mtDNA sequences and entertained numerous enquiries. Several programs in the PAML package were used in the data analysis. We thank the referees for many comments and suggestions, and agree that more work is needed to investigate the notion of evolutionary time in nonstationary substitution processes, as well as the utility of our method in rooting larger trees.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><source>Inferring Phylogenies</source><year>2004</year><publisher-name>Sunderland, Massachusetts: Sinauer Associates, Inc</publisher-name></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Maddison</surname><given-names>WP</given-names></name><name><surname>Donoghue</surname><given-names>MJ</given-names></name><name><surname>Maddison</surname><given-names>DR</given-names></name></person-group><article-title>Outgroup analysis and parsimony</article-title><source>Syst Zool</source><year>1984</year><volume>33</volume><fpage>83</fpage><lpage>103</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wheeler</surname><given-names>WC</given-names></name></person-group><article-title>Nucleic acid sequence phylogeny and random outgroups</article-title><source>Cladistics</source><year>1990</year><volume>6</volume><fpage>363</fpage><lpage>368</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Bollback</surname><given-names>JP</given-names></name><name><surname>M</surname><given-names>LA</given-names></name></person-group><article-title>Inferring the root of a phylogenetic tree</article-title><source>Sys Biol</source><year>2002</year><volume>51</volume><fpage>32</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1080/106351502753475862</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Estimating the pattern of nucleotide substitution</article-title><source>J Mol Evol</source><year>1994</year><volume>39</volume><fpage>105</fpage><lpage>111</lpage><pub-id pub-id-type="pmid">8064867</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Roberts</surname><given-names>D</given-names></name></person-group><article-title>On the use of nucleic acid sequences to infer early branchings in the tree of life</article-title><source>Mol Biol Evol</source><year>1995</year><volume>12</volume><fpage>451</fpage><lpage>458</lpage><pub-id pub-id-type="pmid">7739387</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Galtier</surname><given-names>N</given-names></name><name><surname>Gouy</surname><given-names>M</given-names></name></person-group><article-title>Inferring pattern and process: Maximum-likelihood implementation of a nonhomogeneous model of DNA sequence evolution for phylogenetic analysis</article-title><source>Mol Biol Evol</source><year>1998</year><volume>15</volume><fpage>871</fpage><lpage>879</lpage><pub-id pub-id-type="pmid">9656487</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Maximum-likelihood models for combined analyses of multiple sequence data</article-title><source>J Mol Evol</source><year>1996</year><volume>42</volume><fpage>587</fpage><lpage>596</lpage><pub-id pub-id-type="pmid">8662011</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>WM</given-names></name><name><surname>Prager</surname><given-names>EM</given-names></name><name><surname>Wang</surname><given-names>A</given-names></name><name><surname>Wilson</surname><given-names>AC</given-names></name></person-group><article-title>Mitochondrial DNA sequences of primates, tempo and mode of evolution</article-title><source>J Mol Evol</source><year>1982</year><volume>18</volume><fpage>225</fpage><lpage>239</lpage><pub-id pub-id-type="pmid">6284948</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Statistical tests of models of DNA substitution</article-title><source>J Mol Evol</source><year>1993</year><volume>36</volume><fpage>182</fpage><lpage>198</lpage><pub-id pub-id-type="pmid">7679448</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name><name><surname>Friday</surname><given-names>A</given-names></name></person-group><article-title>Maximum likelihood trees from DNA sequences: A peculiar statistical estimation problem</article-title><source>Syst Biol</source><year>1995</year><volume>44</volume><fpage>384</fpage><lpage>399</lpage></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Maximum-likelihood estimation of phylogeny from DNA sequences when substitution rates differ over sites</article-title><source>Mol Biol Evol</source><year>1993</year><volume>10</volume><fpage>1396</fpage><lpage>1401</lpage><pub-id pub-id-type="pmid">8277861</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname><given-names>D</given-names></name><name><surname>Hartigan</surname><given-names>JA</given-names></name></person-group><article-title>Statitstical analysis of hominoid molecular evolution</article-title><source>Statistical Science</source><year>1987</year><volume>2</volume><fpage>191</fpage><lpage>207</lpage></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>JT</given-names></name></person-group><article-title>Full reconstruction of Markov models on evolutionary trees: Identiflability and consistency</article-title><source>Mathematical Biosciences</source><year>1996</year><volume>137</volume><fpage>51</fpage><lpage>73</lpage><pub-id pub-id-type="pmid">8854662</pub-id><pub-id pub-id-type="doi">10.1016/S0025-5564(96)00075-2</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>J Mol Evol</source><year>1981</year><volume>17</volume><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="pmid">7288891</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lanave</surname><given-names>C</given-names></name><name><surname>Preparata</surname><given-names>G</given-names></name><name><surname>Saccone</surname><given-names>C</given-names></name><name><surname>Serio</surname><given-names>G</given-names></name></person-group><article-title>A new method for calculating evolutionary substitution rates</article-title><source>J Mol Evol</source><year>1984</year><volume>20</volume><fpage>86</fpage><lpage>93</lpage><pub-id pub-id-type="pmid">6429346</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tavar&#x000e9;</surname><given-names>S</given-names></name></person-group><article-title>Some probabilistic and statistical probles in the analysis of DNA sequences</article-title><source>Lectures on Mathematics in the Life Sciences</source><year>1986</year><volume>17</volume><fpage>57</fpage><lpage>86</lpage></citation></ref><ref id="B18"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Jukes</surname><given-names>TH</given-names></name><name><surname>Cantor</surname><given-names>C</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Munro HN</surname></name></person-group><article-title>Evolution of protein molecules</article-title><source>In Mammalian Protein Metabolism</source><year>1969</year><publisher-name>Academic Press</publisher-name><fpage>21</fpage><lpage>132</lpage></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><article-title>A simple method for estimating evolutionary rates of base substitutions through comparative studies of nucleotide sequences</article-title><source>J Mol Evol</source><year>1980</year><volume>16</volume><fpage>111</fpage><lpage>120</lpage><pub-id pub-id-type="pmid">7463489</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kishino</surname><given-names>H</given-names></name><name><surname>Hasegawa</surname><given-names>M</given-names></name></person-group><article-title>Converting distance to time: Application to human evolution</article-title><source>Methods in Enzymology</source><year>1990</year><volume>183</volume><fpage>550</fpage><lpage>570</lpage><pub-id pub-id-type="pmid">2314292</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hasegawa</surname><given-names>M</given-names></name><name><surname>Kishino</surname><given-names>H</given-names></name><name><surname>Yano</surname><given-names>T</given-names></name></person-group><article-title>Dating the human-ape splitting by a molecular clock of mitochondrial DNA</article-title><source>J Mol Evol</source><year>1985</year><volume>22</volume><fpage>160</fpage><lpage>174</lpage><pub-id pub-id-type="pmid">3934395</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tamura</surname><given-names>K</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>Estimation of the number of nucleotide substitutions in the control region of nitochondrial DNA in humans and chimpanzees</article-title><source>Mol Biol Evol</source><year>1993</year><volume>10</volume><fpage>512</fpage><lpage>526</lpage><pub-id pub-id-type="pmid">8336541</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name><name><surname>Churchill</surname><given-names>GA</given-names></name></person-group><article-title>A hidden Markov model approach to variation among sites in rate of evolution</article-title><source>Mol Biol Evol</source><year>1996</year><volume>13</volume><fpage>93</fpage><lpage>104</lpage><pub-id pub-id-type="pmid">8583911</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holmes</surname><given-names>IP</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name></person-group><article-title>An expectation maximization algorithm for training hidden substitution models</article-title><source>J Mol Biol</source><year>2002</year><volume>317</volume><fpage>753</fpage><lpage>764</lpage><pub-id pub-id-type="pmid">11955022</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.2002.5405</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nelder</surname><given-names>JA</given-names></name><name><surname>Mead</surname><given-names>R</given-names></name></person-group><article-title>A simplex method for function minimization</article-title><source>Comput J</source><year>1965</year><volume>7</volume><fpage>308</fpage><lpage>313</lpage></citation></ref></ref-list></back></article>



