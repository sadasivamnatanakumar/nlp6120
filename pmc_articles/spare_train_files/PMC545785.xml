<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-title>Genome Biology</journal-title><issn pub-type="ppub">1465-6906</issn><issn pub-type="epub">1465-6914</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15535870</article-id><article-id pub-id-type="pmc">PMC545785</article-id><article-id pub-id-type="publisher-id">gb-2004-5-11-r94</article-id><article-id pub-id-type="doi">10.1186/gb-2004-5-11-r94</article-id><article-categories><subj-group subj-group-type="heading"><subject>Method</subject></subj-group></article-categories><title-group><article-title>Consensus clustering and functional interpretation of gene-expression data</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Swift</surname><given-names>Stephen</given-names></name><xref ref-type="aff" rid="I1">1</xref></contrib><contrib id="A2" contrib-type="author"><name><surname>Tucker</surname><given-names>Allan</given-names></name><xref ref-type="aff" rid="I1">1</xref></contrib><contrib id="A3" contrib-type="author"><name><surname>Vinciotti</surname><given-names>Veronica</given-names></name><xref ref-type="aff" rid="I1">1</xref></contrib><contrib id="A4" contrib-type="author"><name><surname>Martin</surname><given-names>Nigel</given-names></name><xref ref-type="aff" rid="I2">2</xref></contrib><contrib id="A5" contrib-type="author"><name><surname>Orengo</surname><given-names>Christine</given-names></name><xref ref-type="aff" rid="I3">3</xref></contrib><contrib id="A6" contrib-type="author"><name><surname>Liu</surname><given-names>Xiaohui</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>xiaohui.liu@brunel.ac.uk</email></contrib><contrib id="A7" corresp="yes" contrib-type="author"><name><surname>Kellam</surname><given-names>Paul</given-names></name><xref ref-type="aff" rid="I4">4</xref><email>p.kellam@ucl.ac.uk</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Information Systems and Computing, Brunel University, Uxbridge UB8 3PH, UK</aff><aff id="I2"><label>2</label>School of Computer Science and Information Systems, Birkbeck College, London WC1E 7HX, UK</aff><aff id="I3"><label>3</label>Department of Biochemistry and Molecular Biology, University College London, London WC1E 6BT, UK</aff><aff id="I4"><label>4</label>Virus Genomics and Bioinformatics Group, Department of Infection, Windeyer Institute, 46 Cleveland Street, University College London, London W1T 4JF, UK</aff><pub-date pub-type="ppub"><year>2004</year></pub-date><pub-date pub-type="epub"><day>1</day><month>11</month><year>2004</year></pub-date><volume>5</volume><issue>11</issue><fpage>R94</fpage><lpage>R94</lpage><ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2004/5/11/R94"/><history><date date-type="received"><day>4</day><month>12</month><year>2003</year></date><date date-type="rev-recd"><day>15</day><month>3</month><year>2004</year></date><date date-type="accepted"><day>13</day><month>9</month><year>2004</year></date></history><copyright-statement>Copyright &#x000a9; 2004 Swift et al.; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract abstract-type="short"><p>Consensus clustering, a new method for analyzing microarray data that takes a consensus set of clusters from various algorithms, is shown to perform better than individual methods alone.</p></abstract><abstract><p>Microarray analysis using clustering algorithms can suffer from lack of inter-method consistency in assigning related gene-expression profiles to clusters. Obtaining a consensus set of clusters from a number of clustering methods should improve confidence in gene-expression analysis. Here we introduce consensus clustering, which provides such an advantage. When coupled with a statistically based gene functional analysis, our method allowed the identification of novel genes regulated by NF&#x003ba;B and the unfolded protein response in certain B-cell lymphomas.</p></abstract></article-meta></front><body><sec><title>Background</title><p>There are many practical applications that involve the grouping of a set of objects into a number of mutually exclusive subsets. Methods to achieve the partitioning of objects related by correlation or distance metrics are collectively known as clustering algorithms. Any algorithm that applies a global search for optimal clusters in a given dataset will run in exponential time to the size of problem space, and therefore heuristics are normally required to cope with most real-world clustering problems. This is especially true in microarray analysis, where gene-expression data can contain many thousands of variables. The ability to divide data into groups of genes sharing patterns of coexpression allows more detailed biological insights into global regulation of gene expression and cellular function.</p><p>Many different heuristic algorithms are available for clustering. Representative statistical methods include k-means, hierarchical clustering (HC) and partitioning around medoids (PAM) [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. Most algorithms make use of a starting allocation of variables based, for example, on random points in the data space or on the most correlated variables, and which therefore contain an inherent bias in their search space. These methods are also prone to becoming stuck in local maxima during the search. Nevertheless, they have been used for partitioning gene-expression data with notable success [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>]. Artificial Intelligence (AI) techniques such as genetic algorithms, neural networks and simulated annealing (SA) [<xref ref-type="bibr" rid="B6">6</xref>] have also been used to solve the grouping problem, resulting in more general partitioning methods that can be applied to clustering [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. In addition, other clustering methods developed within the bioinformatics community, such as the cluster affinity search technique (CAST), have been applied to gene-expression data analysis [<xref ref-type="bibr" rid="B9">9</xref>]. Importantly, all of these methods aim to overcome the biases and local maxima involved during a search but to do this requires fine-tuning of parameters.</p><p>Recently, a number of studies have attempted to compare and validate cluster method consistency. Cluster validation can be split into two main procedures: internal validation, involving the use of information contained within the given dataset to assess the validity of the clusters; or external validation, based on assessing cluster results relative to another data source, for example, gene function annotation. Internal validation methods include comparing a number of clustering algorithms based upon a figure of merit (FOM) metric, which rates the predictive power of a clustering arrangement using a leave-one-out technique [<xref ref-type="bibr" rid="B10">10</xref>]. This and other metrics for assessing agreement between two data partitions [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] readily show the different levels of cluster method disagreement. In addition, when the FOM metric was used with an external cluster validity measure, similar inconsistencies are observed [<xref ref-type="bibr" rid="B13">13</xref>].</p><p>These method-based differences in cluster partitions have led to a number of studies that produce statistical measures of cluster reliability either for the gene dimension [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>] or the sample dimension of a gene-expression matrix. For example, the confidence in hierarchical clusters can be calculated by perturbing the data with Gaussian noise and subsequent reclustering of the noisy data [<xref ref-type="bibr" rid="B16">16</xref>]. Resampling methods (bagging) have been used to improve the confidence of a single clustering method, namely PAM in [<xref ref-type="bibr" rid="B17">17</xref>]. A simple method for comparison between two data partitions, the <italic>weighted-kappa </italic>metric [<xref ref-type="bibr" rid="B18">18</xref>], can also be used to assess gene-expression cluster consistency. This metric rates agreement between the classification decisions made by two or more observers. In this case the two observers are the clustering methods. The <italic>weighted-kappa </italic>compares clusters to generate the score within the range -1 (no concordance) to +1 (complete concordance) (Table <xref ref-type="table" rid="T1">1</xref>). A high <italic>weighted-kappa </italic>indicates that the two arrangements are similar, while a low value indicates that they are dissimilar. In essence, the <italic>weighted-kappa </italic>metric is analogous to the adjusted Rand index used by others to compare cluster similarity [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B19">19</xref>].</p><p>Despite the formal assessment of clustering methods, there remains a practical need to extract reliably clustered genes from a given gene-expression matrix. This could be achieved by capturing the relative merits of the different clustering algorithms and by providing a usable statistical framework for analyzing such clusters. Recently, methods for gene-function prediction using similarities in gene-expression profiles between annotated and uncharacterized genes have been described [<xref ref-type="bibr" rid="B20">20</xref>]. To circumvent the problems of clustering algorithm discordance, Wu <italic>et al. </italic>used five different clustering algorithms and a variety of parameter settings on a single gene-expression matrix to construct a database of different gene-expression clusters. From these clusters, statistically significant functions were assigned using existing biological knowledge.</p><p>In this paper, we confirm previous work showing gene-expression clustering algorithm discordance using a direct measurement of similarity: the <italic>weighted-kappa </italic>metric. Because of the observed variation between clustering methods, we have developed techniques for combining the results of different clustering algorithms to produce more reliable clusters. A method for clustering gene-expression data using resampling techniques on a single clustering method has been proposed for microarray analysis [<xref ref-type="bibr" rid="B19">19</xref>]. In addition, Wu <italic>et al. </italic>showed that clusters that are statistically significant with respect to gene function could be identified within a database of clusters produced from different algorithms [<xref ref-type="bibr" rid="B20">20</xref>]. Here we describe a fusion of these two approaches using a 'consensus' strategy to produce both robust and consensus clustering (CC) of gene-expression data and assign statistical significance to these clusters from known gene functions. Our method is different from the approach of Monti <italic>et al.</italic>, in that different clustering algorithms are used rather than perturbing the gene-expression data for a single algorithm [<xref ref-type="bibr" rid="B19">19</xref>]. Our method is also distinct from the cluster database approach of Wu <italic>et al </italic>[<xref ref-type="bibr" rid="B20">20</xref>]. There, clusters from different algorithms were in effect fused if the consensus view of all algorithms indicated that the gene-expression profiles clustered independently of the method. In the absence of a defined rule base for selecting clustering algorithms, we have implemented clustering methods from the statistical, AI and data-mining communities to prevent 'cluster-method type' biases. When consensus clustering was used with probabilistic measures of cluster membership derived from external validation with gene function annotations, it was possible to accurately and rapidly identify specific transcriptionally co-regulated genes from microarray data of distinct B-cell lymphoma types [<xref ref-type="bibr" rid="B21">21</xref>].</p></sec><sec><title>Results</title><sec><title>Cluster method comparison</title><p>Initially we assessed cluster method consistency for HC, PAM, SA and CAST using the <italic>weighted-kappa </italic>metric and a synthetic dataset of 2,217 gene-expression profiles over 100 time points that partitioned into 40 known clusters. The <italic>weighted-kappa </italic>values derived from the metric indicate the strength of agreement between two observers (Table <xref ref-type="table" rid="T1">1</xref>). To interpret two <italic>weighted-kappa </italic>scores, for example, from two cluster arrangements, the broad categories from Table <xref ref-type="table" rid="T1">1</xref> are used, together with an assessment of relative score differences. If the two scores in question were 0.2 and 0.4, one could say that the former is poor (worse) and the latter is fair (better), but not that one is twice as good as the other. To allow defined clusters to be extracted from the tree structure of HC we used the R statistical package [<xref ref-type="bibr" rid="B22">22</xref>] implementation of HC. This implementation uses the CUTTREE method to convert the tree structure into a specified number of clusters.</p><p>With the synthetic dataset, all clustering algorithms had a 'high' <italic>weighted-kappa </italic>agreement (data not shown) [<xref ref-type="bibr" rid="B18">18</xref>]. It is possible that the highly stylized nature of synthetic data resulted in higher than expected cluster-method agreement compared to experimentally derived data. This effect has been observed previously [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B12">12</xref>]. Therefore, we used a repeated microarray control element Amersham Score Card (ASC) dataset as a semi-synthetic validation standard. We also used an experimentally derived microarray dataset for cross-cluster-method comparison. To facilitate cross-method comparison, we used fixed parameters where appropriate (see Materials and methods). Consistent with other studies, we observed that clustering-method consistency varied between methods and datasets (Figure <xref ref-type="fig" rid="F1">1</xref>). As expected, the repeated gene/probe measurements present in the ASC dataset resulted in higher levels of cluster agreement between methods than the single gene probe B-cell data. With the ASC data there was in general a 'good' level of agreement between all different clustering algorithms, with only CAST compared to HC scoring as 'moderate'. This shows that most clustering methods are able to group highly correlated data accurately, and that repeated measurements of gene-expression values can aid cluster partitioning [<xref ref-type="bibr" rid="B12">12</xref>]. Nevertheless, even with such high gene-expression correlation not all cluster assignments were consistent. This effect is magnified with the single probe per gene B-cell lymphoma data, where the degree of agreement for cluster partitioning was less, with no comparison scoring above 'fair'. This observation emphasizes the need for the current desired practice in microarray analysis of using many different clustering algorithms to explore gene-expression data, thereby not over-interpreting clusters on the basis of a single method [<xref ref-type="bibr" rid="B23">23</xref>].</p></sec><sec><title>Algorithms</title><p>The partial agreement of the different clustering algorithms must reflect the clustering of highly similar gene-expression vectors regardless of the clustering methods used. Where algorithm-based inconsistency problems occur in other aspects of computational biology, such as protein secondary structure prediction, consensus algorithms are often used [<xref ref-type="bibr" rid="B24">24</xref>]. These can either report a full or a majority agreement. This consensus strategy has also been applied to explore the effect of perturbing the gene-expression data for a single clustering algorithm [<xref ref-type="bibr" rid="B19">19</xref>]. We have therefore designed a similar strategy to identify the consistently clustered gene-expression profiles in microarray datasets by producing a consensus over different clustering methods for a given parameter set (see Materials and methods). Extracting such consistently clustered robust data from a large gene-expression matrix is extremely useful, increasing overall analysis confidence.</p><sec><title>Robust clustering</title><p>We initially developed an algorithm called robust clustering (RC) for compiling the results of different clustering methods reporting only the co-clustered genes grouped together by all the different algorithms - that is, with maximum agreement across clustering methods. For two genes <italic>i </italic>and <italic>j</italic>, all clustering methods must have allocated them to the same cluster in order for them to be assigned to a robust cluster. This gives a higher level of confidence to the correct assignment of genes appearing within the same cluster. Robust clustering works by first producing an upper triangular <italic>n </italic>&#x000d7; <italic>n </italic>agreement matrix with each matrix cell containing the number of agreements among methods for clustering together the two variables, represented by the row and column indices (Figure <xref ref-type="fig" rid="F2">2</xref>). This matrix is then used to group variables on the basis of their cluster agreement (present in the matrix).</p><p>Robust clustering uses the agreement matrix to generate a list, <italic>List</italic>, which contains all the pairs where the appropriate cell in the agreement matrix contains a value equal to the number of clustering methods being combined (that is, full agreement). Starting with an empty set of robust clusters RC, where <italic>RC</italic><sub><italic>i </italic></sub>is the <italic>i</italic>th robust cluster, the first cluster is created containing the elements of the first pair in <italic>List</italic>. Then the pairs in <italic>List </italic>are iterated through and checked to see if one of the members of the current pair is within any of the existing clusters, <italic>RC</italic><sub><italic>i</italic></sub>.</p><p>If one element of the current pair is found and the other element of the pair is not in the same cluster, then the other element is added to that cluster. If neither element of the pair is found in an existing <italic>RC</italic><sub><italic>i </italic></sub>in RC, then a new cluster is added to RC containing each element of the pair. When the end of the list is reached, the set of robust clusters, RC, is the output. The robust clustering algorithm is as follows:</p><p>Input:Agreement Matrix (<italic>n </italic>&#x000d7; <italic>n</italic>), <italic>A</italic></p><p>(1) Set <italic>List </italic>= all pairs (<italic>x</italic>, <italic>y</italic>) in the matrix, with agreement = the number of methods</p><p>(2) Set <italic>RC </italic>to be an empty list of clusters</p><p>(3) Create a cluster and insert the two elements (<italic>x</italic>, <italic>y</italic>) of the first pair in <italic>List </italic>into it</p><p>(4) For <italic>i </italic>= 2 to size of <italic>List</italic>-1</p><p>(5)&#x000a0;&#x000a0;For <italic>j </italic>= 1 to number of Clusters in <italic>RC</italic></p><p>(6)&#x000a0;&#x000a0;&#x000a0;If <italic>x </italic>or <italic>y </italic>of <italic>List</italic><sub><italic>i </italic></sub>is found within <italic>RC</italic><sub><italic>j</italic></sub></p><p>(7)&#x000a0;&#x000a0;&#x000a0;&#x000a0;If the other member of the pair <italic>List</italic><sub><italic>i </italic></sub>is not found in <italic>RC</italic><sub><italic>j</italic></sub></p><p>(8)&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;Add the other member to <italic>RC</italic><sub><italic>j</italic></sub></p><p>(9)&#x000a0;&#x000a0;&#x000a0;&#x000a0;End If</p><p>(10)&#x000a0;&#x000a0;&#x000a0;Else If the other member of the pair <italic>List</italic><sub><italic>i </italic></sub>is not found in <italic>RC</italic><sub><italic>j</italic></sub></p><p>(11)&#x000a0;&#x000a0;&#x000a0;&#x000a0;Add a new cluster to <italic>RC </italic>containing <italic>x </italic>and <italic>y</italic></p><p>(12)&#x000a0;&#x000a0;&#x000a0;End If</p><p>(13)&#x000a0;&#x000a0;End For</p><p>(14)&#x000a0;End For</p><p>Output:Set of Robust Clusters <italic>RC</italic></p></sec><sec><title>Application of robust clustering</title><p>Robust clustering was applied to both the ASC and B-cell lymphoma datasets and the partitioning of the gene-expression profiles observed. As expected, the robust clusters do not contain all variables because of the underlying lack of consistent clustering by all methods. As a result, the <italic>weighted-kappa </italic>cannot be calculated. This metric requires both clustering arrangements being compared to be drawn from the same set of items. This is not the case with robust clustering because many items will not be assigned to a cluster. However, approximately 80% of the total ASC data variables and 25% of the B-cell lymphoma variables are assigned to a robust cluster. Robust clustering further subdivides the datasets into smaller clusters, with 24 rather than 13 clusters being defined for ASC, and 154 rather than 40 being defined for the B-cell lymphoma data (Table <xref ref-type="table" rid="T2">2</xref>). Robust clusters are therefore valuable for allowing a rapid 'drilling down' in a gene-expression dataset to groups of genes whose coexpression pattern is identified in a manner independent of cluster method.</p><p>The robust clustering algorithm is, by definition, subject to discarding gene-expression vectors if only one clustering method performs badly in the co-clustering. This effect of single method under performance on a given dataset has been previously observed for single linkage hierarchical clustering [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. Therefore, to generate clusters with high agreement across methods but not so restrictive as to discard majority consistent variables, we adapted the algorithm to generate consensus clusters, making use of the same agreement matrix.</p></sec><sec><title>Consensus clustering</title><p>Consensus clustering relaxes the full agreement requirement by taking a parameter, 'minimum agreement', which allows different agreement thresholds to be explored. Rather than grouping variables on the basis of full agreement only, consensus clustering maximizes a metric, which rewards variables in the same cluster if they have high cluster method agreement and penalizes variables in the same cluster if they have low agreement. Consensus clustering maximizes agreement using the function <italic>f</italic>(<italic>G</italic><sub><italic>i</italic></sub>) in Equation (1) to score each cluster of size <italic>s</italic><sub><italic>i</italic></sub></p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i1.gif"/></p><p>where <italic>A </italic>is the agreement matrix, <italic>G</italic><sub><italic>ij </italic></sub>is the <italic>j</italic>th element of cluster <italic>i </italic>(<italic>G</italic><sub><italic>i</italic></sub>) and <italic>&#x003b2; </italic>is a user-defined parameter (the agreement threshold), which determines whether the score for the cluster is increased or decreased. The score for a clustering arrangement is the sum of the scores of each cluster, which consensus clustering attempts to maximize.</p><p>If <italic>&#x003b2; </italic>is equal to <italic>Min</italic>, the minimum value in <italic>A</italic>, then the function is maximized when all variables are placed into the same cluster (that is, a single large cluster). Alternatively, when <italic>&#x003b2; </italic>is equal to <italic>Max</italic>, the maximum value in <italic>A</italic>, the function is maximized when each variable is placed into its own cluster. Essentially all clusters produced by Consensus Clustering are scored by <italic>f</italic>(<italic>G</italic><sub><italic>i</italic></sub>), rewarding and preserving clusters with high agreement between members, while penalizing and discarding clusters containing low agreement between members. A value for <italic>&#x003b2; </italic>should lie between the minimum and the maximum agreement so as not to skew the scoring function. A suitable value for <italic>&#x003b2; </italic>is (<italic>Max </italic>+ <italic>Min</italic>)/2, where <italic>Max </italic>is the maximum value in <italic>A </italic>and <italic>Min </italic>is the minimum. For a uniformly distributed agreement matrix, (<italic>Max </italic>+ <italic>Min</italic>)/2 is the mean value; therefore we penalize values below the mean agreement and reward above it. For both the ASC and B-cell lymphoma data <italic>&#x003b2; </italic>was 2, as <italic>Max </italic>= 4 (four clustering algorithms giving complete agreement) and <italic>Min </italic>= 0 (no agreement). In order to maximize the scoring function for consensus clustering, a search over possible cluster membership is needed. There are many methods for performing a search and it was decided that SA was best because it is an efficient search/optimization procedure that does not suffer from becoming stuck in local maxima. The consensus algorithm is as follows:</p><p>Input: Agreement Matrix (<italic>n </italic>&#x000d7; <italic>n</italic>), <italic>A; </italic>Maximum Number of Clusters sought, <italic>m; </italic>Number of Iterations, <italic>Iter; </italic>Agreement Threshold, <italic>&#x003b2;; </italic>Initial Temperature, <italic>&#x003b8;</italic><sub>0</sub><italic>; </italic>Cooling Rate, <italic>c</italic></p><p>(1) Generate a random number of empty clusters (&#x0003c;m)</p><p>(2) Randomly distribute the variables (genes) 1..<italic>n </italic>between the clusters</p><p>(3) Score each cluster according to Equation (1)</p><p>(4) For <italic>i </italic>= 1 to <italic>Iter </italic>do</p><p>(5)&#x000a0;&#x000a0;Either Split a cluster, Merge two clusters or Move a variable (gene) from one random cluster to another</p><p>(6)&#x000a0;&#x000a0;Set &#x00394;<italic>f </italic>to difference in score according to Equation (1)</p><p>(7)&#x000a0;&#x000a0;If &#x00394;<italic>f </italic>&#x0003c; 0 Then</p><p>(8)&#x000a0;&#x000a0;Calculate probability, <italic>p</italic>, according to Equation (2)</p><p>(9)&#x000a0;&#x000a0;If <italic>p </italic>&#x0003e; random(0,1) then undo operator</p><p>(10) End If</p><p>(11)&#x000a0;&#x000a0;<italic>&#x003b8;</italic><sub><italic>i </italic></sub>= <italic>c&#x003b8;</italic><sub><italic>i</italic>-1</sub></p><p>(12) End For</p><p>Output:Set of Consensus Clusters</p><p>Note that <italic>random</italic>(0,1) (line 9) returns a random uniformly distributed real number between 0 and 1.</p><p>The 'split', 'merge' and 'move' operators (line 5) are as follows and used with equal probability:</p><p>Split a cluster:</p><p>Input: Cluster <italic>g </italic>of size <italic>n</italic></p><p>(1) Randomly shuffle the cluster</p><p>(2) Set <italic>i </italic>to be a random whole number between 1 and <italic>n</italic>-1</p><p>(3) Create two empty clusters <italic>g</italic><sub>1 </sub>and <italic>g</italic><sub>2</sub></p><p>(4) Add elements 1..<italic>i </italic>of <italic>g </italic>to <italic>g</italic><sub>1</sub></p><p>(5) Add elements i+1..<italic>n </italic>of <italic>g </italic>to <italic>g</italic><sub>2</sub></p><p>Output:Two new clusters <italic>g</italic><sub>1 </sub>and <italic>g</italic><sub>2</sub></p><p>Here the old cluster is deleted and the two new clusters are then added to the set of clusters.</p><p>Merge two clusters:</p><p>Input: Two Clusters <italic>g</italic><sub>1 </sub>and <italic>g</italic><sub>2</sub></p><p>(1) A new cluster <italic>g </italic>is created by forming the union of <italic>g</italic><sub>1 </sub>and <italic>g</italic><sub>2</sub></p><p>Output: A new cluster <italic>g</italic></p><p>Here the old clusters are deleted and new cluster is then added to the set of clusters.</p><p>Move a gene:</p><p>Input:A set of clusters <italic>G</italic></p><p>(1) Two random clusters <italic>g</italic><sub>1 </sub>and <italic>g</italic><sub>2 </sub>are chosen where the size of <italic>g</italic><sub>1 </sub>is greater than one</p><p>(2) A random element of <italic>g</italic><sub>1 </sub>is moved into <italic>g</italic><sub>2</sub></p><p>Output:The updated set of clusters <italic>G</italic></p><p>The probability (<italic>p</italic>) (line 8) is calculated by:</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i2.gif"/></p><p>In the following experiments we found <italic>&#x003b8;</italic><sub>0 </sub>= 100, <italic>c </italic>= 0.99994 and <italic>iter </italic>= 1,000,000 as the most efficient parameters for SA.</p><p>These parameter settings for SA are effectively determined by the <italic>iter </italic>setting. We denote the change in fitness during the SA algorithm as &#x00394;<italic>f </italic>and the starting temperature as <italic>&#x003b8;</italic><sub>0 </sub>which is always positive. From equation 2 it can be clearly seen that if &#x00394;<italic>f </italic>= <italic>&#x003b8;</italic><sub>0 </sub>then the (worse) solution will be accepted with probability 0.368 (<italic>e</italic><sup>-1</sup>). As the temperature cools, this probability will reduce. Here we set <italic>&#x003b8;</italic><sub>0 </sub>to be the average of &#x00394;<italic>f </italic>over 1,000 trial evaluations, so that at the beginning of the algorithm, the average worse solution (&#x00394;<italic>f </italic>= <italic>&#x003b8;</italic><sub>0</sub>) will be accepted with the probability stated above.</p><p>It can be seen from the consensus algorithm that during the <italic>i</italic>th stage of the SA algorithm <italic>&#x003b8;</italic><sub>0 </sub>= <italic>&#x003b8;</italic><sub>0</sub><italic>c</italic><sup><italic>i</italic></sup>. The SA algorithm works by assuming that the temperature reduces to zero over an infinite number of iterations. As it is not practical to run the SA algorithm to infinity the method is usually terminated after a fixed number of iterations, (<italic>iter</italic>). At this time the temperature will not be zero, but very small and positive, say <italic>&#x003b5;</italic>. Therefore,</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i3.gif"/></p><p>Hence if some small positive value for <italic>&#x003b5; </italic>is chosen, and the algorithm is to run for a defined number of iterations (<italic>iter</italic>), then the decay constant <italic>c </italic>is calculated as above.</p></sec><sec><title>Application of consensus clustering</title><p>As consensus clustering relaxes the 'complete agreement' criteria we would expect the majority but not necessarily all robust cluster members to be assigned to the same consensus clusters. This was indeed true for the B-cell data where consensus clustering of the datasets showed that 98.5% of the B-cell robust clusters were assigned correctly to their respective consensus clusters. With the more consistent ASC data 100% of the robust clusters were assigned to the correct consensus clusters.</p><p>The advantage of consensus clustering over all single-cluster methods was evident when comparing consensus clustering to the mean <italic>weighted-kappa </italic>score for each pairwise combination of individual clustering algorithms (derived from Figure <xref ref-type="fig" rid="F1">1</xref>). Comparisons for the ASC dataset (Figure <xref ref-type="fig" rid="F3">3a</xref>) and B-cell lymphoma data (Figure <xref ref-type="fig" rid="F3">3b</xref>) show that consensus clustering improves on all single methods regardless of dataset, except in the case of CAST compared to SA for the ASC dataset (Figure <xref ref-type="fig" rid="F3">3a</xref>). It is interesting to observe that consensus clustering has higher agreement with SA compared to SA agreement with all other methods in the B-cell data (Figure <xref ref-type="fig" rid="F3">3b</xref>). The reasons for this are unclear, but suggest that with datasets similar to the B-cell data, SA captures a reliably partitioned subset of the data. To determine if consensus clustering was consistently superior to the use of single clustering methods, particularly the stochastic methods CAST and SA, we performed 10 independent runs of CAST, SA and consensus clustering. From the resulting clusters we determined the mean <italic>weighted-kappa </italic>scores for 45 possible comparisons (that is, the number of unique pairs formed from 10 objects = 10 &#x000d7; 9/2) (Table <xref ref-type="table" rid="T3">3</xref>). Consensus clustering provided an extremely high degree of consistency over all 10 runs, with a mean <italic>weighted-kappa </italic>score of 0.96. Importantly, there was little variation between each of the 10 runs with a standard deviation of the mean <italic>weighted-kappa </italic>of 0.0015. SA had a similar low standard deviation, but produced lower inter-run consistency (mean <italic>weighted-kappa </italic>of 0.816). CAST was the least consistent of the methods (mean <italic>weighted-kappa </italic>of 0.646). The differences in the consensus clustering mean compared to SA and CAST are significant at greater than the 99.9% confidence level, thereby showing consensus clustering identifies a reliable data partition, which is significantly better than multiple runs of single clustering methods.</p><p>We wished to confirm that the benefit of consensus clustering was not simply due to the parameter settings chosen for the dataset used. This could be confirmed by extensively varying each algorithm's parameter settings and comparing cluster partitioning using the same dataset; however, the large number of combinations of possible parameter settings between all methods makes this unrealistic. An alternative approach is to compare all methods on additional datasets. We therefore tested consensus clustering on two different simulated datasets containing 60 defined clusters of genes. The first synthetic dataset was generated from a vector autoregressive process (VAR) and the second using a multivariate normal distribution (MVN). The number of genes in each cluster varied from 1 to 60, with the number of conditions (arrays) set to 20. The datasets therefore contained 1,830 genes over 20 conditions. As the structure of each dataset is known, the results of each clustering method can be evaluated for accuracy using the <italic>weighted-kappa </italic>metric. Cluster accuracy using the single methods ranged between a <italic>weighted-kappa </italic>of 0.505 to 0.7 (mean <italic>weighted-kappa </italic>of 0.614) (Table <xref ref-type="table" rid="T4">4</xref>). It is interesting to note that the single clustering methods performed differently on the two synthetic datasets, with HC, SA and CAST performing better on the MVN synthetic data and PAM better on the VAR synthetic data. Consensus clustering was superior to all single clustering algorithms with <italic>weighted-kappa </italic>scores of 0.725 and 0.729 for VAR and MVN respectively, demonstrating that consensus clustering is accurate regardless of subtleties in the data structure (Table <xref ref-type="table" rid="T4">4</xref>).</p></sec></sec><sec><title>Interpretation of consensus clustering</title><p>Consensus clustering greatly improves the accuracy of identifying cluster group membership based solely on the gene-expression vector, but as with other clustering algorithms still produces essentially unannotated clusters which require further external validation by gene function analysis. To address this problem, we derived a probability score to test the significance of observing multiple genes with known function in a given cluster against the null hypothesis of this happening by chance. This identifies clusters of high functional group significance, aiding assignment of functions to unclassified genes in the cluster using the 'guilt by association' hypothesis.</p><p>The probability score is based on the hypothesis that, if a given cluster, <italic>i</italic>, of size <italic>s</italic><sub><italic>i</italic></sub>, contains <italic>x </italic>genes from a defined functional group of size <italic>k</italic><sub><italic>j</italic></sub>, then the chance of this occurring randomly follows a binomial distribution and is defined by:</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i4.gif"/></p><p>where <italic>n </italic>is the number of genes in the dataset. As <italic>k</italic><sub><italic>j </italic></sub>and <italic>x </italic>may potentially be very large, <italic>Pr </italic>from the above equation would be difficult to evaluate. Therefore the normal approximation to the binomial distribution can be used as defined by:</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i5.gif"/></p><p>Large positive values of <italic>z </italic>mean that the probability of observing <italic>x </italic>elements from functional group <italic>j </italic>in cluster <italic>i </italic>by chance is very small, (for example <italic>z </italic>&#x0003e; 2.326 corresponds to a probability less than 1%). Note that we perform a one tailed test as we are only interested in the case where a significantly high number of co-clustered genes belong to the same functional group.</p><p>This cluster function probability score was used to identify statistically significant (at the 1% level) B-cell consensus clusters containing defined genes known to be associated with 10 functional groups [<xref ref-type="bibr" rid="B21">21</xref>]. To determine if consensus clustering was better able to identify important functional group clusters we determined the functional group probability scores produced by individual clustering algorithms analogous to the strategy of Wu <italic>et al</italic>. [<xref ref-type="bibr" rid="B20">20</xref>]. For each functional group, the mean lowest probability scores (using Equation (4)) were calculated for the signal clustering methods and compared to consensus clustering (Figure <xref ref-type="fig" rid="F4">4a</xref>). Consensus clustering always produced equivalent or lower probabilities for each functional group, indicating that it produced more informative clusters.</p><p>One potential confounding factor in this analysis is that consensus clustering achieves a lower probability score by finding smaller clusters. This would decrease the ability to associated new genes with a given functional group. In the worst case the number of genes defining a functional group (FG) would equal the cluster size (<italic>s</italic><sub><italic>i</italic></sub>) (FG/<italic>s</italic><sub><italic>i </italic></sub>= 1). Alternatively, single clustering methods may produce lower probability scores by increasing the cluster size, thereby pulling many genes into the cluster resulting in a FG/<italic>s</italic><sub><italic>i </italic></sub>ratio tending towards zero. This would also reduce the usefulness of the clusters. We determined the cluster size and functional group size for two representative functional groups where the consensus clustering probability was similar to the single method probability score, namely the endoplasmic reticulum (ER) stress response (also known as the unfolded protein response) (ER/UPR) functional group, or the markedly better nuclear factor-&#x003ba;B (NF&#x003ba;B) functional group (Figure <xref ref-type="fig" rid="F4">4b</xref>). Apart from SA, all single clustering methods tended to produce larger clusters, thereby decreasing the FG/<italic>s</italic><sub><italic>i </italic></sub>ratio. In the most extreme case of the ER/UPR functional group, the HC cluster size was 310 compared to the consensus clustering size of 40. SA tended to produce similar cluster sizes as consensus clustering but with higher overall probabilities. Therefore, consensus clustering identifies significant functional clusters while achieving a workable balance between large or small cluster sizes.</p><p>We further investigated the two groups NF&#x003ba;B and ER/UPR to assess what additional insights consensus clustering allowed. These two functional groups represent important B-cell functions at different stages of the B-cell development pathway. The consensus cluster associated with NF&#x003ba;B also contained genes either not previously associated with or only tentatively associated with NF&#x003ba;B activity in subsets of B-cell lymphomas. The gene-expression profiles from this consensus cluster were visualized by average linkage HC using the programmes Cluster and Treeview [<xref ref-type="bibr" rid="B5">5</xref>] (Figure <xref ref-type="fig" rid="F5">5</xref>) and clustered gene functions were investigated further using the annotation resources DAVID [<xref ref-type="bibr" rid="B25">25</xref>] and GeneCards [<xref ref-type="bibr" rid="B26">26</xref>]. From GeneCards each gene was identified in the complete human genome sequence using Ensembl [<xref ref-type="bibr" rid="B27">27</xref>] and 1,000 base pairs (bp) upstream of the predicted transcriptional start site extracted for promoter analysis using the program TESS from the Baylor College sequence analysis software BCM [<xref ref-type="bibr" rid="B28">28</xref>] (Figure <xref ref-type="fig" rid="F6">6</xref>).</p><p>This consensus cluster is predominantly overexpressed in the cell lines Raji, Pel-B, EHEB, Bonna-12 and L-428. These cell lines have in common the induction of the NF&#x003ba;B pathway, either through expression of Epstein-Barr virus LMP-1 protein (Raji, Pel-B, EHEB and Bonna-12) or the loss of function of the inhibitor of NF&#x003ba;B, namely I&#x003ba;B (L-428). This implies that many of these genes could be NF&#x003ba;B responsive. Twenty-four putative promoter regions were analyzed and NF&#x003ba;B-binding sites were identified in 12 of these. As expected, NF&#x003ba;B-binding sites were found in the CD40L receptor gene, <italic>Bfl-1</italic>, <italic>BIRC3</italic>, EBV-induced gene 3 (<italic>EBI3</italic>), and the genes for class I MHC-C and lymphotoxin <italic>&#x003b1;</italic>, as these have been previously characterized as NF&#x003ba;B responsive and were present in the initial NF&#x003ba;B-defined gene set. Interestingly, NF&#x003ba;B-binding sites were also found in six additional promoters for which accurate mapping of promoter transcription factor binding is not available (Figure <xref ref-type="fig" rid="F6">6a</xref>). All but four NF&#x003ba;B-binding sites conform precisely to the canonical consensus binding site (Figure <xref ref-type="fig" rid="F6">6b</xref>) [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>] and of the variants with T at position 1, two genes, <italic>lymphotoxin &#x003b1; </italic>and <italic>BIRC3 </italic>are known to be NF&#x003ba;B responsive. Overall, this indicates that the six additional genes identified are likely to be NF&#x003ba;B responsive.</p><p>The consensus cluster associated with the ER/UPR functional group contained genes not previously associated with ER stress-induced upregulation. The gene-expression profiles were visualized and annotated as described for the NF&#x003ba;B functional group (Figure <xref ref-type="fig" rid="F7">7a</xref>). Annotation showed that of the 32 genes within the ER/UPR consensus cluster (23 defining the original functional group), 16% (5) were involved in calcium-ion binding within the ER and 13% (4) were involved with <italic>N</italic>-glycan biosynthesis. This functional group was overexpressed in cell lines of plasmablast or plasma-cell tumors, where physiological upregulation of the ER is required for cellular function. This process is controlled by two transcription factors, ATF6 and XBP1 [<xref ref-type="bibr" rid="B31">31</xref>]. The <italic>ATF6 </italic>transcript was present as a defining signature gene in the ER/UPR functional group. This suggests that ATF6 and XBP1 may be responsible for upregulation of the calcium-ion binding and <italic>N</italic>-glycan biosynthetic genes. Two responsive elements have been defined for ATF6 and XBP1 respectively, the ER stress-response element (ESRE), comprising the binding site CCAATN<sub>9</sub>CCACG and the unfolded protein response element (UPRE), comprising the binding site TGACGTG(G) [<xref ref-type="bibr" rid="B32">32</xref>]. ATF6 and XBP1 can bind to the CCACG region of ESRE in conjunction with the general transcription factor NF-Y/CB. XBP1 can bind to the UPRE, but ATF6 can only bind to the UPRE when expressed to high (possibly non-physiological) levels [<xref ref-type="bibr" rid="B33">33</xref>]. ESRE sites were identified in two of the five calcium-ion binding proteins, namely, calnexin and the tumor rejection antigen (gp96) 1(TRA1) (Figure <xref ref-type="fig" rid="F7">7b</xref>). Interestingly, XBP1 (UPRE) binding sites were identified in two of the <italic>N</italic>-glycan biosynthetic genes but no ESRE sites were found. This suggests that these two groups of genes are regulated through two distinct mechanisms by transcription factors ATF6 and XBP1 as a result of ER stress.</p></sec></sec><sec><title>Discussion</title><p>Grouping data into sets based on a consistent property is a common occurrence in biological analysis. This has recently increased in importance with the production of large microarray datasets. Implicit in the experimental rationale is the fact that patterns of coexpressed genes should be identifiable in a gene expression matrix and these can be linked to shared biological processes. However, different clustering algorithms are known to partition data into different groups [<xref ref-type="bibr" rid="B10">10</xref>-<xref ref-type="bibr" rid="B13">13</xref>]. We also observe a similar lack of cluster-method concordance using a <italic>weighted-kappa </italic>metric. This metric effectively scores how well different cluster method pairs assign the same genes to the same clusters. The <italic>weighted-kappa </italic>metric readily shows that, even for highly correlated gene-expression profiles present in the ACS dataset, no two clustering algorithms have complete agreement, although the global search methods such as SA seem to produce the most consistent results. Overall this emphasizes that no single analysis method will identify all patterns in the gene-expression data; therefore multiple analyses should be performed and compared [<xref ref-type="bibr" rid="B23">23</xref>].</p><p>We and others recently described the use of consensus clustering to improve confidence [<xref ref-type="bibr" rid="B34">34</xref>] or as a re-sampling method for microarray analysis [<xref ref-type="bibr" rid="B19">19</xref>]. It was suggested that a natural extension of Monti <italic>et al</italic>. was to use a meta-consensus across different clustering algorithms rather than to re-sample over the same algorithm. Our results represent this extension and confirm the validity of consensus clustering. We have developed both robust and consensus clustering, with these methods offering specific advantages over the use of individual clustering algorithms for microarray analysis. The robust clustering algorithm is useful for creating clusters of genes with high confidence and is extremely effective for reducing the dimensionality of large gene-expression datasets. However, robust clustering can be restrictive in discarding genes that do not have full agreement. Consensus clustering overcomes this problem, requiring a minimum-agreement parameter to generate clusters based on the combined results of a number of existing clustering methods. This strategy enables the effective identification of cluster groups that are of high reliability and cluster method independent.</p><p>The choice of clustering algorithms and parameter settings is a major stumbling block for all gene array cluster analysis. The effect of varying the parameters depends on the cluster method used. The performance of cluster methods has been extensively investigated [<xref ref-type="bibr" rid="B12">12</xref>]. The authors show that model-based methods and certain partitional methods, when used with optimal distance matrices, perform well on synthetic and real-world data. From our study, SA, an optimization method, also performs well as a clustering method. Therefore, the individual algorithms used as input to consensus clustering should ideally consist of representative algorithms from optimization (for example, SA), graph theoretical (for example, CAST), model-based (for example, MCLUST [<xref ref-type="bibr" rid="B12">12</xref>]) and partitional (for example, HC). Some methods (for example, CAST, SA and MCLUST) can determine the number of clusters directly from the input data. However, some other methods require the number of clusters to be specified as a parameter (for example, PAM and HC). In principle, methods such as CAST, SA and MCLUST can be used to determine this parameter for methods such as PAM and HC.</p><p>Consensus clusters are likely to contain gene subsets that are co-regulated by common transcriptional control networks or are coexpressed to participate in cellular processes that together manifest a global phenotype of the cell or tissue. In either case, these clusters are of high biological value. To facilitate further analysis it is useful to know which clusters are involved in a given biological process. By supplying a list of genes from a given biological process or network, the use of the normal approximation to the binomial distribution of these genes over all consensus clusters, allows the identification of clusters of high functional significance. Similar statistical assignment of gene function based on cluster analysis was performed by Wu <italic>et al. </italic>using a database of clusters [<xref ref-type="bibr" rid="B20">20</xref>]. To assign significance Wu <italic>et al. </italic>used the hypergeometric distribution. This distribution can be formally shown to asymptotically become the binomial distribution when the population size increases. Therefore, when used on large gene-expression datasets our methods are directly analogous to Wu <italic>et al</italic>. However, consensus clustering has the advantage over a database of clusters by producing low-probability clusters containing a significant percentage of known elements from functional groups.</p><p>Two functionally significant clusters, the NF&#x003ba;B-responsive cluster and the ER/UPR cluster, were investigated further here. Within the NF&#x003ba;B-responsive cluster 50% of the putative promoters of genes investigated had canonical NF&#x003ba;B-binding sites within 1,000 base pairs of the transcriptional start site, suggesting that they are NF&#x003ba;B responsive [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. The majority of these genes had NF&#x003ba;B-binding sites within 500 bp of the transcriptional start sites, consistent with the location in other NF&#x003ba;B-responsive genes [<xref ref-type="bibr" rid="B35">35</xref>]. Of the remaining two genes with NF&#x003ba;B-binding sites greater than 800 bp from the transcription start site, one, <italic>Bfl-2</italic>, has been experimentally verified [<xref ref-type="bibr" rid="B36">36</xref>]. Analysis of the ER/UPR consensus cluster also provided information on gene regulatory elements, but more interestingly provides insights into the control and effect of the ERSR/UPR.</p><p>In cells, the presence of unfolded proteins in the ER is associated with induction of the ER/UPR. However, during the maturation of B-cells to antibody-secreting plasma cells, expansion of the ER to accommodate increased secretion of immunoglobulins is thought to be coupled to the final stages of plasma-cell maturation. The induction of the ER/UPR occurs via the coordinated activation of the transcription factors ATF6 and XBP1 [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. ATF6 is normally maintained as an inactive, ER-resident, transmembrane protein that is cleaved, after translocating to the Golgi upon ER stress, by the site proteases S1P and S2P [<xref ref-type="bibr" rid="B37">37</xref>,<xref ref-type="bibr" rid="B38">38</xref>]. The cleaved transcriptionally active ATF6 is then free to translocate to the nucleus, where it can activate target genes such as XBP1 and the ER chaperon protein GRP78/BiP [<xref ref-type="bibr" rid="B39">39</xref>]. <italic>XBP1 </italic>mRNA is cleaved by the ER stress activated protein IRE1 to yield the transcriptionally active form of XBP1, inducing further genes of the UPR [<xref ref-type="bibr" rid="B32">32</xref>]. The activation of both the ATF6 and IRE1/XBP1 pathways results in enhanced transcription of ESRE-responsive genes; however, only XBP1 appears able to transactivate the UPRE. The identification of ESRE binding sites in the promoter regions of genes for calcium-ion binding protein and UPRE binding sites in the promoter regions of <italic>N</italic>-glycan biosynthesis genes suggests that these genes are differentially regulated by ATF6/XBP1 and XBP1 respectively.</p><p>The only known UPRE target gene is ER degradation-enhancing <italic>&#x003b1;</italic>-mannoside-like protein (EDEM), whose induction depends solely on IRE1/XBP1 activity [<xref ref-type="bibr" rid="B33">33</xref>]. Induction of the two UPRE-containing genes, UDP-GlcNAc:dolichol phosphate <italic>N</italic>-acetylglucosamine-1 phosphate transferase (<italic>DPAGT1</italic>) and UDP-GlcNAc:<italic>&#x003b1;</italic>-6-D-mannoside <italic>&#x003b2;</italic>-1-2-<italic>N</italic>-acetylglucosaminyltransferase II (<italic>MGAT2</italic>), which catalyze essential steps in the biosynthetic pathway of complex <italic>N</italic>-linked glycans, supporting a clear link between the dolichol pathway and the UPR [<xref ref-type="bibr" rid="B40">40</xref>]. In addition, the ER/UPR functional group suggests that <italic>DPAGT1 </italic>and <italic>MGAT2 </italic>expression is regulated solely by the IRE1/XBP1 pathway. Altogether, these results show that consensus clustering and gene functional group analysis provide a highly accurate way of mining gene-expression data for novel insights into different genes within the cluster.</p><p>Robust and consensus clustering provide a platform for more efficient microarray analysis pipelines. There is effectively no limit to the number of different clustering algorithms that can be used to feed into the consensus clusters, and each clustering algorithm could be run under different parameter sets to fully explore a microarray dataset [<xref ref-type="bibr" rid="B19">19</xref>]. In addition, different distance matrices could be used as input into the range of clustering algorithms. In each case the consensus clustering algorithm effectively acts as the collation and interpretation point for the different individual analysis methods. This environment is ideal for use in parallel processing computer farms and the GRID [<xref ref-type="bibr" rid="B41">41</xref>]. In such an environment, each node of the farm could perform a range of analyses with a subset of clustering algorithms, with the master node compiling the consensus results. This would greatly increase computational speed and allow a thorough, single data entry point, access to an extensive range of clustering methods.</p><p>All areas of functional genomics that produce high-dimensional datasets with inherent patterns will require data partitioning to allow interpretation. Consensus clustering in the context of statistically defined functional groups could allow a consistent analysis platform for such diverse data types.</p></sec><sec sec-type="materials|methods"><title>Materials and methods</title><sec><title>Clustering methods</title><p>We implemented and compared a representative sample of methods from the statistical, AI and data-mining communities. The methods used were average linkage HC, PAM, SA and CAST. As all the clustering techniques use correlation between variables, we used the Pearson's correlation coefficient, <italic>r</italic>, to measure the linear relationship between two variables, <italic>x</italic><sub>1 </sub>and <italic>x</italic><sub>2</sub>, where the variable can be either discrete or continuous [<xref ref-type="bibr" rid="B42">42</xref>]. HC and PAM methods were implemented using the statistical package R [<xref ref-type="bibr" rid="B22">22</xref>], while CAST and SA were implemented locally in C++.</p><p>HC is an agglomerative method that produces a hierarchical (binary) tree or dendrogram representing a nested set of data partitions. It has been applied successfully to many gene-expression datasets [<xref ref-type="bibr" rid="B43">43</xref>]. Sectioning a hierarchically clustered tree at a particular level leads to a partition with a number of disjointed groups, thereby yielding different clustering of the data. The tree was sectioned using the CUTTREE method, to yield 13 clusters for the ASC dataset and 40 for the B-cell dataset. The method PAM works by first selecting <italic>m </italic>out of <italic>n </italic>total objects that are the closest (according to a distance matrix) to the remaining (<italic>n </italic>- <italic>m</italic>) objects. The fitness of these medoids is calculated by placing the remaining (<italic>n </italic>- <italic>m</italic>) objects in a group according to the nearest medoid and summing the distances of the group members from this medoid. These <italic>m </italic>selected objects are the initial medoids. A <italic>Swapping </italic>procedure is then applied to reassort the objects until there is no improvement in the fitness of the medoids [<xref ref-type="bibr" rid="B3">3</xref>]. As with HC, PAM is set to search for 13 and 40 clusters. The choice of 13 clusters for the ASC data was determined by the number of repeated genes, whereas 40 clusters for the B-cell data was based on previous exploratory data analysis [<xref ref-type="bibr" rid="B21">21</xref>].</p><p>SA [<xref ref-type="bibr" rid="B6">6</xref>] is an iterative improvement search technique that starts with a random solution to a given problem, and then tries to increase its worth by a series of small changes in cluster membership. If such a small change is better than the previous solution, then further changes are made from this new point. However, if the new solution is worse than the old one, it is not discarded, but accepted with a certain probability. The measured worth of the SA clustering arrangement is based here on the EVM metric [<xref ref-type="bibr" rid="B44">44</xref>]. SA has recently been applied to the clustering of gene-expression data [<xref ref-type="bibr" rid="B45">45</xref>]. The performance related parameters for SA were set as follows: <italic>&#x003b8;</italic><sub>0 </sub>= 100, <italic>c </italic>= 0.99994 and number of iterations = 1,000,000.</p><p>CAST [<xref ref-type="bibr" rid="B9">9</xref>] is a heuristic algorithm that uses an affinity measure to determine whether variables are assigned to clusters. It requires a threshold parameter, which determines whether variables are assigned or moved to new clusters. Once CAST is complete, a clean-up operation is applied to ensure that the affinity of every variable to its cluster is greater than a user defined threshold. The only parameter CAST needed was the affinity level, which was set to 0.5 as recommended [<xref ref-type="bibr" rid="B9">9</xref>].</p><p>Methods such as CAST and SA require the differences/relationships between a pair of observations, <italic>x</italic><sub>1 </sub>and <italic>x</italic><sub>2</sub>, to be expressed as binary (<italic>b</italic>). As Pearson's correlation coefficient is bounded, it provides a good basis for defining a binary relationship between two variables as defined by:</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i6.gif"/></p><p>where 0 &#x0003c;<italic>&#x003b1; </italic>&#x02264; 0 is a constant and <inline-graphic xlink:href="gb-2004-5-11-r94-i11.gif"/> is a floor function that returns the largest integer less than or equal to the real number <italic>y</italic>.</p></sec><sec><title>Datasets for evaluation</title><p>Two datasets were used for evaluating the cluster methods. The first is a set of multiply repeated control element spots relating to the Amersham Score Card (ASC) probe set on the Human Genome Mapping Project Human Gen1 clone set array [<xref ref-type="bibr" rid="B46">46</xref>]. The ASC probes are present as a single row of 32 elements in each of the 24 array sub-grids. Of these elements, 13 gene probes consistently give signals above background in both the Cy5 and Cy3 channels. Therefore, each array has effectively 24 repeat measurements of 13 spots. After filtering for low signal-to-noise ratio (SNR) probes, a dataset of 30 arrays was examined by treating each positional repeat probe element across the 30 array set as an individual gene, which together with the remaining 23 same-gene probes per array, represents a highly correlated gene-expression profile. Therefore, we assume the repeated probes should cluster together; thus, this dataset becomes 308 genes/probe elements, which would cluster into 13 known groups, with each group having between 6 and 24 members after SNR filtering. In essence, the ASC data represent a semi-synthetic dataset for internal cluster method validation.</p><p>The second dataset consists of a series of 26 arrays (1,987 filtered genes) measuring gene-expression difference across a set of human B-cell lymphomas and leukemias [<xref ref-type="bibr" rid="B21">21</xref>]. The dataset is available via the URL indicated in Jenner et al. [<xref ref-type="bibr" rid="B21">21</xref>]. Each probe on the array detected a single gene transcript. This dataset contains a number of genes that correspond to known cellular functions, for example cell proliferation and NF&#x003ba;B response. The four clustering techniques described above were applied to both the datasets, with each method being set to find 13 clusters for the ASC and 40 clusters for the B-cell data.</p></sec><sec><title>Synthetic datasets</title><p>Two synthetic datasets were generated using a vector autoregressive process (VAR) or a multivariate normal distribution (MVN). The two datasets contained 1,830 genes and 20 conditions (arrays). The VAR process of order <italic>p </italic>is a linear multivariate time series defined by</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i7.gif"/></p><p>where <underline><italic>x</italic></underline>(<italic>t</italic>) is the <italic>n</italic>-dimensional vector of observations at time <italic>t</italic>, <italic>A</italic><sub><italic>i </italic></sub>is the <italic>n </italic>&#x000d7; <italic>n </italic>autoregressive coefficient matrix at time lag <italic>i</italic>, and <underline><italic>&#x003b5;</italic></underline>(<italic>t</italic>) is the zero mean <italic>n</italic>-dimensional noise vector at time <italic>t </italic>(drawn from a normal distribution). Therefore <underline><italic>x</italic></underline>(<italic>t</italic>) is a linear combination of the previous observations plus some random noise. For the synthetic dataset, each cluster was generated by a vector autoregressive model of order <italic>p </italic>= 1 and size <italic>n </italic>equal to the number of genes in the cluster.</p><p>For the MVN dataset, a vector of random variables <underline><italic>x</italic></underline> has a MVN distribution if every linear combination of that vector is also normal. Under such conditions we use the notation <underline><italic>x</italic></underline> ~ <italic>N</italic>(<underline><italic>&#x003bc;</italic></underline>, &#x003a3;) to denote that <underline><italic>x</italic></underline> follows the MVN distribution, where <underline><italic>&#x003bc;</italic></underline> is the mean vector and &#x003a3; is a positive definite matrix of covariance. The probability density function of <underline><italic>x</italic></underline> is given by</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i8.gif"/></p><p>where |&#x003a3;| = det(&#x003a3;). For the synthetic dataset, each cluster was drawn from an MVN distribution with varying mean <underline><italic>&#x003bc;</italic></underline> and covariance &#x003a3;.</p></sec><sec><title><italic>Weighted-kappa </italic>metric</title><p>To compare the resultant clusters for each method, a statistic known as <italic>weighted-kappa </italic>was used [<xref ref-type="bibr" rid="B18">18</xref>]. This metric rates agreement between the classification decisions made by two or more observers. In this case the two observers are the clustering methods. The classification from each observer for each unique pairing of variables (within the clusters) is divided into a 2 &#x000d7; 2 contingency table. Rows and columns within this table are indexed according to whether the two variables are in the same group or in different groups. The total number of comparisons, <italic>N</italic>, is defined in the following equation, where <italic>Count</italic><sub><italic>ij </italic></sub>is the number of elements in the matrix cell indexed by (<italic>i</italic>,<italic>j</italic>),</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i9.gif"/></p><p>and <italic>n </italic>is the number of variables (genes) in the clusters as this represents the number of unique variable pairings.</p><p>The <italic>weighted-kappa </italic>metric is calculated from the contigency table by:</p><p><inline-graphic xlink:href="gb-2004-5-11-r94-i10.gif"/></p><p>where, <italic>w</italic><sub><italic>ij </italic></sub>is the weights for each category comparison; <italic>p</italic><sub><italic>o</italic>(<italic>w</italic>) </sub>and <italic>p</italic><sub><italic>e</italic>(<italic>w</italic>) </sub>represent the observed weighted proportional agreement and the expected weighted proportional agreement; <italic>Count</italic><sub><italic>ij </italic></sub>is the <italic>i</italic>th, <italic>j</italic>th element of the 2 &#x000d7; 2 contingency table; <italic>N </italic>is the sum of the elements within this table; <italic>Row</italic>(<italic>i</italic>) and <italic>Col</italic>(<italic>i</italic>) are the row and column totals for this table respectively and <italic>K</italic><sub><italic>w </italic></sub>is the <italic>weighted-kappa </italic>value. The interpretation of <italic>weighted-kappa </italic>values indicates the strength of agreement between two observers (Table <xref ref-type="table" rid="T1">1</xref>) is used to compare cluster method agreement in both datasets.</p></sec></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work is supported in part by the BBSRC, the EPSRC and the MRC in the UK. We would also like to thank Richard Jenner for the viral gene expression dataset and Antonia Kwan for preparing the ASC dataset. These methods are available on request as functions in the statistical package, R.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>JH</given-names></name></person-group><article-title>Hierarchical grouping to optimize an objective function.</article-title><source>J Am Stat Assoc</source><year>1963</year><volume>58</volume><fpage>236</fpage><lpage>244</lpage></citation></ref><ref id="B2"><citation citation-type="book"><person-group person-group-type="author"><name><surname>McQueen</surname><given-names>J</given-names></name></person-group><article-title>Some methods for classification and analysis of multivariate observations.</article-title><source>5th Berkeley Symposium on Mathematical Statistics and Probability</source><year>1967</year><publisher-name>Berkeley</publisher-name><fpage>281</fpage><lpage>297</lpage></citation></ref><ref id="B3"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Kaufman</surname><given-names>L</given-names></name><name><surname>Rousseeuw</surname><given-names>PJ</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Dodge Y</surname></name></person-group><article-title>Clustering by means of medoids.</article-title><source>Statistical Analysis Based Upon the L1 Norm</source><year>1987</year><publisher-name>Amsterdam: North-Holland</publisher-name><fpage>405</fpage><lpage>416</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>D</given-names></name><name><surname>Ghosh</surname><given-names>D</given-names></name><name><surname>Conlon</surname><given-names>E</given-names></name></person-group><article-title>Statistical issues in the clustering of gene expression data.</article-title><source>Stat Sin</source><year>2002</year><volume>12</volume><fpage>219</fpage><lpage>241</lpage></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Cluster analysis and display of genome-wide expression patterns.</article-title><source>Proc Natl Acad Sci USA</source><year>1998</year><volume>95</volume><fpage>14863</fpage><lpage>14868</lpage><pub-id pub-id-type="pmid">9843981</pub-id><pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>S</given-names></name><name><surname>Gelatt</surname><given-names>CD</given-names><suffix>Jr</suffix></name><name><surname>Vecchi</surname><given-names>MP</given-names></name></person-group><article-title>Optimization by simulated annealing.</article-title><source>Science</source><year>1983</year><volume>220</volume><fpage>671</fpage><lpage>680</lpage></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Falkenauer</surname><given-names>E</given-names></name></person-group><source>Genetic Algorithms and Grouping Problems</source><year>1998</year><publisher-name>New York: Wiley</publisher-name></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Kohonen</surname><given-names>T</given-names></name></person-group><source>Self Organization and Associative Memory</source><year>1989</year><edition>3</edition><publisher-name>New York: Springer-Verlag</publisher-name></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ben-Dor</surname><given-names>A</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name><name><surname>Yakhini</surname><given-names>Z</given-names></name></person-group><article-title>Clustering gene expression patterns.</article-title><source>J Comput Biol</source><year>1999</year><volume>6</volume><fpage>281</fpage><lpage>297</lpage><pub-id pub-id-type="pmid">10582567</pub-id><pub-id pub-id-type="doi">10.1089/106652799318274</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yeung</surname><given-names>KY</given-names></name><name><surname>Haynor</surname><given-names>DR</given-names></name><name><surname>Ruzzo</surname><given-names>WL</given-names></name></person-group><article-title>Validating clustering for gene expression data.</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>309</fpage><lpage>318</lpage><pub-id pub-id-type="pmid">11301299</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/17.4.309</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Datta</surname><given-names>S</given-names></name></person-group><article-title>Comparisons and validation of statistical clustering techniques for microarray gene expression data.</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>459</fpage><lpage>466</lpage><pub-id pub-id-type="pmid">12611800</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg025</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yeung</surname><given-names>KY</given-names></name><name><surname>Medvedovic</surname><given-names>M</given-names></name><name><surname>Bumgarner</surname><given-names>RE</given-names></name></person-group><article-title>Clustering gene-expression data with repeated measurements.</article-title><source>Genome Biol</source><year>2003</year><volume>4</volume><fpage>R34</fpage><pub-id pub-id-type="pmid">12734014</pub-id><pub-id pub-id-type="doi">10.1186/gb-2003-4-5-r34</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gibbons</surname><given-names>FD</given-names></name><name><surname>Roth</surname><given-names>FP</given-names></name></person-group><article-title>Judging the quality of gene expression-based clustering methods using gene annotation.</article-title><source>Genome Res</source><year>2002</year><volume>12</volume><fpage>1574</fpage><lpage>1581</lpage><pub-id pub-id-type="pmid">12368250</pub-id><pub-id pub-id-type="doi">10.1101/gr.397002</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kerr</surname><given-names>MK</given-names></name><name><surname>Churchill</surname><given-names>GA</given-names></name></person-group><article-title>Bootstrapping cluster analysis: assessing the reliability of conclusions from microarray experiments.</article-title><source>Proc Natl Acad Sci USA</source><year>2001</year><volume>98</volume><fpage>8961</fpage><lpage>8965</lpage><pub-id pub-id-type="pmid">11470909</pub-id><pub-id pub-id-type="doi">10.1073/pnas.161273698</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Horimoto</surname><given-names>K</given-names></name><name><surname>Toh</surname><given-names>H</given-names></name></person-group><article-title>Statistical estimation of cluster boundaries in gene expression profile data.</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>1143</fpage><lpage>1151</lpage><pub-id pub-id-type="pmid">11751222</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/17.12.1143</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McShane</surname><given-names>LM</given-names></name><name><surname>Radmacher</surname><given-names>MD</given-names></name><name><surname>Freidlin</surname><given-names>B</given-names></name><name><surname>Yu</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>MC</given-names></name><name><surname>Simon</surname><given-names>R</given-names></name></person-group><article-title>Methods for assessing reproducibility of clustering patterns observed in analyses of microarray data.</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1462</fpage><lpage>1469</lpage><pub-id pub-id-type="pmid">12424117</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.11.1462</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Fridlyand</surname><given-names>J</given-names></name></person-group><article-title>Bagging to improve the accuracy of a clustering procedure.</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1090</fpage><lpage>1099</lpage><pub-id pub-id-type="pmid">12801869</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg038</pub-id></citation></ref><ref id="B18"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Altman</surname><given-names>DG</given-names></name></person-group><source>Practical Statistics for Medical Research</source><year>1997</year><publisher-name>London: Chapman and Hall</publisher-name></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Monti</surname><given-names>S</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mesirov</surname><given-names>J</given-names></name><name><surname>Golub</surname><given-names>T</given-names></name></person-group><article-title>Consensus clustering: a resampling-based method for class discovery and visualization of gene expression microarray data.</article-title><source>Machine Learning</source><year>2003</year><volume>52</volume><fpage>91</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1023/A:1023949509487</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>LF</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name><name><surname>Davierwala</surname><given-names>AP</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Stoughton</surname><given-names>R</given-names></name><name><surname>Altschuler</surname><given-names>SJ</given-names></name></person-group><article-title>Large-scale prediction of <italic>Saccharomyces cerevisiae </italic>gene function using overlapping transcriptional clusters.</article-title><source>Nat Genet</source><year>2002</year><volume>31</volume><fpage>255</fpage><lpage>265</lpage><pub-id pub-id-type="pmid">12089522</pub-id><pub-id pub-id-type="doi">10.1038/ng906</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jenner</surname><given-names>RG</given-names></name><name><surname>Maillard</surname><given-names>K</given-names></name><name><surname>Cattini</surname><given-names>N</given-names></name><name><surname>Weiss</surname><given-names>RA</given-names></name><name><surname>Boshoff</surname><given-names>C</given-names></name><name><surname>Wooster</surname><given-names>R</given-names></name><name><surname>Kellam</surname><given-names>P</given-names></name></person-group><article-title>Kaposi's sarcoma-associated herpesvirus-infected primary effusion lymphoma has a plasma cell gene expression profile.</article-title><source>Proc Natl Acad Sci USA</source><year>2003</year><volume>100</volume><fpage>10399</fpage><lpage>10404</lpage><pub-id pub-id-type="pmid">12925741</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1630810100</pub-id></citation></ref><ref id="B22"><citation citation-type="other"><article-title>The R Project for Statistical Computing</article-title><ext-link ext-link-type="uri" xlink:href="http://www.r-project.org"/></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Quackenbush</surname><given-names>J</given-names></name></person-group><article-title>Computational analysis of microarray data.</article-title><source>Nat Rev Genet</source><year>2001</year><volume>2</volume><fpage>418</fpage><lpage>427</lpage><pub-id pub-id-type="pmid">11389458</pub-id><pub-id pub-id-type="doi">10.1038/35076576</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cuff</surname><given-names>JA</given-names></name><name><surname>Clamp</surname><given-names>ME</given-names></name><name><surname>Siddiqui</surname><given-names>AS</given-names></name><name><surname>Finlay</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>GJ</given-names></name></person-group><article-title>JPred: A consensus secondary structure prediction server.</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>892</fpage><lpage>893</lpage><pub-id pub-id-type="pmid">9927721</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/14.10.892</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dennis</surname><given-names>G</given-names><suffix>Jr</suffix></name><name><surname>Sherman</surname><given-names>BT</given-names></name><name><surname>Hosack</surname><given-names>DA</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Gao</surname><given-names>W</given-names></name><name><surname>Lane</surname><given-names>HC</given-names></name><name><surname>Lempicki</surname><given-names>RA</given-names></name></person-group><article-title>DAVID: database for annotation, visualization, and integrated discovery.</article-title><source>Genome Biol</source><year>2003</year><volume>4</volume><fpage>R60</fpage><pub-id pub-id-type="doi">10.1186/gb-2003-4-9-r60</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Safran</surname><given-names>M</given-names></name><name><surname>Solomon</surname><given-names>I</given-names></name><name><surname>Shmueli</surname><given-names>O</given-names></name><name><surname>Lapidot</surname><given-names>M</given-names></name><name><surname>Shen-Orr</surname><given-names>S</given-names></name><name><surname>Adato</surname><given-names>A</given-names></name><name><surname>Ben-Dor</surname><given-names>U</given-names></name><name><surname>Esterman</surname><given-names>N</given-names></name><name><surname>Rosen</surname><given-names>N</given-names></name><name><surname>Peter</surname><given-names>I</given-names></name><etal></etal></person-group><article-title>GeneCards(TM) 2002: towards a complete, object-oriented, human gene compendium.</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1542</fpage><lpage>1543</lpage><pub-id pub-id-type="pmid">12424129</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.11.1542</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Barker</surname><given-names>D</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name><name><surname>Cameron</surname><given-names>G</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Clark</surname><given-names>L</given-names></name><name><surname>Cox</surname><given-names>T</given-names></name><name><surname>Cuff</surname><given-names>J</given-names></name><name><surname>Curwen</surname><given-names>V</given-names></name><name><surname>Down</surname><given-names>T</given-names></name><etal></etal></person-group><article-title>The Ensembl genome database project.</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>38</fpage><lpage>41</lpage><pub-id pub-id-type="pmid">11752248</pub-id><pub-id pub-id-type="doi">10.1093/nar/30.1.38</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>RF</given-names></name><name><surname>Wiese</surname><given-names>BA</given-names></name><name><surname>Wojzynski</surname><given-names>MK</given-names></name><name><surname>Davison</surname><given-names>DB</given-names></name><name><surname>Worley</surname><given-names>KC</given-names></name></person-group><article-title>BCM Search Launcher - an integrated interface to molecular biology data base search and analysis services available on the World Wide Web.</article-title><source>Genome Res</source><year>1996</year><volume>6</volume><fpage>454</fpage><lpage>462</lpage><pub-id pub-id-type="pmid">8743995</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>May</surname><given-names>MJ</given-names></name><name><surname>Kopp</surname><given-names>EB</given-names></name></person-group><article-title>NF-kappa B and Rel proteins: evolutionarily conserved mediators of immune responses.</article-title><source>Annu Rev Immunol</source><year>1998</year><volume>16</volume><fpage>225</fpage><lpage>260</lpage><pub-id pub-id-type="pmid">9597130</pub-id><pub-id pub-id-type="doi">10.1146/annurev.immunol.16.1.225</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>A</given-names></name><name><surname>Scoggin</surname><given-names>S</given-names></name><name><surname>Gaynor</surname><given-names>RB</given-names></name><name><surname>Williams</surname><given-names>NS</given-names></name></person-group><article-title>Identification of NF-kappa B-regulated genes induced by TNFalpha utilizing expression profiling and RNA interference.</article-title><source>Oncogene</source><year>2003</year><volume>22</volume><fpage>2054</fpage><lpage>2064</lpage><pub-id pub-id-type="pmid">12673210</pub-id><pub-id pub-id-type="doi">10.1038/sj.onc.1206262</pub-id></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Calfon</surname><given-names>M</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Urano</surname><given-names>F</given-names></name><name><surname>Till</surname><given-names>JH</given-names></name><name><surname>Hubbard</surname><given-names>SR</given-names></name><name><surname>Harding</surname><given-names>HP</given-names></name><name><surname>Clark</surname><given-names>SG</given-names></name><name><surname>Ron</surname><given-names>D</given-names></name></person-group><article-title>IRE1 couples endoplasmic reticulum load to secretory capacity by processing the XBP-1 mRNA.</article-title><source>Nature</source><year>2002</year><volume>415</volume><fpage>92</fpage><lpage>96</lpage><pub-id pub-id-type="pmid">11780124</pub-id><pub-id pub-id-type="doi">10.1038/415092a</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>H</given-names></name><name><surname>Matsui</surname><given-names>T</given-names></name><name><surname>Yamamoto</surname><given-names>A</given-names></name><name><surname>Okada</surname><given-names>T</given-names></name><name><surname>Mori</surname><given-names>K</given-names></name></person-group><article-title>XBP1 mRNA is induced by ATF6 and spliced by IRE1 in response to ER stress to produce a highly active transcription factor.</article-title><source>Cell</source><year>2001</year><volume>107</volume><fpage>881</fpage><lpage>891</lpage><pub-id pub-id-type="pmid">11779464</pub-id><pub-id pub-id-type="doi">10.1016/S0092-8674(01)00611-0</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>H</given-names></name><name><surname>Matsui</surname><given-names>T</given-names></name><name><surname>Hosokawa</surname><given-names>N</given-names></name><name><surname>Kaufman</surname><given-names>RJ</given-names></name><name><surname>Nagata</surname><given-names>K</given-names></name><name><surname>Mori</surname><given-names>K</given-names></name></person-group><article-title>A time-dependent phase shift in the mammalian unfolded protein response.</article-title><source>Dev Cell</source><year>2003</year><volume>4</volume><fpage>265</fpage><lpage>271</lpage><pub-id pub-id-type="pmid">12586069</pub-id><pub-id pub-id-type="doi">10.1016/S1534-5807(03)00022-4</pub-id></citation></ref><ref id="B34"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Kellam</surname><given-names>P</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Martin</surname><given-names>N</given-names></name><name><surname>Orengo</surname><given-names>C</given-names></name><name><surname>Swift</surname><given-names>S</given-names></name><name><surname>Tucker</surname><given-names>A</given-names></name></person-group><article-title>Comparing, contrasting and combining clusters in viral gene expression data.</article-title><source>Proceedings of the IDAMAP2001 Workshop</source><year>2001</year><fpage>56</fpage><lpage>62</lpage></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>R</given-names></name><name><surname>McEachin</surname><given-names>RC</given-names></name><name><surname>States</surname><given-names>DJ</given-names></name></person-group><article-title>Computationally identifying novel NF-kappa B-regulated immune genes in the human genome.</article-title><source>Genome Res</source><year>2003</year><volume>13</volume><fpage>654</fpage><lpage>661</lpage><pub-id pub-id-type="pmid">12654722</pub-id><pub-id pub-id-type="doi">10.1101/gr.911803</pub-id></citation></ref><ref id="B36"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Edelstein</surname><given-names>LC</given-names></name><name><surname>Lagos</surname><given-names>L</given-names></name><name><surname>Simmons</surname><given-names>M</given-names></name><name><surname>Tirumalai</surname><given-names>H</given-names></name><name><surname>Gelinas</surname><given-names>C</given-names></name></person-group><article-title>NF-kappa B-dependent assembly of an enhanceosome-like complex on the promoter region of apoptosis inhibitor Bfl-1/A1.</article-title><source>Mol Cell Biol</source><year>2003</year><volume>23</volume><fpage>2749</fpage><lpage>2761</lpage><pub-id pub-id-type="pmid">12665576</pub-id><pub-id pub-id-type="doi">10.1128/MCB.23.8.2749-2761.2003</pub-id></citation></ref><ref id="B37"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Haze</surname><given-names>K</given-names></name><name><surname>Yoshida</surname><given-names>H</given-names></name><name><surname>Yanagi</surname><given-names>H</given-names></name><name><surname>Yura</surname><given-names>T</given-names></name><name><surname>Mori</surname><given-names>K</given-names></name></person-group><article-title>Mammalian transcription factor ATF6 is synthesized as a transmembrane protein and activated by proteolysis in response to endoplasmic reticulum stress.</article-title><source>Mol Biol Cell</source><year>1999</year><volume>10</volume><fpage>3787</fpage><lpage>3799</lpage><pub-id pub-id-type="pmid">10564271</pub-id></citation></ref><ref id="B38"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>K</given-names></name><name><surname>Tirasophon</surname><given-names>W</given-names></name><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>Michalak</surname><given-names>M</given-names></name><name><surname>Prywes</surname><given-names>R</given-names></name><name><surname>Okada</surname><given-names>T</given-names></name><name><surname>Yoshida</surname><given-names>H</given-names></name><name><surname>Mori</surname><given-names>K</given-names></name><name><surname>Kaufman</surname><given-names>RJ</given-names></name></person-group><article-title>IRE1-mediated unconventional mRNA splicing and S2P-mediated ATF6 cleavage merge to regulate XBP1 in signaling the unfolded protein response.</article-title><source>Genes Dev</source><year>2002</year><volume>16</volume><fpage>452</fpage><lpage>466</lpage><pub-id pub-id-type="pmid">11850408</pub-id><pub-id pub-id-type="doi">10.1101/gad.964702</pub-id></citation></ref><ref id="B39"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>H</given-names></name><name><surname>Haze</surname><given-names>K</given-names></name><name><surname>Yanagi</surname><given-names>H</given-names></name><name><surname>Yura</surname><given-names>T</given-names></name><name><surname>Mori</surname><given-names>K</given-names></name></person-group><article-title>Identification of the <italic>cis</italic>-acting endoplasmic reticulum stress response element responsible for transcriptional induction of mammalian glucose-regulated proteins. Involvement of basic leucine zipper transcription factors.</article-title><source>J Biol Chem</source><year>1998</year><volume>273</volume><fpage>33741</fpage><lpage>33749</lpage><pub-id pub-id-type="pmid">9837962</pub-id><pub-id pub-id-type="doi">10.1074/jbc.273.50.33741</pub-id></citation></ref><ref id="B40"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Doerrler</surname><given-names>WT</given-names></name><name><surname>Lehrman</surname><given-names>MA</given-names></name></person-group><article-title>Regulation of the dolichol pathway in human fibroblasts by the endoplasmic reticulum unfolded protein response.</article-title><source>Proc Natl Acad Sci USA</source><year>1999</year><volume>96</volume><fpage>13050</fpage><lpage>13055</lpage><pub-id pub-id-type="pmid">10557271</pub-id><pub-id pub-id-type="doi">10.1073/pnas.96.23.13050</pub-id></citation></ref><ref id="B41"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>I</given-names></name><name><surname>Kesselman</surname><given-names>C</given-names></name></person-group><source>The Grid: Blueprint for a New Computing Infrastructure</source><year>1998</year><publisher-name>San Francisco: Morgan Kaufmann</publisher-name></citation></ref><ref id="B42"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Snedecor</surname><given-names>G</given-names></name><name><surname>Cochran</surname><given-names>W</given-names></name></person-group><source>Statistical Methods</source><year>1989</year><edition>8</edition><publisher-name>Ames: Iowa State University Press</publisher-name></citation></ref><ref id="B43"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gasch</surname><given-names>AP</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Kao</surname><given-names>CM</given-names></name><name><surname>Carmel-Harel</surname><given-names>O</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Storz</surname><given-names>G</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name></person-group><article-title>Genomic expression programs in the response of yeast cells to environmental changes.</article-title><source>Mol Biol Cell</source><year>2000</year><volume>11</volume><fpage>4241</fpage><lpage>4257</lpage><pub-id pub-id-type="pmid">11102521</pub-id></citation></ref><ref id="B44"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tucker</surname><given-names>A</given-names></name><name><surname>Swift</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name></person-group><article-title>Grouping multivariate time series via correlation.</article-title><source>IEEE Trans Systems Man Cybernet B: Cybernetics</source><year>2001</year><volume>31</volume><fpage>235</fpage><lpage>245</lpage></citation></ref><ref id="B45"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lukashin</surname><given-names>AV</given-names></name><name><surname>Fuchs</surname><given-names>R</given-names></name></person-group><article-title>Analysis of temporal gene expression profiles: clustering by simulated annealing and determining the optimal number of clusters.</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>405</fpage><lpage>414</lpage><pub-id pub-id-type="pmid">11331234</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/17.5.405</pub-id></citation></ref><ref id="B46"><citation citation-type="other"><article-title>HGMP-Microarrays</article-title><ext-link ext-link-type="uri" xlink:href="http://www.hgmp.mrc.ac.uk/Research/Microarray/HGMP-RC_Microarrays/description_of_old_arrays.jsp#20"/></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p>Pairwise comparison of consistency between different cluster algorithm data partitions using the <italic>weighted-kappa </italic>metric (Table 1) to score similarity. Each clustering algorithm was used to analyze the Amersham Score Card dataset (black bars) and the B-cell lymphoma dataset (gray bars), and the cluster-method agreement based on assigning the same genes to the same cluster was calculated and scored. HC, hierarchical clustering; CAST, cluster affinity search technique; PAM, partitioning around medoids; and SA, simulated annealing.</p></caption><graphic xlink:href="gb-2004-5-11-r94-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p>A visual representation of the agreement matrix used as input to robust and consensus clustering. The <italic>n </italic>&#x000d7; <italic>n </italic>matrix is upper triangular. Each cell within the matrix, referenced by column <italic>i </italic>and row <italic>j</italic>, represents the number of clustering methods that have placed gene <italic>i </italic>and gene <italic>j </italic>into the same cluster. In other words, the number represents the agreement between clustering methods concerning gene <italic>i </italic>and gene <italic>j</italic>.</p></caption><graphic xlink:href="gb-2004-5-11-r94-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p>Comparison between consensus clustering and pairwise clustering. The <italic>weighted-kappa </italic>score for consensus clustering (solid line) calculated by comparing consensus clusters to the corresponding individual clustering algorithm is shown relative to mean pairwise <italic>weighted-kappa </italic>score for each single method compared to all other single methods (broken line) for <bold>(a) </bold>the ASC dataset, <bold>(b) </bold>the B-cell lymphoma dataset. The maximum and minimum <italic>weighted-kappa </italic>scores for the collection of single methods are indicated by the error bars. The definitions of <italic>weighted-kappa </italic>scores are derived from Table 1. The parameter settings for the clustering algorithms are: HC and PAM, 13 clusters for the ASC dataset and 40 for the B-cell dataset; CAST, affinity level 0.5; and SA, <italic>&#x003b8;</italic><sub>0 </sub>= 100, <italic>c </italic>= 0.99994 and number of iterations = 1,000,000.</p></caption><graphic xlink:href="gb-2004-5-11-r94-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p>Probability scores and cluster size. <bold>(a) </bold>The lowest probability scores determined for clusters containing the following functional group signature genes were identified: AC, actin cytoskeleton; BST, B-cell signal transduction; EGT, ER/Golgi trafficking; ERUPR, ER stress/unfolded protein response; ICS, immunoglobulin class switching; IA, inflammation and adhesion; NF&#x003ba;B, NF&#x003ba;B signaling; OBS, other B-cell signaling; P, proliferation; RNA, RNA maturation and splicing. The mean (open diamond), standard error (green line) and standard deviation (thin black line and bars) of the minimum probability scores for SA, CAST, HC and PAM are shown together with the minimum probability score for the corresponding consensus cluster (red circle). <bold>(b) </bold>The cluster size (<italic>s</italic><sub><italic>i</italic></sub>) (open circles) and number of defining functional group genes (FG) (open squares) for the NF&#x003ba;B signaling and ER/UPR functional groups are shown together with the FG/<italic>s</italic><sub><italic>i </italic></sub>ratio (open diamonds).</p></caption><graphic xlink:href="gb-2004-5-11-r94-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p>Visualization of average linkage HC using the programs Cluster and Treeview [5] of the NF&#x003ba;B responsive gene cluster identified from consensus clustering and functional annotation. The sample names correspond to different leukemia and lymphoma samples [21], with the NF&#x003ba;B-responsive gene cluster being predominantly expressed in the cell lines Raji, PEL-B, EHEB, BONNA-12 and L-428. Gene names with red circles represent those genes that contain one or more NF&#x003ba;B-binding sites in the region up to 1,000 bp upstream from the putative transcriptional start site.</p></caption><graphic xlink:href="gb-2004-5-11-r94-5"/></fig><fig position="float" id="F6"><label>Figure 6</label><caption><p>Location and consensus sequence of NF&#x003ba;B-binding sites. <bold>(a) </bold>Position of the NF&#x003ba;B-binding sites identified in the upstream 1,000-bp regions of each gene. The gray ovals represent the position of each binding site shown in <bold>(b) </bold>where the nucleotide sequence for each respective NF&#x003ba;B-binding site is shown relative to the consensus NF&#x003ba;B-binding site GGGRNNNYCY (R is G or A (purine), Y is T or C (pyrimidine) and N is any nucleotide).</p></caption><graphic xlink:href="gb-2004-5-11-r94-6"/></fig><fig position="float" id="F7"><label>Figure 7</label><caption><p>Genes involved in the ER/UPR. <bold>(a) </bold>Visualization of the ER/UPR consensus cluster using Cluster and Treeview. The <italic>ATF6 </italic>gene is indicated by a green circle. Gene names indicated by red circles represent those genes whose upstream 1,000-bp regions contain <bold>(b) </bold>the endoplasmic reticulum stress response element (ESRE), namely, <italic>calnexin </italic>and <italic>TRA1</italic>, or unfolded protein response element (UPRE) namely, <italic>DPAGT1 </italic>and <italic>MGAT2</italic>.</p></caption><graphic xlink:href="gb-2004-5-11-r94-7"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>The <italic>weighted-kappa </italic>guideline</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left"><italic>Weighted-kappa</italic></td><td align="left">Agreement strength</td></tr></thead><tbody><tr><td align="left">0.0 &#x02264; <italic>K </italic>&#x02264; 0.2</td><td align="left">Poor</td></tr><tr><td align="left">0.2 &#x0003c;<italic>K </italic>&#x02264; 0.4</td><td align="left">Fair</td></tr><tr><td align="left">0.4 &#x0003c;<italic>K </italic>&#x02264; 0.6</td><td align="left">Moderate</td></tr><tr><td align="left">0.6 &#x0003c;<italic>K </italic>&#x02264; 0.8</td><td align="left">Good</td></tr><tr><td align="left">0.8 &#x0003c;<italic>K </italic>&#x02264; 1.0</td><td align="left">Very good</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Robust clusters</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Dataset</td><td align="center">ASC*</td><td align="center">B-cell</td></tr></thead><tbody><tr><td align="left">Number of robust clusters</td><td align="center">24</td><td align="center">154</td></tr><tr><td align="left">% of variables assigned</td><td align="center">79.2%</td><td align="center">25%</td></tr><tr><td align="left">Maximum robust cluster size</td><td align="center">44</td><td align="center">14</td></tr><tr><td align="left">Minimum robust cluster size</td><td align="center">2</td><td align="center">2</td></tr><tr><td align="left">Mean robust cluster size</td><td align="center">10.2</td><td align="center">3.2</td></tr></tbody></table><table-wrap-foot><p>*Amersham Score Card dataset.</p></table-wrap-foot></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Multiple runs of the stochastic clustering methods</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Method</td><td align="left">Mean*</td><td align="left">Min<sup>&#x02020;</sup></td><td align="left">Max<sup>&#x02020;</sup></td><td align="left">SD<sup>&#x02020;</sup></td></tr></thead><tbody><tr><td align="left">CAST</td><td align="left">0.646</td><td align="left">0.448</td><td align="left">0.769</td><td align="left">0.092</td></tr><tr><td align="left">Simulated annealing (SA)</td><td align="left">0.816</td><td align="left">0.794</td><td align="left">0.838</td><td align="left">0.015</td></tr><tr><td align="left">Consensus clustering (CC)</td><td align="left">0.960</td><td align="left">0.922</td><td align="left">0.982</td><td align="left">0.010</td></tr></tbody></table><table-wrap-foot><p>*Mean <italic>weighted-kappa </italic>scores; <sup>&#x02020;</sup>Min (minimum) and Max (maximum) and SD (standard deviation) of the <italic>weighted-kappa </italic>scores.</p></table-wrap-foot></table-wrap><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Cluster partition <italic>weighted-kappa </italic>scores of two synthetic datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Dataset</td><td align="center">HC</td><td align="center">PAM</td><td align="center">CAST</td><td align="center">SA</td><td align="center">CC</td></tr></thead><tbody><tr><td align="left">Vector autoregressive</td><td align="center">0.505</td><td align="center">0.700</td><td align="center">0.537</td><td align="center">0.614</td><td align="center">0.725</td></tr><tr><td align="left">Multivariate normal</td><td align="center">0.697</td><td align="center">0.605</td><td align="center">0.591</td><td align="center">0.667</td><td align="center">0.729</td></tr></tbody></table><table-wrap-foot><p>HC, hierarchical clustering; PAM, partitioning around medoids; CAST, cluster affinity search technique; SA, simulated annealing; CC, consensus clustering.</p></table-wrap-foot></table-wrap></sec></back></article>



