<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id><journal-title>BMC Evolutionary Biology</journal-title><issn pub-type="epub">1471-2148</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15377393</article-id><article-id pub-id-type="pmc">PMC522809</article-id><article-id pub-id-type="publisher-id">1471-2148-4-33</article-id><article-id pub-id-type="doi">10.1186/1471-2148-4-33</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Reconstruction of ancestral protein sequences and its applications</article-title></title-group><contrib-group><contrib id="A1" equal-contrib="yes" contrib-type="author"><name><surname>Cai</surname><given-names>Wei</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>wcai@biochem.swmed.edu</email></contrib><contrib id="A2" equal-contrib="yes" contrib-type="author"><name><surname>Pei</surname><given-names>Jimin</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>jpei@chop.swmed.edu</email></contrib><contrib id="A3" corresp="yes" contrib-type="author"><name><surname>Grishin</surname><given-names>Nick V</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>grishin@chop.swmed.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Howard Hughes Medical Institute, University of Texas Southwestern Medical Center at Dallas, 5323 Harry Hines Blvd., Dallas, TX. 75390-9050, USA</aff><aff id="I2"><label>2</label>Department of Biochemistry, University of Texas Southwestern Medical Center at Dallas, 5323 Harry Hines Blvd., Dallas, TX. 75390-9050, USA</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>17</day><month>9</month><year>2004</year></pub-date><volume>4</volume><fpage>33</fpage><lpage>33</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2148/4/33"/><history><date date-type="received"><day>4</day><month>6</month><year>2004</year></date><date date-type="accepted"><day>17</day><month>9</month><year>2004</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2004 Cai et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2004</copyright-year><copyright-holder>Cai et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Cai
               Wei
               
               wcai@biochem.swmed.edu
            </dc:author><dc:title>
            Reconstruction of ancestral protein sequences and its applications
         </dc:title><dc:date>2004</dc:date><dcterms:bibliographicCitation>BMC Evolutionary Biology 4(1): 33-. (2004)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2148(2004)4:1&#x0003c;33&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2148</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Modern-day proteins were selected during long evolutionary history as descendants of ancient life forms. <italic>In silico </italic>reconstruction of such ancestral protein sequences facilitates our understanding of evolutionary processes, protein classification and biological function. Additionally, reconstructed ancestral protein sequences could serve to fill in sequence space thus aiding remote homology inference.</p></sec><sec><title>Results</title><p>We developed ANCESCON, a package for distance-based phylogenetic inference and reconstruction of ancestral protein sequences that takes into account the observed variation of evolutionary rates between positions that more precisely describes the evolution of protein families. To improve the accuracy of evolutionary distance estimation and ancestral sequence reconstruction, two approaches are proposed to estimate position-specific evolutionary rates. Comparisons show that at large evolutionary distances our method gives more accurate ancestral sequence reconstruction than PAML, PHYLIP and PAUP*. We apply the reconstructed ancestral sequences to homology inference and functional site prediction. We show that the usage of hypothetical ancestors together with the present day sequences improves profile-based sequence similarity searches; and that ancestral sequence reconstruction methods can be used to predict positions with functional specificity.</p></sec><sec><title>Conclusions</title><p>As a computational tool to reconstruct ancestral protein sequences from a given multiple sequence alignment, ANCESCON shows high accuracy in tests and helps detection of remote homologs and prediction of functional sites. ANCESCON is freely available for non-commercial use. Pre-compiled versions for several platforms can be downloaded from <ext-link ext-link-type="ftp" xlink:href="ftp://iole.swmed.edu/pub/ANCESCON/"/>.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Present-day protein sequences can be used to reconstruct ancestral sequences based on a model of sequence evolution. Such knowledge about ancestral sequences is helpful for understanding the evolutionary processes as well as the functional aspects of a protein family. Existing methods of ancestral sequence reconstruction can be divided into two main categories: Maximum Parsimony (MP) methods [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>] and Maximum Likelihood (ML) methods [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. MP methods do not take into account biased substitution patterns between amino acids or different tree branch lengths, and cannot distinguish those equally parsimonious reconstructions [<xref ref-type="bibr" rid="B3">3</xref>]. ML methods do not have these limitations and generally give more reliable results than the MP methods [<xref ref-type="bibr" rid="B6">6</xref>]. Yang et al. [<xref ref-type="bibr" rid="B3">3</xref>] first developed a ML method for ancestral sequence reconstruction. Yang [<xref ref-type="bibr" rid="B7">7</xref>] also made a distinction between "joint" reconstruction and "marginal" reconstruction. Joint reconstruction methods intend to find the most likely set of amino acids for all internal nodes at a site, which yields the maximum joint likelihood of the tree [<xref ref-type="bibr" rid="B5">5</xref>]. Marginal reconstruction compares the probabilities of different amino acids at an internal node at a site and selects the amino acid that yields the maximum likelihood for the tree at that site. Marginal reconstruction can also compute probabilities of all other amino acids for that node [<xref ref-type="bibr" rid="B4">4</xref>]. Koshi and Goldstein [<xref ref-type="bibr" rid="B4">4</xref>] developed a fast dynamic programming algorithm for marginal reconstruction in the framework of Bayesian statistics, while Pupko et al. [<xref ref-type="bibr" rid="B5">5</xref>] proposed a fast algorithm for joint reconstruction. The computational complexities for both algorithms scale linearly with the number of sequences. Both marginal and joint reconstruction algorithms are implemented in our program.</p><p>All reconstruction methods require a phylogenetic tree inferred from a given alignment. The quality of the tree is crucial for the reliability of reconstruction. A number of methods exist for phylogenetic inference, such as maximum likelihood [<xref ref-type="bibr" rid="B8">8</xref>], distance-based [<xref ref-type="bibr" rid="B9">9</xref>] and parsimony [<xref ref-type="bibr" rid="B1">1</xref>]. Distance-based methods have the advantage of being simple and are able to handle a large set of sequences. They require evolutionary distances estimated for all the sequence pairs. The most common method to infer phylogeny from distances is based on the neighbor-joining algorithm [<xref ref-type="bibr" rid="B9">9</xref>]. Bruno et al. [<xref ref-type="bibr" rid="B10">10</xref>] introduced a distance-based phylogeny reconstruction method called "Weighbor", i.e. "weighted neighbor joining", which takes into account the fact that errors in distance estimates are larger for longer distances. Giving similar results, Weighbor is much faster than ML phylogeny reconstruction. It is also better than other methods such as BIONJ [<xref ref-type="bibr" rid="B11">11</xref>] and parsimony [<xref ref-type="bibr" rid="B1">1</xref>], in aspects of "long branches attract" and "long branch distracts" problems [<xref ref-type="bibr" rid="B10">10</xref>]. Weighbor is used in our program for phylogenetic inference.</p><p>Overwhelming evidence exists for substitution rate variation across sites [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. For a protein family, rate heterogeneity reflects the selective pressure imposed by folding, stability and function. Gamma distribution is widely used to model the rate variation among sites [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] because of its simplicity. Nielsen [<xref ref-type="bibr" rid="B18">18</xref>] suggested a method for site-by-site estimation of rate factors by a Maximum Likelihood approach. Rate variation among sites has not been taken into account in the early work of ML reconstruction of ancestral sequences [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>]. Recently, Pupko et al. [<xref ref-type="bibr" rid="B19">19</xref>] introduced rate variation into joint reconstruction by a branch-and-bound algorithm, assuming a gamma distribution of rates among sites. In our package, two methods are proposed to estimate a rate factor for each site. The first one is based on our observation that the substitution rate at a site is correlated with the conservation of the site. The more conserved the site is in a multiple sequence alignment, the smaller its substitution rate is. This empirical method, the result of which we call Alignment-Based rate factors or <italic>&#x003b1;</italic><sub><italic>AB</italic></sub>, relies only on a multiple sequence alignment and a general model of amino acid exchange. The other one is a maximum likelihood method (<italic>&#x003b1;</italic><sub><italic>ML</italic></sub>), which requires a tree. In our implementation, we incorporate <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>or <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>in the joint and marginal reconstruction algorithms [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>]. <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>is also used in the Maximum Likelihood estimation of evolutionary distances [<xref ref-type="bibr" rid="B20">20</xref>] for tree inference.</p><p>We implement a method of evolutionary simulation that introduces site-specific rate variations in a natural way by imposing structural and functional constraints [<xref ref-type="bibr" rid="B21">21</xref>]. We show by simulations that the reconstruction methods can give reasonable results and that the problem of evolutionary distance underestimation [<xref ref-type="bibr" rid="B22">22</xref>] is alleviated by considering rate variation across sites.</p><p>Background (or equilibrium) amino acid frequencies (<italic>&#x003c0;</italic>) are usually estimated from the target set of sequences or from large databases of protein families. Background amino acid frequencies estimated from a small dataset tend to have bias, while amino acid frequencies from large databases may not be suitable for the specific protein family under analysis. Here, we propose a ML method to optimize the amino acid frequency vector <italic>&#x003c0;</italic>. The optimized <italic>&#x003c0; </italic>vector can give significant improvement over the likelihood of a alignment.</p><p>Information obtained from ancestral sequence reconstruction is used for two applications: homology detection and prediction of functional sites. For homology detection, ancestral sequences represent an enlargement of the sequence space around native sequences. We demonstrate that adding reconstructed ancestral sequences to a native alignment improves the detection of homologs in database searches.</p><p>A number of methods have been developed to predict functional sites from amino acid sequences [<xref ref-type="bibr" rid="B23">23</xref>,<xref ref-type="bibr" rid="B24">24</xref>]. One simple way to infer functional sites is by positional conservation of a multiple sequence alignment [<xref ref-type="bibr" rid="B25">25</xref>]. Lichtarge et al. [<xref ref-type="bibr" rid="B26">26</xref>] proposed a method called evolutionary trace to predict functional sites by analyzing the conservation of sequence subgroups. Functional divergence during the evolutionary process can be reflected in the variation of amino acid usage across different functional subgroups. We propose a new approach that uses information from ancestral sequence reconstruction to identify sites that are well conserved within individual sub-trees but exhibit variability among different sub-trees. By several examples, we show that these sites frequently contribute to the functional specificity of a protein family.</p></sec><sec><title>Results and discussion</title><p>We developed a package (ANCESCON) to reconstruct ancestral protein sequences considering rate variation among sites. Rate factors can be estimated either by an empirical method or by a maximum likelihood method. Consideration of rate variation among sites not only improves evolutionary distance estimation, but also gives more accurate ancestral sequence reconstruction. Ancestral sequences are used to improve profile-based sequence similarity searches. We also propose a new approach to predict positions with functional specificity based on the reconstruction of ancestral sequences.</p><sec><title>Observed <italic>&#x003b1;</italic>, Alignment Based Rate Factor <italic>&#x003b1; </italic>(<italic>&#x003b1;</italic><sub><italic>AB</italic></sub>) and Rate Factor <italic>&#x003b1; </italic>estimated by Maximum Likelihood (<italic>&#x003b1;</italic><sub><italic>ML</italic></sub>)</title><p>Evolutionary simulations based on a <italic>Z</italic>-score model introduce rate variation across sites in a natural way by incorporating structural and functional constraints specific for a protein family [<xref ref-type="bibr" rid="B21">21</xref>]. The simulation procedure is a Monte Carlo simulation of the amino acid substitution process. The fixation of substitutions is dictated by a simple scoring function, which is derived from the template structure and an alignment of its homologs. The number of substitutions occurring at each site can be recorded during the simulation process and the observed <italic>&#x003b1; </italic>at a site equals the number of recorded substitutions at that site divided by the average substitution number for all sites. To reduce sampling variance, an average observed <italic>&#x003b1; </italic>vector is calculated from 100 simulations.</p><p>For the alignment consisting of all the leaf node sequences generated by the simulation process, an <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>vector was calculated according to equation (11) (for details see Methods). An average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>vector was derived from 100 simulations. Correlation coefficient between the average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>vector and the average observed <italic>&#x003b1; </italic>vector was high (data not shown). However, we found that for large observed <italic>&#x003b1; </italic>values, the corresponding <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>values were smaller. A constant <italic>&#x003b2; </italic>was introduced to correct this underestimation in equation (11).</p><p><inline-graphic xlink:href="1471-2148-4-33-i1.gif"/></p><p>Here, <italic>&#x003b1;</italic><sub><italic>i </italic></sub>is Alignment-Based rate factor at site <italic>i</italic>. <italic>K </italic>is the number of sites in a given alignment. <italic>C</italic><sub><italic>i </italic></sub>is the value assigned to site <italic>i </italic>(for details see Methods).</p><p>We optimized the <italic>&#x003b2; </italic>value by fitting the average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>vector and average observed <italic>&#x003b1; </italic>vector to <italic>y </italic>= <italic>x </italic>line. Alignments for three different protein families (trypsin, carboxypeptidase and pdz domain) gave a good empirical estimation for <italic>&#x003b2; </italic>of about 1.3. The relation between this corrected average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>vector and average observed <italic>&#x003b1; </italic>vector is shown in Figure <xref ref-type="fig" rid="F1">1a</xref> for a typical example, the pdz domain (correlation coefficient 0.973).</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>a) Correlation between average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>and average observed <italic>&#x003b1;</italic>. b) Correlation between average <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>and average observed <italic>&#x003b1;</italic>. </bold><italic>&#x003b1;</italic><sub><italic>AB </italic></sub>is Alignment-Based rate factor solely depending on the given alignment. <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>is rate factor estimated by maximum likelihood method, which requires an alignment and evolutionary tree inferred from the alignment. The protein family used here is the PDZ domain.</p></caption><graphic xlink:href="1471-2148-4-33-1"/></fig><p>We also estimated an <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>vector for each alignment generated from the simulation (for details see Methods). The average <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>vector shows good correlation with the average observed <italic>&#x003b1; </italic>vector (Figure <xref ref-type="fig" rid="F1">1b</xref>) (correlation coefficient 0.945). <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>or <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>can be incorporated in likelihood calculation in marginal or joint reconstruction. Table <xref ref-type="table" rid="T1">1</xref> shows that improvement of logarithm likelihood of the alignment is significant when <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>or <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>is used.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Difference of logarithm likelihood and CPU time when using different <italic>&#x003b1; </italic>vectors</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center"><italic>&#x003b1; </italic>= 1.0</td><td align="center" colspan="3"><italic>&#x003b1;</italic><sub><italic>AB</italic></sub></td><td align="center" colspan="3"><italic>&#x003b1;</italic><sub><italic>ML</italic></sub></td></tr></thead><tbody><tr><td></td><td></td><td></td><td align="center">&#x00394;<italic>l</italic></td><td align="center">P*</td><td></td><td align="center">&#x00394;<italic>l</italic></td><td align="center">P*</td></tr><tr><td colspan="8"><hr></hr></td></tr><tr><td align="center">Logarithm Likelihood</td><td align="center">-5324.56</td><td align="center">-5087.72</td><td align="center">236.84</td><td align="center">&#x0003c;0.0001</td><td align="center">-4987.27</td><td align="center">337.29</td><td align="center">&#x0003c;0.0001</td></tr><tr><td align="center">CPU Time (s)<sup>+</sup></td><td align="center">213</td><td></td><td align="center" colspan="3">213</td><td align="center" colspan="3">359</td></tr></tbody></table><table-wrap-foot><p>The alignment tested here is a subset of SH2 family. It includes 44 sequences and each sequence contains 83 amino acids (including gaps).</p><p>* The likelihood ratio test (LRT) [58] is used to test whether <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>and <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>are significantly different from <italic>&#x003b1; </italic>= 1.0. The difference in number of free parameters between <italic>&#x003b1;</italic><sub><italic>AB</italic></sub>, <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>and <italic>&#x003b1; </italic>= 1.0 model is 82.</p><p><sup>+ </sup>CPU times were computed on a Dell PowerEdge 8450 server (CPU 700MHz, RAM 8G).</p></table-wrap-foot></table-wrap><p>Rate variation across sites can be modeled by assuming that the rate factors follow a certain type of statistical distribution. Gamma distribution [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B27">27</xref>] and its discrete approximations [<xref ref-type="bibr" rid="B28">28</xref>] are frequently used for DNA or protein sequences. Rate variation for a protein family reflects different selective pressure at different sites to maintain structure and function. Fewer substitutions are expected to occur in more conserved sites. This hypothesis has prompted us to estimate rate factors (<italic>&#x003b1;</italic><sub><italic>AB</italic></sub>) based on sequence conservation in an empirical way. The <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>is compared and calibrated using the observed <italic>&#x003b1; </italic>as standards. Our method of estimating <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>is similar to the one proposed by Nielson [<xref ref-type="bibr" rid="B18">18</xref>]. One problem with site-by-site rate factor estimation is the small sample size at each site, especially with a small alignment. We have used <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>to eliminate outliers with very large <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>estimates (for details see Methods).</p></sec><sec><title>Site-specific rate factors improve distance estimation</title><p>Evolutionary distances tend to be underestimated when rate homogeneity among sites is assumed [<xref ref-type="bibr" rid="B22">22</xref>]. This was tested using the simulation with structural and functional constraints. For the arbitrarily selected tree shown in Figure <xref ref-type="fig" rid="F2">2</xref>, we obtained leaf node sequences in the simulation and estimated an evolutionary distance for each sequence pair by Maximum Likelihood, either incorporating <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>or setting <italic>&#x003b1; </italic>equal to 1.0 (equation (16)). Evolutionary distances were severely underestimated (average underestimation: 0.894) without considering rate variation among sites (Figure <xref ref-type="fig" rid="F3">3a</xref>). Introducing <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>in the maximum likelihood method gave more accurate distance estimation (Figure <xref ref-type="fig" rid="F3">3b</xref>), although the distances were still underestimated, especially for small distances (average underestimation: 0.286). We believe that more accurate distances will give more accurate phylogeny reconstruction using "Weighbor" [<xref ref-type="bibr" rid="B10">10</xref>]. Since a tree is required to estimate <italic>&#x003b1;</italic><sub><italic>ML</italic></sub>, <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>is not incorporated in estimating evolutionary distance.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>The tree used to test ancestral sequence reconstruction. </bold>This is an arbitrarily selected evolutionary tree. Evolutionary distances are shown to scale.</p></caption><graphic xlink:href="1471-2148-4-33-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Comparison of pairwise distances between the rebuilt tree and original tree. a) distance estimation assuming no rate variation among sites; b) distance estimation with <italic>&#x003b1;</italic><sub><italic>AB</italic></sub>. </bold>The rebuilt tree is inferred from the alignment that is generated by evolutionary simulation performed on the original tree. The original tree is arbitrarily selected.</p></caption><graphic xlink:href="1471-2148-4-33-3"/></fig></sec><sec><title>Optimization of equilibrium frequencies</title><p>A continuous minimization method by simulated annealing was used to optimize the equilibrium frequency vector <italic>&#x003c0;</italic>, with the objective function being the logarithm likelihood of the alignment. Our <italic>&#x003c0; </italic>vector optimization program was tested on four alignments, which were taken from the SH2 and SH3 superfamilies in Pfam database (version 7.3) [<xref ref-type="bibr" rid="B29">29</xref>]. Two alignments from the SH2 superfamily have 44 and 87 sequences respectively and both alignment lengths are 83 amino acids (including gaps). The other two alignments from SH3 superfamily have 39 and 94 sequences respectively and both alignment lengths are 57 amino acids (including gaps). For each alignment, we ran optimization 3 times starting from different random initial points. The optimized <italic>&#x003c0; </italic>vectors did not converge to exactly the same point, but they had a high correlation with each other (always &#x0003e; 0.95) and the difference of logarithm likelihood function values was small (less than 0.1%). The logarithm likelihood of the alignment, using optimized <italic>&#x003c0; </italic>vector, increased slightly, but significantly (Table <xref ref-type="table" rid="T2">2</xref>), compared with the logarithm likelihood using the <italic>&#x003c0; </italic>vector calculated from the alignment.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Difference of logarithm likelihood and CPU time with and without optimization of <italic>&#x003c0; </italic>vector</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center"><italic>&#x003b1;</italic><sub><italic>AB </italic></sub>&#x00026; Calculated <italic>&#x003c0;</italic></td><td align="center"><italic>&#x003b1;</italic><sub><italic>AB </italic></sub>&#x00026; Optimized <italic>&#x003c0;</italic></td><td align="center">&#x00394;<italic>l</italic></td><td align="center">P*</td></tr></thead><tbody><tr><td align="center">Logarithm Likelihood</td><td align="center">-5087.72</td><td align="center">-5055.97</td><td align="center">31.75</td><td align="center">&#x0003c;0.0001</td></tr><tr><td align="center">CPU Time (s)<sup>+</sup></td><td align="center">213</td><td align="center">14902</td><td></td><td></td></tr></tbody></table><table-wrap-foot><p>The alignment tested here is the same alignment used in Table 1. Calculated <italic>&#x003c0; </italic>means frequency vector calculated from the alignment.</p><p>* The likelihood ratio test (LRT) [58] is used to test whether optimized <italic>&#x003c0; </italic>is significantly different from calculated <italic>&#x003c0;</italic>. The difference in number of free parameters between these two models is 19.</p><p><sup>+</sup>CPU times were computed on a Dell PowerEdge 8450 server (CPU 700MHz, RAM 8G).</p></table-wrap-foot></table-wrap><p>Optimization of the <italic>&#x003c0; </italic>vector is time consuming. The running time for reconstruction with or without optimizing <italic>&#x003c0; </italic>vector is 14,902 seconds and 213 seconds for SH2 alignment (44 sequences), respectively, on a Dell PowerEdge 8450 server (CPU 700MHz, RAM 8G) (Table <xref ref-type="table" rid="T2">2</xref>). In our program, the default <italic>&#x003c0; </italic>vector is calculated from the alignment while the user has the option to optimize the <italic>&#x003c0; </italic>vector for ancestral sequence reconstruction.</p></sec><sec><title>Testing reconstruction</title><p>Two different methods for simulations of the evolutionary process were used, as described in Methods, to test the reliability of the reconstruction results. In the first simulation method, starting from a randomly generated root sequence, we simulated the evolutionary process to obtain leaf node sequences based on a tree and a rate matrix. This process was repeated 100 times for a given root sequence <italic>R </italic>to produce 100 alignments consisting of all leaf node sequences. For each of the 100 alignments, we used the marginal reconstruction method to obtain an amino acid probability vector for each site at the root. To reduce sampling variance, the amino acid probability vector was averaged over the 100 simulation trials. At each site, the amino acid with the highest average probability was chosen as our result of the "reconstructed amino acid" at that site. All "reconstructed amino acids" formed the reconstructed sequences <italic>R'</italic>. There is no difference between <italic>R </italic>and <italic>R'</italic>, that is, the accuracy of reconstruction is 100% for the tree shown in Figure <xref ref-type="fig" rid="F2">2</xref>. For each individual simulation and its reconstruction, we checked the amino acid with the highest probability in the reconstructed probability vector of the root. If it is indeed the "reconstructed amino acid", the prediction for that simulation is correct according to the average reconstructed results. The fraction of individual predictions that are correct according to the average reconstructed results is almost always higher than the average probability of the "reconstructed amino acid", suggesting that the average probability of the "reconstructed amino acid" gives a lower estimation of the reconstruction reliability (Figure <xref ref-type="fig" rid="F4">4a</xref>).</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>a) Correlation between the average probability of "the reconstructed amino acid" and the fraction of correct predictions. b) Correlation between the fraction of correct predictions and average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>at each site. </bold>The protein family used here is the PDZ domain. Red filled points are sites with incorrect reconstruction.</p></caption><graphic xlink:href="1471-2148-4-33-4"/></fig><p>For the second simulation method, we introduced rate heterogeneity across sites with structural and functional constraints [<xref ref-type="bibr" rid="B21">21</xref>]. For the same tree, the accuracy of reconstruction was about 90%. Sites with larger substitution rates are expected to have less reliable reconstructions. Figure <xref ref-type="fig" rid="F4">4b</xref> shows the relationship between the average <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>and the fraction of individual predictions that are correct according to the "reconstructed amino acid". Sites with incorrect "reconstructed amino acids" all have large <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>values. These values reflect the difficulty of reconstructing sites with large numbers of substitutions. The probabilities of the "reconstructed amino acids" are all small for sites with incorrect reconstructions (less than 0.15), suggesting that the information content of the reconstruction is low.</p><p>The second simulation method was also used to test ANCESCON along with the reconstruction programs from PAML [<xref ref-type="bibr" rid="B30">30</xref>], PHYLIP [<xref ref-type="bibr" rid="B31">31</xref>] and PAUP* [<xref ref-type="bibr" rid="B32">32</xref>]. All tree topologies used in reconstruction tests were inferred from real alignments. All original root sequences were taken from PDB database [<xref ref-type="bibr" rid="B33">33</xref>]. We had three different types of alignment testing sets. The first testing set used the same tree topology but different root sequences to generate 100 alignments (for details see Methods). The second testing set used the same root sequence but different tree topologies. The third testing set randomly selected a root sequence and a tree topology to generate 100 alignments. After 100 alignments were generated, we reconstructed the root sequence for each alignment and found the consensus root sequence for the 100 reconstructed root sequences. Finally, the consensus root sequence was compared with the original root sequence to calculate the reconstruction accuracy, i.e. the fraction of correctly reconstructed sites for the root sequence. In addition, for the third test, the paired t-test was used to calculate the one-tail probability between ANCESCON and other three methods. In order to make different tree topologies comparable, those trees were scaled to make the average distance from root to all leaf nodes (<italic>d</italic><sub><italic>a</italic></sub>) the same for all trees and equal to the tree of pii1 (a signal transduction protein) (<italic>d</italic><sub><italic>a </italic></sub>= 4.23). If <italic>d</italic><sub><italic>a </italic></sub>was too small (e.g. 0.5), the reconstruction accuracy was always close to 1 for all reconstruction methods used. The value <italic>d</italic><sub><italic>a </italic></sub>= 4.23 was large enough to generate diverse sequences to differentiate 4 different ancestral sequence reconstruction methods.</p><p>For ANCESCON we had 3 different parameter settings, which included site-specific rate factors estimated by maximum likelihood method (<italic>&#x003b1;</italic><sub><italic>ML</italic></sub>), Alignment-Based rate factors (<italic>&#x003b1;</italic><sub><italic>AB</italic></sub>) and no rate factors (equal rates among sites). Different parameters were also used for the reconstruction programs from PAML and PHYLIP to find their best reconstructions. For PAML, reconstruction was tested with parameter <italic>&#x003b1; </italic>(rate factor) estimated from alignment and without <italic>&#x003b1;</italic>. For PHYLIP, 4 different parameter settings were tried, which were combinations of with/without <italic>&#x003b1; </italic>estimated from alignment by PAML and with/without branch length dwelling in input tree topology. For PAUP*, default settings were used.</p><p>Table <xref ref-type="table" rid="T3">3</xref> shows a comparison of the reconstruction accuracy for these 4 methods. The reconstruction accuracy of ANCESCON with <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>is higher than the other three methods in almost every test. Also the reconstruction accuracy of ANCESCON with <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>and without <italic>&#x003b1; </italic>is comparable with PAML and PHYLIP methods and is much better than PAUP*. For the first testing set, the best average accuracy for ANCESCON is about 0.5, while the best average reconstruction accuracies for PAML, PHYLIP and PAUP* are 0.45, 0.39 and 0.32 respectively. Testing set 2 and 3 produce similar results. Using the paired t-test in the third testing set, we show that ANCESCON method with <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>gives significantly better reconstruction than the other 3 methods. Because the site-specific <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>is very close to the true mutation rate at a site (Figure <xref ref-type="fig" rid="F1">1b</xref>), using the site-specific <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>can improve our ability to reconstruct the amino acids for ancestral sequences correctly. These reconstruction tests suggest that ANSCESCON may be a better tool to reconstruct ancestral sequences compared to PAML, PHYLIP and PAUP* if the given alignment contains more diverse sequences.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Ancestral sequence reconstruction accuracy by different programs</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Root Seq.</td><td align="center">Tree</td><td align="center">Leaf Node Num.</td><td align="center" colspan="10">Methods</td></tr><tr><td></td><td></td><td></td><td colspan="10"><hr></hr></td></tr><tr><td></td><td></td><td></td><td align="center" colspan="3">ANCESCON</td><td align="center" colspan="2">PAML</td><td align="center" colspan="4">PHYLIP $</td><td align="center">PAUP*</td></tr><tr><td></td><td></td><td></td><td colspan="9"><hr></hr></td><td></td></tr><tr><td></td><td></td><td></td><td align="center"><italic>&#x003b1;</italic><sub><italic>ML</italic></sub></td><td align="center"><italic>&#x003b1;</italic><sub><italic>AB</italic></sub></td><td align="center">-<italic>&#x003b1;</italic></td><td align="center">+<italic>&#x003b1;</italic></td><td align="center">-<italic>&#x003b1;</italic></td><td align="center">+L +<italic>&#x003b1;</italic></td><td align="center">-L +<italic>&#x003b1;</italic></td><td align="center">+L -<italic>&#x003b1;</italic></td><td align="center">-L -<italic>&#x003b1;</italic></td><td></td></tr></thead><tbody><tr><td align="center">1em2</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.45</bold></td><td align="center">0.32</td><td align="center">0.35</td><td align="center">0.41</td><td align="center">0.37</td><td align="center">0.29</td><td align="center">0.27</td><td align="center">0.21</td><td align="center">0.29</td><td align="center">0.26</td></tr><tr><td align="center">1g9o</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.56</bold></td><td align="center">0.46</td><td align="center">0.47</td><td align="center">0.53</td><td align="center">0.53</td><td align="center">0.51</td><td align="center">0.54</td><td align="center">0.40</td><td align="center">0.51</td><td align="center">0.47</td></tr><tr><td align="center">1rgg</td><td align="center">pii1</td><td align="center">25</td><td align="center">0.60</td><td align="center">0.42</td><td align="center">0.47</td><td align="center">0.60</td><td align="center"><bold>0.62</bold></td><td align="center">0.47</td><td align="center">0.58</td><td align="center">0.32</td><td align="center">0.56</td><td align="center">0.47</td></tr><tr><td align="center">1sgt</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.38</bold></td><td align="center">0.34</td><td align="center">0.33</td><td align="center">0.33</td><td align="center">0.32</td><td align="center">0.32</td><td align="center">0.33</td><td align="center">0.27</td><td align="center">0.33</td><td align="center">0.32</td></tr><tr><td align="center">1zm2</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.33</bold></td><td align="center">0.29</td><td align="center">0.3</td><td align="center">0.28</td><td align="center">0.25</td><td align="center">0.21</td><td align="center">0.25</td><td align="center">0.21</td><td align="center">0.27</td><td align="center">0.16</td></tr><tr><td align="center">2a8v</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.62</bold></td><td align="center">0.45</td><td align="center">0.42</td><td align="center">0.56</td><td align="center">0.55</td><td align="center">0.44</td><td align="center">0.46</td><td align="center">0.28</td><td align="center">0.50</td><td align="center">0.36</td></tr><tr><td align="center">2ctb</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.53</bold></td><td align="center">0.40</td><td align="center">0.39</td><td align="center">0.41</td><td align="center">0.38</td><td align="center">0.24</td><td align="center">0.24</td><td align="center">0.21</td><td align="center">0.29</td><td align="center">0.22</td></tr><tr><td align="center" colspan="3">Average accuracy</td><td align="center"><bold>0.496</bold></td><td align="center">0.383</td><td align="center">0.390</td><td align="center">0.446</td><td align="center">0.431</td><td align="center">0.354</td><td align="center">0.381</td><td align="center">0.271</td><td align="center">0.393</td><td align="center">0.323</td></tr><tr><td align="center">2ctb</td><td align="center">gef</td><td align="center">27</td><td align="center"><bold>0.54</bold></td><td align="center">0.37</td><td align="center">0.38</td><td align="center">0.35</td><td align="center">0.35</td><td align="center">0.29</td><td align="center">0.17</td><td align="center">0.24</td><td align="center">0.22</td><td align="center">0.22</td></tr><tr><td align="center">2ctb</td><td align="center">LacI</td><td align="center">54</td><td align="center"><bold>0.66</bold></td><td align="center">0.64</td><td align="center">0.57</td><td align="center">0.44</td><td align="center">0.37</td><td align="center">0.49</td><td align="center">0.35</td><td align="center">0.42</td><td align="center">0.33</td><td align="center">0.34</td></tr><tr><td align="center">2ctb</td><td align="center">pdz</td><td align="center">39</td><td align="center"><bold>0.54</bold></td><td align="center">0.41</td><td align="center">0.42</td><td align="center">0.44</td><td align="center">0.39</td><td align="center">0.22</td><td align="center">0.34</td><td align="center">0.18</td><td align="center">0.32</td><td align="center">0.22</td></tr><tr><td align="center">2ctb</td><td align="center">ph</td><td align="center">30</td><td align="center"><bold>0.79</bold></td><td align="center">0.74</td><td align="center">0.75</td><td align="center">0.53</td><td align="center">0.55</td><td align="center">0.45</td><td align="center">0.25</td><td align="center">0.43</td><td align="center">0.37</td><td align="center">0.32</td></tr><tr><td align="center">2ctb</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.53</bold></td><td align="center">0.40</td><td align="center">0.39</td><td align="center">0.41</td><td align="center">0.38</td><td align="center">0.24</td><td align="center">0.24</td><td align="center">0.21</td><td align="center">0.29</td><td align="center">0.22</td></tr><tr><td align="center">2ctb</td><td align="center">ptb</td><td align="center">29</td><td align="center"><bold>0.58</bold></td><td align="center">0.39</td><td align="center">0.43</td><td align="center">0.39</td><td align="center">0.38</td><td align="center">0.29</td><td align="center">0.23</td><td align="center">0.26</td><td align="center">0.24</td><td align="center">0.23</td></tr><tr><td align="center">2ctb</td><td align="center">sh2</td><td align="center">34</td><td align="center"><bold>0.61</bold></td><td align="center">0.42</td><td align="center">0.40</td><td align="center">0.43</td><td align="center">0.40</td><td align="center">0.30</td><td align="center">0.22</td><td align="center">0.20</td><td align="center">0.27</td><td align="center">0.22</td></tr><tr><td align="center">2ctb</td><td align="center">sh3</td><td align="center">43</td><td align="center"><bold>0.83</bold></td><td align="center">0.82</td><td align="center">0.80</td><td align="center">0.62</td><td align="center">0.55</td><td align="center">0.69</td><td align="center">0.45</td><td align="center">0.66</td><td align="center">0.46</td><td align="center">0.54</td></tr><tr><td align="center">2ctb</td><td align="center">GST</td><td align="center">140</td><td align="center"><bold>0.76</bold></td><td align="center">0.73</td><td align="center">0.73</td><td align="center">@</td><td align="center">@</td><td align="center">#</td><td align="center">#</td><td align="center">0.47</td><td align="center">0.38</td><td align="center">0.33</td></tr><tr><td align="center" colspan="3">Average accuracy<sup>&#x00026;</sup></td><td align="center"><bold>0.635</bold></td><td align="center">0.524</td><td align="center">0.518</td><td align="center">0.451</td><td align="center">0.421</td><td align="center">0.371</td><td align="center">0.281</td><td align="center">0.325</td><td align="center">0.313</td><td align="center">0.289</td></tr><tr><td align="center">1em2</td><td align="center">pdz</td><td align="center">39</td><td align="center"><bold>0.45</bold></td><td align="center">0.35</td><td align="center">0.36</td><td align="center">0.44</td><td align="center">0.44</td><td align="center">0.29</td><td align="center">0.43</td><td align="center">0.23</td><td align="center">0.4</td><td align="center">0.24</td></tr><tr><td align="center">1g9o</td><td align="center">pii1</td><td align="center">25</td><td align="center"><bold>0.56</bold></td><td align="center">0.46</td><td align="center">0.47</td><td align="center">0.53</td><td align="center">0.53</td><td align="center">0.51</td><td align="center">0.54</td><td align="center">0.40</td><td align="center">0.51</td><td align="center">0.47</td></tr><tr><td align="center">1rgg</td><td align="center">sh2</td><td align="center">34</td><td align="center"><bold>0.64</bold></td><td align="center">0.48</td><td align="center">0.46</td><td align="center">0.61</td><td align="center">0.61</td><td align="center">0.56</td><td align="center">0.59</td><td align="center">0.34</td><td align="center">0.6</td><td align="center">0.41</td></tr><tr><td align="center">1sgt</td><td align="center">gef</td><td align="center">27</td><td align="center"><bold>0.49</bold></td><td align="center">0.39</td><td align="center">0.40</td><td align="center">0.48</td><td align="center">0.44</td><td align="center">0.42</td><td align="center">0.44</td><td align="center">0.36</td><td align="center">0.45</td><td align="center">0.41</td></tr><tr><td align="center">1zm2</td><td align="center">ptb</td><td align="center">29</td><td align="center"><bold>0.66</bold></td><td align="center">0.47</td><td align="center">0.48</td><td align="center">0.57</td><td align="center">0.57</td><td align="center">0.53</td><td align="center">0.51</td><td align="center">0.32</td><td align="center">0.52</td><td align="center">0.41</td></tr><tr><td align="center">2a8v</td><td align="center">ph</td><td align="center">30</td><td align="center"><bold>0.81</bold></td><td align="center">0.78</td><td align="center"><bold>0.81</bold></td><td align="center">0.71</td><td align="center">0.74</td><td align="center">0.60</td><td align="center">0.61</td><td align="center">0.50</td><td align="center">0.65</td><td align="center">0.50</td></tr><tr><td align="center">2ctb</td><td align="center">LacI</td><td align="center">54</td><td align="center"><bold>0.66</bold></td><td align="center">0.64</td><td align="center">0.57</td><td align="center">0.44</td><td align="center">0.37</td><td align="center">0.49</td><td align="center">0.35</td><td align="center">0.42</td><td align="center">0.33</td><td align="center">0.34</td></tr><tr><td align="center" colspan="3">Average accuracy</td><td align="center"><bold>0.610</bold></td><td align="center">0.510</td><td align="center">0.507</td><td align="center">0.540</td><td align="center">0.529</td><td align="center">0.486</td><td align="center">0.496</td><td align="center">0.367</td><td align="center">0.494</td><td align="center">0.397</td></tr><tr><td align="center" colspan="3">Probability<sup>&#x00394;</sup></td><td></td><td align="center">0.0026</td><td align="center">0.0023</td><td align="center">0.0248</td><td align="center">0.0328</td><td align="center">0.0007</td><td align="center">0.0168</td><td align="center">0.0001</td><td align="center">0.0143</td><td align="center">0.0005</td></tr></tbody></table><table-wrap-foot><p>All root sequences are taken from PDB database and the names listed in the table are PDB IDs.</p><p>Tree topologies for gef (guanine nucleotide exchange factor), LacI (PurR/LacI family of bacterial transcription factors), pdz, ph, pii1 (a signal transduction protein), ptb, sh2, sh3 and GST (glutathione S-transferase) are inferred from multiple sequence alignments chosen from Pfam database (version 7.3).</p><p>All tree topologies are generated from real alignments and the distances are rescaled in order to make the trees comparable.</p><p>The value in this table represents the accuracy of reconstruction, i.e. the fraction of correctly reconstructed sites for the root sequence. The best reconstruction accuracy in each test is shown in bold.</p><p><italic>&#x003b1;</italic><sub><italic>ML </italic></sub>means that the site-specific rate factors were estimated by maximum likelihood method.</p><p><italic>&#x003b1;</italic><sub><italic>AB </italic></sub>means that the site-specific rate factors were estimated by our empirical equation based on the given alignment (for details see Methods).</p><p>-<italic>&#x003b1; </italic>means that the rate factors were not considered in reconstruction.</p><p>+<italic>&#x003b1; </italic>means that the rate factors were considered in reconstruction.</p><p>+L means that branch lengths of the input tree were used in reconstruction, while -L means that branch lengths were estimated by the reconstruction program itself.</p><p>@: tree topology for GST had 140 leaf nodes that were too many for PAML to run through.</p><p><sup>$</sup>: rate factors estimated by PAML were used by PHYLIP in ancestral sequence reconstruction.</p><p>#: tree topology for GST had 140 leaf nodes, which were too many for PAML to estimate rate factors for GST.</p><p><sup>&#x00026;</sup>:GST is excluded in calculation of the average.</p><p><sup>&#x00394;</sup>: paired t-test method [40] was used to estimate the one-tail probability between ANCESCON and the other three reconstruction methods.</p></table-wrap-foot></table-wrap></sec><sec><title>Ancestral sequences used in homology detection</title><p>Thirty-eight OB (Oligonucleotide/oligosaccharide binding)-fold [<xref ref-type="bibr" rid="B34">34</xref>] proteins and ten other alignments (adenylyl kinase, gef, globin, pdz, ph, ptb, ras, sh2, sh3 and subtilase) from the Pfam database (version 7.3) [<xref ref-type="bibr" rid="B29">29</xref>] were chosen to perform homology detection tests.</p><p>Given an alignment with <italic>N </italic>sequences, we had four different methods, "BEST", "SECOND BEST", "SHUFFLE" and "RANDOM", to generate another <italic>N</italic>-1 sequences (for details see Methods). For each combined alignment (2<italic>N</italic>-1 sequences), PSI-BLAST [<xref ref-type="bibr" rid="B35">35</xref>] searches were performed starting from each sequence and seeded with the combined alignment (-B option in the program BLASTPGP, e-value cutoff 0.01), and all found hits were pooled together.</p><p>The benchmark experiment was PSI-BLAST seeded with the native alignment (<italic>N </italic>sequences). For each type of the four combined alignments, we checked hits not found by the native alignments. New hits were verified to be true positives or false positives by running PSI-BLAST or HMMER [<xref ref-type="bibr" rid="B36">36</xref>], followed by manual inspections.</p><p>Using the 48 native alignments, a total of 13973 hits were found by the benchmark. Compared to the benchmark, the "BEST" method detected 120 new homologs and the other three methods found 69, 74 and 9 new homologs, respectively (Figure <xref ref-type="fig" rid="F5">5</xref>). Among those new homologs, "BEST", "SECOND BEST", "SHUFFLE" and "RANDOM" methods had 3, 2, 6 and 3 false positives, respectively (Figure <xref ref-type="fig" rid="F5">5</xref>). Also, "BEST", "SECOND BEST", "SHUFFLE" and "RANDOM" methods missed 61, 1070, 60 and 7811 homologs as compared to the benchmark.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Comparison of "BEST", "SECOND BEST", "SHUFFLE" and "RANDOM" methods in the number of new homologs detected when compared with the benchmark experiment. </bold>The methods are defined in "Methods" section. The blue portion of the bar shows the number of true positives. The red portion of the bar shows the number of the false positives.</p></caption><graphic xlink:href="1471-2148-4-33-5"/></fig><p>Adding non-native sequences to the native alignment results in a change of sequence profile for PSI-BLAST searches. Random sequences can dilute the position-specific amino acid exchange characteristics of native alignments. This effect should not improve the profile. Indeed, few new homologs are found by the "RANDOM" method. However, sequences generated by shuffling each position of the native alignment have the same conservation properties as the native alignment, and the "SHUFFLE" method detects a total of 74 new homologs. Two effects may account for this finding. First, addition of shuffled sequences to the native alignment can slightly change the estimates of pseudocount frequencies of amino acids and thus the position specific scoring matrix [<xref ref-type="bibr" rid="B35">35</xref>]. Second, the new version of PSI-BLAST program uses composition-based statistics with e-value estimation related to the composition of the query sequence [<xref ref-type="bibr" rid="B37">37</xref>]. Each shuffled sequence has its own amino acid composition that is different from the native sequences. This difference can affect the e-values of hits. The "BEST" method detects the most number of new homologs, suggesting that the reconstructed ancestral sequences resemble the native sequences. Ancestral sequences may therefore be more similar to some remote homologs than to the native sequences. The "SECOND BEST" method detects less new homologs than the "BEST" method but more than the "RANDOM" method, suggesting that the second most probable amino acids in reconstruction can still reflect some properties of native sequences. Table <xref ref-type="table" rid="T4">4</xref> shows homology detection results of OB-fold structures using reconstructed ancestral sequences.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Homology detection results of OB-fold structures using reconstructed ancestral sequences</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">SCOP Superfamily/family</td><td align="left">PDB structure</td><td align="center">New homologs</td><td align="left">NCBI annotation</td></tr></thead><tbody><tr><td align="left">Nucleic acid-binding proteins/ Anticodon-binding domain</td><td align="left">1b7yB, 39&#x02013;151</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1b8aA, 1&#x02013;102</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1bbuA, 64&#x02013;151</td><td align="center">13431467</td><td align="left">DNA polymerase II small subunit</td></tr><tr><td></td><td></td><td align="center">15598836</td><td align="left">DNA polymerase III, alpha chain</td></tr><tr><td></td><td align="left">1c0aA, 1&#x02013;106</td><td align="center">11261591</td><td align="left">DNA polymerase III, alpha chain</td></tr><tr><td></td><td></td><td align="center">11499379</td><td align="left">conserved hypothetical protein</td></tr><tr><td></td><td></td><td align="center">1169392</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">118794</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">13620707</td><td align="left">putative DNA polymerase III, alpha chain</td></tr><tr><td></td><td></td><td align="center">14194684</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">14194702</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">14195653</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">14195659</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">15594924</td><td align="left">DNA polymerase III, subunit alpha</td></tr><tr><td></td><td></td><td align="center">15598836</td><td align="left">DNA polymerase III, alpha chain</td></tr><tr><td></td><td></td><td align="center">15601899</td><td align="left">DnaE</td></tr><tr><td></td><td></td><td align="center">15642243</td><td align="left">DNA polymerase III, alpha subunit</td></tr><tr><td></td><td></td><td align="center">15669005</td><td align="left">M. <italic>jannaschii </italic>predicted coding region MJ0818</td></tr><tr><td></td><td></td><td align="center">15679404</td><td align="left">DNA polymerase delta small subunit</td></tr><tr><td></td><td></td><td align="center">3914611</td><td align="left">ATP-dependent DNA helicase recG</td></tr><tr><td></td><td align="left">1cuk, 1&#x02013;64</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1e1oA, 64&#x02013;148</td><td align="center">11261591</td><td align="left">DNA polymerase III, alpha chain XF0204</td></tr><tr><td></td><td></td><td align="center">14194684</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td align="left">1fguA, 181&#x02013;298</td><td align="center">15219507</td><td align="left">hypothetical protein</td></tr><tr><td></td><td></td><td align="center">15230563</td><td align="left">putative protein</td></tr><tr><td></td><td></td><td align="center">15790309</td><td align="left">Vng1255c from <italic>Halobacterium </italic>sp.</td></tr><tr><td></td><td></td><td align="center">6166145</td><td align="left">DNA polymerase III alpha subunit</td></tr><tr><td></td><td></td><td align="center">8778702</td><td align="left">T1N15.20</td></tr><tr><td></td><td align="left">1fl0A</td><td align="center">10957481</td><td align="left">hypothetical protein</td></tr><tr><td></td><td align="left">1g51A, 1&#x02013;104</td><td align="center">14520587</td><td align="left">hypothetical protein</td></tr><tr><td></td><td></td><td align="center">14591565</td><td align="left">hypothetical protein</td></tr><tr><td></td><td></td><td align="center">15595886</td><td align="left">hypothetical protein</td></tr><tr><td></td><td></td><td align="center">3914638</td><td align="left">ATP-dependent DNA helicase recG</td></tr><tr><td></td><td align="left">1otcB, 36&#x02013;126</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1quqA, 62&#x02013;152</td><td align="center">15387767</td><td align="left">probable replication protein a 28 Kd subunit</td></tr><tr><td></td><td align="left">1qvcA, 1&#x02013;114</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Nucleic acid-binding proteins/Cold shock DNA-binding domain like</td><td align="center">1a62, 48&#x02013;125</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1ah9</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1bkb, 75&#x02013;139</td><td align="center">15790688</td><td align="left">translation initiation factor eIF-5A; Eif5a</td></tr><tr><td></td><td align="left">1c9oA</td><td align="center">6014735</td><td align="left">Cold shock protein CspSt</td></tr><tr><td></td><td align="left">1csp</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1d7qA</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1mjc</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1rl2</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1sro</td><td align="center">15671445</td><td align="left">N utilization substance protein A</td></tr><tr><td></td><td></td><td align="center">15794781</td><td align="left">N utilisation substance protein A</td></tr><tr><td></td><td></td><td align="center">15803711</td><td align="left">transcription pausing; L factor</td></tr><tr><td></td><td align="left">2eifA, 73&#x02013;132</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Nucleic acid-binding proteins/DNA ligase, mRNA capping enzyme, domain2</td><td align="left">1a0i, 241&#x02013;349</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1dgsA, 315&#x02013;400</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1ckmA, 238&#x02013;302</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1fviA, 190&#x02013;293</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Nucleic acid-binding proteins/Phage ssDNA-binding proteins</td><td align="left">1gpc</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1gvp</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1pfs</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Nucleic acid-binding proteins/RNA polymerase subunit RBP8</td><td align="left">1a1d</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Staphylococcal nuclease/Staphylococcal nuclease</td><td align="left">1eyd</td><td align="center">13422779</td><td align="left">aldose 1-epimerase *</td></tr><tr><td align="left">Bacterial enterotoxins/Bacterial AB5 toxins, B units</td><td align="left">1c4qA</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td></td><td align="left">1prtF</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Bacterial enterotoxins/Superantigen toxins</td><td align="left">1an8, 19&#x02013;94</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">TIMP-like/Tissue inhibitor of metalloproteases</td><td align="left">1ueaB, 14&#x02013;106</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">Inorganic pyrophosphatase/ Inorganic pyrophosphatase</td><td align="left">2prd</td><td align="center">N/A</td><td align="left">-</td></tr><tr><td align="left">MOP-like/BiMOP, duplicated molybdate-binding domain</td><td align="left">1b9mA, 127&#x02013;262</td><td align="center">10639288</td><td align="left">probable ATP-binding protein</td></tr><tr><td></td><td></td><td align="center">10955070</td><td align="left">AgtA</td></tr><tr><td></td><td></td><td align="center">1175513</td><td align="left">Putative ferric transport ATP-binding protein afuC</td></tr><tr><td></td><td></td><td align="center">15598450</td><td align="left">probable ATP-binding component of ABC transporter</td></tr><tr><td></td><td></td><td align="center">3978166</td><td align="left">ATPase FbpC</td></tr><tr><td></td><td></td><td align="center">4895001</td><td align="left">glucose ABC transporter ATPase *</td></tr><tr><td align="left">Histidine kinase CheA, C-terminal domain/ Histidine kinase CheA, C-terminal domain</td><td align="left">1b3qA, 540&#x02013;671</td><td align="center">N/A</td><td align="left">-</td></tr></tbody></table><table-wrap-foot><p>* Putative false positives as assessed by manual inspection.</p></table-wrap-foot></table-wrap></sec><sec><title>Prediction of functional sites</title><p>Ten well-studied protein families (adenylyl kinase, gef, globin, pdz, ph, ptb, ras, sh2, sh3 and subtilase) from the Pfam database (version 7.3) [<xref ref-type="bibr" rid="B29">29</xref>] were selected to test the prediction of functional sites. To define functional sites, we considered residues falling within 5&#x000c5; of any ligand to be functionally important (i.e. AP5 for adenylyl kinase). As a simple quantification of prediction accuracy, we counted the number of predictions that lie within 5&#x000c5; from the ligands and consider these sites to be true positives.</p><p>Our method intends to identify those sites with high similarity within individual sub-trees and high variation among sub-trees. These sites are likely to contribute to functional specificity. Based on a tree partition and the reconstructions at the cutting nodes (details see Methods), we have developed a measure called specificity score (equation (27)). We expect that both highly variable sites and highly conserved sites tend to score low in our method. Ten top-ranking sites were selected as our predicted functional sites for each family. For comparison, we also implemented a simple conservation (SC) method [<xref ref-type="bibr" rid="B25">25</xref>], the evolutionary trace (ET) method [<xref ref-type="bibr" rid="B26">26</xref>] and the conservation difference (CD) method [<xref ref-type="bibr" rid="B21">21</xref>] on the 10 protein families. The results are shown in Table <xref ref-type="table" rid="T5">5</xref>. Here, the results from these three methods tend to include invariant or highly conserved sites while the result from our method scores those sites low. Still, the number of true positives of our method is comparable to other methods for several families. For some protein families, such as gef, pdz and subtilase, our method predicts no fewer functional residues than the other three methods.</p><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Comparison of the true hits among the top 10 predicted sites for ANCESCON, evolutionary trace (ET), simple conservation (SC), and conservation difference (CD) methods</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Protein Family</td><td align="center">PDB ID<sup>#</sup></td><td align="center">Ligand/ substrate</td><td align="center">Number of sites</td><td align="center">*</td><td align="center">**</td><td align="center">***</td><td align="center">ANCESCON</td><td align="center">ET</td><td align="center">SC</td><td align="center">CD</td></tr></thead><tbody><tr><td align="center">adkinase</td><td align="center">1aky</td><td align="center">AP5</td><td align="center">188</td><td align="center">42</td><td align="center">20</td><td align="center">18</td><td align="center">3</td><td align="center">9.5</td><td align="center">9.1</td><td align="center">8</td></tr><tr><td align="center">gef</td><td align="center">1bkd</td><td align="center">H-Ras</td><td align="center">245</td><td align="center">47</td><td align="center">4</td><td align="center">0</td><td align="center">3</td><td align="center">3</td><td align="center">3</td><td align="center">2</td></tr><tr><td align="center">globin</td><td align="center">1a6g</td><td align="center">HEM</td><td align="center">147</td><td align="center">21</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">5.5</td><td align="center">6</td><td align="center">6</td></tr><tr><td align="center">pdz</td><td align="center">1be9</td><td align="center">+</td><td align="center">81</td><td align="center">15</td><td align="center">2</td><td align="center">1</td><td align="center">6</td><td align="center">4</td><td align="center">4</td><td align="center">2</td></tr><tr><td align="center">ph</td><td align="center">1mai</td><td align="center">I3P</td><td align="center">109</td><td align="center">11</td><td align="center">2</td><td align="center">0</td><td align="center">2</td><td align="center">2</td><td align="center">3</td><td align="center">2</td></tr><tr><td align="center">ptb</td><td align="center">1shc</td><td align="center">PTR</td><td align="center">157</td><td align="center">27</td><td align="center">2</td><td align="center">1</td><td align="center">6</td><td align="center">5</td><td align="center">5</td><td align="center">9</td></tr><tr><td align="center">ras</td><td align="center">821p</td><td align="center">GTN</td><td align="center">185</td><td align="center">29</td><td align="center">10</td><td align="center">9</td><td align="center">2</td><td align="center">5.6</td><td align="center">8.7</td><td align="center">5</td></tr><tr><td align="center">sh2</td><td align="center">1a09</td><td align="center">ACE</td><td align="center">83</td><td align="center">17</td><td align="center">2</td><td align="center">1</td><td align="center">3</td><td align="center">5</td><td align="center">4</td><td align="center">4</td></tr><tr><td align="center">sh3</td><td align="center">1nlo</td><td align="center">ACE</td><td align="center">57</td><td align="center">9</td><td align="center">1</td><td align="center">1</td><td align="center">2</td><td align="center">5</td><td align="center">4</td><td align="center">0</td></tr><tr><td align="center">subtilase</td><td align="center">1av7</td><td align="center">SBL</td><td align="center">278</td><td align="center">22</td><td align="center">8</td><td align="center">4</td><td align="center">5</td><td align="center">4.6</td><td align="center">3.8</td><td align="center">4</td></tr></tbody></table><table-wrap-foot><p><sup>#:</sup>Representative protein structure</p><p>*: Number of sites within 5&#x000c5; to ligand or substrates</p><p>**: Number of invariant sites, which may contain gaps</p><p>***: Number of invariant sites within 5 &#x000c5; to ligand or substrates</p><p>+: C-terminal peptide of protein CRIPT</p></table-wrap-foot></table-wrap><p>Figure <xref ref-type="fig" rid="F6">6</xref> shows the mapping of our predictions on the structure for the PDZ domain family. In green color is the ligand and in red color are the functional residues predicted by our method. Six of the predicted residues are within 5&#x000c5; to the peptide ligand. Nine of the predicted residues are around the ligand binding area. Only one is distant from the ligand (Figure <xref ref-type="fig" rid="F6">6</xref>).</p><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Mapping top 10 predictions by ANCESCON to PDZ domain (PDB ID: 1be9) [50]. </bold>The color code scheme: ligand is shown in green and the predicted functional residues are shown in red.</p></caption><graphic xlink:href="1471-2148-4-33-6"/></fig><p>Another example is the family of adenylyl kinases. Our method identified 3 residues within 5 &#x000c5; to the ligand while the other 3 methods identified more such residues, most of which are in highly conserved positions such as the catalytic residues. Highly conserved residues, however, are not selected by our method since our measure is designed to emphasize on sites contributing to specificity. Figure <xref ref-type="fig" rid="F7">7</xref> shows the N-terminal part of the alignment of adenylyl kinases, with our predictions highlighted in red and orange colors. The evolutionary tree for the alignment is shown in Figure <xref ref-type="fig" rid="F8">8</xref>. The first cutting layer (for details see Methods) results in two well-separated sub-trees. Functional annotations suggest that they contain enzymes with different substrate preferences: adenylyl kinases and uridylate kinases, respectively. Three residues (27, 54 and 89) from our predictions (red colored in Figure <xref ref-type="fig" rid="F9">9</xref>) contribute to substrate-binding specificity, as have been noted before in the structural studies of the UMP kinases [<xref ref-type="bibr" rid="B38">38</xref>]. Figure <xref ref-type="fig" rid="F9">9</xref> highlights our predicted functional residues on the adenylyl kinase protein structure. Most of our predictions fall within the specificity pocket.</p><fig position="float" id="F7"><label>Figure 7</label><caption><p><bold>A partial alignment of the N-terminal part of adenylyl kinases. </bold>Sites colored in red are our predictions that are within 5&#x000c5; from the ligand. Sites colored in orange are our predictions more than 5&#x000c5; apart from the ligand.</p></caption><graphic xlink:href="1471-2148-4-33-7"/></fig><fig position="float" id="F8"><label>Figure 8</label><caption><p><bold>The evolutionary tree for the adenylyl kinase family generated by "Weighbor". </bold>The first cutting layer is shown. Evolutionary distances are shown to scale.</p></caption><graphic xlink:href="1471-2148-4-33-8"/></fig><fig position="float" id="F9"><label>Figure 9</label><caption><p><bold>Mapping top 10 predictions by ANCESCON to adenylyl kinase domain (PDB ID: 1aky) [47]. </bold>The color code scheme: ligand is shown in green and the predicted functional residues are shown in red.</p></caption><graphic xlink:href="1471-2148-4-33-9"/></fig></sec></sec><sec><title>Conclusions</title><p>We developed a package (ANCESCON) to reconstruct ancestral protein sequences that takes into account the variation of substitution rates among sites. Two methods were proposed to estimate site-specific evolutionary rates (<italic>&#x003b1;</italic>), namely Alignment-Based rate factor (<italic>&#x003b1;</italic><sub><italic>AB</italic></sub>) and rate factor <italic>&#x003b1; </italic>estimated by maximum likelihood (<italic>&#x003b1;</italic><sub><italic>ML</italic></sub>). Consideration of rate variation among sites can alleviate the underestimation of evolutionary distances. Accuracy of ancestral sequence reconstruction by our method is higher than that of PAML, PHYLIP and PAUP* when the given alignment contains more diverse sequences. We show that reconstructed ancestral sequences help to improve detection of distant homologs and prediction of functional sites with specificity.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Transition probability and likelihood calculations</title><p>For all models discussed in this paper, we assume all sites in an alignment evolve independently and according to a homogeneous, stationary and time reversible Markov process. The probability of an amino acid <italic>i </italic>to be replaced by amino acid <italic>j </italic>after a time interval <italic>t </italic>is <italic>P</italic><sub><italic>ij</italic></sub>(<italic>t</italic>). The transition probability matrix of 20 amino acids is written as <bold>P</bold>(<italic>t</italic>), which can be calculated as</p><p><bold>P</bold>(<italic>t</italic>) = exp(<bold>Q</bold><italic>t</italic>) &#x000a0;&#x000a0;&#x000a0; (2)</p><p>Here, <bold>Q </bold>is the rate matrix. The non-diagonal elements <italic>q</italic><sub><italic>ij </italic></sub>are the instantaneous rates of change from amino acid <italic>i </italic>to amino acid <italic>j </italic>and diagonal elements <italic>q</italic><sub><italic>ii </italic></sub>are such that each matrix row sums up to 0. <bold>Q </bold>can be calculated by:</p><p><bold>Q </bold>= <bold>S</bold>* <italic>diag</italic>(<italic>&#x003c0;</italic>) &#x000a0;&#x000a0;&#x000a0; (3)</p><p><bold>S </bold>is the matrix of amino acid exchangeability parameters [<xref ref-type="bibr" rid="B39">39</xref>]. <italic>&#x003c0;</italic><sub><italic>i </italic></sub>is the equilibrium frequency for amino acid <italic>i</italic>. Time reversibility implies that <bold>S </bold>is a symmetric matrix. In our program, the <bold>S </bold>matrix is taken from Whelan and Goldman [<xref ref-type="bibr" rid="B39">39</xref>] and the default <italic>&#x003c0; </italic>vector is estimated from the given alignment.</p><p><bold>Q </bold>can be decomposed into eigenvalues (<italic>&#x003bb;</italic><sub><italic>i</italic></sub>) and eigenvectors (<bold><italic>u</italic></bold><sub><italic>i</italic></sub>).</p><p><inline-graphic xlink:href="1471-2148-4-33-i2.gif"/></p><p><bold>U </bold>= (<bold><italic>u</italic></bold><sub>1</sub>, ..., <bold><italic>u</italic></bold><sub>20</sub>) &#x000a0;&#x000a0;&#x000a0; (5)</p><p><italic>P</italic><sub><italic>ij</italic></sub>(<italic>t</italic>) can be calculated using the following equation,</p><p><inline-graphic xlink:href="1471-2148-4-33-i3.gif"/></p><p>The likelihood function [<xref ref-type="bibr" rid="B8">8</xref>] for an evolutionary tree T shown in Figure <xref ref-type="fig" rid="F10">10</xref> is:</p><fig position="float" id="F10"><label>Figure 10</label><caption><p><bold>An evolutionary tree topology. </bold>Nodes C, D, E and F represent given protein sequences, while nodes A and B represent ancestral protein sequences, i.e. unknown sequences. <italic>d</italic><sub><italic>YZ </italic></sub>represents the evolutionary distance between nodes Y and Z.</p></caption><graphic xlink:href="1471-2148-4-33-10"/></fig><p><inline-graphic xlink:href="1471-2148-4-33-i4.gif"/></p><p>Here, <inline-graphic xlink:href="1471-2148-4-33-i5.gif"/> is the equilibrium frequency of the amino acid at the node A. <inline-graphic xlink:href="1471-2148-4-33-i6.gif"/> is the transition probability from the amino acid at node A to the amino acid at node B after an evolutionary distance <italic>d</italic><sub><italic>AB</italic></sub>.</p><p>Considering that each site <italic>i </italic>has a rate factor <italic>&#x003b1;</italic><sub><italic>i </italic></sub>[<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B18">18</xref>], we have:</p><p><inline-graphic xlink:href="1471-2148-4-33-i7.gif"/></p><p><italic>t </italic>in equation (6) can be expressed as:</p><p><italic>t </italic>= <italic>&#x003b1;</italic>&#x000b7;<italic>d </italic>&#x000a0;&#x000a0;&#x000a0; (9)</p><p><italic>d </italic>is the evolutionary distance and <italic>&#x003b1; </italic>is rate factor. The following restriction on the vector <italic>&#x003b1; </italic>holds:</p><p><inline-graphic xlink:href="1471-2148-4-33-i8.gif"/></p><p>Here, <italic>K </italic>is the number of sites.</p></sec><sec><title>Alignment-Based Rate Factor <italic>&#x003b1; </italic>(<italic>&#x003b1;</italic><sub><italic>AB</italic></sub>) and Rate factor <italic>&#x003b1; </italic>estimated by Maximum Likelihood (<italic>&#x003b1;</italic><sub><italic>ML</italic></sub>)</title><p>Our program supports two methods to estimate a rate factor for each site: Alignment-Based rate factor <italic>&#x003b1; </italic>(<italic>&#x003b1;</italic><sub><italic>AB</italic></sub>) and Maximum Likelihood-estimated rate factor <italic>&#x003b1; </italic>(<italic>&#x003b1;</italic><sub><italic>ML</italic></sub>).</p><p>The estimation of <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>is empirical and based on the observation that the substitution rate at a site is correlated with the conservation of the site, which, in turn, is correlated with the average transition probability among the amino acids at that site. Conserved sites are dominated by highly similar amino acids and thus have high average transition probabilities among the amino acids. The algorithm to calculate <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>is as follows:</p><p>1. Set <italic>t </italic>equal to 1.0 and use equation (6) to calculate a transition probability matrix <bold>P </bold>for 20 amino acids. Equation, <inline-graphic xlink:href="1471-2148-4-33-i9.gif"/>, is used to compute a symmetric matrix <bold>P'</bold>.</p><p>2. Calculate the average transition probability for each site and take the reciprocal: <inline-graphic xlink:href="1471-2148-4-33-i10.gif"/>, where <inline-graphic xlink:href="1471-2148-4-33-i11.gif"/> is the number of non-gapped amino acid pairs in site <italic>i </italic>and the denominator is the sum over the transition probabilities between all amino acid pairs (<italic>j</italic>,<italic>k</italic>) at a site <italic>i</italic>.</p><p>3. For invariant sites, <italic>C</italic><sub><italic>i </italic></sub>is set to 0 to make it consistent with the Maximum Likelihood estimation.</p><p>4. Equation (11) is used to calculate <italic>&#x003b1;</italic><sub><italic>AB</italic></sub>, so that equation (10) holds.</p><p><inline-graphic xlink:href="1471-2148-4-33-i12.gif"/></p><p>If an evolutionary tree is assumed for the alignment, we can estimate the <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>factors by maximizing the likelihood (equation (8)) for each site:</p><p><inline-graphic xlink:href="1471-2148-4-33-i13.gif"/></p><p>If some sites are highly variable, the <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>at those sites can be very large, as has been previously noticed [<xref ref-type="bibr" rid="B18">18</xref>]. We consider these rate factors to be outliers. For these sites, we have observed that likelihood changes very little over a wide range of the <italic>&#x003b1; </italic>values. An empirical method is used to reduce the values of <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>outliers, guided by the <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>values. a <italic>Z</italic>-score of the ratio of <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>to <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>is calculated for each site except invariant sites:</p><p><inline-graphic xlink:href="1471-2148-4-33-i14.gif"/></p><p><inline-graphic xlink:href="1471-2148-4-33-i15.gif"/></p><p>Here, <inline-graphic xlink:href="1471-2148-4-33-i16.gif"/> is the ratio of <inline-graphic xlink:href="1471-2148-4-33-i17.gif"/> to <inline-graphic xlink:href="1471-2148-4-33-i18.gif"/> for site <italic>i</italic>; <inline-graphic xlink:href="1471-2148-4-33-i19.gif"/> is the number of sites excluding the invariant sites. If <italic>Z</italic><sub><italic>i </italic></sub>is greater than 3, it is reduced to 3 by decreasing the value of <inline-graphic xlink:href="1471-2148-4-33-i17.gif"/>. We repeat this procedure until no <italic>Z</italic><sub><italic>i </italic></sub>for any site <italic>i </italic>is greater than 3. After removing the outliers, we scale the <inline-graphic xlink:href="1471-2148-4-33-i17.gif"/> values so that equation (10) holds.</p></sec><sec><title>Amino acid frequency vector <italic>&#x003c0; </italic>optimization</title><p>Two methods are implemented to estimate the equilibrium frequency vector <italic>&#x003c0;</italic>, one derived directly from the given alignment (Alignment-Based <italic>&#x003c0; </italic>or <italic>&#x003c0;</italic><sub><italic>AB</italic></sub>) and the other estimated by Maximum Likelihood (<italic>&#x003c0;</italic><sub><italic>ML</italic></sub>). The likelihood for the entire alignment is a function of <italic>&#x003c0; </italic>with 19 variables. A continuous minimization method by simulated annealing [<xref ref-type="bibr" rid="B40">40</xref>] is used to optimize <italic>&#x003c0;</italic>, with the objective function being the logarithm likelihood of the alignment. The simulated annealing is computationally intensive and is the major reason for the long CPU time given in Table <xref ref-type="table" rid="T2">2</xref>.</p></sec><sec><title>Distance matrix calculation and tree inference</title><p>A Maximum Likelihood approach is used to estimate the evolutionary distances among sequences, either considering rate variation across sites or not. The logarithm likelihood for replacing one protein sequence (A) with another protein sequence (B) after an evolutionary distance <italic>d </italic>can be written as:</p><p><inline-graphic xlink:href="1471-2148-4-33-i20.gif"/></p><p>Here, <inline-graphic xlink:href="1471-2148-4-33-i21.gif"/> is the equilibrium frequency for the amino acid at site <italic>j </italic>in sequence A. <inline-graphic xlink:href="1471-2148-4-33-i22.gif"/> is the transition probability from amino acid at site <italic>j </italic>in sequence A to amino acid at site <italic>j </italic>in sequence B after an evolutionary distance <italic>&#x003b1; </italic><sub><italic>j</italic></sub>&#x000b7;<italic>d</italic>. <italic>&#x003b1;</italic><sub><italic>j </italic></sub>is 1 if all sites are assumed to evolve at the same rate; otherwise the <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>at site <italic>j </italic>is used for <italic>&#x003b1;</italic><sub><italic>j</italic></sub>.</p><p>An estimate of the evolutionary distance between two sequences is obtained by maximizing the likelihood function of equation (15):</p><p><inline-graphic xlink:href="1471-2148-4-33-i23.gif"/></p><p>Equation (16) can be solved by the bisection root-finding method [<xref ref-type="bibr" rid="B40">40</xref>].</p><p>After the distance matrix is calculated, the "Weighbor" method, i.e. weighted neighbor joining, is used to infer an evolutionary tree [<xref ref-type="bibr" rid="B10">10</xref>].</p></sec><sec><title>Ancestral sequence reconstruction</title><p>Two methods are implemented to reconstruct ancestral sequences. One is a marginal reconstruction method [<xref ref-type="bibr" rid="B4">4</xref>], and the other is a joint reconstruction method [<xref ref-type="bibr" rid="B5">5</xref>]. Below are their brief descriptions.</p></sec><sec><title>The marginal reconstruction method [<xref ref-type="bibr" rid="B4">4</xref>]</title><p>We calculate <italic>P</italic>(<italic>A</italic><sub><italic>r</italic></sub>|{<italic>A</italic><sub><italic>l</italic></sub>}<italic>T</italic>), which is the conditional probability of amino acid <italic>A</italic><sub><italic>r </italic></sub>at the root, given leaf node amino acid set {<italic>A</italic><sub><italic>l</italic></sub>} and a tree <italic>T</italic>. Since time reversibility is assumed, any internal node can serve as a root. Using Bayes' theorem, we have:</p><p><inline-graphic xlink:href="1471-2148-4-33-i24.gif"/></p><p>Here, <italic>P</italic>(<italic>A</italic><sub><italic>r</italic></sub>) is used here instead of <italic>P</italic>(<italic>A</italic><sub><italic>r</italic></sub>|<italic>T</italic>) because the frequency of the root amino acid <italic>A</italic><sub><italic>r</italic></sub>, i.e. <italic>&#x003c0;</italic><sub><italic>r</italic></sub>, does not depend on tree <italic>T</italic>. <italic>P</italic>({<italic>A</italic><sub><italic>l</italic></sub>}|<italic>A</italic><sub><italic>r</italic></sub><italic>T</italic>) is the conditional probability of the known amino acids at the leaf nodes, given <italic>T </italic>and <italic>A</italic><sub><italic>r</italic></sub>. <italic>P</italic>({<italic>A</italic><sub><italic>l</italic></sub>}|<italic>T</italic>) does not depend on <italic>A</italic><sub><italic>r</italic></sub>, so it is calculated as a normalization constant for <italic>P</italic>(<italic>A</italic><sub><italic>r</italic></sub>|{<italic>A</italic><sub><italic>l</italic></sub>},<italic>T</italic>) terms over all 20 possible values of <italic>A</italic><sub><italic>r </italic></sub>to make the sum equal to 1.</p><p>For Figure <xref ref-type="fig" rid="F10">10</xref>, <italic>P</italic>({<italic>A</italic><sub><italic>l</italic></sub>}|<italic>A</italic><sub><italic>r</italic></sub><italic>T</italic>) can be expanded as:</p><p><inline-graphic xlink:href="1471-2148-4-33-i25.gif"/></p><p>Here, <inline-graphic xlink:href="1471-2148-4-33-i6.gif"/> is the transition probability from amino acid at node A to amino acid at node B after an evolutionary distance <italic>d</italic><sub><italic>AB</italic></sub>. Equation (18) can be calculated using a recursive method suggested by Felsenstein [<xref ref-type="bibr" rid="B8">8</xref>].</p><p>If rate factors are used in the reconstruction of the root sequence, we have:</p><p><inline-graphic xlink:href="1471-2148-4-33-i26.gif"/></p><p>Here, <italic>&#x003b1;</italic><sub><italic>i </italic></sub>could be either <italic>&#x003b1;</italic><sub><italic>AB </italic></sub>or <italic>&#x003b1;</italic><sub><italic>ML </italic></sub>at site <italic>i</italic>. <italic>P</italic>(<italic>A</italic><sub><italic>C</italic></sub>,<italic>A</italic><sub><italic>D</italic></sub>,<italic>A</italic><sub><italic>E</italic></sub>,<italic>A</italic><sub><italic>F </italic></sub>| <italic>A</italic><sub><italic>A</italic></sub>,<italic>T</italic>)<sub><italic>i </italic></sub>is the conditional probability <italic>P</italic>(<italic>A</italic><sub><italic>C</italic></sub>,<italic>A</italic><sub><italic>D</italic></sub>,<italic>A</italic><sub><italic>E</italic></sub>,<italic>A</italic><sub><italic>F </italic></sub>| <italic>A</italic><sub><italic>A</italic></sub>,<italic>T</italic>) at site <italic>i</italic>.</p></sec><sec><title>The joint reconstruction method [<xref ref-type="bibr" rid="B5">5</xref>]</title><p>The objective of a joint reconstruction method is to find the combination of amino acids for an internal node set {<italic>A</italic><sub><italic>i</italic></sub>} that maximize the conditional probability of this amino acid combination, given the leaf node amino acid set {<italic>A</italic><sub><italic>l</italic></sub>} and a tree <italic>T</italic>, <italic>P</italic>({<italic>A</italic><sub><italic>i</italic></sub>}|{<italic>A</italic><sub><italic>l</italic></sub>},<italic>T</italic>). Using the Bayes' theorem, we have:</p><p><inline-graphic xlink:href="1471-2148-4-33-i27.gif"/></p><p>Because <italic>P</italic>({<italic>A</italic><sub><italic>l</italic></sub>}|<italic>T</italic>) is the same for all amino acid combination at internal node set {<italic>A</italic><sub><italic>i</italic></sub>} this problem becomes finding the maximum of <italic>P</italic>({<italic>A</italic><sub><italic>l</italic></sub>}|{<italic>A</italic><sub><italic>i</italic></sub>},<italic>T</italic>) *<italic>P</italic>({<italic>A</italic><sub><italic>i</italic></sub>}).</p><p>The details of a fast algorithm to solve equation (20) can be found in Pupko et al. [<xref ref-type="bibr" rid="B5">5</xref>]. We also incorporated site-specific rate factors in this algorithm, in a similar way as equation (19)</p></sec><sec><title>Gaps</title><p>Due to difficulties with the probabilistic models of gaps, a simplified empirical approach is used to alleviate the problem. We assume that gaps are "supersede" letters. Gaps are considered for each site independently. If a leaf node has a gap instead of an amino acid at a site, this node will be deleted from the tree for this site. After dealing with leaves, we check all internal nodes for children. If an internal node has no children or only one child due to the leaf removal because of gaps, it will be removed from the tree and a gap will be assumed as its reconstructed state.</p></sec><sec><title>Simulations of evolutionary process</title><p>Two methods of simulating amino acid substitution process were used to test the reliability of reconstruction, rate factors and evolutionary distance estimation. The first simulation method was based on a homogeneous time reversible Markov model. The parameters from Whelan and Goldman [<xref ref-type="bibr" rid="B39">39</xref>] were chosen for our model, including the equilibrium frequency vector <italic>&#x003c0; </italic>and the <bold>S </bold>matrix. Given the length of a branch from a parent node to one of its child nodes and the amino acid for the parent node, we simulated the substitution process to generate an amino acid for the child node based on the transition probabilities that were calculated using equation (6). For the arbitrarily selected tree shown in Figure <xref ref-type="fig" rid="F2">2</xref>, we first generated a random sequence of 100 amino acids as the root sequence based on the amino acid frequencies from Whelan and Goldman [<xref ref-type="bibr" rid="B39">39</xref>]. We then simulated the random substitution process to obtain all leaf node sequences. This simulation was repeated 100 times. The resulting 100 alignments were used to test the reliability of the reconstruction result. In this simulation, each site evolved independently according to the same tree topology and branch lengths, thus there was no rate heterogeneity across sites.</p><p>The second simulation method, based on a <italic>Z</italic>-score model, introduced rate variation across sites by using structural and functional information for a specific protein family [<xref ref-type="bibr" rid="B21">21</xref>]. We selected three protein families for the <italic>Z</italic>-score simulations under structural and functional constraints: pdz domain (Protein DataBank (PDB) ID: 1g9o) [<xref ref-type="bibr" rid="B41">41</xref>], trypsin (PDB ID: 1sgt) [<xref ref-type="bibr" rid="B42">42</xref>] and carboxypeptidase A (PDB ID: 2ctb) [<xref ref-type="bibr" rid="B43">43</xref>]. Given a rooted tree, the native sequence with known structure was used as the root sequence. Simulations were made along the tree to generate sequences at any internal node or leaf node. If the evolutionary distance from a parent node to a child node was <italic>d</italic>, the child sequence was obtained after <italic>l</italic>*<italic>d </italic>accepted substitutions starting from the parent sequence, where <italic>l </italic>is protein sequence length. Simulations of the substitution process were repeated 100 times. For each site, the number of accepted substitutions was recorded and averaged over 100 simulations. Rate factors (observed <italic>&#x003b1;</italic>), representing site mutability, were calculated from these average substitution numbers, such that the average of rate factors is 1 (equation (10)). 100 simulated alignments were used to test the rate factor estimators (<italic>&#x003b1;</italic><sub><italic>AB </italic></sub>and <italic>&#x003b1;</italic><sub><italic>ML</italic></sub>), distance calculation methods and ancestral sequence reconstruction.</p></sec><sec><title>Homology detection</title><sec><title>Testing dataset</title><p>38 OB (Oligonucleotide/oligosaccharide binding)-fold [<xref ref-type="bibr" rid="B34">34</xref>] proteins with known structures were selected for homology detection test. OB-fold has a 5-stranded <italic>&#x003b2;</italic>-barrel structure. In the SCOP (Structure Classification of Proteins) database (version 1.55) [<xref ref-type="bibr" rid="B44">44</xref>], there are 7 OB-fold superfamilies. The superfamily of nucleic acid binding proteins is the most populated. Diversity of many OB-fold homologs extends beyond detection by automatic PSI-BLAST searches. Multiple sequence alignments of native sequences were obtained from PSI-BLAST searches starting from the 38 OB-fold sequences with known structures. We also selected 10 alignments (adenylyl kinase, gef, globin, pdz, ph, ptb, ras, sh2, sh3 and subtilase) from the Pfam database (version 7.3) [<xref ref-type="bibr" rid="B29">29</xref>] for homology detection test.</p></sec><sec><title>Four different methods</title><p>For each alignment with <italic>N </italic>sequences, ancestral sequences for the <italic>N</italic>-1 internal nodes were reconstructed. The idea is to test whether adding more sequences to a native alignment can help homology detection. Four types of combined alignments were generated, adding different sets of <italic>N</italic>-1 sequences to the native alignment. In the first case, the added sequence at each internal node consisted of amino acids with the largest probability at each position. In the second case, the added sequences were made up of amino acids with the second largest probability. In the third case, we shuffled the native alignment at each position while keeping the gap pattern as in the native alignment. After shuffling, we added <italic>N</italic>-1 sequences resulted from the shuffling to the native alignment. In the fourth case, <italic>N</italic>-1 random sequences were generated with the overall amino acid frequencies of the native alignment. These four methods are named "BEST", "SECOND BEST", "SHUFFLE" and "RANDOM", respectively.</p></sec></sec><sec><title>Prediction of functional sites</title><p>Our objective is to find sites that are well conserved within each sub-tree, but show high variability between different sub-trees. These sites are likely to contribute to functional specificity [<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B45">45</xref>,<xref ref-type="bibr" rid="B46">46</xref>].</p><sec><title>Sequence datasets</title><p>Multiple sequence alignments of ten protein families were chosen from the Pfam database (version 7.3) [<xref ref-type="bibr" rid="B29">29</xref>]. These families are: adenylyl kinase (adkinase) (representing structure PDB ID: 1aky; its ligand or substrate: AP5) [<xref ref-type="bibr" rid="B47">47</xref>], guanine nucleotide exchange factor (gef) (1bkd; H-Ras) [<xref ref-type="bibr" rid="B48">48</xref>], globin (1a6g; HEM) [<xref ref-type="bibr" rid="B49">49</xref>], pdz domain (1be9; C-terminal peptide of protein CRIPT) [<xref ref-type="bibr" rid="B50">50</xref>], ph domain (1mai; I3P) [<xref ref-type="bibr" rid="B51">51</xref>], ptb domain (1shc; PTR) [<xref ref-type="bibr" rid="B52">52</xref>], ras (821p; GTN) [<xref ref-type="bibr" rid="B53">53</xref>], sh2 domain (1a09; ACE) [<xref ref-type="bibr" rid="B54">54</xref>], sh3 domain (1nlo; ACE) [<xref ref-type="bibr" rid="B55">55</xref>] and subtilase (1av7; SBL) [<xref ref-type="bibr" rid="B56">56</xref>]. Most of these alignments contain many sequences. We pruned and clustered the sequences in each alignment according to the length and diversity. Representative sequences were kept and used for tree inference and ancestral sequence reconstruction. This procedure was done in three steps: 1) removing fragments, 2) single-linkage clustering and 3) complete-linkage clustering, as described below.</p><p>1. For each family, there is a template sequence with known structure. The sequences, which cover less than 75% of the non-gapped positions in the template sequence with amino acids, were considered to be fragments and discarded.</p><p>2. A sequence identity matrix was calculated for the remaining sequences. A single linkage clustering was done to form sequence groups at sequence identity threshold 0.8. For each group, we chose the longest sequence as a representative, discarding other members. This step reduced redundancy in the dataset.</p><p>3. An average sequence identity was calculated for the remaining sequences. We used this average identity as a threshold for complete linkage clustering to form new sequence groups. Four groups with the largest sequence numbers were chosen to form our new alignment. Any group with the same number of sequences as the fourth group was also included in the new alignment. The purpose of this step is to keep the major sequence subgroups of a family while leaving out highly divergent sequences that might be deleterious for tree inference.</p></sec><sec><title>Rooting</title><p>The "Weighbor" method gives an unrooted tree. For our purpose of predicting functional sites, we need to find a point on the tree that serves as the root. We used a least-squares modification of the midpoint rooting procedure to define the root [<xref ref-type="bibr" rid="B57">57</xref>].</p></sec><sec><title>Tree partitioning</title><p>The tree was partitioned into sub-trees at several levels and compared the amino acid usages within each sub-tree and among the sub-trees. For this partitioning, we "cut" the tree into a fixed number of equal-distanced layers, using the midpoint as the root (Figure <xref ref-type="fig" rid="F11">11</xref>). Several criteria were tried for selecting the distance between adjacent layers. Empirically we found that a simple partition of the tree into 5 layers usually gave the best results. If the average distance from the root to all leaf nodes is <italic>d</italic><sub><italic>r</italic></sub>, then the distance between adjacent layers is <italic>d</italic><sub><italic>r</italic></sub>/5 (Figure <xref ref-type="fig" rid="F11">11</xref>). Each place of a "cut" between the layers corresponds to a certain ancestral sequence. We term the location of a "cut" as a "cutting" node. The marginal reconstruction method was used to reconstruct amino acid probability vectors for all the cutting nodes (Figure <xref ref-type="fig" rid="F11">11</xref>). The reconstructed probability vector of a cutting node reflects the amino acid usages of the sub-tree under it.</p><fig position="float" id="F11"><label>Figure 11</label><caption><p><bold>An example showing the different cutting layers in a rooted tree. </bold><italic>d</italic><sub><italic>r </italic></sub>is the average distance from the root to all leaf nodes. Nodes <italic>i </italic>and <italic>j </italic>are neighboring cutting nodes.</p></caption><graphic xlink:href="1471-2148-4-33-11"/></fig></sec><sec><title>Calculating specificity score for each site</title><p>We use {<italic>L</italic><sub><italic>K</italic></sub>} to represent the set of cutting nodes for layer <italic>L</italic><sub><italic>K</italic></sub>, <italic>K </italic>= 0,1,5. {<italic>L</italic><sub><italic>0</italic></sub>} is the root and <italic>L</italic><sub>1 </sub>is the closest layer to the root, etc.</p><p>A dissimilarity score between any neighboring cutting node pair is calculated. The definition of a neighboring cutting node pair (<italic>i</italic>, <italic>j</italic>) (Figure <xref ref-type="fig" rid="F11">11</xref>) is:</p><p>1. <italic>i </italic>&#x02208; {<italic>L</italic><sub><italic>K</italic></sub>}</p><p>2. <italic>j </italic>&#x02208; {<italic>L</italic><sub><italic>K</italic>+1</sub>}</p><p>3. Node <italic>i </italic>is an ancestor of node <italic>j </italic>(all points on the path from <italic>j </italic>to root node are ancestors of node <italic>j</italic>), so that the distance between <italic>i </italic>and <italic>j </italic>is exactly <italic>d</italic><sub><italic>r</italic></sub><italic>/5</italic>. Each cutting node has only one ancestral cutting node neighbor.</p><p>The dissimilarity score for cutting node <italic>j </italic>and its ancestral cutting node neighbor <italic>i, </italic>i.e. <italic>anc</italic>(<italic>j</italic>), at site <italic>m </italic>is defined as:</p><p><inline-graphic xlink:href="1471-2148-4-33-i28.gif"/></p><p><inline-graphic xlink:href="1471-2148-4-33-i29.gif"/> and <inline-graphic xlink:href="1471-2148-4-33-i30.gif"/> are the reconstructed probabilities of amino acid <italic>A </italic>at cutting node <italic>j </italic>and its ancestral cutting node neighbor <italic>i</italic>(<italic>anc</italic>(<italic>j</italic>)), respectively.</p><p>Let <inline-graphic xlink:href="1471-2148-4-33-i31.gif"/>, <italic>K </italic>= 1,...,5 &#x000a0;&#x000a0;&#x000a0; (22)</p><p>Here, <inline-graphic xlink:href="1471-2148-4-33-i32.gif"/> is the average dissimilarity score for layer <italic>K </italic>. <italic>N</italic><sub><italic>K </italic></sub>is the number of cutting nodes in layer <italic>K</italic>.</p><p>The specificity score is defined as:</p><p><inline-graphic xlink:href="1471-2148-4-33-i33.gif"/></p><p><inline-graphic xlink:href="1471-2148-4-33-i34.gif"/> reflects the difference of amino acid compositions among the major sub-trees defined by the first layer. <inline-graphic xlink:href="1471-2148-4-33-i35.gif"/> to <inline-graphic xlink:href="1471-2148-4-33-i36.gif"/> reflect the average difference of amino acid compositions within each sub-tree. If the amino acids are highly conserved within each sub-tree but show variability among the sub-trees, <inline-graphic xlink:href="1471-2148-4-33-i35.gif"/> to <inline-graphic xlink:href="1471-2148-4-33-i36.gif"/> are small and <inline-graphic xlink:href="1471-2148-4-33-i34.gif"/> is large, leading to a large value of <italic>S</italic><sub><italic>m</italic></sub>. We set <italic>S</italic><sub><italic>m </italic></sub>to 0 for invariant sites. We sort the sites by their specificity scores and choose the 10 top scoring sites as our predicted functional sites. Those predicted functional sites that lie within 5 &#x000c5; from the ligand(s) are considered to be true positives.</p></sec><sec><title>Comparison with other methods</title><p>We compared our method with three other methods for prediction of functional sites. The first method (Simple Conservation or SC) is based on sequence conservation. Highly conserved sites are considered to be functional. For each family, we sorted the sites by positional conservation [<xref ref-type="bibr" rid="B25">25</xref>] and chose the 10 top-ranking sites as the predictions. There might be ties for sites. For example, if there were 5 sites tied at the tenth conservation value and only one of them was within 5&#x000c5; from the ligand(s), then its contribution to the total number of "correct predictions" was 1/5. The second method is the evolutionary trace (ET) method [<xref ref-type="bibr" rid="B26">26</xref>], which partitions a sequence identity dendrogram into sub-trees at varying sequence identity thresholds. Sites that are invariant within each individual sub-tree are picked as functional sites. A higher identity threshold gives rise to more sub-trees and, since conserved sites are more frequent in the sub-trees with smaller sizes, lead to more predicted sites. ET analysis was performed from a low identity threshold to higher thresholds until the number of predicted sites was 10 or just above 10 (in the cases of ties). Ties were resolved similarly to the simple conservation method. The third method (conservation difference or CD) is based on the conservation differences between a native alignment and an alignment derived from the <italic>Z</italic>-score sequence design [<xref ref-type="bibr" rid="B21">21</xref>]. The basic idea was to differentiate sites conserved due to structural stability and sites conserved due to function. Since the pairwise potential in the <italic>Z</italic>-score design tends to weaken the conservation caused by function, functionally conserved sites tend to have a large conservation difference between the native alignment and the alignment of designed sequences. We chose 10 top ranking sites sorted by conservation difference as predictions by CD.</p></sec></sec></sec><sec><title>Authors' contributions</title><p>NVG conceived and initiated the study. All authors took part in developing methods and designing experiments. WC wrote the source code and JP analyzed the data. All authors read and approved the final manuscripts.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>We thank Lisa Kinch, James Wrabl and Hua Cheng for their useful comments. This work was supported by the NIH grant GM67165 to NVG.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name></person-group><article-title>Toward defining the course of evolution: minimum change for a specific tree topology</article-title><source>Syst Zool</source><year>1971</year><volume>20</volume><fpage>406</fpage><lpage>416</lpage></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hartigan</surname><given-names>JA</given-names></name></person-group><article-title>Minimum evolution fits to a given tree</article-title><source>Biometrics</source><year>1973</year><volume>29</volume><fpage>53</fpage><lpage>65</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>A new method of inference of ancestral nucleotide and amino acid sequences</article-title><source>Genetics</source><year>1995</year><volume>141</volume><fpage>1641</fpage><lpage>1650</lpage><pub-id pub-id-type="pmid">8601501</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Koshi</surname><given-names>JM</given-names></name><name><surname>Goldstein</surname><given-names>RA</given-names></name></person-group><article-title>Probabilistic reconstruction of ancestral protein sequences</article-title><source>J Mol Evol</source><year>1996</year><volume>42</volume><fpage>313</fpage><lpage>320</lpage><pub-id pub-id-type="pmid">8919883</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pupko</surname><given-names>T</given-names></name><name><surname>Pe'er</surname><given-names>I</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name><name><surname>Graur</surname><given-names>D</given-names></name></person-group><article-title>A fast algorithm for joint reconstruction of ancestral amino acid sequences</article-title><source>Mol Biol Evol</source><year>2000</year><volume>17</volume><fpage>890</fpage><lpage>896</lpage><pub-id pub-id-type="pmid">10833195</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>Accuracies of ancestral amino acid sequences inferred by the parsimony, likelihood, and distance methods</article-title><source>J Mol Evol</source><year>1997</year><volume>44 Suppl 1</volume><fpage>S139</fpage><lpage>146</lpage><pub-id pub-id-type="pmid">9071022</pub-id></citation></ref><ref id="B7"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>PAML: a phylogenetic analysis by maximum likelihood. Version 2.0e</article-title><source>Pennsylvania State University, University Park</source><year>1995</year></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>J Mol Evol</source><year>1981</year><volume>17</volume><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="pmid">7288891</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Saitou</surname><given-names>N</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title><source>Mol Biol Evol</source><year>1987</year><volume>4</volume><fpage>406</fpage><lpage>425</lpage><pub-id pub-id-type="pmid">3447015</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bruno</surname><given-names>WJ</given-names></name><name><surname>Socci</surname><given-names>ND</given-names></name><name><surname>Halpern</surname><given-names>AL</given-names></name></person-group><article-title>Weighted neighbor joining: a likelihood-based approach to distance-based phylogeny reconstruction</article-title><source>Mol Biol Evol</source><year>2000</year><volume>17</volume><fpage>189</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">10666718</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gascuel</surname><given-names>O</given-names></name></person-group><article-title>BIONJ: an improved version of the NJ algorithm based on a simple model of sequence data</article-title><source>Mol Biol Evol</source><year>1997</year><volume>14</volume><fpage>685</fpage><lpage>695</lpage><pub-id pub-id-type="pmid">9254330</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Uzzell</surname><given-names>T</given-names></name><name><surname>Corbin</surname><given-names>KW</given-names></name></person-group><article-title>Fitting discrete probability distributions to evolutionary events</article-title><source>Science</source><year>1971</year><volume>172</volume><fpage>1089</fpage><lpage>1896</lpage><pub-id pub-id-type="pmid">5574514</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Maximum-likelihood estimation of phylogeny from DNA sequences when substitution rates differ over sites</article-title><source>Mol Biol Evol</source><year>1993</year><volume>10</volume><fpage>1396</fpage><lpage>1401</lpage><pub-id pub-id-type="pmid">8277861</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name><name><surname>Margoliash</surname><given-names>E</given-names></name></person-group><article-title>Construction of phylogenetic trees</article-title><source>Science</source><year>1967</year><volume>155</volume><fpage>279</fpage><lpage>284</lpage><pub-id pub-id-type="pmid">5334057</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name></person-group><article-title>The estimate of total nucleotide substitutions from pairwise differences is biased</article-title><source>Philos Trans R Soc Lond B Biol Sci</source><year>1986</year><volume>312</volume><fpage>317</fpage><lpage>324</lpage><pub-id pub-id-type="pmid">2870524</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title>A simple method for estimating the parameter of substitution rate variation among sites</article-title><source>Mol Biol Evol</source><year>1997</year><volume>14</volume><fpage>1106</fpage><lpage>1113</lpage><pub-id pub-id-type="pmid">9364768</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Taking variation of evolutionary rates between sites into account in inferring phylogenies</article-title><source>J Mol Evol</source><year>2001</year><volume>53</volume><fpage>447</fpage><lpage>455</lpage><pub-id pub-id-type="pmid">11675604</pub-id><pub-id pub-id-type="doi">10.1007/s002390010234</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><article-title>Site-by-site estimation of the rate of substitution and the correlation of rates in mitochondrial DNA</article-title><source>Syst Biol</source><year>1997</year><volume>46</volume><fpage>346</fpage><lpage>353</lpage><pub-id pub-id-type="pmid">11975345</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pupko</surname><given-names>T</given-names></name><name><surname>Pe'er</surname><given-names>I</given-names></name><name><surname>Hasegawa</surname><given-names>M</given-names></name><name><surname>Graur</surname><given-names>D</given-names></name><name><surname>Friedman</surname><given-names>N</given-names></name></person-group><article-title>A branch-and-bound algorithm for the inference of ancestral amino-acid sequences when the replacement rate varies among sites: Application to the evolution of five gene families</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1116</fpage><lpage>1123</lpage><pub-id pub-id-type="pmid">12176835</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.8.1116</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname><given-names>T</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name></person-group><article-title>Modeling amino acid replacement</article-title><source>J Comput Biol</source><year>2000</year><volume>7</volume><fpage>761</fpage><lpage>776</lpage><pub-id pub-id-type="pmid">11382360</pub-id><pub-id pub-id-type="doi">10.1089/10665270050514918</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pei</surname><given-names>J</given-names></name><name><surname>Dokholyan</surname><given-names>NV</given-names></name><name><surname>Shakhnovich</surname><given-names>EI</given-names></name><name><surname>Grishin</surname><given-names>NV</given-names></name></person-group><article-title>Using protein design for homology detection and active site searches</article-title><source>Proc Natl Acad Sci U S A</source><year>2003</year><volume>100</volume><fpage>11361</fpage><lpage>11366</lpage><pub-id pub-id-type="pmid">12975528</pub-id><pub-id pub-id-type="doi">10.1073/pnas.2034878100</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Evalution of Several Methods for Estimating Phylogenetic Trees When Substitution Rates Differ over Nucleotide Sites</article-title><source>J Mol Evol</source><year>1995</year><volume>40</volume><fpage>689</fpage><lpage>697</lpage></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>S</given-names></name><name><surname>Thornton</surname><given-names>JM</given-names></name></person-group><article-title>Searching for functional sites in protein structures</article-title><source>Curr Opin Chem Biol</source><year>2004</year><volume>8</volume><fpage>3</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">15036149</pub-id><pub-id pub-id-type="doi">10.1016/j.cbpa.2003.11.001</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lichtarge</surname><given-names>O</given-names></name><name><surname>Sowa</surname><given-names>ME</given-names></name></person-group><article-title>Evolutionary predictions of binding surfaces and interactions</article-title><source>Curr Opin Struct Biol</source><year>2002</year><volume>12</volume><fpage>21</fpage><lpage>27</lpage><pub-id pub-id-type="pmid">11839485</pub-id><pub-id pub-id-type="doi">10.1016/S0959-440X(02)00284-1</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pei</surname><given-names>J</given-names></name><name><surname>Grishin</surname><given-names>NV</given-names></name></person-group><article-title>AL2CO: calculation of positional conservation in a protein sequence alignment</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>700</fpage><lpage>712</lpage><pub-id pub-id-type="pmid">11524371</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/17.8.700</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lichtarge</surname><given-names>O</given-names></name><name><surname>Bourne</surname><given-names>HR</given-names></name><name><surname>Cohen</surname><given-names>FE</given-names></name></person-group><article-title>An evolutionary trace method defines binding surfaces common to protein families</article-title><source>J Mol Biol</source><year>1996</year><volume>257</volume><fpage>342</fpage><lpage>358</lpage><pub-id pub-id-type="pmid">8609628</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1996.0167</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tamura</surname><given-names>K</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees</article-title><source>Mol Biol Evol</source><year>1993</year><volume>10</volume><fpage>512</fpage><lpage>526</lpage><pub-id pub-id-type="pmid">8336541</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title><source>J Mol Evol</source><year>1994</year><volume>39</volume><fpage>306</fpage><lpage>314</lpage><pub-id pub-id-type="pmid">7932792</pub-id><pub-id pub-id-type="doi">10.1007/BF00178256</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bateman</surname><given-names>A</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name><name><surname>Cerruti</surname><given-names>L</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Etwiller</surname><given-names>L</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name><name><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name><surname>Howe</surname><given-names>KL</given-names></name><name><surname>Marshall</surname><given-names>M</given-names></name><name><surname>Sonnhammer</surname><given-names>EL</given-names></name></person-group><article-title>The Pfam protein families database</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>276</fpage><lpage>280</lpage><pub-id pub-id-type="pmid">11752314</pub-id><pub-id pub-id-type="doi">10.1093/nar/30.1.276</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>PAML: a program package for phylogenetic analysis by maximum likelihood</article-title><source>Comput Appl Biosci</source><year>1997</year><volume>13</volume><fpage>555</fpage><lpage>556</lpage><pub-id pub-id-type="pmid">9367129</pub-id></citation></ref><ref id="B31"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>PHYLIP (Phylogeny Inference Package), version 3.6b</article-title><source>Department of Genetics, University of Washington, Seattle</source><year>2004</year></citation></ref><ref id="B32"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Swofford</surname><given-names>DL</given-names></name></person-group><article-title>PAUP*: Phylogenetic Analysis Using Parsimony (*and Other Methods). Version 4.</article-title><source>Sinauer Associates, Sunderland, Massachusetts</source><year>2002</year></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>HM</given-names></name><name><surname>Westbrook</surname><given-names>J</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Gilliland</surname><given-names>G</given-names></name><name><surname>Bhat</surname><given-names>TN</given-names></name><name><surname>Weissig</surname><given-names>H</given-names></name><name><surname>Shindyalov</surname><given-names>IN</given-names></name><name><surname>Bourne</surname><given-names>PE</given-names></name></person-group><article-title>The Protein Data Bank</article-title><source>Nucleic Acids Res</source><year>2000</year><volume>28</volume><fpage>235</fpage><lpage>242</lpage><pub-id pub-id-type="pmid">10592235</pub-id><pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>AG</given-names></name></person-group><article-title>OB(oligonucleotide/oligosaccharide binding)-fold: common structural and functional solution for non-homologous sequences</article-title><source>Embo J</source><year>1993</year><volume>12</volume><fpage>861</fpage><lpage>867</lpage><pub-id pub-id-type="pmid">8458342</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Madden</surname><given-names>TL</given-names></name><name><surname>Schaffer</surname><given-names>AA</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Lipman</surname><given-names>DJ</given-names></name></person-group><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title><source>Nucleic Acids Res</source><year>1997</year><volume>25</volume><fpage>3389</fpage><lpage>3402</lpage><pub-id pub-id-type="pmid">9254694</pub-id><pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id></citation></ref><ref id="B36"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>Profile hidden Markov models</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>755</fpage><lpage>763</lpage><pub-id pub-id-type="pmid">9918945</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.755</pub-id></citation></ref><ref id="B37"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schaffer</surname><given-names>AA</given-names></name><name><surname>Aravind</surname><given-names>L</given-names></name><name><surname>Madden</surname><given-names>TL</given-names></name><name><surname>Shavirin</surname><given-names>S</given-names></name><name><surname>Spouge</surname><given-names>JL</given-names></name><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name></person-group><article-title>Improving the accuracy of PSI-BLAST protein database searches with composition-based statistics and other refinements</article-title><source>Nucleic Acids Res</source><year>2001</year><volume>29</volume><fpage>2994</fpage><lpage>3005</lpage><pub-id pub-id-type="pmid">11452024</pub-id><pub-id pub-id-type="doi">10.1093/nar/29.14.2994</pub-id></citation></ref><ref id="B38"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Muller-Dieckmann</surname><given-names>HJ</given-names></name><name><surname>Schulz</surname><given-names>GE</given-names></name></person-group><article-title>Substrate specificity and assembly of the catalytic center derived from two structures of ligated uridylate kinase</article-title><source>J Mol Biol</source><year>1995</year><volume>246</volume><fpage>522</fpage><lpage>530</lpage><pub-id pub-id-type="pmid">7877173</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1994.0104</pub-id></citation></ref><ref id="B39"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Whelan</surname><given-names>S</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach</article-title><source>Mol Biol Evol</source><year>2001</year><volume>18</volume><fpage>691</fpage><lpage>699</lpage><pub-id pub-id-type="pmid">11319253</pub-id></citation></ref><ref id="B40"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Press</surname><given-names>WH</given-names></name><name><surname>Teukolsky</surname><given-names>SA</given-names></name><name><surname>Vetterling</surname><given-names>WT</given-names></name><name><surname>Flannery</surname><given-names>BP</given-names></name></person-group><article-title>Numerical Recipes in C : The Art of Scientific Computing</article-title><year>1992</year><fpage>451</fpage><lpage>455</lpage></citation></ref><ref id="B41"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karthikeyan</surname><given-names>S</given-names></name><name><surname>Leung</surname><given-names>T</given-names></name><name><surname>Birrane</surname><given-names>G</given-names></name><name><surname>Webster</surname><given-names>G</given-names></name><name><surname>Ladias</surname><given-names>JA</given-names></name></person-group><article-title>Crystal structure of the PDZ1 domain of human Na(+)/H(+) exchanger regulatory factor provides insights into the mechanism of carboxyl-terminal leucine recognition by class I PDZ domains</article-title><source>J Mol Biol</source><year>2001</year><volume>308</volume><fpage>963</fpage><lpage>973</lpage><pub-id pub-id-type="pmid">11352585</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.2001.4634</pub-id></citation></ref><ref id="B42"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Read</surname><given-names>RJ</given-names></name><name><surname>James</surname><given-names>MN</given-names></name></person-group><article-title>Refined crystal structure of Streptomyces griseus trypsin at 1.7 A resolution</article-title><source>J Mol Biol</source><year>1988</year><volume>200</volume><fpage>523</fpage><lpage>551</lpage><pub-id pub-id-type="pmid">3135412</pub-id></citation></ref><ref id="B43"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Teplyakov</surname><given-names>A</given-names></name></person-group><article-title>High-resolution structure of the complex between carboxypeptidase A and L-phenyl lactate</article-title><source>Acta Crystallogr D Biol Crystallogr</source><year>1993</year><volume>49</volume><fpage>534</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">15299490</pub-id><pub-id pub-id-type="doi">10.1107/S0907444993007267</pub-id></citation></ref><ref id="B44"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>AG</given-names></name><name><surname>Brenner</surname><given-names>SE</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name><name><surname>Chothia</surname><given-names>C</given-names></name></person-group><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>J Mol Biol</source><year>1995</year><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">7723011</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1995.0159</pub-id></citation></ref><ref id="B45"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hannenhalli</surname><given-names>SS</given-names></name><name><surname>Russell</surname><given-names>RB</given-names></name></person-group><article-title>Analysis and prediction of functional sub-types from protein sequence alignments</article-title><source>J Mol Biol</source><year>2000</year><volume>303</volume><fpage>61</fpage><lpage>76</lpage><pub-id pub-id-type="pmid">11021970</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.2000.4036</pub-id></citation></ref><ref id="B46"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mirny</surname><given-names>LA</given-names></name><name><surname>Gelfand</surname><given-names>MS</given-names></name></person-group><article-title>Using orthologous and paralogous proteins to identify specificity-determining residues in bacterial transcription factors</article-title><source>J Mol Biol</source><year>2002</year><volume>321</volume><fpage>7</fpage><lpage>20</lpage><pub-id pub-id-type="pmid">12139929</pub-id><pub-id pub-id-type="doi">10.1016/S0022-2836(02)00587-9</pub-id></citation></ref><ref id="B47"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Abele</surname><given-names>U</given-names></name><name><surname>Schulz</surname><given-names>GE</given-names></name></person-group><article-title>High-resolution structures of adenylate kinase from yeast ligated with inhibitor Ap5A, showing the pathway of phosphoryl transfer</article-title><source>Protein Sci</source><year>1995</year><volume>4</volume><fpage>1262</fpage><lpage>1271</lpage><pub-id pub-id-type="pmid">7670369</pub-id></citation></ref><ref id="B48"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boriack-Sjodin</surname><given-names>PA</given-names></name><name><surname>Margarit</surname><given-names>SM</given-names></name><name><surname>Bar-Sagi</surname><given-names>D</given-names></name><name><surname>Kuriyan</surname><given-names>J</given-names></name></person-group><article-title>The structural basis of the activation of Ras by Sos</article-title><source>Nature</source><year>1998</year><volume>394</volume><fpage>337</fpage><lpage>343</lpage><pub-id pub-id-type="pmid">9690470</pub-id><pub-id pub-id-type="doi">10.1038/28548</pub-id></citation></ref><ref id="B49"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vojtechovsky</surname><given-names>J</given-names></name><name><surname>Chu</surname><given-names>K</given-names></name><name><surname>Berendzen</surname><given-names>J</given-names></name><name><surname>Sweet</surname><given-names>RM</given-names></name><name><surname>Schlichting</surname><given-names>I</given-names></name></person-group><article-title>Crystal structures of myoglobin-ligand complexes at near-atomic resolution</article-title><source>Biophys J</source><year>1999</year><volume>77</volume><fpage>2153</fpage><lpage>2174</lpage><pub-id pub-id-type="pmid">10512835</pub-id></citation></ref><ref id="B50"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Doyle</surname><given-names>DA</given-names></name><name><surname>Lee</surname><given-names>A</given-names></name><name><surname>Lewis</surname><given-names>J</given-names></name><name><surname>Kim</surname><given-names>E</given-names></name><name><surname>Sheng</surname><given-names>M</given-names></name><name><surname>MacKinnon</surname><given-names>R</given-names></name></person-group><article-title>Crystal structures of a complexed and peptide-free membrane protein-binding domain: molecular basis of peptide recognition by PDZ</article-title><source>Cell</source><year>1996</year><volume>85</volume><fpage>1067</fpage><lpage>1076</lpage><pub-id pub-id-type="pmid">8674113</pub-id><pub-id pub-id-type="doi">10.1016/S0092-8674(00)81307-0</pub-id></citation></ref><ref id="B51"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ferguson</surname><given-names>KM</given-names></name><name><surname>Lemmon</surname><given-names>MA</given-names></name><name><surname>Schlessinger</surname><given-names>J</given-names></name><name><surname>Sigler</surname><given-names>PB</given-names></name></person-group><article-title>Structure of the high affinity complex of inositol trisphosphate with a phospholipase C pleckstrin homology domain</article-title><source>Cell</source><year>1995</year><volume>83</volume><fpage>1037</fpage><lpage>1046</lpage><pub-id pub-id-type="pmid">8521504</pub-id><pub-id pub-id-type="doi">10.1016/0092-8674(95)90219-8</pub-id></citation></ref><ref id="B52"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>MM</given-names></name><name><surname>Ravichandran</surname><given-names>KS</given-names></name><name><surname>Olejniczak</surname><given-names>EF</given-names></name><name><surname>Petros</surname><given-names>AM</given-names></name><name><surname>Meadows</surname><given-names>RP</given-names></name><name><surname>Sattler</surname><given-names>M</given-names></name><name><surname>Harlan</surname><given-names>JE</given-names></name><name><surname>Wade</surname><given-names>WS</given-names></name><name><surname>Burakoff</surname><given-names>SJ</given-names></name><name><surname>Fesik</surname><given-names>SW</given-names></name></person-group><article-title>Structure and ligand recognition of the phosphotyrosine binding domain of Shc</article-title><source>Nature</source><year>1995</year><volume>378</volume><fpage>584</fpage><lpage>592</lpage><pub-id pub-id-type="pmid">8524391</pub-id><pub-id pub-id-type="doi">10.1038/378584a0</pub-id></citation></ref><ref id="B53"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Franken</surname><given-names>SM</given-names></name><name><surname>Scheidig</surname><given-names>AJ</given-names></name><name><surname>Krengel</surname><given-names>U</given-names></name><name><surname>Rensland</surname><given-names>H</given-names></name><name><surname>Lautwein</surname><given-names>A</given-names></name><name><surname>Geyer</surname><given-names>M</given-names></name><name><surname>Scheffzek</surname><given-names>K</given-names></name><name><surname>Goody</surname><given-names>RS</given-names></name><name><surname>Kalbitzer</surname><given-names>HR</given-names></name><name><surname>Pai</surname><given-names>EF</given-names></name><name><surname>Wittinghofer</surname><given-names>A</given-names></name></person-group><article-title>Three-dimensional structures and properties of a transforming and a nontransforming glycine-12 mutant of p21H-ras</article-title><source>Biochemistry</source><year>1993</year><volume>32</volume><fpage>8411</fpage><lpage>8420</lpage><pub-id pub-id-type="pmid">8357792</pub-id></citation></ref><ref id="B54"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Charifson</surname><given-names>PS</given-names></name><name><surname>Shewchuk</surname><given-names>LM</given-names></name><name><surname>Rocque</surname><given-names>W</given-names></name><name><surname>Hummel</surname><given-names>CW</given-names></name><name><surname>Jordan</surname><given-names>SR</given-names></name><name><surname>Mohr</surname><given-names>C</given-names></name><name><surname>Pacofsky</surname><given-names>GJ</given-names></name><name><surname>Peel</surname><given-names>MR</given-names></name><name><surname>Rodriguez</surname><given-names>M</given-names></name><name><surname>Sternbach</surname><given-names>DD</given-names></name><name><surname>Consler</surname><given-names>TG</given-names></name></person-group><article-title>Peptide ligands of pp60(c-src) SH2 domains: a thermodynamic and structural study</article-title><source>Biochemistry</source><year>1997</year><volume>36</volume><fpage>6283</fpage><lpage>6293</lpage><pub-id pub-id-type="pmid">9174343</pub-id><pub-id pub-id-type="doi">10.1021/bi970019n</pub-id></citation></ref><ref id="B55"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>S</given-names></name><name><surname>Kapoor</surname><given-names>TM</given-names></name><name><surname>Shirai</surname><given-names>F</given-names></name><name><surname>Combs</surname><given-names>AP</given-names></name><name><surname>Schreiber</surname><given-names>SL</given-names></name></person-group><article-title>Molecular basis for the binding of SH3 ligands with non-peptide elements identified by combinatorial synthesis</article-title><source>Chem Biol</source><year>1996</year><volume>3</volume><fpage>661</fpage><lpage>670</lpage><pub-id pub-id-type="pmid">8807900</pub-id><pub-id pub-id-type="doi">10.1016/S1074-5521(96)90134-9</pub-id></citation></ref><ref id="B56"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stoll</surname><given-names>VS</given-names></name><name><surname>Eger</surname><given-names>BT</given-names></name><name><surname>Hynes</surname><given-names>RC</given-names></name><name><surname>Martichonok</surname><given-names>V</given-names></name><name><surname>Jones</surname><given-names>JB</given-names></name><name><surname>Pai</surname><given-names>EF</given-names></name></person-group><article-title>Differences in binding modes of enantiomers of 1-acetamido boronic acid based protease inhibitors: crystal structures of gamma-chymotrypsin and subtilisin Carlsberg complexes</article-title><source>Biochemistry</source><year>1998</year><volume>37</volume><fpage>451</fpage><lpage>462</lpage><pub-id pub-id-type="pmid">9425066</pub-id><pub-id pub-id-type="doi">10.1021/bi971166o</pub-id></citation></ref><ref id="B57"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>YI</given-names></name><name><surname>Aravind</surname><given-names>L</given-names></name><name><surname>Grishin</surname><given-names>NV</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><article-title>Evolution of aminoacyl-tRNA synthetases--analysis of unique domain architectures and phylogenetic trees reveals a complex history of horizontal gene transfer events</article-title><source>Genome Res</source><year>1999</year><volume>9</volume><fpage>689</fpage><lpage>710</lpage><pub-id pub-id-type="pmid">10447505</pub-id></citation></ref><ref id="B58"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Statistical tests of models of DNA substitution</article-title><source>J Mol Evol</source><year>1993</year><volume>36</volume><fpage>182</fpage><lpage>198</lpage><pub-id pub-id-type="pmid">7679448</pub-id></citation></ref></ref-list></back></article>



